function _asyncToGenerator(a){return function(){var b=a.apply(this,arguments);return new Promise(function(a,c){function d(e,f){try{var g=b[e](f),h=g.value}catch(a){return void c(a)}return g.done?void a(h):Promise.resolve(h).then(function(a){d("next",a)},function(a){d("throw",a)})}return d("next")})}}import imageCompression from"../vendor/browser-image-compression.js";import formatFileSize from"../helpers/formatFileSize.js";import getLocalStorageId from"../helpers/getLocalStorageId.js";import getCompleteStorage from"../helpers/getCompleteStorage.js";export const storeDesign=(()=>{var a=_asyncToGenerator(function*(a,b,c){const d=a.image,e=yield imageCompression.getFilefromDataUrl(d),f=yield imageCompression(e,{maxSizeMB:1,useWebWorker:!0}),g=yield imageCompression.getDataUrlFromFile(f),h={src:g,date:new Date().toISOString(),pageUrl:a.pageUrl,readableFileSize:formatFileSize(g.length),fileSize:g.length,originalName:a.name,storedInCloud:!1},i=getLocalStorageId(a.pageUrl);try{yield localStorage.setItem(i,JSON.stringify(h))}catch(b){if(b.toString().includes("exceeded the quota")){const b=getCompleteStorage(),d=b.reduce(function(a,b){return a+b.fileSize},0),e=g.length;return void c({error:"STORAGE_FULL",storage:b,freeSpaceNeeded:formatFileSize(e-(5120000-d)),request:a})}}c(h)});return function(){return a.apply(this,arguments)}})();export const getDesign=(a,b,c)=>{const d=getLocalStorageId(a.pageUrl),e=localStorage.hasOwnProperty(d)&&"undefined"!=typeof localStorage[d];c(e&&JSON.parse(localStorage.getItem(d)))};export const deleteDesign=a=>{const b=getLocalStorageId(a.pageUrl);localStorage.removeItem(b)};