"use strict";function displayCalcOptionsNew(){if($("div#third-party-controls").length){var e=document.getElementById("third-party-controls"),t=void 0,n=void 0;if(notStartingMsg&&(checkForNonStartersNew(),$("input[name=lineup-type]").on("change",function(){setTimeout(function(){$("#rg-warning").remove(),checkForNonStartersNew()},2e3)})),playerExpose){$(".Filters_rg-container").length?n=document.getElementsByClassName("Filters_rg-global-options")[0]:(t=document.createElement("div"),t.setAttribute("class","Filters_rg-container"),$(t).css({padding:"8px 0"}),$(t).insertAfter(e),n=document.createElement("div"),n.setAttribute("class","Filters_rg-global-options"),$(n).css({display:"inline-block"}),$(".Filters_rg-container").append(n));var i=document.createElement("img");i.setAttribute("src",browser.runtime.getURL("logo-128.png")),$(i).appendTo($(n));var a=document.createElement("div");a.setAttribute("class","Filters_rg-player-expose"),a.textContent="Player Exposure Options:",$(a).appendTo($(n));var r=document.createElement("select");r.setAttribute("id","rg-calc-total"),a.appendChild(r);var s=document.createElement("option");s.value="total-entries",s.text="Total Entries",r.appendChild(s);var o=document.createElement("option");o.value="unique-lineups",o.text="Unique Lineups",r.appendChild(o);var l=document.createElement("select");l.setAttribute("id","rg-slate-groups"),a.appendChild(l);var p=document.createElement("option");p.value="group-slates",p.text="Group By Slate",l.appendChild(p);var u=document.createElement("option");u.value="group-game-styles",u.text="Group By Game Style",l.appendChild(u);var c=document.createElement("option");c.value="group-all-sport",c.text="Group All By Sport",l.appendChild(c),$(".Filters_rg-global-options img").css({height:"20px",width:"20px","vertical-align":"baseline",padding:"0 8px"}),$(".Filters_rg-player-expose").css({color:"#f98c13","font-weight":"600 !important","font-size":"16px","padding-right":"8px",display:"inline-block"}),$(".Filters_rg-player-expose select").css({"margin-left":"8px"}),$("#rg-calc-total, #rg-slate-groups").on("change",function(){displayExposureBtns()}),$("input[name=lineup-type]").on("change",function(){setTimeout(function(){displayExposureBtns()},2e3)}),$("input.player-search").on("input",function(){displayExposureBtns()}),$("input.player-search").parent().on("click","span, ul",function(){displayExposureBtns()}),$("#third-party-controls").parent().on("click",".legacy",function(){setTimeout(function(){displayExposureBtns()},2e3)}),document.addEventListener("dk-public-data-ready",function(){g_lineupCards=getAllLineups(),Object.keys(g_lineupCards).length&&(g_playerMap=getAllDraftables(),g_gameTypeMap=getAllGameTypes(),waitForClosedDrawer())}),g_lineupCards=getAllLineups(),g_playerMap=getAllDraftables(),g_gameTypeMap=getAllGameTypes(),waitForLineupCardsNew(),watchForChangesNew()}}else setTimeout(function(){displayCalcOptionsNew()},2e3)}function displayExposureBtns(){if($("div.ReactVirtualized__Table").parent().length)$("div.ReactVirtualized__Table").parent().each(function(){$(this).find(".ReactVirtualized__Table__headerColumn").css({"margin-right":"0"}),insertExposureBtn(this)}),summarizeLineupsNew();else{if($(".ReactVirtualized__List span").length&&-1!==$(".ReactVirtualized__List span").text().indexOf("You currently do not have any"))return;setTimeout(function(){displayExposureBtns()},1e3)}}function watchForChangesNew(){$("[data-test-id=lineup-editor]").length?waitForCompletedEditsNew():setTimeout(function(){playerExpose&&displayExposureBtns(),watchForChangesNew()},2e3)}function watchForChanges(){var e,t,n=!1;if($("div.popdown.new-lineup-panel.new").each(function(){n=!0,e="new",t=null}),$("div.popdown.global-player-swap-panel.complete").each(function(){n=!0,e="global",t=$(this).find("select.contest-type-filter option:selected").text()}),$(".dkjs-editor").each(function(){e="edit_single",t=$(this).find(".EditLineup_sport-name").text()}),$("div.popdown.export-panel").each(function(){e="export",t=$(this).find("div.top h2").text()}),$("div.bottom").filter(function(){return"lineup complete show"!==$(this).parent().get(0).className}).each(function(){"block"===$(this).find("div.popdown-arrow").css("display")&&(n=!0)}),n)waitForCompletedEdits(e,t);else{var i=sumLineupGroups(),a=foundLineupStatusChange(i.newCt,i.upcomingCt,i.liveCt);if(playerExpose){var r=$("input[name=player-opts]:checked").val(),s=$("input[name=status-opts]:checked").val(),o=$("input[name=slate-opts]:checked").val();(a||calcAllEntries!==r||statusGrouping!==s||slateGrouping!==o)&&(calcAllEntries=r,statusGrouping=s,slateGrouping=o,summarizeLineups(calcAllEntries,statusGrouping,slateGrouping))}setTimeout(function(){watchForChanges()},2e3)}}function waitForCompletedEditsNew(){$("[data-test-id=lineup-editor]").length?setTimeout(function(){waitForCompletedEditsNew()},2e3):setTimeout(function(){notStartingMsg&&($("#rg-warning").remove(),checkForNonStartersNew()),watchForChangesNew()},2e3)}function waitForCompletedEdits(e,t){$("div.popdown.new-lineup-panel.new").each(function(){e="new"}),$("div.popdown.global-player-swap-panel.complete").each(function(){e="global",t=$(this).find("select.contest-type-filter option:selected").text()}),$(".dkjs-editor").each(function(){e="edit_single",t=$(this).find(".EditLineup_sport-name").text()}),$("div.popdown.export-panel").each(function(){e="export",t=$(this).find("div.top h2").text()}),"block"===$("div.popdown").css("display")?setTimeout(function(){waitForCompletedEdits(e,t)},2e3):setTimeout(function(){letLineupsGenerate(e,t)},2e3)}function letLineupsGenerate(e,t){notStartingMsg&&($("#rg-warning").remove(),checkForNonStarters());var n=sumLineupGroups();foundLineupStatusChange(n.newCt,n.upcomingCt,n.liveCt),playerExpose&&(calcAllEntries=$("input[name=player-opts]:checked").val(),statusGrouping=$("input[name=status-opts]:checked").val(),slateGrouping=$("input[name=slate-opts]:checked").val(),summarizeLineups(calcAllEntries,statusGrouping,slateGrouping)),watchForChanges()}function checkForNonStartersNew(){if($("div.ReactVirtualized__Table").parent().length){var e=0;if("Finalized"!==$("input[name=lineup-type]:checked").val()&&(e=$(document).find(".BattingOrder_not-starting").length),e>0){var t=document.querySelector("h3"),n=document.createElement("h2");n.setAttribute("id","rg-warning"),$(n).css({color:"red",display:"flex","padding-right":"8px"});var i="CHECK YOUR LINEUPS: YOU HAVE "+e+" PLAYERS NOT IN THE STARTING LINEUP";1===e&&(i="CHECK YOUR LINEUPS: YOU HAVE "+e+" PLAYER NOT IN THE STARTING LINEUP"),n.textContent=i;var a=document.createElement("a");a.setAttribute("href","#"),a.setAttribute("class","rg-dismiss-btn"),a.textContent="(Close Message)",$(a).css({color:"red","margin-left":"15px"}),a.addEventListener("click",function(){$("#rg-warning").remove()}),n.appendChild(a),t.appendChild(n)}}else{if($(".ReactVirtualized__List span").length&&-1!==$(".ReactVirtualized__List span").text().indexOf("You currently do not have any"))return;setTimeout(function(){checkForNonStartersNew()},1e3)}}function checkForNonStarters(){var e=0;if($("div.lineup").filter(function(){return"lineup complete show"!==$(this).get(0).className}).each(function(){$(this).find("tbody tr").find("i.icon-ban-circle").each(function(){e++})}),e>0){var t=document.getElementById("my-lineups"),n=document.createElement("h3");n.setAttribute("id","rg-warning"),n.style.color="red";var i="CHECK YOUR LINEUPS: YOU HAVE "+e+" PLAYERS NOT IN THE STARTING LINEUP";1===e&&(i="CHECK YOUR LINEUPS: YOU HAVE "+e+" PLAYER NOT IN THE STARTING LINEUP"),n.textContent=i;var a=document.createElement("a");a.setAttribute("href","#"),a.setAttribute("class","rg-dismiss-btn"),a.textContent="(Close Message)",$(a).css({color:"red","margin-left":"15px"}),a.addEventListener("click",function(){$("#rg-warning").remove()}),n.appendChild(a),t.appendChild(n)}}function displayCalcOptions(){var e=document.getElementsByClassName("green-filter-bar")[0],t=void 0,n=void 0;if(notStartingMsg&&checkForNonStarters(),playerExpose){t=document.createElement("div"),t.setAttribute("class","percent-owned-bar"),$(t).insertAfter(e);var i=document.createElement("img");i.setAttribute("src",browser.runtime.getURL("logo-128.png")),$(i).appendTo($(t));var a=document.createElement("div");a.setAttribute("class","player-expose-toggle"),a.textContent="CALCULATE PLAYER % OWNED BY:",$(a).appendTo($(t)),$('<label><input type="radio" name="player-opts" value="Entries" checked="checked"><span>TOTAL ENTRIES</span></label>').appendTo($(a)),$('<label><input type="radio" name="player-opts" value="Lineups"><span>UNIQUE LINEUPS</span></label>').appendTo($(a)),$('<label><input type="radio" name="status-opts" value="Separate" checked="checked"><span>SEPARATE STATUSES</span></label>').appendTo($(a)),$('<label><input type="radio" name="status-opts" value="Group"><span>GROUP STATUSES</span></label>').appendTo($(a)),n=document.createElement("div"),n.setAttribute("class","game-types-bar"),$(n).insertAfter(t);var r=document.createElement("div");r.setAttribute("class","player-expose-toggle"),r.textContent="PLAYER % OWNED SLATE OPTIONS:",$(r).appendTo($(n)),$('<label><input type="radio" name="slate-opts" value="Separated" checked="checked"><span>SEPARATE BY START TIME/GAME TYPE</span></label>').appendTo($(r)),$('<label><input type="radio" name="slate-opts" value="Grouped"><span>GROUP ALL BY SPORT</span></label>').appendTo($(r)),$(".percent-owned-bar").css({color:"#f98c13"}),$(".percent-owned-bar").css({padding:"15px 20px 0"}),$(".percent-owned-bar").css({height:"27px"}),$(".percent-owned-bar").css({display:"inline-block"}),$(".percent-owned-bar img").css({height:"20px",width:"20px","vertical-align":"baseline","padding-right":"15px"}),$(".player-expose-toggle").css({display:"inline-block"}),$(".percent-owned-bar").css({display:"inline-block"}),$(".player-expose-toggle label").css({"margin-left":"15px"}),$(".game-types-bar").css({color:"#fff"}),$(".game-types-bar").css({padding:"5px 20px 0"}),$(".game-types-bar").css({height:"27px"})}watchForChanges()}function matchPlayerNew(e,t,n,i,a,r,s,o,l,p){var u=getExposureTotal(n,t,a,r,s,o,l),c=$(e),d=c.find(".exposedetails");d.length||(d=$('<span class="exposedetails"></span>').appendTo(c.find(".ReactVirtualized__Table__rowColumn").eq(p)),c.find(".ReactVirtualized__Table__rowColumn").eq(p).css({overflow:"visible"}));var f=void 0;0===i?f=0:(f=Math.round(u/i*100),0===f&&0!==u?f="<1":100===f&&u<i&&(f=">99")),d.text(" "+f+"%").css({color:"#0094d9","margin-left":"3px","font-size":"smaller"})}function matchPlayer(e,t,n,i,a,r){var s=t+"/"+r,o=$(e);o.find("td.p-name").attr("data-exp","true");var l=_.find(n,function(e){return s===e.PlayerId}),p=o.find(".exposedetails");p.length||(p=$('<small class="exposedetails"></small>').appendTo(o.find("td.p-name")));var u=void 0;0===i?u=0:(u=Math.round(l.Entries/i*100),0===u&&0!==l.Entries?u="<1":100===u&&l.Entries<i&&(u=">99")),"new"===a?p.text(" "+u+"%").css({color:"silver"}):"live"===a?p.text(" "+u+"%").css({color:"yellow"}):"upcoming"===a?p.text(" "+u+"%").css({color:"orange"}):p.text(" "+u+"%").css({color:"white"})}function getPlayerId(e,t,n,i,a){var r=0;$(e).find("tbody tr").each(function(){var s=$(e).find("tbody tr").eq(r).attr("data-pid");matchPlayer($(e).find("tbody tr").eq(r),s,t,n,i,a),r++})}function getExposureTotal(e,t,n,i,a,r,s){var o=0;return"group-all-sport"===s?"total-entries"===r?e.forEach(function(e){e.id===t&&e.status===a&&(o+=e.entryCt)}):e.forEach(function(e){e.id===t&&e.status===a&&(o+=e.lineupCt)}):"group-game-styles"===s?"total-entries"===r?e.forEach(function(e){e.id===t&&e.gameStyle===n&&e.status===a&&(o+=e.entryCt)}):e.forEach(function(e){e.id===t&&e.gameStyle===n&&e.status===a&&(o+=e.lineupCt)}):"total-entries"===r?e.forEach(function(e){e.id===t&&e.draftGroupId===i&&e.status===a&&(o+=e.entryCt)}):e.forEach(function(e){e.id===t&&e.draftGroupId===i&&e.status===a&&(o+=e.lineupCt)}),o}function getPlayerTotals(e,t,n,i,a,r,s,o,l){var p=1;"NAS"===n&&(p=0),$(e).find(".ReactVirtualized__Table__row").each(function(){var e=Number($(this).find("._3Lq5HRFohPaV7Euqe8UxKA").attr("data-pid"));matchPlayerNew($(this),e,t,i,a,r,s,o,l,p)})}function getSportTotals(e,t,n,i,a){var r=$("input[name=lineup-type]:checked").val();$("div.ReactVirtualized__Table").parent().each(function(){var s=$(this).attr("data-lineupid");if(exclExposure.includes(s))$(this).find(".exposedetails").remove();else{var o=$(this).find(".CDR1ZxQX2ZSv-k1OldAaF").text(),l=o.split(" ")[0];o=$.trim(o.replace(l,""));var p=n.find(function(e){return e.lineupId===s});if(void 0!==p){var u=p.slateId,c=getExposureTotal(t,l,o,u,r,i,a);getPlayerTotals(this,e,l,c,o,u,r,i,a)}}})}function getSport(e,t,n,i,a){$(e).each(function(){var r=$(e).find("div.top h2").text(),s=r.split("-")[0];r+=$(this).find("div.status span").attr("data-time");var o=r;"Grouped"===a&&(o=s);var l=_.find(n,function(e){return o===e.Sport});getPlayerId(e,t,l.NumContests,i,o)})}function getNewDetails(e,t,n,i){$("div.lineup.new").each(function(){getSport(this,e,t,n,i)})}function getLiveDetails(e,t,n,i){$("div.lineup.live").each(function(){getSport(this,e,t,n,i)})}function getUpcomingDetails(e,t,n,i){$("div.lineup.upcoming").each(function(){getSport(this,e,t,n,i)})}function populatePlayerList(e,t,n,i){var a=0,r=$(e).find("div.top h2").text(),s=r.split("-")[0];r+=$(e).find("div.status span").attr("data-time");var o=r;"Grouped"===i&&(o=s),$(e).find("tbody tr").each(function(){var i=$(e).find("tbody tr").eq(a).attr("data-pid");i+="/"+o;var r=!1;if(t.forEach(function(t){if(i===t.PlayerId){var a=Number($(e).find("div.entries").children("span").text());0===a||"Lineups"===n?t.Entries++:t.Entries+=a,r=!0}}),!r){var s={PlayerId:"Entries"};s.PlayerId=i;var l=Number($(e).find("div.entries").children("span").text());0!==l&&"Lineups"!==n||(l=1),s.Entries=l,t.push(s)}a++})}function calculateExposure(e,t,n,i,a,r){if("Separate"===a){var s=[],o=[],l=[];$("div.lineup.new").each(function(){populatePlayerList(this,s,i,r)}),$("div.lineup.upcoming").each(function(){populatePlayerList(this,l,i,r)}),$("div.lineup.live").each(function(){populatePlayerList(this,o,i,r)}),getNewDetails(s,e,"new",r),getLiveDetails(o,t,"live",r),getUpcomingDetails(l,n,"upcoming",r)}else{var p,u;!function(){p=e.slice();var a=p.map(function(e){return e.Sport});t.forEach(function(e){var t=a.indexOf(e.Sport);-1===t?p.push(e):p[t].NumContests+=e.NumContests}),a=p.map(function(e){return e.Sport}),n.forEach(function(e){var t=a.indexOf(e.Sport);-1===t?p.push(e):p[t].NumContests+=e.NumContests}),u=[],$("div.lineup.new").each(function(){populatePlayerList(this,u,i,r)}),$("div.lineup.upcoming").each(function(){populatePlayerList(this,u,i,r)}),$("div.lineup.live").each(function(){populatePlayerList(this,u,i,r)}),getNewDetails(u,p,"all",r),getLiveDetails(u,p,"all",r),getUpcomingDetails(u,p,"all",r)}()}}function summarizeLineupsNew(){Object.keys(g_lineupCards).length&&function(){var e=document.getElementById("rg-calc-total").value,t=document.getElementById("rg-slate-groups").value,n=[],i=[],a=[];Object.keys(g_lineupCards).forEach(function(e){var t=g_lineupCards[e];if(t.draftGroupId&&!exclExposure.includes(e)){var r={};r.lineupId=e,r.slateId=t.draftGroupId,a.push(r);var s=i.find(function(e){return e.id===t.sport&&e.status===t.status&&e.draftGroupId===t.draftGroupId});if(void 0===s){var o={};o.id=t.sport,o.status=t.status,o.gameTypeId=t.gameTypeId,o.gameStyle=g_gameTypeMap[t.gameTypeId].displayName,o.draftGroupId=t.draftGroupId,o.entryCt=t.entries.length,o.lineupCt=1,i.push(o)}else s.entryCt+=t.entries.length,s.lineupCt++;Object.values(t.draftableIds);Object.values(t.draftableIds).forEach(function(e){var i=n.find(function(n){return g_playerMap[e].playerId===n.id&&t.status===n.status&&t.draftGroupId===n.draftGroupId});if(void 0===i){var a={};a.id=g_playerMap[e].playerId,a.status=t.status,a.gameTypeId=t.gameTypeId,a.gameStyle=g_gameTypeMap[t.gameTypeId].displayName,a.draftGroupId=t.draftGroupId,a.entryCt=t.entries.length,a.lineupCt=1,n.push(a)}else i.entryCt+=t.entries.length,i.lineupCt++})}}),getSportTotals(n,i,a,e,t)}()}function summarizeLineups(e,t,n){var i=[],a=[],r=[];$("div.lineup.new").each(function(){var e=$(this).find("div.top h2").text(),t=e.split("-")[0];e+=$(this).find("div.status span").attr("data-time");var a=e;"Grouped"===n&&(a=t);var r=!1;if(i.forEach(function(e){a===e.Sport&&(e.NumContests++,r=!0)}),!r){var s={Sport:"NumContests"};s.Sport=a,s.NumContests=1,i.push(s)}}),$("div.lineup.upcoming").each(function(){var t=this,i=$(this).find("div.top h2").text(),r=i.split("-")[0];i+=$(this).find("div.status span").attr("data-time");var s=i;"Grouped"===n&&(s=r);var o=!1;if(a.forEach(function(n){s===n.Sport&&("Entries"===e?n.NumContests+=Number($(t).find("div.entries").children("span").text()):n.NumContests++,o=!0)}),!o){var l={Sport:"NumContests"};l.Sport=s,l.NumContests="Entries"===e?Number($(this).find("div.entries").children("span").text()):1,a.push(l)}}),$("div.lineup.live").each(function(){var t=this,i=$(this).find("div.top h2").text(),a=i.split("-")[0];i+=$(this).find("div.status span").attr("data-time");var s=i;"Grouped"===n&&(s=a);var o=!1;if(r.forEach(function(n){s===n.Sport&&("Entries"===e?n.NumContests+=Number($(t).find("div.entries").children("span").text()):n.NumContests++,o=!0)}),!o){var l={Sport:"NumContests"};l.Sport=s,l.NumContests="Entries"===e?Number($(this).find("div.entries").children("span").text()):1,r.push(l)}}),calculateExposure(i,r,a,e,t,n)}function sumLineupGroups(){var e=0,t=0,n=0;return $("div.lineup.new").each(function(){e++}),$("div.lineup.upcoming").each(function(){t++}),$("div.lineup.live").each(function(){n++}),{newCt:e,upcomingCt:t,liveCt:n}}function foundLineupStatusChange(e,t,n){var i=!1;return prevNewCt===e&&prevUpcomingCt===t&&prevLiveCt===n||(i=!0),prevNewCt=e,prevUpcomingCt=t,prevLiveCt=n,i}function insertExposureBtn(e){if(!$(e).find(".excl-calc").length){$(e).find(".ReactVirtualized__Table__rowColumn").css({"margin-right":"0"});var t=document.createElement("button");exclExposure.includes($(e).attr("data-lineupid"))?(t.setAttribute("class","_3jc_jKgc5R0NukZ4kiMZRA _1F6ixBWXyeC9EIqvOrlo-8  _3thDCX4ICx4WvvhZta4U9F excl-calc"),t.setAttribute("value","off"),t.textContent="X"):(t.setAttribute("class","_3jc_jKgc5R0NukZ4kiMZRA excl-calc"),t.setAttribute("value","on"),t.textContent="%",t.style.background="#53d337",t.style.color="#121212"),$(t).appendTo($(e).find("._22UNV-RuopvTI67G7upjjO")),$(e).find(".excl-calc").on("click",function(){if("on"===this.getAttribute("value"))exclExposure.push($(e).attr("data-lineupid")),localStorage.setItem("storedExposureOff",JSON.stringify(exclExposure)),this.setAttribute("value","off"),this.textContent="X",$(this).removeAttr("style"),$(this).addClass("_1F6ixBWXyeC9EIqvOrlo-8");else if("off"===this.getAttribute("value")){var t=exclExposure.indexOf($(e).attr("data-lineupid"));exclExposure.splice(t,1),localStorage.setItem("storedExposureOff",JSON.stringify(exclExposure)),this.setAttribute("value","on"),this.textContent="%",$(this).removeClass("_1F6ixBWXyeC9EIqvOrlo-8"),$(this).css({"background-color":"#53d337"}),$(this).css({color:"#121212"})}})}}function waitForClosedDrawer(){if($("[data-test-id=lineup-editor]").length)setTimeout(function(){waitForClosedDrawer()},1e3);else{if(null!==JSON.parse(localStorage.getItem("storedExposureOff"))){exclExposure=JSON.parse(localStorage.getItem("storedExposureOff"));for(var e=Object.keys(g_lineupCards),t=0;null!==exclExposure&&t<exclExposure.length;)e.includes(exclExposure[t])?t++:(exclExposure.splice(t,1),localStorage.setItem("storedExposureOff",JSON.stringify(exclExposure)))}displayExposureBtns()}}function waitForLineupCardsNew(){if($("div.ReactVirtualized__Table").parent().length)displayExposureBtns();else{if($(".ReactVirtualized__List span").length&&-1!==$(".ReactVirtualized__List span").text().indexOf("You currently do not have any"))return;setTimeout(function(){waitForLineupCardsNew()},1e3)}}var prevNewCt=void 0,prevUpcomingCt=void 0,prevLiveCt=void 0,exclExposure=[],calcAllEntries="",statusGrouping="",slateGrouping="",playerExpose=!1,notStartingMsg=!1,newDesign=!1,g_lineupCards=void 0,g_playerMap=void 0,g_gameTypeMap=void 0,playerExposureInit=function(e,t){prevNewCt=0,prevUpcomingCt=0,prevLiveCt=0;t&&(notStartingMsg=!0),e&&(playerExpose=!0,null!==JSON.parse(localStorage.getItem("storedExposureOff"))&&(exclExposure=JSON.parse(localStorage.getItem("storedExposureOff")))),displayCalcOptionsNew()};