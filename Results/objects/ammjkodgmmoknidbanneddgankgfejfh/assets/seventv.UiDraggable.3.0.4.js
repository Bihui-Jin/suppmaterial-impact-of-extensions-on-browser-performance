import{z as b,o as A}from"./seventv.index.esm.3.0.4.js";import{e as P,d as M,a as k,a3 as B,w as E,o as D,l as C,f as T,m as z,aM as S,a4 as h,_ as $}from"./seventv.useSettings.3.0.4.js";import{r as f,b as F}from"./seventv.useUserAgent.3.0.4.js";const H=P({__name:"UiDraggable",props:{initialPosition:null,initialAnchor:null,initialMiddleware:null,initialPlacement:null,emitClickout:{type:Boolean},handle:null},emits:["clickout"],setup(_,{emit:p}){const e=_,n=f(),g=[S({crossAxis:!0,mainAxis:!0})],w=M(()=>e.handle??n.value);let v;const r=f(0),c=f(0);async function s(t,i){if(!n.value)return;const o=Symbol();v=o;const{x:m,y:d}=await h({getBoundingClientRect(){return{width:0,height:0,x:t,y:i,top:i,left:t,right:t,bottom:i}},contextElement:e.initialAnchor instanceof HTMLElement?e.initialAnchor:void 0},n.value,{middleware:g,placement:"bottom-start"});v===o&&(r.value=m,c.value=d)}async function x(t){if(!n.value)return;const{x:i,y:o}=await h(t,n.value,{middleware:e.initialMiddleware,placement:e.initialPlacement});await s(i,o)}let u;b(n,{onMove({x:t,y:i}){u||window.requestAnimationFrame(()=>{s(t,i),u=void 0})},handle:w,preventDefault:!0});let a;k(()=>[n.value,e.initialPosition,e.initialMiddleware,e.initialPlacement],()=>{a==null||a(),a=void 0;const t=n.value;if(!t)return;let i=!0;a=B({getBoundingClientRect(){return{width:0,height:0,x:r.value,y:c.value,top:c.value,left:r.value,right:r.value,bottom:c.value}},contextElement:e.initialAnchor instanceof HTMLElement?e.initialAnchor:void 0},t,()=>{var o,m;if(i){if(e.initialAnchor)x(e.initialAnchor);else{const d=((o=e.initialPosition)==null?void 0:o[0])??0,y=((m=e.initialPosition)==null?void 0:m[1])??0;s(d,y)}i=!1}else s(r.value,c.value)})},{immediate:!0});let l;return E(()=>{l==null||l(),l=void 0,e.emitClickout&&(l=A(n.value,t=>p("clickout",t)))}),D(()=>{a==null||a(),l==null||l(),u&&cancelAnimationFrame(u)}),(t,i)=>(C(),T("div",{ref_key:"el",ref:n,class:"draggable-container",style:F({top:`${c.value}px`,left:`${r.value}px`})},[z(t.$slots,"default",{},void 0,!0)],4))}});const U=$(H,[["__scopeId","data-v-12b6a76f"]]);export{U};
