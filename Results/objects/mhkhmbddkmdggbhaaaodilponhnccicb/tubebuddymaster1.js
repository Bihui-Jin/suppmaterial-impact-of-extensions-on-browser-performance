var pluginHost="https://www.tubebuddy.com";var pluginFileRoot="chrome-extension://EXTENSION_ID/";var loadLocalHTML=true;var DOMPurifyConfig={ADD_TAGS:["meta","iframe"],ADD_ATTR:["itemprop","content","src","target"],SAFE_FOR_JQUERY:true,SANITIZE_DOM:false,WHOLE_DOCUMENT:true};DOMPurify.addHook("uponSanitizeAttribute",function(e,t,i){if(e.nodeName.toLowerCase()==="img"&&t.attrName.toLowerCase()==="src"){t.forceKeepAttr=true}return e});var TBYouTubeApi=function(){var e=false;var t=false;var i;var o;var r;var n;var a;var s;var l;var d;var u;var c;var p;var h=[];var y=[];var b=null;var f=0;var m;var v;var g;var T;var w;var k;var x=function(){Y();e=true};var B=function(e){d=e;var t=TBGlobal.host+TBGlobal.apiUrls.youtubeApiGetTrendingVideos;TBExtension.Get(t,"TBGetTrendingVideos",null)};var j=function(e,t){var i="https://www.googleapis.com/youtube/v3/channels?part=statistics&id="+e+"&key="+TBGlobal.Profile().ApiKey;TBExtension.Get(i,t,{channelId:e})};var L=function(e,t){var i="https://www.googleapis.com/youtube/v3/playlists?part=id&id="+encodeURIComponent(e)+"&key="+TBGlobal.Profile().ApiKey;TBExtension.Get(i,t,{playlistIds:e})};var C=function(e,t,i){var o="https://www.googleapis.com/youtube/v3/channels?part=id%2Csnippet%2Cstatistics%2CcontentDetails&id="+e+"&key="+TBGlobal.Profile().ApiKey;TBExtension.Get(o,t,{channelId:e,unique:i})};var Q=function(e,t,o){i=o;var r=TBGlobal.host+TBGlobal.apiUrls.youtubeApiGetVideo+"?videoId="+e+"&part="+t;TBExtension.Get(r,"TBGetVideo",null)};var U=function(e,t){return new Promise(function(i,o){var r=TBGlobal.host+TBGlobal.apiUrls.youtubeApiGetVideo+"?videoId="+e+"&part="+t;TBExtension.Get(r,function(e,t,r,n){if(e){var a=JSON.parse(r);i(a)}else{o(null)}},null)})};var I=function(e){p=e;var t=TBGlobal.host+TBGlobal.apiUrls.youtubeApiGetCurrentChannel;TBExtension.Get(t,"TBGetCurrentChannel",null)};function S(e,t){if(t.success){var o=JSON.parse(t.response);if(o){i(o)}else{i(null)}}else{i(null)}}var A=function(e,t,i,r,n,a,s){v=r;g=n;T=a;w=s;o=i;var l=TBGlobal.host+TBGlobal.apiUrls.youtubeApiGetChannelUploadPlaylist+"?channelId="+e;TBExtension.Get(l,"TBApiGetChannelUploadPlaylist",null)};var E=function(e,t,i,o){if(!t)t=TBUtilities.GetUrlEncoded("id,snippet,statistics,contentDetails");k=i;var r=TBGlobal.host+TBGlobal.apiUrls.youtubeApiGetChannel+"?channelId="+e+"&part="+t;TBExtension.Get(r,"TBGetChannelDetails",null)};function D(e,t){r=t;var i=TBGlobal.host+TBGlobal.apiUrls.youtubeApiGetApiSubscribers+"?pageToken="+e;TBExtension.Get(i,"TBGetSubscribers",e)}function R(e,t,i){m=i;var o=TBGlobal.host+TBGlobal.apiUrls.youtubeApiGetCommentsOnVideo+"?videoId="+e+"&max="+t;TBExtension.Get(o,"TBGetCommentsOnVideo",{videoId:e})}function P(e,t){if(t.success){var i=JSON.parse(t.response);if(i.Success){jQuery.each(i.Subscribers,function(e,t){if(t.ChannelId){if(TBUtilities.GetInArray(y,"channelId",t.ChannelId)==null){y.push(t)}}});if(y.length>=1e3){var o=y.slice(0,1e3);y.length=0;r(o,i.PageToken)}else{if(i.PageToken!=null&&i.PageToken!=""){D(i.PageToken,r)}else{r(y,null)}}}else{r(y,null)}}else{r(y,null)}}function G(e,t,i,o,r,d,u,c){n=o;a=r;s=d;l=c;var p=TBGlobal.host+TBGlobal.apiUrls.youtubeApiGetPageOfVideos+"?pageToken="+t+"&playlistId="+e+"&store="+(u==true);TBExtension.Get(p,"TBGetPageOfVideos",null)}function O(e,t){if(t.success){var i=JSON.parse(t.response);if(i.Success){jQuery.each(i.PlaylistItems,function(e,t){if(l){if(t.snippet.resourceId.videoId!=l){h.push(t)}}else{h.push(t)}if(s!=null){if(h.length>=s){i.PageToken=null;return false}}});if(a!=null){a({totalCount:i.TotalResults,loaded:h.length})}TBUtilities.Log(i.PageToken);if(i.PageToken!=null&&i.PageToken!=""){b=i.PageToken;G(i.PlaylistId,i.PageToken,null,n,a,s,i.Store,l)}else{n(h)}}else{n(h)}}else{n(h)}}function V(e,t,i,o){u=i;c=o;var r=TBGlobal.host+TBGlobal.apiUrls.youtubeApiGetChannelVideoSearch+"?pageToken="+t+"&query="+encodeURIComponent(e);TBExtension.Get(r,"TBGetChannelVideoSearch","")}function _(e,t){if(t.success){var i=JSON.parse(t.response);if(i.Success){jQuery.each(i.Videos,function(e,t){h.push(t)});if(c!=null){c({totalCount:i.TotalResults,loaded:h.length})}if(i.PageToken!=null&&i.PageToken!=""){b=i.PageToken;V(i.Query,i.PageToken,u,c)}else{u(h)}}else{u(h)}}else{u(h)}}function M(e,t){if(t.success){var i=JSON.parse(t.response);m(i)}}function F(e,t){if(t.success){var i=JSON.parse(t.response);p(i)}else{p(null)}}function N(e,t){if(t.success){var i=JSON.parse(t.response);d(i)}else{d(null)}}var Y=function(){jQuery(document.body).on("TBGetSubscribers",function(e,t){TBYouTubeApi.GetChannelSubscribersCallback(e,t)});jQuery(document.body).on("TBApiGetChannelUploadPlaylist",function(e,t){TBYouTubeApi.GetChannelUploadPlaylistCallback(e,t)});jQuery(document.body).on("TBGetChannelDetails",function(e,t){TBYouTubeApi.GetChannelDetailsCallback(e,t)});jQuery(document.body).on("TBGetPageOfVideos",function(e,t){TBYouTubeApi.GetPageOfVideosCallback(e,t)});jQuery(document.body).on("TBGetChannelVideoSearch",function(e,t){TBYouTubeApi.GetChannelVideoSearchCallback(e,t)});jQuery(document.body).on("TBGetVideo",function(e,t){TBYouTubeApi.GetVideoCallback(e,t)});jQuery(document.body).on("TBGetCommentsOnVideo",function(e,t){TBYouTubeApi.GetVideoCommentsCallback(e,t)});jQuery(document.body).on("TBGetCurrentChannel",function(e,t){TBYouTubeApi.GetCurrentChannelCallback(e,t)});jQuery(document.body).on("TBGetTrendingVideos",function(e,t){TBYouTubeApi.GetTrendingVideosCallback(e,t)})};return{Initialize:function(){if(!e)x()},GetTrendingVideos:function(t){if(!e){x()}return B(t)},GetVideoComments:function(t,i,o){if(!e){x()}return R(t,i,o)},GetChannelStatisticsNoApiClient:function(e,t){return j(e,t)},GetChannelSubscribersCallback:function(e,t){return P(e,t)},GetPageOfVideosCallback:function(e,t){return O(e,t)},GetVideoCallback:function(e,t){return S(e,t)},GetChannelVideoSearchCallback:function(e,t){return _(e,t)},GetVideoCommentsCallback:function(e,t){return M(e,t)},GetCurrentChannelCallback:function(e,t){return F(e,t)},GetTrendingVideosCallback:function(e,t){return N(e,t)},GetChannelSnippetContentDetailsNoApiClient:function(e,t,i){return C(e,t,i)},GetPlaylistsNoApiClient:function(e,t){return L(e,t)},GetChannelSubscribers:function(t,i){if(!e){x()}D(t,i)},GetCurrentChannel:function(t){if(!e){x()}I(t)},GetChannelDetails:function(e,t,i,o){E(e,t,i,o)},GetChannelVideos:function(e,t,i,o,r,n,a){h=[];A(e,t,i,o,r,n,a)},GetChannelUploadPlaylistCallback:function(e,t){TBUtilities.Log("Got Response");if(t!=null&&t.response!=null){h=[];loggedInUploadPlaylistId=t.response;loggedInUploadPlaylistId=TBUtilities.ReplaceAll(loggedInUploadPlaylistId,'"',"");G(loggedInUploadPlaylistId,null,null,o,v,g,T,w)}else{o(null)}},GetChannelDetailsCallback:function(e,t){if(t.success){var i=JSON.parse(t.response);k(i)}},GetChannelVideosSearch:function(t,i,o,r){h=[];if(!e){x()}V(t,i,o,r)},GetPlaylistVideos:function(t,i,o,r){h=[];if(!e){x()}G(t,null,i,o,r)},GetVideoDetails:function(t,i,o){if(!e){x()}Q(t,i,o)},GetVideoDetailsAsync:function(e,t){return U(e,t)}}}();var TBUtilities=function(){var e=0;var t=[];var o=null;var r=null;var n="header-";var a="delegatedSessionId-";var l='["asshole", "bitch", "blowjob", "cock", "cocksucker", "cunt", "piss", "fuck", "fuck you", "fucking", "motherfucker", "nigger", "pussy", "shit", "slut", "whore"]';var d=' window["ytInitialData"] = {"responseContext":';var u='window["ytInitialData"] = JSON.parse("';var c="var ytInitialData = JSON.parse('";var p="var ytInitialData = ";var h='window["ytInitialPlayerResponse"] = {"responseContext":';var y='window["ytInitialPlayerResponse"] = JSON.parse("';var b="var ytInitialPlayerResponse = ";var f=function(t){if(TBGlobal.host.indexOf("www.tubebuddy.com")==-1){$("body").prepend("<span class='tb-debug-msg' style='background-color:black; color:white; z-index: 9999999999999; font-size:16px; position:absolute; left:0; top:"+e++*18+"px; line-height:17px; border:solid 1px white;'>"+t+"</span>")}};var m=function(){if(r==null){r=JSON.parse(l)}return r};var v=function(e,t,i){var o=g();var r='<label class="tb-checkbox" for="'+o+'"><input type="checkbox" id="'+o+'" '+i+' class="'+t+'"><span class="tb-checkbox__indicator"></span></label >';return r};var g=function(e,t){var i="tb-";var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(var r=0;r<5;r++)i+=o.charAt(Math.floor(Math.random()*o.length));return i};var T=function(e,t){var i=w();var o="https://clients1.google.com/complete/search?client=youtube&hl=en&gl=us&gs_rn=23&gs_ri=youtube&tok="+i+"&ds=yt&cp=15&gs_id=a&q="+encodeURIComponent(e)+"&callback=google.sbox.p50&gs_gbg=3no8d";TBExtension.Get(o,function(i,o,r){var n=[];try{if(i){var a=r.indexOf("[");var s=r.indexOf("{");var o=r.substring(a,s);o=TBUtilities.ReplaceAll(o,'"',"'");var l=o.match(/'[^']*'/g);var d=0;var u=0;jQuery.each(l,function(t,i){i=TBUtilities.ReplaceAll(i,"'","").trim();i=TBUtilities.ReplaceAll(i,"\\u0027","'").trim();i=TBUtilities.ReplaceAll(i,"'","'").trim();var o=TBUtilities.GetInArray(n,null,i);if(o==null){if(i.toLowerCase()!=e.toLowerCase()){n.push(i)}}})}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyKeywordExplorer] CRTBTagExplorerGetYouTubeSuggest"})}finally{t(n)}},null)};var w=function(){var e=jQuery("body")[0].outerHTML;var t=e.indexOf('PSUGGEST_TOKEN":"')+'PSUGGEST_TOKEN":"'.length;var i=e.indexOf('"',t);var o=e.substring(t,i);return o};var k=function(e){var t=false;try{e=e.toLowerCase();if(r==null){r=JSON.parse(l)}var i=e.split(" ");for(var o=0;o<i.length;o++){var n=x(r,i[o]);if(n>-1){t=true;console.log(i[o])}}}catch(e){TBUtilities.Log(e)}return t};var x=function(e,t){var i=t.toLowerCase();var o;for(o=0;o<e.length;o++){if(e[o].toString()===i){return o}}return-1};var B=function(e){if(o==null){if(TBGlobal.host.indexOf("localhost")>-1||TBGlobal.host.indexOf("staging")>-1){o=true}else{o=false}}if(!o){var i=TBUtilities.GetCookie("forceDebugLocal");if(i&&i.length>0){o=true}}if(o){try{var r=C(e);console.log(r)}catch(e){console.log(e)}}else{var r=C(e);t.push(r)}};var L=function(){return t.join("\n")};var C=function(e){var t="";if(e!==null&&typeof e==="object"){t=Q()+" - "+JSON.stringify(e)}else{t=Q()+" - "+e}return t};var Q=function(){var e=new Date;var t=e.getFullYear();var i=e.getMonth()+1;var o=e.getDate();var r=e.getHours();var n=e.getMinutes();var a=e.getSeconds();return t+"-"+i+"-"+o+" "+r+":"+n+":"+a};var U=function(e,t,i){var o,r=e.length>t;i=i||true;e=r?e.substr(0,t-1):e;o=e.search(/\s/)===-1?true:false;if(!o){e=i&&r?e.substr(0,e.lastIndexOf(" ")):e}return r?e+"...":e};var I=function(e){if(TBGlobal.host.indexOf("www.tubebuddy.com")==-1){f(JSON.stringify(e))}};var S=function(e,t,i){var o;if(i){var r=new Date;r.setTime(r.getTime()+i*24*60*60*1e3);o="; expires="+r.toGMTString()}else{o=""}document.cookie=escape(e)+"="+escape(t)+o+"; path=/"};var A=function(e){var t=escape(e)+"=";var i=document.cookie.split(";");for(var o=0;o<i.length;o++){var r=i[o];while(r.charAt(0)===" ")r=r.substring(1,r.length);if(r.indexOf(t)===0)return unescape(r.substring(t.length,r.length))}return null};var E=function(){var e="-08:00";try{e=moment().format("Z")}catch(e){ne(e)}B("getTimeZoneOffSetInHours: "+e);return e};var D=function(e){if(e==" ")return"/s/";return e.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")};var R=function(e,t,i,o,r){if(e){e=e.toString().replace(/\u00A0/," ");var n="";if(r===true)n="\\b";if(o===true)return e.toString().replace(new RegExp(n+D(t)+n,"ig"),i);else return e.toString().replace(new RegExp(n+D(t)+n,"g"),i)}else{return e}};var P=function(){var e=new Date;var t=e.getHours();var i=e.getMinutes();var o=t>=12?"pm":"am";t=t%12;t=t?t:12;i=i<10?"0"+i:i;var r=t+":"+i+" "+o;return r};var G=function(e,t,i,o,r){if(e){e=e.toString().replace(/\u00A0/," ");var n="";var a="";if(o===true){n="\\b";a="\\b"}if(r===true){n="^";a="$"}var s;if(i===true)s=e.match(new RegExp(n+D(t)+a,"ig"));else s=e.match(new RegExp(n+D(t)+a,"g"));if(s==null)return 0;else return s.length}else{return 0}};var O=function(e,t,o){for(i=0;i<e.length;i++){if(t!=null){if(e[i][t]==o){return e[i]}}else{if(e[i]==o){return e[i]}}}};var V=function(e,t,i,o,r){e.sort((e,n)=>parseFloat(e[t])>parseFloat(n[t])?!i?1:-1:parseFloat(e[t])<parseFloat(n[t])?!i?-1:1:parseFloat(e[o])<parseFloat(n[o])?r?1:-1:!r?1:-1)};var _=function(e,t,i,o){if(o)e.sort((e,o)=>parseFloat(e[t])>parseFloat(o[t])?!i?1:-1:!i?-1:1);else e.sort((e,o)=>e[t]>o[t]?!i?1:-1:!i?-1:1)};var M=function(e,t,o){for(i=0;i<e.length;i++){if(e[i][t]==o){return e.splice(i,1)}}};var F=function(){var e="-";function t(){return((1+Math.random())*65536|0).toString(16).substring(1)}return t()+t()+e+t()+e+t()+e+t()+e+t()+t()+t()};var N=function(e){if(e==null)return false;var t=e.indexOf("@");var i=e.lastIndexOf(".");if(t<1||i<t+2||i+2>=e.length)return false;else return true};var Y=function(e){if(!e)return false;var t=/(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/;return t.test(e)};var H=function(e){if(e==null||isNaN(e))return"-99999";var t=e.toString().split(".");t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,",");return t.join(".")};var W=function(e,t,i){if(typeof t!="undefined"&&t!=null){if(e>=1e10)return(e/1e9).toFixed(t)+z("B",i);if(e>=1e9)return(e/1e9).toFixed(t)+z("B",i);if(e>=1e8)return(e/1e6).toFixed(t)+z("M",i);if(e>=1e7)return(e/1e6).toFixed(t)+z("M",i);if(e>=1e6)return(e/1e6).toFixed(t)+z("M",i);if(e>=1e5)return(e/1e3).toFixed(t)+z("K",i);if(e>=1e4)return(e/1e3).toFixed(t)+z("K",i);if(e>=1e3)return(e/1e3).toFixed(t)+z("K",i)}else{if(e>=1e10)return(e/1e9).toFixed(1)+z("B",i);if(e>=1e9)return(e/1e9).toFixed(2)+z("B",i);if(e>=1e8)return(e/1e6).toFixed(0)+z("M",i);if(e>=1e7)return(e/1e6).toFixed(1)+z("M",i);if(e>=1e6)return(e/1e6).toFixed(2)+z("M",i);if(e>=1e5)return(e/1e3).toFixed(0)+z("K",i);if(e>=1e4)return(e/1e3).toFixed(1)+z("K",i);if(e>=1e3)return(e/1e3).toFixed(2)+z("K",i)}return H(e)};var z=function(e,t){var i=e;if(t){i="<span class="+t+">"+e+"</span>"}return i};var q=function(e,t,o,r){t=isNaN(t=Math.abs(t))?2:t,o=o==undefined?".":o,r=r==undefined?",":r,s=e<0?"-":"",i=parseInt(e=Math.abs(+e||0).toFixed(t))+"",j=(j=i.length)>3?j%3:0;return s+(j?i.substr(0,j)+r:"")+i.substr(j).replace(/(\d{3})(?=\d)/g,"$1"+r)+(t?o+Math.abs(e-i).toFixed(t).slice(2):"")};var K=function(e,t,i){var o=jQuery.ajax({type:"GET",url:e,datatype:"json",contentType:"application/json"});o.done(function(e){t(e)});o.fail(function(e,t){if(i){i(e,t)}})};var J=function(e,t,i,o){var r=jQuery.ajax({type:"POST",url:e,datatype:"json",data:JSON.stringify(t),contentType:"application/json"});r.done(function(e){i(e)});r.fail(function(e,t){if(o){o(e,t)}})};var X=function(e){var t=window.location.search.substring(1);var i=t.split("&");for(var o=0;o<i.length;o++){var r=i[o].split("=");if(r[0]==e){return r[1]}}try{TBUtilities.Log("In getUrlParameter "+window.location.href);if(window.location.href.indexOf("studio.youtube.com")>=0){TBUtilities.Log("In getUrlParameter2");if(window.location.href.indexOf("/#/")>0){return null}var n=window.location.href.indexOf("#");var a=window.location.href.substring("https://studio.youtube.com/?".length,n);var i=a.split("&");for(var o=0;o<i.length;o++){var r=i[o].split("=");if(r[0]==e){TBUtilities.Log("In getUrlParameter FOUND "+r[1]);return r[1]}}TBUtilities.Log("In getUrlParameter none found")}}catch(e){}return null};var Z=function(e){if(e==null||e=="")return[];return e.match(/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9._-]+)/gi)};var ee=function(e,t){var i="";for(var o=0;o<e.length;o++){var r=e.charCodeAt(o);if(r>=65&&r<=90)i+=String.fromCharCode((r-65+t)%26+65);else if(r>=97&&r<=122)i+=String.fromCharCode((r-97+t)%26+97);else i+=e.charAt(o)}return i};var te=function(e){var t=new moment(e);return t.format("MMM Do YYYY")};var ie=function(e){e=R(e,"____-_-___","@");e=R(e,"__-__-__-__",".");e=R(e,"_|_-|__","{");e=R(e,"_--|_|__","}");e=R(e,"|-|_|_-_",":");return ee(e,(26-10)%26)};var oe=function(e,t,i){try{if(e==null)e={};var o={YouTubeChannelId:TBGlobal.CurrentChannelId(),ClientActionDate:(new Date).toISOString(),ChannelActionType:t,ToolId:i};$.extend(e,o);var r=TBGlobal.host+"/api/channelaction/add";TBExtension.Post(r,JSON.stringify(e),"notused",null,{contentType:"application/json; charset=utf-8"})}catch(e){ne({exception:e,location:"TBUtilities.addAction"})}};var re=function(e,t,i){try{if(e==null)e={};var o={ActivityLogType:t,ClientActionDate:(new Date).toISOString(),ToolId:i,YouTubeChannelId:TBGlobal.CurrentChannelId()};$.extend(e,o);var r=TBGlobal.host+"/api/activitylog/add";TBExtension.Post(r,jQuery.param(e),"notused",null,{contentType:"application/x-www-form-urlencoded; charset=UTF-8"})}catch(e){ne({exception:e,location:"TBUtilities.addAction"})}};var ne=function(e){try{var t="unknown";try{t=TBExtension.GetExtensionVersion()}catch(e){}B(e);if(e!=null&&e.Exception!=null){var i=false;if(e.SkipSerialization){i=true}if(i==false){var o={};Object.getOwnPropertyNames(e.Exception).forEach(function(t){o[t]=e.Exception[t]});e.Exception=o}}var r=jQuery.param({UserAgent:navigator.userAgent,CookiesEnabled:navigator.cookieEnabled,BrowserLanguage:navigator.language,Details:"Extension version: "+t+" "+JSON.stringify(e),ClientDateLogged:(new Date).toISOString(),YouTubeChannelId:TBGlobal.CurrentChannelId()});TBUtilities.AddDebugObject(e);if(TBGlobal.Profile().EnableDebug==true){var n=TBGlobal.host+"/api/clienterror/add";TBExtension.Post(n,r,function(e,t,i){try{if(e){TBUtilities.Log("Posted client debug error.")}else{TBUtilities.Log("Error posting client debug error.")}}catch(e){console.log(e)}},null,{contentType:"application/x-www-form-urlencoded; charset=UTF-8"})}}catch(e){console.log(e)}};var ae=function(e){try{var t="unknown";try{t=TBExtension.GetExtensionVersion()}catch(e){}B(e);var i=jQuery.param({UserAgent:navigator.userAgent,CookiesEnabled:navigator.cookieEnabled,BrowserLanguage:navigator.language,Details:"Extension version: "+t+" "+JSON.stringify(e),ClientDateLogged:(new Date).toISOString(),YouTubeChannelId:TBGlobal.CurrentChannelId()});TBUtilities.AddDebugObject(e);var o=TBGlobal.host+"/api/clienterror/add";TBExtension.Post(o,i,null,null,{contentType:"application/x-www-form-urlencoded; charset=UTF-8"})}catch(e){}};var ae=function(e){try{var t="unknown";try{t=TBExtension.GetExtensionVersion()}catch(e){}B(e);var i=jQuery.param({UserAgent:navigator.userAgent,CookiesEnabled:navigator.cookieEnabled,BrowserLanguage:navigator.language,Details:"Extension version: "+t+" "+JSON.stringify(e),ClientDateLogged:(new Date).toISOString(),YouTubeChannelId:TBGlobal.CurrentChannelId()});TBUtilities.AddDebugObject(e);var o=TBGlobal.host+"/api/clienterror/add";TBExtension.Post(o,i,null,null,{contentType:"application/x-www-form-urlencoded; charset=UTF-8"})}catch(e){}};var se=function(e){return jQuery("<div/>").text(e).html()};var le=function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")};var de=function(e){return e===null||e.match(/^ *$/)!==null};var ue=function(e,t,i){try{if(!i){i="tb-highlight"}var o={className:i,accuracy:{value:"exactly",limiters:[",","."]},separateWordSearch:false};var r=jQuery(t);r.mark(e,o);t=r[0].outerHTML}catch(e){TBUtilities.LogError(e)}return t};var ce=function(e){return encodeURIComponent(e)};var pe=function(e){return decodeURIComponent(e)};var he=function(e){return e.replace(/[|&;$%@"<>()+,]/g,"")};var ye=function(e,t){var i="$";if(t){i="<span class="+t+">$</span >"}if(e==0)return i+"0.00";if(e.toString().indexOf(".")>-1){var o=e.toString().split(".");o[0]=o[0].replace(/\B(?=(\d{3})+(?!\d))/g,",");o[1]=(o[1]+"00").substr(0,2);return i+o[0]+"."+o[1]}else{return i+e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+".00"}};var be=function(e,t){if(!t)t=50;try{var i=parseInt(e.text());if(isNaN(i))i=0;var o=parseInt(e.attr("data-auto-count"));if(i<o){if(o-i>15)e.text(i+3);else e.text(i+1);setTimeout(TBUtilities.AutoIncrementCount,t,e)}}catch(e){TBUtilities.Log(e.message)}};var fe=function(e,t){var i=e%1e3;var o=Math.floor(e/1e3%60);var r=Math.floor(e/(1e3*60)%60);var n=Math.floor(e/(1e3*60*60)%24);var a=Math.floor(e/(1e3*60*60*24));if(!t){if(a>0)return a+"d:"+n+"h:"+r+"m:"+o+"s";else if(n>0)return n+"h:"+r+"m:"+o+"s";else if(r>0)return r+"m:"+o+"s";else return o+"sec"}else{if(a>0)return H(a)+"d:"+n+"h";else if(n>0)return n+"h:"+r+"m";else if(r>0)return r+"m:"+o+"s";else return o+"sec"}};var me=function(e){var t=(e/1e3%60).toFixed(1);var i=Math.floor(e/(60*1e3)%60);if(i>0)return i+"m:"+t+"s";else return t+" sec"};var ve=function e(t){return t.replace(/\\u[\dABCDEFabcdef][\dABCDEFabcdef][\dABCDEFabcdef][\dABCDEFabcdef]/g,function(e){return String.fromCharCode(parseInt(e.replace(/\\u/g,""),16))})};var ge=function(e){if(/[^a-zA-Z0-9]/.test(e)){return false}return true};var Te=function(e,t){if(t=="js"){var i=document.createElement("script");i.setAttribute("type","text/javascript");i.setAttribute("src",e)}else if(t=="css"){var i=document.createElement("link");i.setAttribute("rel","stylesheet");i.setAttribute("type","text/css");i.setAttribute("href",e)}if(typeof i!="undefined")document.getElementsByTagName("head")[0].appendChild(i)};var we=function(e,t){var i=Be();if(t){alertify.alert(e,t).setHeader(i)}else{alertify.alert(e).setHeader(i)}};var ke=function(e,t,i){var o=Be();return alertify.confirm(e,t,i).setHeader(o).set({labels:{ok:"OK",cancel:"Cancel"}})};var xe=function(e,t,i,o){var r=Be();alertify.prompt(e,t,i,o).setHeader(r)};var Be=function(){var e="<img style='height:20px;' src='https://www.tubebuddy.com/images/branding/logo_small.png'></img>";return e};var je=function(e){var t=/^.*(youtu\.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/;var i=e.match(t);if(i&&i[2].length==11){return i[2]}else{return null}};var Le=function(e){var t=e.split("/");var i=t[t.length-1];return i};var Ce=function(e){var t=new RegExp("[&?]list=([a-z0-9_-]+)","i");var i=t.exec(e);if(i&&i[1].length>0){return i[1]}else{return null}};var Qe=function(e,t,i){var o=e.indexOf("#");var r=o===-1?"":e.substr(o);e=o===-1?e:e.substr(0,o);var n=new RegExp("([?&])"+t+"=.*?(&|$)","i");var a=e.indexOf("?")!==-1?"&":"?";if(!i){e=e.replace(new RegExp("([?&]?)"+t+"=[^&]*","i"),"");if(e.slice(-1)==="?"){e=e.slice(0,-1)}if(e.indexOf("?")===-1)e=e.replace(/&/,"?")}else if(e.match(n)){e=e.replace(n,"$1"+t+"="+i+"$2")}else{e=e+a+t+"="+i}return e+r};var Ue=function(e){if(TBExtension.GetType()=="safari"){var t=safari.extension.baseURI.replace(/\/$/,"");e=R(e,"{PLUGIN_FILE_ROOT}",t,true,false)}else{var t=chrome.extension.getURL("").replace(/\/$/,"");e=R(e,"{PLUGIN_FILE_ROOT}",t,true,false)}return e};var Ie=function(e,t){if(!t)t=window.location.href;e=e.replace(/[\[\]]/g,"\\$&");var i=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),o=i.exec(t);if(!o)return null;if(!o[2])return"";return decodeURIComponent(o[2].replace(/\+/g," "))};var Se=function(){try{var e=window.navigator.userAgent,t=window.navigator.platform,i=["Macintosh","MacIntel","MacPPC","Mac68K"],o=["Win32","Win64","Windows","WinCE"],r=["iPhone","iPad","iPod"],n=null;if(i.indexOf(t)!==-1){n="Mac OS"}else if(r.indexOf(t)!==-1){n="iOS"}else if(o.indexOf(t)!==-1){n="Windows"}else if(/Android/.test(e)){n="Android"}else if(!n&&/Linux/.test(t)){n="Linux"}return n}catch(e){return"Unknown"}};var Ae=function(e){var t=TBGlobal.GetYouTubeUIFromHtml(e);var i=null;switch(t){case"studio":case"material":{var o='"XSRF_TOKEN":"';var r=e.indexOf(o);var n=e.substring(r+o.length,e.length);var a=n.indexOf('","');i=n.substring(0,a);if(i.length>=300){a=i.indexOf('"});<');i=n.substring(0,a)}i=ve(i);break}case"default":{var o="'XSRF_TOKEN':";var r=e.indexOf(o);var n=e.substring(r+o.length,e.length);var a=n.indexOf('",');i=n.substring(0,a);i=i.replace(/['"]+/g,"").trim();break}}return i};var Ee=function(){return new Promise(function(e,t){var i=jQuery("body")[0].outerHTML;var o=i.indexOf('PSUGGEST_TOKEN":"');if(o!==-1){o+=+'PSUGGEST_TOKEN":"'.length;var r=i.indexOf('"',o);var n=i.substring(o,r);e(n)}else{TBExtension.Get("https://www.youtube.com/",function(i,o,r){if(i===true){var n=r;var a=n.indexOf('PSUGGEST_TOKEN":"')+'PSUGGEST_TOKEN":"'.length;var s=n.indexOf('"',a);var l=n.substring(a,s);e(l)}else{t("error getting autocomplete")}},null,null)}})};var De=function(e){return new Promise(function(t,i){TBUtilities.Log("getVideoTopics");var o=0;Ee().then(function(i){var r=[];r.push("how "+e);r.push("how to "+e);r.push("why "+e);r.push("what "+e);r.push("where "+e);r.push("did "+e);r.push("can "+e);r.push("do "+e);r.push("does "+e);r.push("is "+e);r.push("top "+e);r.push("top 10"+e);var n=[];jQuery.each(r,function(e,a){TubeBuddyYouTubeActions.GetYouTubeAutoComplete(i,a,function(e){o++;jQuery.each(e,function(e,t){var i=TBUtilities.GetInArray(n,null,t);if(!i){n.push(t)}});if(o>=r.length){t(n)}})})})})};var Re=function(e){var t='"INNERTUBE_API_KEY":"';var i=e.indexOf(t);var o=e.substring(i+t.length,e.length);var r=o.indexOf('","');token=o.substring(0,r);if(token.length>45){r=token.indexOf('"})');token=token.substring(0,r)}return token};var Pe=function(e){var t='"DELEGATED_SESSION_ID":"';var i=e.indexOf(t);if(i>=0){var o=e.substring(i+t.length,e.length);var r=o.indexOf('","');token=o.substring(0,r);if(isNaN(token)===true){r=o.indexOf('"}');token=o.substring(0,r)}return token}else{return null}};var Ge=function(e){var t='"INNERTUBE_CONTEXT_SERIALIZED_DELEGATION_CONTEXT":"';var i=e.indexOf(t);if(i>=0){var o=e.substring(i+t.length,e.length);var r=o.indexOf('","');token=o.substring(0,r);if(token.match(/^[a-z0-9]+$/i)===false){r=o.indexOf(";");token=o.substring(0,r)}return token}else{return null}};var Oe=function(e){var t='"INNERTUBE_CONTEXT_CLIENT_VERSION":"';var i=e.indexOf(t);var o=e.substring(i+t.length,e.length);var r=o.indexOf('","');token=o.substring(0,r);var n=/^[0-9.]+$/;if(n.test(token)===false&&token.indexOf('"}')!==-1){r=token.indexOf('"}');token=token.substring(0,r)}return token};var Ve=function(e){var t='"INNERTUBE_CONTEXT":';var i=e.indexOf(t);var o=e.substring(i+t.length,e.length);var r=o.indexOf("}},");token=o.substring(0,r)+"}}";return token};var _e=function(e){var t='"INNERTUBE_CONTEXT_CLIENT_NAME":';var i=e.indexOf(t);var o=e.substring(i+t.length,e.length);var r=o.indexOf(",");token=o.substring(0,r);if(isNaN(token)===true){r=o.indexOf("}");token=o.substring(0,r)}return parseInt(token)};var Me=function(e){var t='"INNERTUBE_CONTEXT_GL":"';var i=e.indexOf(t);var o=e.substring(i+t.length,e.length);var r=o.indexOf('","');token=o.substring(0,r);return token};var Fe=function(e){var t='"INNERTUBE_CONTEXT_HL":"';var i=e.indexOf(t);var o=e.substring(i+t.length,e.length);var r=o.indexOf('","');token=o.substring(0,r);if(token.length>10){r=token.indexOf('"})');token=token.substring(0,r)}return token};var Ne=function(e){return new Promise(function(t,i){TBUtilities.Log("processHeader");const o=e.www==undefined?"studio":"www";const r=n+o+TBGlobal.CurrentChannelId();var a=lscache.get(r);if(a!==null){TBUtilities.Log("processHeader - cache found");e.header=a;t(e)}else{let n=TBUtilities.GetCookie("SS"+"ID");let a=TBUtilities.GetCookie("SA"+"PI"+"SI"+"D");let s=TBUtilities.GetCookie("S"+"ID");if(!a){a=TBUtilities.GetCookie("__Se"+"cure-3"+"PAP"+"IS"+"ID")}TBUtilities.Log("processHeader - getting string");TBExtension.Get(TBGlobal.host+"/api/youtubechannel/processstring?v="+n+"&f=h&s="+a+"&t="+s+"&w="+o,function(o,n,a){a=TBUtilities.ReplaceAll(a,'"',"");e.header=a;if(o===true){lscache.set(r,a,1);t(e)}else{i("failed to process header")}},null,null,null)}})};var Ye=function(e){"use strict";var t,i;if(e.split(",")[0].indexOf("base64")!==-1){t=atob(e.split(",")[1])}else{t=decodeURI(e.split(",")[1])}i=e.split(",")[0].split(":")[1].split(";")[0];var o=new Array;for(var r=0;r<t.length;r++){o[r]=t.charCodeAt(r)}return new Blob([new Uint8Array(o)],{type:i})};var He=function(e){var t=TBGlobal.GetYouTubeUI();var i=et(e);if(i==true){t="material"}else{t="default"}var o=null;try{switch(t){case"studio":case"material":{var r=tt(e);const t=r.contents.twoColumnWatchNextResults.results.results.contents.filter(e=>e.hasOwnProperty("itemSectionRenderer")).filter(e=>e.itemSectionRenderer.targetId==="comments-section");if(t.length){if(t[0].itemSectionRenderer.continuations){o=t[0].itemSectionRenderer.continuations[0].nextContinuationData.continuation}else{o=t[0].itemSectionRenderer.contents[0].continuationItemRenderer.continuationEndpoint.continuationCommand.token}}break}case"default":{var n=e.indexOf("COMMENTS_TOKEN");var a=e.indexOf('"',n);var s=e.indexOf('"',a+1);o=e.substring(a+1,s);break}}}catch(e){TBUtilities.Log(e)}return o};var We=function(e){var t=TBGlobal.GetYouTubeUI();var i=et(e);if(i===true){t="material"}else{t="default"}var o=null;switch(t){case"studio":case"material":{var r='"ID_TOKEN":"';var n=e.indexOf(r);var a=e.substring(n+r.length,e.length);var s=a.indexOf('","');o=a.substring(0,s);break}case"default":{break}}o=ve(o);return o};var ze=function(e){var t=et(e);if(t===true){ytUI="material"}else{ytUI="default"}var o=null;switch(ytUI){case"studio":case"material":{var r=tt(e);jQuery.each(r.responseContext.serviceTrackingParams,function(e,t){if(t.service&&t.service=="CSI"){for(i=0;i<t.params.length;i++){if(t.params[i].key=="cver"){o=t.params[i].value}}}});break}case"default":{break}}return o};var qe=function(e){var t=TBUtilities.GetListRendererKey(e);var i=e[t];var o=[];if(t==="richGridRenderer"){o=TBUtilities.GetRichGridRendererContents(i)}else{o=TBUtilities.GetSectionListRendererContents(i)}return o};var Ke=function(e){var t=[];jQuery.each(e.contents,function(e,i){var o="";if(i.continuationItemRenderer!==undefined){return}else if(i.richSectionRenderer!==undefined){o="richSectionRenderer"}else{o="richItemRenderer"}t.push(i[o].content)});return t};var Je=function(e){var t=TBUtilities.GetVideoSearchCollectionIndex(e.contents);if(t==null){return[]}return e.contents[t].itemSectionRenderer.contents};var Xe=function(e){var t=null;try{jQuery.each(e,function(e,i){jQuery.each(i.itemSectionRenderer.contents,function(i,o){if(o.shelfRenderer||o.videoRenderer||o.channelRenderer){t=e;return false}});if(t!=null){return false}})}catch(e){TBUtilities.Log(e)}return t};var Ze=function(e){var t="sectionListRenderer";if(e.richGridRenderer!==undefined){t="richGridRenderer"}return t};var $e=function(e){var t="itemSectionRenderer";if(e.richItemRenderer!==undefined){t="richItemRenderer"}return t};var et=function(e){var t=false;if(e.indexOf(d)!==-1){t=true}else if(e.indexOf(u)!==-1){t=true}else if(e.indexOf(c)!==-1){t=true}else if(e.indexOf(p)!=-1){t=true}return t};var tt=function(e){let t=e.indexOf(d);let i=null;if(t!=-1){t=t+26;let o=e.substring(t,e.length);let r=o.indexOf("};")+1;let n=o.substring(0,r);i=jQuery.parseJSON(n)}else if(e.indexOf(u)!=-1){t=e.indexOf(u);t=t+u.length-1;let o=e.substring(t,e.length);let r=o.indexOf('");');let n=o.substring(0,r+1);i=JSON.parse(JSON.parse(n))}else if(e.indexOf(c)!=-1){t=e.indexOf(c);t=t+c.length;let r=e.substring(t,e.length);r=it(r);let n=r.indexOf(";<\/script>");let a=r.substring(0,n-2);var o=TBUtilities.ReplaceAll(a,'\\"','\\\\"');i=JSON.parse(o)}else if(e.indexOf(p)!=-1){t=e.indexOf(p);t=t+p.length;let o=e.substring(t,e.length);let r=";<\/script>";let n="// scraper_data_end";let a="";if(o.indexOf(n)!==-1){let e=o.indexOf(n);a=o.substring(0,e-3)}else{let e=o.indexOf(r);a=o.substring(0,e)}i=JSON.parse(a)}return i};var it=function(e){return e.replace(/\\x([0-9A-Fa-f]{2})/g,function(){return String.fromCharCode(parseInt(arguments[1],16))})};var ot=function(e){var t="window.chunkedPrefetchResolvers['id-1'].resolve(";var i=e.indexOf(t);var o=e.substring(i+t.length,e.length);var r=o.indexOf(");");token=o.substring(0,r);json=JSON.parse(token);return json};var rt=function(e){let t=e.indexOf(h);let i=null;if(t!=-1){t=t+36;let o=e.substring(t,e.length);let r;let n=o.indexOf("interpreterScript");if(n===-1){r=o.indexOf("};")+1}else{r=o.indexOf("]};")+2}let a=o.substring(0,r);i=jQuery.parseJSON(a)}else if(e.indexOf(y)!=-1){let t=e.indexOf(y);t=t+y.length-1;let o=e.substring(t,e.length);let r=o.indexOf('");');let n=o.substring(0,r+1);i=JSON.parse(JSON.parse(n))}else if(e.indexOf(b)!=-1){t=e.indexOf(b);t=t+b.length;let o=e.substring(t,e.length);let r=o.indexOf("};");let n=o.substring(0,r+1);i=JSON.parse(n)}return i};var nt=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,escape)};var at=function(e){var t=0;jQuery.each(e,function(e,i){var o=i.trim();o=o.replace(/\s/,"---");t+=o.length;t+=1});if(t>0)t--;return t};var st=function(e){try{if(TBExtension.GetType()==="chrome"&&TBGlobal.Profile()!==null&&TBGlobal.Profile().EnablePreview===true){chrome.runtime.sendMessage({type:"tb-corb-record",data:{url:e,host:TBGlobal.host}})}}catch(e){console.log(e)}};var lt=function(e,t){t(false);return};var dt=function(e){return new Promise(function(t,i){let o={keyword:e,autoCompleteTags:[],keywordMisspellings:[],searchResults:null,searchResultTags:[],suggestions:[]};yt(o).then(mt).then(bt).then(ft).then(function(e){var i=ut(e);t(i)}).catch(function(e){TBUtilities.Log(e);i(e)})})};var ut=function(e){try{let t={};for(let i=0;i<e.searchResultTags.length;++i){if(!t[e.searchResultTags[i]])t[e.searchResultTags[i]]=0;++t[e.searchResultTags[i]]}let i=Object.keys(t).map(function(e){return[e,this[e]]},t).sort(function(e,t){return t[1]-e[1]});for(let e in i){if(i[e][1]<=1){delete i[e]}}let o=[];for(let e in i){o.push(i[e][0])}let r=o.indexOf(e.keyword);if(r>-1){o.splice(r,1)}jQuery.each(o,function(t,i){if(i){var o=ht(i,"search",2,"keyword");e.suggestions.push(o)}});jQuery.each(e.keywordMisspellings,function(t,i){jQuery.each(i.Alternatives,function(t,o){if(o.toLowerCase()!=e.keyword.toLowerCase()){var r=i.Keyword.split(" ");var n=o.split(" ");var a=null;for(var s=0;s<r.length;s++){if(r[s]!==n[s]){a=n[s];break}}var l=ht(o,"searchautocomplete",i.Keyword.toLowerCase()===e.keyword.toLowerCase()?0:1.5,"keyword",true,a);e.suggestions.push(l)}})});jQuery.each(e.autoCompleteTags,function(t,i){if(i.toLowerCase()!=e.keyword.toLowerCase()){var o=ht(i,"searchautocomplete",1,"keyword");e.suggestions.push(o)}})}catch(e){console.log(e)}return e.suggestions};var ct=function(e,t){var i;var o=pt({data:e});if(o==null)return;if(t.indexOf(".csv")==-1)t+=".csv";o="data:text/csv;charset=utf-8,"+encodeURIComponent(o);i=document.createElement("a");i.setAttribute("href",o);i.setAttribute("download",t);i.click()};var pt=function(e){var t,i,o,r,n,a;a=e.data||null;if(a==null||!a.length){return null}r=e.columnDelimiter||",";n=e.lineDelimiter||"\n";o=Object.keys(a[0]);t="";t+=o.join(r);t+=n;a.forEach(function(e){i=0;o.forEach(function(o){if(i>0)t+=r;if(typeof e[o]=="string"){t+='"'+e[o].replace(/"/g,'""')+'"'}else{t+=encodeURI(e[o])}i++});t+=n});return t};var ht=function(e,t,i,o,r,n){var a=TBUtilities.IsWordCensored(e);var s={tag:e,source:t,priority:i,seed:o,isCensored:a,isMisSpell:r===true,misSpelledWord:n};return s};var yt=function(e){return new Promise(function(t,i){TubeBuddyYouTubeActions.GetYouTubeAutoComplete(w(),e.keyword,function(i){if(i.length>0){e.autoCompleteTags=i}t(e)})})};var bt=function(e){return new Promise(function(t,i){TubeBuddyYouTubeActions.GetVideoSearchResults(e.keyword,function(i){if(i&&i.length>0){i=i.slice(0,15);var o=i.map(function(e){return e.id});e.searchResults=o}t(e)})})};var ft=function(e){return new Promise(function(t,i){if(e.searchResults&&e.searchResults.length>0){var o=0;for(var r=0;r<e.searchResults.length;r++){TubeBuddyYouTubeActions.GetVideoTags(e.searchResults[r],function(i){o++;try{e.searchResultTags=e.searchResultTags.concat(i)}catch(e){console.log(e)}if(o===e.searchResults.length){var r=[];jQuery.each(e.searchResultTags,function(e,t){if(/\s/.test(t)&&t!=""){var i=t.trim().toLowerCase();if(r.indexOf(i)==-1){r.push(i)}}});e.searchResultTags=r;t(e)}})}}else{t(e)}})};var mt=function(e){return new Promise(function(t,i){var o=TBGlobal.host+TBGlobal.apiUrls.grammerGetKeyWordMisspellings;e.autoCompleteTags.push(e.keyword);TBExtension.Post(o,JSON.stringify(e.autoCompleteTags),function(i,o,r){try{if(i===true){e.keywordMisspellings=r}}catch(e){TBUtilities.Log(e)}t(e)},null,{contentType:"application/json",dataType:"json"})})};var vt=function(e){var t=_e(e);var i=Oe(e);var o=Me(e);var r=Fe(e);var n={clientName:t,clientVersion:i,hl:r,gl:o,experimentsToken:""};return n};var gt=function(e){var t=Pe(e);var i={client:vt(e),request:{returnLogEntry:true},user:{},clientScreenNonce:""};if(t){lscache.set(TBUtilities.DelegatedSessionIdKey(),t,15)}if(t){i.user.onBehalfOfUser=t}if(e.indexOf("CREATOR_CHANNEL_ROLE_TYPE_EDITOR")>-1){i.user.delegationContext={externalChannelId:TBGlobal.CurrentChannelId(),roleType:{channelRoleType:"CREATOR_CHANNEL_ROLE_TYPE_EDITOR"}};i.user.serializedDelegationContext=Ge(e)}if(e.indexOf("CREATOR_CHANNEL_ROLE_TYPE_MANAGER")>-1){i.user.delegationContext={externalChannelId:TBGlobal.CurrentChannelId(),roleType:{channelRoleType:"CREATOR_CHANNEL_ROLE_TYPE_MANAGER"}};i.user.serializedDelegationContext=Ge(e)}else if(e.indexOf("CREATOR_CHANNEL_ROLE_TYPE_OWNER")>-1){i.user.delegationContext={externalChannelId:TBGlobal.CurrentChannelId(),roleType:{channelRoleType:"CREATOR_CHANNEL_ROLE_TYPE_OWNER"}};i.user.serializedDelegationContext=Ge(e)}return i};var Tt=function(e){var t=[];var i=0;return new Promise(function(o,r){if(e.length>0){e.forEach(function(n){var a=TBGlobal.host+TBGlobal.apiUrls.imageGetBytes+"?url="+encodeURIComponent(n);TBExtension.Get(a,function(n,a,s){i++;if(n===true){var l=JSON.parse(s).split(",")[1];var d={url:a,dataUrl:l};t.push(d)}else{r("error converting image to data url = "+a)}if(i>=e.length){o(t)}},n)})}else{o(t)}})};var wt=function(e,t,i){var o=parseInt(e.teaserStartMs);TBUtilities.Log("TubeBuddyCards - start ms ="+o);TBUtilities.Log("TubeBuddyCards - sourceVideoMiliseconds ="+t);TBUtilities.Log("TubeBuddyCards - destinationVideoMiliseconds ="+i);var r=o>t*.85;var n=t-o;if(n<3e3)n=3e3;if(r){o=i-n;TBUtilities.Log("TubeBuddyCards - dock at end = true, new teaserStartMs ="+o)}if(o>=i){o=i-3e3;TBUtilities.Log("TubeBuddyCards - start ms is greater than video length, adjusting to ="+o)}if(o<0){o=0}e.teaserStartMs=o.toString()};var kt=function(e,t,i){let o=i.videoDurationMs-i.endscreenStartMs;if(e.durationMs>o||e.durationMs+e.offsetMs>o){let r=t.videoDurationMs-t.endscreenStartMs;let n=i.videoDurationMs-r;let a=i.videoDurationMs-n;if(i.videoDurationMs>25e3&&i.videoDurationMs<=4e4){e.durationMs=o;e.offsetMs=0}else{i.endscreenStartMs=n}}};var xt=function(e){let t="";let i=0;let o=0;let r=0;let n=0;if(e.length>4){t+="<p>Max of 4 endscreen elements reached</p>"}jQuery.each(e,function(e,t){switch(t.type){case"CHANNEL":{if(t.channelEndscreenElement.isSubscribe){r++}break}case"WEBSITE":{n++;break}case"VIDEO":{switch(t.videoEndscreenElement.videoType){case"VIDEO_TYPE_RECENT_UPLOAD":{i++;break}case"VIDEO_TYPE_BEST_FOR_VIEWER":{o++;break}}break}}});if(i>1){t+="<p>Can only have 1 most recent video</p>"}if(o>1){t+="<p>Can only have 1 best for viewer</p>"}if(r>1){t+="<p>Can only have 1 subscribe</p>"}if(n>1){t+="<p>Can only have 1 link</p>"}return t};var Bt=function(e,t){let i=t.endscreenStartMs;if(i===null){if(t.videoDurationMs>25e3&&t.videoDurationMs<=31e3){i=t.videoDurationMs-1e4}else{let o=e.videoDurationMs-e.endscreenStartMs;i=t.videoDurationMs-o}}return i};var jt=function e(t){var i=new Date(t/1e3);var o=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var r=i.getFullYear();var n=o[i.getMonth()];var a=i.getDate();var s=i.getHours();var l=i.getMinutes();var d=i.getSeconds();var u=r+"-"+(i.getMonth()+1)+"-"+a;return u};var Lt=function(e){return e.charAt(0).toUpperCase()+e.slice(1)};var Ct=function(e){return e.charAt(0).toLowerCase()+e.slice(1)};var Qt=function(e){if(!e)return"error";var t=DOMPurify.sanitize(e,DOMPurifyConfig);var i=jQuery(t).find('span[id^="u_0_0"]').text();return i};var Ut=async function(e){const t=new TextEncoder;const i=t.encode(e);const o=await crypto.subtle.digest("SHA-256",i);const r=btoa(Array.prototype.map.call(new Uint8Array(o),e=>String.fromCharCode(e)).join(""));return r};var It=async function(e,t,i="",o=""){if(i.length>0&&i!==document.location.href){return}var r=e+t+o;var n=await Ut(r);return new Promise(function(o){TBExtension.GetDbValue("tbReportedExtensionDOMIssues",function(r,a){var s=[];if(a){s=a.split(",");if(s.indexOf(n)>-1){TBUtilities.Log("DOM Issue already reported. Module: "+e+" Selector: "+t+" Reported Page: "+i);o();return}}s.push(n);TBUtilities.Log("Reporting new DOM issue. Module: "+e+" Selector: "+t+" Reported Page: "+i);TBExtension.SetDbValue("tbReportedExtensionDOMIssues",s.join(","));var l={Hash:n,ModuleName:e,Selector:t,PageURL:location.href};var d=TBGlobal.host+TBGlobal.apiUrls.checkYTDOMIssue;TBExtension.Post(d,JSON.stringify(l),function(i,r,a){var s="";try{if(i===true&&a=="true"){s=document.querySelector("html").outerHTML}var l={Hash:n,ModuleName:e,Selector:t,PageURL:location.href,ChannelId:TBGlobal.CurrentChannelId(),UserAgent:navigator.userAgent,PageHTML:s,Country:"",Language:navigator.language,ExtVersion:TBExtension.GetExtensionVersion()};var d=TBGlobal.host+TBGlobal.apiUrls.reportYTDOMIssue;TBExtension.Post(d,JSON.stringify(l),function(e,t,i){try{if(e===true){TBUtilities.Log("Successfully reported YT DOM Issue")}else{TBUtilities.Log("Error reporting YT DOM Issue")}}catch(e){TBUtilities.Log(e)}finally{o()}},null,{contentType:"application/json; charset=UTF-8"})}catch(e){TBUtilities.Log(e)}},null,{contentType:"application/json; charset=UTF-8"})})})};var St=function(e,t){var i=TBGlobal.GetExperiment(e);if(i===null){return}const o=`amplitude-${e}`;if(!t){TBExtension.RemoveDbValue(o)}TBExtension.GetDbValue(o,function(t,r){if(r===undefined){TBExtension.SetDbValue(o,i.key);At("Exposure",{flag_key:e,variant:i.key});return}if(r!==i.key){TBExtension.SetDbValue(o,i.key);At("Exposure",{flag_key:e,variant:i.key})}})};var At=function(e,t){const i=["Feature Used","Feature Applied","Subscription Paywall","Exposure","Seo Studio","Seo Studio Opened","Seo Studio Closed","Seo Studio Navigated","Seo Studio Clicked","Seo Studio Used","Seo Studio Applied","Seo Studio Saved","Chapter Editor Opened","Chapter Editor Closed","Chapter Editor 30 Day Follow Up","Chapter Editor Applied To Video","Chapter Editor Copied To Clipboard","Toolbox Feature Clicked","Toolbox Upgrade Clicked","Video Optimization Testing Test Alternates Clicked","Channelytics Launched On Click","Channelytics Launched On Load"];if(!i.includes(e)){return Promise.reject("Invalid event type")}return new Promise((i,o)=>{var r=TBGlobal.host+TBGlobal.apiUrls.productEvents;const n={event_type:e,properties:t,platform:"EXTENSION"};TBExtension.Post(r,JSON.stringify(n),function(e,t,r){if(!e){TBUtilities.LogError("Product event capture failure.");o(r);return}i(r)},null,{contentType:"application/json; charset=UTF-8"})})};var Et=function(e,t){const i=["Feature Used","Feature Applied","Account Removed User","Checkout Started","Payment Info Entered","Coupon Applied","Coupon Denied","Coupon Removed","Order Completed","Order Updated","Order Refunded","Order Cancelled","Order Success","Order Failed","AB Test Launched","AB Test Video Selected","AB Test Test Type Selected","AB Test Run Settings Edited","AB Test Upload Image & Continue","AB Test Continue Tags Clicked","AB Test Metadata Used Suggested Tags","AB Test Metadata Update Titles Continue","AB Test Metadata Update Descriptions Continue","AB Test Start Test"];if(!i.includes(e)){return Promise.reject("Invalid event type")}return new Promise((i,o)=>{let r=localStorage.getItem("ajs_anonymous_id");let n=localStorage.getItem("ajs_synced");const a=/[0-9a-fA-F]{8}-([0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}/gm;const s="/api/productevents/addsiteevent";let l={event_type:e,properties:t,platform:"WEB"};if(a.test(r)&&r!==n){l.anonymousId=r.replaceAll('"',"").toLowerCase();localStorage.setItem("ajs_synced",r)}TBUtilities.PerformPost(s,l,function(e){if(e.Success){i(response)}},function(){o(response)})})};var Dt=function(e){return e.replace(/[^\p{L}\p{N}\p{P}\p{Z}{\^\$}]|([.*+?^=!:${}()|\[\]\/\\])/gu,"")};return{ActionTypes:{Unknown:0,AdvancedVideoEmbedding_Use:100,AnimatedGifGenerator_Generate:200,AnimatedGifGenerator_Share:201,AnnotationTemplates_Applied:300,BestTimeToPublish_Calculate:400,BrandAlerts_Fetch:500,BulkCopyAnnotations_Copy:600,BulkCopyCards_Copy:700,BulkDeleteAnnotations_Delete:800,BulkDeleteCards_Delete:900,BulkFindReplaceAppent_Find:1e3,BulkFindReplaceAppend_FindAndUpdate:1001,BulkPublishToFacebook_Publish:1100,BulkThumbnailOverlays_Add:1200,BulkThumbnailOverlays_Remove:1201,BulkUpdateAnnotations_Update:1300,BulkUpdateCards_Update:1400,CannedResponses_Use:1500,CaptionsService_Order:1600,CardTemplates_Apply:1700,ChannelBackup_Backup:1800,Channelytics_Use:1900,CommentFilters_ApplyFilter:2e3,CommunityConnect_External:2100,CommunityConnect_Internal:2101,CompetitorsScorecard_View:2200,CompetitorsUploadAlert_Fetch:2210,DefaultUploadProfiles_Apply:2300,DescriptionPromotion_Promote:2400,FeaturedVideoPromotions_Promote:2500,HealthReport_View:2600,LanguageAnalysis_Use:2700,PickAWinner_Pick:2800,PublishToFacebook_Publish:2900,QuickEditToolbar_PlaylistEdit:2970,QuickEditToolbar_MyVideosEdit:2971,QuickEditToolbar_VideoClick:2972,QuickLinksMenu_Click:3e3,ScheduleGoLive_Schedule:3100,ScheduleGoLive_AddCommentAfterPublish:3101,SearchRanking_View:3200,ShareTracker_Track:3300,SocialMonitor_View:3400,SubscriberExport_Export:3500,SubscriberOutreach_ViewSocial:3600,SuggestedTags_Use:3700,SunsetVideos_Schedule:3800,TagExplorer_TagExplored:3900,TagSorter_Sorted:4e3,AutoTranslator_Use:4100,ThumbnailGenerator_Use:4200,VideoAbTests_Use:4300,VideoTopicPlanner_SaveComment:4400,VideoTopicPlanner_Use:4401,ViewAndCopyVideoTags_Copy:4500,WatchPageStats_Stats:4600,BulkCopyEndScreen_Copy:4700,Playlists_BulkUpdate:4800,Playlist_UpdateOrdering:4810,Playlist_UpdatePrivacy:4820,Playlist_UpdateFiltering:4830,UploadChecklist_CompletedItem:4900,BestPractice_UserCompleted:5e3,Opportunities_MarkedAsComplete:5100,Opportunities_UserCompleted:5101,NotificationMenu_PostCommentReply:5200,CommentCloud_Show:5300,EndScreenTemplates_Apply:5400,SocialBluebookValuation_GetValue:5500,BulkUpdateEndScreens_Update:5600,ExportComments_Export:5700,TagLists_Export:5800,CopyTo_Export:5900,SearchTermAnalysis_Use:7100,InstaSuggest_Use:7200,SEOStudio_Save:7300,SEOStudio_ApplyToVideo:7301,Strategy_Start:7400,Strategy_Finish:7401,ClickMagnet_AdvancedAnalytics:7500,ClickMagnet_ElementInspector:7501,ClickMagnet_CTROppotunitiesUse:7502,ClickMagnet_PowerRankings:7503,SearchInsights_ViewDetails:7600,BulkDeleteComments_Use:7700},ActivityLogTypes:{Unknown:0,QuickLinksMenu_MyAccount:1,QuickLinksMenu_HealthReport:2,QuickLinksMenu_CompetitorScorecard:3,QuickLinksMenu_BrandAlerts:4,QuickLinksMenu_ABTests:5,QuickLinksMenu_BackupsAndExports:6,QuickLinksMenu_CannedResponses:7,QuickLinksMenu_Settings:8,QuickLinksMenu_CommunityForums:9,QuickLinksMenu_TipsAndTricks:10,QuickLinksMenu_SuggestAFeature:11,QuickLinksMenu_KnowledgeBase:12,QuickLinksMenu_Dashboard:13,QuickLinksMenu_MyVideos:14,QuickLinksMenu_Playlists:15,QuickLinksMenu_LiveStreaming:16,QuickLinksMenu_Comments:17,QuickLinksMenu_Messages:18,QuickLinksMenu_Subscribers:19,QuickLinksMenu_Analytics:20,QuickLinksMenu_Realtime:21,QuickLinksMenu_TagExplorer:22,QuickLinksMenu_VideoTopicPlanner:23,QuickLinksMenu_BestTimeToPublish:24,PublishToFacebook_Blocked:30,BulkPublishToFacebook_UpgradeClick:40,ShowUpgradePage:50,Layout_SubmitDebugCode:60},GetActivityLogTypeValueFromString:function(e){for(var t in TBUtilities.ActivityLogTypes){if(t==e){return TBUtilities.ActivityLogTypes[t]}}return 0},AddDebug:function(e){f(e)},AddDebugObject:function(e){I(e)},CreateCookie:function(e,t,i){S(e,t,i)},GetCookie:function(e){return A(e)},RemoveCookie:function(e){S(e,"",-1)},ReplaceAll:function(e,t,i,o,r){return R(e,t,i,o,r)},CountMatches:function(e,t,i,o,r){return G(e,t,i,o,r)},GetInArray:function(e,t,i){return O(e,t,i)},RemoveFromArray:function(e,t,i){return M(e,t,i)},SortArray:function(e,t,i,o){return _(e,t,i,o)},SortArrayTwoNumberColumns:function(e,t,i,o,r){return V(e,t,i,o,r)},CreateGuid:function(){return F()},ValidateEmail:function(e){return N(e)},GetHtmlEncoded:function(e){return se(e)},GetXmlEncoded:function(e){return le(e)},GetUrlEncoded:function(e){return ce(e)},HighlightText:function(e,t,i){return ue(e,t,i)},GetUrlDecoded:function(e){return pe(e)},FormatNumberWithCommas:function(e){return H(e)},FormatNumberAbbreviated:function(e,t,i){return W(e,t,i)},FormatCurrency:function(e,t,i,o){return q(e,t,i,o)},PerformGet:function(e,t,i){K(e,t,i)},PerformPost:function(e,t,i,o){J(e,t,i,o)},GetEmailsWithinString:function(e){return Z(e)},AddAction:function(e,t,i){oe(e,t,i)},AddActivityLog:re,LogError:function(e){ne(e)},LogFailedWebRequest:ae,UnicodeToChar:function(e){return ve(e)},FormatFileName:function(e){return he(e)},GetOs:function(){return Se()},GetUrlParameter:function(e){return X(e)},ToLongDateTimeString:function(e){return ie(e)},ToShortDateString:function(e){return te(e)},ToCurrency:function(e,t){return ye(e,t)},GetTime:function(){return P()},Log:function(e){return B(e)},MilliSecondsToTime:function(e,t){return fe(e,t)},MilliSecondsToTimeShort:function(e){return me(e)},AutoIncrementCount:function(e,t){be(e,t)},LoadExternalFile:function(e,t){Te(e,t)},IsAlphaNumeric:function(e){return ge(e)},Truncate:function(e,t,i){return U(e,t,i)},GetDebugEntries:function(){return L()},ValidateUrl:function(e){return Y(e)},IsNullOrEmptyOrWhitespace:function(e){return de(e)},GetVideoTweetCount:function(e,t){return lt(e,t)},Alert:function(e,t){we(e,t)},Confirm:function(e,t,i){return ke(e,t,i)},Prompt:function(e,t,i,o){xe(e,t,i,o)},ParseChannelIdFromUrl:function(e){return Le(e)},ParseVideoIdFromUrl:function(e){return je(e)},ParsePlaylistIdFromUrl:function(e){return Ce(e)},UpdateUrlParameter:function(e,t,i){return Qe(e,t,i)},DataURItoBlob:function(e){return Ye(e)},ForceDebugging:function(){o=true},FixLocalHtml:function(e){return Ue(e)},GetParameterByName:function(e,t){return Ie(e,t)},ParseInnerTubeApiKey:function(e){return Re(e)},ParseDelegatedSessionId:function(e){return Pe(e)},ParseInnerTubeContext:function(e){return Ve(e)},ParseInnerTubeApiClientVersion:function(e){return Oe(e)},ParseInnerTubeApiClientName:function(e){return _e(e)},ParseInnerTubeContextCountry:function(e){return Me(e)},GetSessionToken:Ae,GetCommentTokenFromWatchPageHtml:function(e){return He(e)},GetIdokenFromWatchPageHtml:function(e){return We(e)},GetYouTubeUIVersion:function(e){return ze(e)},FixedEncodeURIComponent:function(e){return nt(e)},IsWordCensored:function(e){return k(e)},GetCensoredWords:function(){return m()},GetYouTubeAutoSuggested:function(e,t){return T(e,t)},GetTubeBuddyCheckboxHtml:function(e,t,i){return v(e,t,i)},GetTagCharacterCount:function(e){return at(e)},CorbUrl:function(e){return st(e)},IsResponseContextFound:function(e){return et(e)},ParseResponseContextFromHtml:function(e){return tt(e)},ParseVideoEditObjectFromHtml:function(e){return ot(e)},GetVideoSearchCollection:function(e){return qe(e)},GetRichGridRendererContents:function(e){return Ke(e)},GetSectionListRendererContents:function(e){return Je(e)},GetVideoSearchCollectionIndex:function(e){return Xe(e)},GetListRendererKey:function(e){return Ze(e)},GetSectionRendererKey:function(e){return $e(e)},ParsePlayerResponseFromHtml:function(e){return rt(e)},GetKeywordRecommendedTags:function(e){return dt(e)},BuildContextRequestObject:function(e){return gt(e)},ProcessHeader:function(e){return Ne(e)},ConvertImagesToDataUrls:function(e){return Tt(e)},AdjustEndScreenElementTiming:function(e,t,i){return kt(e,t,i)},AdjustEndScreenTiming:function(e,t){return Bt(e,t)},ValidateEndscreenElements:function(e){return xt(e)},GetVideoTopics:function(e){return De(e)},DownloadArrayToCSV:function(e,t){ct(e,t)},CapitlizeFirstLetterString:function(e){return Lt(e)},LowerCaseFirstLetterString:function(e){return Ct(e)},HeaderCacheKey:function(){return n},DelegatedSessionIdKey:function(){return a},GetDateFromAnalyticsTimeStamp:function(e){return jt(e)},CheckCardStartMs:function(e,t,i){wt(e,t,i)},GetTimeZoneOffSetInHours:function(e){return E(e)},ParseFacebookLikeCountText:function(e){return Qt(e)},ReportExtensionDOMIssue:function(e,t,i,o){return It(e,t,i,o)},ReportProductExposure:function(e,t=false){return St(e,t)},ReportProductEvent:function(e,t){return At(e,t)},ReportProductSiteEvent:function(e,t){return Et(e,t)},RemoveEmojiAndSpecialCharacters:function(e){return Dt(e)}}}();if(!String.prototype.padLeft){String.prototype.padLeft=function(e,t){var i=this,t=t||"0";while(i.length<e)i=t+i;return i}}if(!String.prototype.hashCode){String.prototype.hashCode=function(){var e=0,t,i;if(this.length===0)return e;for(t=0;t<this.length;t++){i=this.charCodeAt(t);e=(e<<5)-e+i;e|=0}return e}}var tbdelay=function(){var e=0;return function(t,i){clearTimeout(e);e=setTimeout(t,i)}}();(function(e){var t=e({});e.ajaxQueue=function(i){var o,r=e.Deferred(),n=r.promise();function a(t){o=e.ajax(i);o.done(r.resolve).fail(r.reject).then(t,t)}t.queue(a);n.abort=function(s){if(o){return o.abort(s)}var l=t.queue(),d=e.inArray(a,l);if(d>-1){l.splice(d,1)}r.rejectWith(i.context||i,[n,s,""]);return n};return n}})(jQuery);var TBGlobal=function(){var e="";var t="";var i;var o="";var r=null;var n=0;var a=[];var s=false;var l=[];var d="";var u=[];var c=[];var p="{S}";var h=null;var b=null;var f=[{id:"bulkcopycards",icon:"copy",category:"bulk",color:"#445569",pages:["My Videos"],name:"Bulk Copy Cards",summary:"Automate the process of copying Cards across some or all of your videos",howToVideoId:"llMep6_-ijY",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:false,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["Manually adding Cards on all your videos one by one takes forever and is a pain in the &#^@@$","Copying Cards through TubeBuddy ensures you have a clean, consistent look across all your videos",'<a href="https://support.google.com/youtube/answer/6140493?hl=en&ref_topic=6140492" target="_blank">Cards</a> are extremely important for marketing your brand on desktop and mobile'],whereToFindIt:'Go to your <a class="underline" target="_blank" href="https://www.youtube.com/my_videos">My Videos</a> page on YouTube and select "Bulk Copy Cards" from the TubeBuddy menu next to the video that you want to copy Cards <i>from</i>.<br /><img src="/assets/images/tools/screenshots/bulkcopycardswhere.png" />',tipsAndTricks:['Don\'t worry if your videos have different durations. TubeBuddy uses "Smart Timing" to figure out where to place the Cards on each destination video. For example, if you have a set of <i>end cards</i>, TubeBuddy automatically places them at the end of each destination video (same distance from end as source video).','If you are only using this tool for your most recent upload, use <a href="Tools?tool=cardtemplates">Card Templates</a> instead.','If want to get rid of all existing Cards from the destination videos before copying the new Cards, simply select the "remove existing cards" option in Step 2.',"Each video is processed 1 at a time and takes a second or two. So 1,000 videos might take about 30 minutes to process. We recommend limiting bulk copying to 2,000 or less videos. If you have more, consider breaking them up into playlists and running the tool for each playlist separately.","After processing is complete, you can click on the video link in the <i>Completed</i> area to quickly verify that it was done correctly.","You can customize Card properties on individual destination videos in Step 3.","TubeBuddy handles all Card types and each time YouTube puts out a new type of Card, it is added to our system within a day or two."],limits:'<div class="limitHeader">Starter (FREE) | Pro</div><div class="limitbody">Cannot copy Cards to more than one video at a time</div><div class="margin-top10 limitHeader2">Network | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"bulkdeletecards",icon:"remove",category:"bulk",color:"#445569",pages:["My Videos"],name:"Bulk Delete Cards",summary:"Delete Cards from some or all of your videos with just a few clicks",howToVideoId:"8D1HVZSLdNE",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:false,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["Manually deleting Cards on all your videos one by one would take forever",'It\'s an easy way to create a clean slate before executing a <a href="https://support.google.com/youtube/answer/6140493?hl=en&ref_topic=6140492" target="_blank">Cards</a> strategy',"Quickly remove Cards from an old or expired promotion"],whereToFindIt:'Go to your <a class="underline" target="_blank" href="https://www.youtube.com/my_videos">My Videos</a> page on YouTube and select "Delete Cards" from the Bulk TubeBuddy menu above your list of videos.<br /><img src="/assets/images/tools/screenshots/bulkdeletecardswhere.png" />',tipsAndTricks:["The Bulk Copy Cards tool has an option to delete all Cards on videos before copying new Cards. In some cases it makes sense to use that option instead of this tool.","Remember this process deletes ALL Cards from a video. (Some day we will add the ability to delete just certain types of Cards)","Each video is processed 1 at a time and takes a second or two. So 1,000 videos might take about 30 minutes to process. We recommend limiting bulk copying to 2,000 or less videos. If you have more, consider breaking them up into playlists and running the tool for each playlist separately.","After processing is complete, you can click on the video link in the <i>Completed</i> area to quickly verify that it was done correctly."],limits:'<div class="limitHeader">Starter (FREE) | Pro</div><div class="limitbody">Cannot delete Cards from more than one video at a time</div><div class="margin-top10 limitHeader2">Network | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"sunsetvideos",icon:"sun-o",category:"productivity",color:"#445569",name:"Sunset Videos",pages:["My Videos","Edit Video","Upload"],summary:"Schedule videos to be hidden and removed from playlists at a future date/time ",howToVideoId:"z_GVn_q-o30",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:false,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You need to set a video's Privacy to Private or Unlisted at a certain time in the future","You want to remove a video from some or all your playlists at a certain time in the future","Protect yourself against licensed content"],whereToFindIt:'On the My Videos page, Upload Page or Edit Video page. <br /><img src="/assets/images/tools/screenshots/sunsetvideowhere.png" />',tipsAndTricks:["You will receive a notification 24 hours in advance before items scheduled to be sunsetted are actually sunsetted."],limits:'<div class="limitHeader">Starter (FREE) | Pro </div><div class="limitbody">Cannot Sunset Videos</div><div class="margin-top10 limitHeader2">Star | Network | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"playlistactions",icon:"bolt",category:"productivity",color:"#445569",name:"Playlist Actions",pages:["All Playlists"],summary:"Advanced ordering and filtering options for videos within playlists",howToVideoId:"6wmaBD5pVq8",Level0Limitation:"Can only use Standard / Misc Ordering options",Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to order a playlist based on video Engagement, Subscribers Gained or Watch Time","You want to randomize, alphabetize or reverse the order of videos in a playlist","You want to remove Private or Unlisted videos from a playlist"],whereToFindIt:'<a href="https://www.youtube.com/view_all_playlists" target="_blank">All Playlists Page</a>',tipsAndTricks:["Sort your playlist by Watch Time in order to gain the best SEO boost","Due to YouTube API limitations we dont recommend running playlist action on playlists with more than 1k videos"]},{id:"bulkdemonetization",icon:"dollar",category:"bulk",color:"#445569",name:"Demonetization Double-Check",pages:["My Videos"],summary:"Quickly find demonetized videos on your channel then bulk submit them for manual review",howToVideoId:"BZvV9tCbyH8",Level0Limitation:"",Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:false,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to find old demonetized videos that you are not aware of","You want to submit videos for manual review in bulk","You want to ensure you are making the most money possible from your channel"],whereToFindIt:'<img src="/assets/images/tools/screenshots/bulkdemonetizationwhere.png" /><a href="https://www.youtube.com/my_videos" target="_blank">My Videos Page</a>',tipsAndTricks:["Run this process at least once per week to make sure you are not missing out on old videos that were demonetized."],limits:'<div class="limitHeader">Starter (FREE) | Pro | Star</div><div class="limitbody">Cannot Sunset Videos</div><div class="margin-top10 limitHeader2">Network | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"schedulegolive",icon:"power-off",category:"productivity",color:"#445569",name:"Scheduled Publish",pages:["My Videos","Edit Video","Upload"],summary:"Schedule unlisted videos to be published and added to playlists at a future date/time ",howToVideoId:"qK0dT2_uNS4",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:false,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to give your patron supporters early access to a video before making it public","You want to add a video to playlists at a certain time in the future","You want to pass around a video internally at your business before publishing it live"],whereToFindIt:'On the My Videos page, Upload Page or Edit Video page. <br /><img src="/assets/images/tools/screenshots/scheduledpublishwhere.png" />',tipsAndTricks:["(optional) You will receive a notification 24 hours in advance before items scheduled to be published are actually live."],goals:["audience"],featureType:"extension",showInToolbox:true,toolBoxCopy:"Increase the likelihood that your audience watches your content by publishing when your audience is most active.",highlight:"",limits:'<div class="limitHeader">Starter (FREE)</div><div class="limitbody">Cannot Scheduled Publish</div><div class="margin-top10 limitHeader2">Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"bulkthumbnailoverlays",icon:"photo",category:"bulk",color:"#445569",name:"Bulk Thumbnail Overlays",pages:["My Videos"],summary:"Add (and optionally remove later) a graphic overlay to some or all of your video thumbnails",howToVideoId:"JHnVDCA27ZQ",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:false,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to add your business logo to all your thumbnails but don't have 500 hours of spare time to do it manually","You want to run a promotion on your channel by adding (and later removing) a sponsor's logo to your videos' thumbnails","You want to add a distinct image overlay to all thumbnails in a certain playlist"],whereToFindIt:'Go to your <a class="underline" target="_blank" href="https://www.youtube.com/my_videos">My Videos</a> page on YouTube and select "Thumbnail Overlays" from the Bulk TubeBuddy menu above your list of videos.<br /><img src="/assets/images/tools/screenshots/bulkthumbnailoverlayswhere.png" />',tipsAndTricks:["This feature is coming soon! (we are just running some final tests)"],limits:'<div class="limitHeader">Starter (FREE) | Pro</div><div class="limitbody">Cannot update thumbnails of more than one video at a time</div><div class="margin-top10 limitHeader2">Network | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"bulkfindreplaceappend",icon:"refresh",category:"bulk",color:"#445569",name:"Bulk Find, Replace &amp; Append",pages:["My Videos"],summary:"Find & Replace, Append or Remove from video titles and descriptions across your entire channel",howToVideoId:"mU9tahNRVgE",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:false,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to insert a new social profile in the middle of all your existing videos' descriptions","You want to replace a hyperlink in your videos' descriptions with a new link","You want to remove references to that website you were promoting"],whereToFindIt:'Go to your <a class="underline" target="_blank" href="https://www.youtube.com/my_videos">My Videos</a> page on YouTube and select "Titles & Descriptions" from the Bulk Meta Updates TubeBuddy menu above your list of videos.<br /><img src="/assets/images/tools/screenshots/bulkfindandreplacewhere.png" />',tipsAndTricks:["Use caSE SensiTivE and whole word matches to ensure you only update the text you want.","Preview changes before they go live by clicking on the search icon next to each video in step 3.","Each video is processed 1 at a time and takes a second or two. So 1,000 videos might take about 30 minutes to process. We recommend limiting bulk copying to 2,000 or less videos. If you have more, consider breaking them up into playlists and running the tool for each playlist separately."],limits:'<div class="limitHeader">Starter (FREE) | Pro</div><div class="limitbody">Cannot run Find / Replace / Append on more than one video at a time</div><div class="margin-top10 limitHeader2">Network | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"viewandcopyvideotags",icon:"copy",category:"optimization",color:"#9bba5c",name:"View and Copy Video Tags",pages:["Watch Video"],summary:"View and Copy video tags from any video (not just your own)",howToVideoId:"C95gGD6nr6Q",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:true,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You're wondering what your competitor is tagging their videos with","You're looking for ideas around what tags to use in your videos","You want to see why particular videos are rankings higher in search results"],whereToFindIt:'<img src="/assets/images/tools/viewandcopytagswhere2.png" />',tipsAndTricks:["You can hide this feature by going to your Settings tab in the main TubeBuddy menu next to the Upload button in YouTube.","Click on any Tag in the list to run the Tag Explorer tool on the tag."],limits:'<div class="limitHeader">Starter (FREE) | Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"emojipicker",icon:"smile-o",category:"productivity",color:"#9bba5c",name:"Emoji Picker",pages:["Edit Video"],summary:"Add Emojis to your Titles, Tags and Descriptions",howToVideoId:"vuGR5h4SC0k",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:true,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to make your Titles stand out in a crowd","You want to tag your videos in unique ways to help in related videos section","You don't want to have to visit an external site to use emojis"],whereToFindIt:"Info and Settings + Upload Page for Videos",tipsAndTricks:["Use the Search bar to quickly find what you're looking for.","Use the Recently Used area for commong emojis"],limits:'<div class="limitHeader">Starter (FREE) | Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"tagsorter",icon:"reorder",category:"optimization",color:"#9bba5c",name:"Tag Sorter",pages:["Edit Video"],summary:"Reorder your video Tags on any video in any order quickly and easily",howToVideoId:"qoEh7qwQbNc",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:true,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["YouTube removed the ability to reorder your Tags a long time ago","You want your most important Tags ranked first","Helps you rank higher in YouTube search results"],whereToFindIt:'Below your list of Tags on a Video Edit screen<br><img src="/assets/images/tools/screenshots/tagsortwhere.png" />',tipsAndTricks:["Put your most relevant Tags first.","Move tags that people are searching for to the top of your list to help rank higher in search."],limits:'<div class="limitHeader">Starter (FREE) | Pro | Network | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"tagexplorer",icon:"tags",category:"optimization",color:"#9bba5c",name:"Keyword Explorer",pages:["General Page","Edit Page","Watch Page"],summary:"The ultimate Keyword research tool for YouTube and Google Trends",howToVideoId:"2dMFavj55cM",Level0Limitation:"Can only see top 3 results in each category, 25 searches per day.",Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["Get your videos ranked higher in search results and ultimately get more views","Find long-tail search terms to better target what people are looking for on YouTube ","Discover trending Tags to keep your videos relevant long after they are published"],whereToFindIt:'<span style="font-size:12px; font-weight:bold;">[LOCATION 1]</span><br> Click Keyword Explorer from the main TubeBuddy Menu <br /><img src="/assets/images/tools/tagexplorerwhere1.png" /><br><Br><span style="font-size:12px; font-weight:bold;">[LOCATION 2]</span><br> On a Video details screen, click the \'Explore\' button or double-click on any Tag in the Tag list<br/><img src="/assets/images/tools/tagexplorerwhere2.png" /><br/><br><span style="font-size:12px; font-weight:bold;">[LOCATION 3]</span><br> Click on any Tag in the Tag list on a video watch page<br> <img src="/assets/images/tools/tagexplorerwhere3.png" /><br><Br><span style="font-size:12px; font-weight:bold;">[LOCATION 4]</span><br> While you are uploading a new video, click the \'Keyword Explorer\' button<br/><img src="/assets/images/tools/tagexplorerwhere4.png" /><br/><br><span style="font-size:12px; font-weight:bold;">[LOCATION 5]</span><br>From a YouTube Search Results page after clicking the \'View Details\' button, click the magnifying glass next to any tag.<br/><img src="/assets/images/tools/tagexplorerwhere5.png" />',tipsAndTricks:["Find Tags that have a high keyword score meaning they are searched often but there is not too much competition.","Unless you are PewDiePie, it's hard to get your videos ranked high for broad search terms. Try targeting long-tail (more specific) keywords.","If using Tag Explorer on a Video Edit screen or the Upload screen, you can click the (+) Plus Sign next to any Tag to add it to the Tag List in the video you are editing.","Click on any Tag in the results to re-run tag analysis on that Tag.","The Trending Tab only provides results for more general search terms or very popular specific terms."],limits:'<div class="limitHeader">Starter (FREE)</div><div class="limitbody">Cannot view more than the top three results in each section</div><div class="margin-top10 limitHeader2">Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"tagrankings",icon:"tags",category:"optimization",color:"#9bba5c",name:"Tag Rankings",pages:["General Page","Edit Page","Watch Page"],summary:"Instantly see where you video ranks in search results for each its tags",howToVideoId:"NBMvr_V-rts",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:true,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:['Uses "Incognito" results for more accurate rank positions',"Adjust video tags to focus on what you rank for to increase your position","The lower the number the better (1 means you are ranked 1st on the search results page)"],whereToFindIt:"Video Edit Screen",tipsAndTricks:["Keep the Incognito Results option turned in for the most accurate results","Search results vary from person to person, computer to computer so keep in mind that the numbers you see might be slightly different than what someone else sees."],limits:'<div class="limitHeader">Starter (FREE)</div><div class="limitbody">Cannot view more than the top three results in each section</div><div class="margin-top10 limitHeader2">Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"publishtofacebook",icon:"facebook",category:"promotion",color:"#445569",name:"Publish to Facebook",pages:["My Videos","Upload"],summary:"Publish your YouTube videos natively to Facebook with just a couple clicks",howToVideoId:"DJAaoh74iWQ",Level0Limitation:"",Level1Limitation:"",Level2Limitation:null,Level0Access:false,Level1Access:false,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["Facebook is becoming a leader in online video","Make it easier to people to find your content","Monetize your content across multiple social networks"],whereToFindIt:'Upload Page and My Videos page<br><img src="/assets/images/tools/screenshots/publishtofacebookwhere.png" />',tipsAndTricks:["Use this tools for ALL your videos!"],limits:'<div class="limitHeader">Starter (FREE)</div><div class="limitbody">No Access</div><div class="margin-top10 limitHeader2">Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"besttimetopublish",icon:"clock",category:"promotion",color:"#445569",name:"Best Time to Publish",pages:["My Videos","Upload"],summary:"Publish Videos when your Audience is Most Active",howToVideoId:"",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:true,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["Help drive initial view velocity on uploads","Quickly identify when your audience is most active","See when the best time to live stream is"],whereToFindIt:'TubeBuddy Main Menu or Channel Analytics > Audience Tab.  <br /><br /> <div class="header-red-bold-padding-left-0">How recommendations are calculated <div style="padding-bottom:4px;padding-top:4px; font-weight:bold;font-size:14px;color:black;">Overview<div style="font-weight:normal;">The first hour that your video is live is the most critical. The next most critical hour is the second hour. Followed by the third hour and so on. Our proprietary algorithm examines YouTube\'s "When your viewers are on YouTube" data(purple graph above) and calculates a score for every single hour of the week. Our recommendations show when the score is highest. Of course there are different theories and ways to calculate when the best time to publish would be, but this is our particular take on it.</div></div><div style="padding-bottom:4px; font-weight:bold;font-size:14px;color:black;">Upload Time vs Livestream Time<div style="font-weight:normal;">Our Upload Time recommendations look at 6-hour blocks of time (again, where the first hour is weighted the most all the way through to the 6th hour which is weighted the least). We figure the bulk of your subscribers will view your video during this time period so you should publish and optimize focused around this block of time. Our Livestream Time recommendations look at 2-hour blocks of time. This assumes that most people stream for an hour or so. The idea is that you want to livestream right when your audience is most active.</div></div><div style="padding-bottom:4px; font-weight:bold;font-size:14px;color:black;">Other Considerations<div style="font-weight:normal;">Ultimately, consistency is more important than anything. If you can stick to a consistent publishing schedule that your fans remember and can count on, that\'s probably your best bet.</div></div></div>',tipsAndTricks:["These are recommendations - the most important thing is consistency."],limits:'<div class="limitHeader">Starter (FREE)</div><div class="limitbody">No Access</div><div class="margin-top10 limitHeader2">Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"channelytics",icon:"area-chart",category:"research",color:"#f29b27",name:"Channelytics",pages:["Channel Page"],summary:"Stats & Analysis on any channel in YouTube from StatFire",howToVideoId:"zb11V1jsq6I",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:true,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to compare your channel with a competitor's channel","You like graphs and data"],whereToFindIt:"Go to any channel page and click the Channelytics Tab",tipsAndTricks:['The You vs Them graph is powered by <a target="_blank" href="http://www.statfire.com">StatFire.com</a>.'],limits:'<div class="limitHeader">Starter (FREE) | Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"languageanalysis",icon:"language",category:"research",color:"#f29b27",name:"Language Analysis",pages:["Edit Video"],summary:"Get a breakdown of languages spoken by your channel's audience",howToVideoId:"",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:true,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:['Use the data to choose which languages to translate key Tags to (using our <a href="/tools?tool=tagtranslator">Tag Translator</a>)',"Use the data to choose which languages to create Title and Description translations for","Use the data to learn more about your audience and who to target in your videos"],whereToFindIt:'On the <a href="/tools?tool=tagtranslator">Tag Translator</a> tool as well as the Translations Tab on any video Info &amp; Settings screen. <br /><img src="/assets/images/tools/screenshots/languageanalysiswhere.png" />',tipsAndTricks:["When using this data for Tags, try to focus on languages with at least 10%"],limits:'<div class="limitHeader">Starter (FREE) | Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"retentionanalyzer",icon:"clock-o",category:"research",color:"#f29b27",name:"Retention Analyzer",pages:[],summary:"See how videos across your channel are performing at various time intervals.",howToVideoId:"QJ51UFuGj04",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:false,Level2Access:false,Level3Access:true,Level4Access:true,whyYouNeedIt:["Identify what intros or opening sequences are causing viewers to leave.","Work to improve overall retention on your videos by identifying trends in audience viewership.","Test various End Screens to figure out which one performs the best. "],whereToFindIt:"TubeBuddy website channel features",tipsAndTricks:["Use the chart as a scoring system"],limits:'<div class="limitHeader">Starter (FREE) | Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"thumbnailgenerator",icon:"photo",category:"productivity",color:"#445569",name:"Thumbnail Generator",pages:["My Videos","Video Upload"],summary:"Create professional quality thumbnails using still frames from your video and text/image overlays",howToVideoId:"oVnILqIhHk8",Level0Limitation:"Can only add one custom image, cannot create templates, cannot download a copy of image",Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You spend too much time using Photoshop, taking screenshots, copying, pasting, adding, modifying, saving and uploading","You can save and re-use Templates for a clean, consistent look across your video thumbnails","You are paying for an Adobe Photoshop license just to create YouTube video thumbnails"],whereToFindIt:'Go to your <a class="underline" target="_blank" href="https://www.youtube.com/my_videos">My Videos</a> page on YouTube and select "Thumbnail Generator" from the TubeBuddy menu next to the video that you want to generate a thumbnail for.<br><img src="/assets/images/tools/screenshots/thumbnailgeneratorwhere.png" />',tipsAndTricks:["Visual Guidelines (from Creator Playbook): Close-ups on faces, well framed, good composition, looks great at both small and large sizes, accurately represents your content and visually compelling imagery","Create and use Templates to save time and get a consistent look across your videos.","Upload your own custom fonts to ensure thumbnails created in TubeBuddy match your existing content","Upload your logo and other brand images to reuse across videos.","Click on any layer (Text or Image) in the preview area to change its properties, rotate, resize or move it.","Your thumbnail will be updated immediately however, it can take a couple hours for the updated thumbnail to show up throughout all of YouTube."],limits:'<div class="limitHeader">Starter (FREE)</div><div class="limitbody"><ul class="margin-left30"><li>Cannot use Templates</li><li>Cannot upload more than one custom image</li><li>Cannot upload custom fonts</li><li>Cannot download a copy of image</li></ul></div><div class="margin-top10 limitHeader2">Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"coppacenter",icon:"child",category:"productivity",color:"#445569",name:"Coppa Center",pages:["My Videos"],summary:'Learn more about COPPA and quickly identify which videos of yours rated "Made for Kids" by  YouTube ',howToVideoId:"L-M8Yvwmy7k",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:true,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["Learn what COPPA means and how it can affect your channel","Scan your videos to identify which ones are marked as Made for Kids","See which videos that were rated for kids but you overrode as not made for kids"],whereToFindIt:"Click the Coppa Center link under Misc Tools on the Videos List page",tipsAndTricks:["Run periodically to ensure you are not missing new ratings from YouTube"],limits:'<div class="limitHeader">Starter (FREE)</div><div class="limitbody"><ul class="margin-left30"><li>Cannot use Templates</li><li>Cannot upload more than one custom image</li><li>Cannot upload custom fonts</li><li>Cannot download a copy of image</li></ul></div><div class="margin-top10 limitHeader2">Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"defaultuploadprofiles",icon:"upload",category:"productivity",color:"#445569",name:"Default Upload Profiles",pages:["Upload Defaults"],summary:"Create multiple Default Upload Profiles for each type of video you make",howToVideoId:"oYfpUrkn77Q",Level0Limitation:"Can only create one additional upload profile",Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["YouTube only allows you to create one set of Upload Defaults","You have a different set of Tags and boilerplate for your description based on what type of video you are uploading","You can apply these settings to existing videos too (on Video Edit screen)"],whereToFindIt:'<b>Studio Beta:</b> on YouTube Settings, beside the Upload Defaults tab .<br /><img src="/assets/images/tools/screenshots/upload-defaults-where.png" /><br /><br /><b>Classic Studio: </b>On the <a class="underline" target="_blank" href="https://www.youtube.com/upload_defaults">Default Uploads</a> page on YouTube in the upper-right hand corner.<br /><img src="/assets/images/tools/uploaddefaults.png" />',tipsAndTricks:["You can apply your new upload profiles on the Upload page while your video is being uploaded.","Everyone has a different set of options based on their account permissions so if you ever hit a problem, let us know.","Apply your upload profiles to any of your old videos (not just new Uploads)."],limits:'<div class="limitHeader">Starter (FREE)</div><div class="limitbody">Cannot create more than one set of additional Upload Defaults</div><div class="margin-top10 limitHeader2">Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"cardtemplates",icon:"th-large",category:"productivity",color:"#445569",name:"Card Templates",pages:["Video Upload","Cards"],summary:"Set any video as a <i>Card Template</i> then easily apply its Cards to new uploads",howToVideoId:"ZQ5hm0hCDIk",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You are manually creating the same set of Cards on all new uploads","You want to handle all aspects of new uploads quickly and efficiently","You have different sets of Cards to apply depending on what type of video you upload"],whereToFindIt:'Set a video as a Cards Template at the bottom of the Cards page for that video (then you will be able to apply this template on the Upload screen after any new video has been uploaded and processed).<br /><img src="/assets/images/tools/screenshots/cardtemplateswhere2.png" /><br /><br /> <b>Studio Beta:</b> Above on the Video Editor page. <br /><img src="/assets/images/tools/screenshots/cardtemplateswhere.png" />',tipsAndTricks:["Set up different Card Templates for the different types of videos you create. Then on the Upload screen, choose a template based on the type of video being uploaded.",'TubeBuddy uses "Smart Timing" to ensure the Cards get applied in the correct location on your new upload no matter what the duration of the video is.'],goals:["save time"],featureType:"extension",showInToolbox:true,toolBoxCopy:"Direct viewers to other videos you want them to watch, to help create binge behavior, templates make this quicker.",highlight:"",limits:'<div class="limitHeader">Starter (FREE)</div><div class="limitbody">This tool is not available</div><div class="margin-top10 limitHeader2">Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"searchranking",icon:"line-chart",category:"optimization",color:"#9bba5c",name:"Search Positions",pages:["My Videos","Watch Video"],summary:"See where your video ranks for all of its Tags in YouTube search",howToVideoId:"7gOmWGCA2_c",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to know where your video ranks in YouTube search","You want to identify Tags that aren't helping you rank and should therefore be removed","Coming soon: You want to see you video rank position changes week to week"],whereToFindIt:'Go to your <a class="underline" target="_blank" href="https://www.youtube.com/my_videos">My Videos</a> page on YouTube and select "Search Rankings" from the TubeBuddy menu next to the video that you want to see its search rankings.<br /><img src="/assets/images/tools/screenshots/searchrankingswhere.png"/>',tipsAndTricks:["Add your own keywords to track beyond just your Tags"],limits:'<div class="limitHeader">Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited (Subject to change)</div>'},{id:"sharetracker",icon:"twitter",category:"promotion",color:"#bd382f",name:"Share Tracker",pages:["My Videos","Watch Video","Video Upload"],summary:"Share your video on multiple social networks and track which ones you've shared to",howToVideoId:"7pNGyDzaaAM",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:true,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want your video to spread across all social networks","You always forget which social networks you have shared your videos to","You don't want to have to go to the video watch page just to share your video on other social networks"],whereToFindIt:'Go to your <a class="underline" target="_blank" href="https://www.youtube.com/my_videos">My Videos</a> page on YouTube and select "Share Tracker" from the TubeBuddy menu next to the video you want to share and track.<br /><img src="/assets/images/tools/screenshots/sharetrackerwhere.png" />',tipsAndTricks:["You can click on the green/grey dot to toggle the status as sent/not sent.","We hope to some day automate the sharing piece rather than having you manually click to share."],limits:'<div class="limitHeader">Starter (FREE) | Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"vid2vid",icon:"file-text-o",category:"promotion",color:"#bd382f",name:"Vid2Vid Promotion",pages:["My Videos","Video Upload"],summary:"Promote one of your videos in the descriptions of all your other videos",howToVideoId:"y9p_f5PLkhg",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:true,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to easily drive viewers of your old videos to your newest upload","You want to showcase an older video that is relevant to trending topics","You want to feature a video that is running a contest"],whereToFindIt:'Go to your <a class="underline" target="_blank" href="https://www.youtube.com/my_videos">My Videos</a> page on YouTube and select "Promote this Video (Vid2Vid)" from the TubeBuddy menu next to the video that you want to promote.<br /><img src="/assets/images/tools/screenshots/vid2vidwhere.png" />',tipsAndTricks:["Each time you run this tool, it <b>replaces</b> your previous promotion (rather than just appending it to your description)","You can customize the wording - make sure to choose something that a viewer is likely to click","As of right now, you can't easily remove a Description Promotion. You can only replace it. To remove it, you would have to use the Bulk Find / Replace / Append tools and remove each line seprately."],goals:["audience"],featureType:"extension",showInToolbox:true,toolBoxCopy:"Make your content more bingeable by using your library to promote a specific video.",highlight:"",limits:'<div class="limitHeader">Starter (FREE) | Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"advancedvideoembedding",icon:"code",category:"productivity",color:"#445569",name:"Advanced Video Embed",pages:["My Videos","Watch Video","Playlist Edit"],summary:"Create embed codes with the full list of options for adding videos or playlists to your website",howToVideoId:"dFUYsbbf6U0",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:true,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["YouTube only gives you a few basic options for embedding videos and playlists","You want to customize the look of your embedded video or playlist","You don't want to have to go to the video watch page to get the embed code for your own video"],whereToFindIt:'Drop down next to any video on your <a target="_blank" href="https://www.youtube.com/my_videos">My Videos</a> page, "Tools" tab (above Description) on any <a target="_blank" href="https://www.youtube.com/watch?v=oJddzb2DKTU">Video Watch Page</a> or any edit Playlist page<br /><img alt="advanced embed image" src="/assets/images/tools/screenshots/advanceembedwhere.png" />',tipsAndTricks:["Click on on any of the options to learn more about what it does."],limits:'<div class="limitHeader">Starter (FREE) | Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"quicklinksmenu",icon:"link",category:"productivity",color:"#445569",name:"Quick Links Menu",pages:["General Page"],summary:"Easily navigate to common areas on YouTube without having to click 17 times",howToVideoId:"oJcelF4Ao90",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:true,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["YouTube makes you click 47 times and load 13 pages to simply get to your My Videos page (note: we maybe have exaggerated slightly)","There are only a few areas that you go to all the time and you should be able to get to them more easily","Coming soon: Customize the Quick Menu with your own links"],whereToFindIt:'Click the main TubeBuddy menu next to the Upload button on YouTube.<br /><img src="/assets/images/tools/screenshots/quicklinksmenuwhere.png" />',tipsAndTricks:["We hope to allow you to customize this menu in the near future"],limits:'<div class="limitHeader">Starter (FREE) | Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"quickedittoolbar",icon:"pencil",category:"productivity",color:"#445569",name:"Quick-Edit Toolbar",pages:["General Page","Video Edit","Edit Video","Annotations","Cards","My Videos","Playlist","All Playlists"],summary:"Easily navigate between videos when editing a list",howToVideoId:"wo6KA2-Q55g",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:true,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["There is no way to easily edit videos in a Playlist on YouTube without it","You are tired of having to click the My Videos page every time you want to edit another video","You like to be able to easily jump between videos"],whereToFindIt:"Any Video Edit screen - assuming you came from a Playlist page or My Videos page",tipsAndTricks:['Go to your <A href="https://www.youtube.com/view_all_playlists" target="_blank">Playlists</a> page to easily edit any playlist'],limits:'<div class="limitHeader">Starter (FREE) | Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"channelbackup",icon:"download",category:"research",color:"#f29b27",name:"Channel Backup",pages:["My Videos"],summary:"Protect yourself against lost data by backing up all your videos' metadata",howToVideoId:"0k7bEQNIyHY",Level0Limitation:null,Level1Limitation:"Cannot export results to CSV",Level2Limitation:null,Level0Access:false,Level1Access:false,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want peace of mind knowing that your channel information is backed up","You want to play with video metadata in Excel or Google Docs","You want to search, filter or sort video data using a spreadsheet application"],whereToFindIt:'Go to your <a class="underline" target="_blank" href="https://www.youtube.com/my_videos">My Videos</a> page on YouTube and click the "Backup" button.<br /><img src="/assets/images/tools/screenshots/channelbackupwhere.png" />',tipsAndTricks:["Run the backup process often to ensure you never lose your hard earned work","Someday we hope to allow backing up of video files themselves","Someday we hope to add a way to restore a channel from CSV"],limits:'<div class="limitHeader">Starter (FREE) | Pro </div><div class="limitbody">Cannot export data to CSV</div><div class="margin-top10 limitHeader2">Network | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"milestones",icon:"trophy",category:"promotion",color:"#f29b27",name:"Milestones",pages:["My Videos"],summary:"Celebrate your channel's successes",howToVideoId:"dpFtudhGtuM",Level0Limitation:"Can not select custom backgrounds",Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to share your recent achievements on social media","You want to print and frame a special channel milestones","You want to surprise a friend by showing off their channel's milestone"],whereToFindIt:'From the TubeBuddy main menu on YouTube, or, go to <a target="_blank" href="https://www.tubebuddy.com/milestones">TubeBuddy.com/Milestones</a>.',tipsAndTricks:["Don't just celebrate your own milestones, celebrate everyones!","Celebrate milestones but do not get caught up in the numbers. Focus on great content and the achievements will come."],limits:'<div class="limitHeader">Starter (FREE) | Pro </div><div class="limitbody">Cannot export data to CSV</div><div class="margin-top10 limitHeader2">Network | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"exportcomments",icon:"file-excel-o",category:"research",color:"#f29b27",name:"Export Comments",pages:["My Videos"],summary:"Export Video Comments to CSV File",howToVideoId:"yeT8blc5rPs",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:false,Level2Access:false,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to search comments for particular words","You want to run analysis on your comment pages","You want to identify top influencers that are active on your channel"],whereToFindIt:'Video Tools menu on any video on the <a href="https://www.youtube.com/my_videos" target="_blank">My Videos</a> page',tipsAndTricks:[""],limits:'<div class="limitHeader">Starter (FREE) | Pro </div><div class="limitbody">Cannot export data to CSV</div><div class="margin-top10 limitHeader2">Network | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"cannedresponses",icon:"file-text-o",category:"productivity",color:"#445569",name:"Canned Responses",pages:["Subscribers","Watch Video"],summary:"Use pre-written messages in various areas of YouTube ",howToVideoId:"Nnrl_BhFrnA",Level0Limitation:"Can only create 1 Canned Response",Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You find yourself writing the same response over and over in YouTube","You want to personalize messages but write them faster","You want to write messages in your own wording, then have someone else use TubeBuddy to actually send the responses"],whereToFindIt:'Click on the main TubeBuddy menu next to the Upload button then under Website Tools select Canned Responses.<br /><img src="/assets/images/tools/cannedresponses.png" />',tipsAndTricks:["Use {N} as a placeholder which will insert the channel's username into the message and personalize it.","Currently available in Subscribers List page and Community Connect tool. Want it in other areas? Let us know!"],limits:'<div class="limitHeader">Starter (FREE)</div><div class="limitbody">Cannot create more than one Canned Response</div><div class="margin-top10 limitHeader2">Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"pickawinner",icon:"trophy",category:"promotion",color:"#bd382f",name:"Pick a Winner",pages:["My Videos","Watch Video"],summary:"Randomly select a user who has commented on one of your videos",howToVideoId:"ZIxUlz96c8s",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:true,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You are running a contest and need to randomly pick a winner","You want access to social profiles of a random commenter on a video","You want to flip through random comments on a video"],whereToFindIt:'Go to your <a class="underline" target="_blank" href="https://www.youtube.com/my_videos">My Videos</a> page on YouTube and select "Pick a Winner" from the TubeBuddy menu next to the video that you want to want to randomly select a commenter from.<br /><img src="/assets/images/tools/screenshots/pickawinnerwhere.png" />',tipsAndTricks:["If you are selecting more than one winner, simply click the button again"],limits:'<div class="limitHeader">Starter (FREE) | Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"promomaterials",icon:"bullhorn",category:"promotion",color:"#bd382f",name:"Promotion Materials",pages:[""],summary:"Specialized links and code for promoting your channel and videos",howToVideoId:"40AbO-orgbQ",Level0Limitation:"Cannot create custom links or run on custom video Ids",Level1Limitation:null,Level2Limitation:null,Level0Access:true,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to boost new uploads by linking to them in various areas","You want to add your most recent or most popular upload to an email signature","You want to embed a video player on your blog or website that always plays your most recent video"],whereToFindIt:'Log in at TubeBuddy.com/account and click "Promo Materials" under a channel.',tipsAndTricks:[""],limits:'<div class="limitHeader">Starter (FREE) | Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"channelvaluation",icon:"dollar",category:"research",color:"#9bba5c",name:"Channel Valuation",pages:["Dashboard"],summary:"Know your Worth. Brand Deal Valuations via SocialBluebook.com",howToVideoId:"R5x4qN99WVQ",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:true,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to know how much to charge brands for a dedicated video","You want to know how much to charge brands for a shoutout","You want to monitor your channel's worth and see if it is rising or falling"],whereToFindIt:'<a href="https://www.youtube.com/dashboard">YouTube Dashboard</a>.',tipsAndTricks:['If you do not see your valuation, head to <a href="https://socialbluebook.idevaffiliate.com/111.html">socialbluebook.com</a> and link your channel'],limits:'<div class="limitHeader">Starter (FREE)</div><div class="limitbody">Cannot re-run analysis after the first time</div><div class="margin-top10 limitHeader2">Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"channelaccess",icon:"lock",category:"research",color:"#9bba5c",name:"Channel Access",pages:[],summary:"Grant specific people access to your TubeBuddy account",howToVideoId:"bJmJIhd4JW4",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:false,Level2Access:false,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to give another Creator access to your channel Health Report","You want to give your client access to view your progress and their statistics","You want to share your TubeBuddy license among employees in your company"],whereToFindIt:'In the Settings area of a channel on <a href="https://www.tubebuddy.com/account" target="_blank">TubeBuddy.com/Account',tipsAndTricks:["",""],limits:'<div class="limitHeader">Starter (FREE)</div><div class="limitbody">Cannot re-run analysis after the first time</div><div class="margin-top10 limitHeader2">Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"bulkupdatecards",icon:"refresh",category:"bulk",color:"#445569",name:"Bulk Update Cards",pages:["My Videos"],summary:"Automate the process of updating Cards across some or all of your videos",howToVideoId:"eI6FEimLNsg",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:false,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["Manually updating Cards on all your videos one by one takes forever and is a pain in the &#^@@$","You want to test different Teaser Text or Call To Action to see which converts better"],whereToFindIt:'Go to your <a class="underline" target="_blank" href="https://www.youtube.com/my_videos">My Videos</a> page on YouTube and select "Update" under "Bulk Card Updates" in the TubeBuddy menu at the top of the page. <br /><img src="/assets/images/tools/screenshots/bulkupdatecardswhere.png" />',tipsAndTricks:[],limits:'<div class="limitHeader">Starter (FREE) | Pro</div><div class="limitbody">Cannot update Cards to more than one video at a time</div><div class="margin-top10 limitHeader2">Network | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"videoabtests",icon:"adjust",category:"optimization",color:"#9bba5c",name:"Video A/B Tests",pages:[],summary:"Test Titles, Thumbnails, Tags and Descriptions to find what works best",howToVideoId:"og_RxIVaDNs",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level3Limitation:"Max of 10 concurrent tests",Level0Access:false,Level1Access:false,Level2Access:false,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to back up theories about what thumbnails work best for your audience","You want to find the best style for your Titles to drive the most clicks","You want to see if changes to your Title, Description or Tags affects your search traffic"],whereToFindIt:'TubeBuddy.com/Account (then click AB Tests under your channel)<br><br>Want to use A/B Tests to improve your YouTube SEO?<br/>Check out <a href="https://www.milesbeckler.com/youtube-seo/#videoseosoftware">https://www.milesbeckler.com/youtube-seo/#videoseosoftware</a>',tipsAndTricks:["(coming soon!)"],goals:["more views"],featureType:"website",showInToolbox:true,toolBoxCopy:"Test thumbnails, titles, and descriptions and learn which option will drive more views.",highlight:"",limits:'<div class="limitHeader">Starter (FREE) | Network | Pro | Star</div><div class="limitbody">This tool is not available</div><div class="margin-top10 limitHeader2">Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"competitorscorecard",icon:"pie-chart",category:"research",color:"#f29b27",name:"Competitor Scorecard",pages:[],summary:"See how your channel stacks up against the competition",howToVideoId:"NUoGzwGzzW8",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level3Limitation:"Max 10 Competitors",Level0Access:false,Level1Access:false,Level2Access:false,Level3Access:false,Level4Access:true,whyYouNeedIt:["You want to see how you compare with the competition in views, subscribers, uploads and engagement","You want a printable report showing data about you vs your competition","You want to Export to CSV YouTube data about your competition"],whereToFindIt:'TubeBuddy.com (click the "Competitor Scorecard" link on the main TubeBuddy menu on YouTube.com)',tipsAndTricks:["Has Print button to get a printer friendly copy of the Scorecard"],limits:'<div class="limitHeader">Starter (FREE) | Network | Pro | Star </div><div class="limitbody">This tool is not available</div><div class="margin-top10 limitHeader2">Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"competitoruploadalerts",icon:"bell",category:"research",color:"#f29b27",name:"Competitor Upload Alerts",pages:[],summary:"Get notification when a competitor uploads a video",howToVideoId:"ucWK7MyF3IA",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level3Limitation:"Max 10 Competitors",Level0Access:false,Level1Access:false,Level2Access:false,Level3Access:false,Level4Access:true,whyYouNeedIt:["You want to be notified when a competitor uploads a video.","You can choose to be notified via email, TubeBuddy notification or text."],whereToFindIt:'Competitor icon on any of your linked channels at <a href="https://www.tubebuddy.com/account" target="_blank">TubeBuddy.com/account</a> and then click on Manage',tipsAndTricks:["Use this tool to keep track of your competitions video uploads.","This tool will notify you within minutes of an upload so you can monitor competitor activities."],limits:'<div class="limitHeader">Starter (FREE) | Network | Pro | Star </div><div class="limitbody">This tool is not available</div><div class="margin-top10 limitHeader2">Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"brandalerts",icon:"bell",category:"research",color:"#f29b27",name:"Brand Alerts",pages:[],summary:"Monitor YouTube for new videos, playlists and channels uploaded about you or your brand",howToVideoId:"CTctBDrbtDY",Level0Limitation:null,Level1Limitation:null,Level2Limitation:"Limited to just 1 Brand Alert",Level0Access:false,Level1Access:false,Level2Access:false,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to know when someone uploads a review video about your product","You want to track uploads about your competitors","You want to monitor general sentiment about you or your brand on YouTube"],whereToFindIt:'Brand Alert icon on any of your linked channels at <a href="https://www.tubebuddy.com/account" target="_blank">TubeBuddy.com/account</a>. <img src="/assets/images/tools/screenshots/brandalertswhere.png" />',tipsAndTricks:["Use this tool to thank your fans for uploading content about you!","Use this tool to track and find illegal uploaded content"],limits:'<div class="limitHeader">Starter (FREE) | Pro </div><div class="limitbody">This tool is not available</div><div class="margin-top10 limitHeader2">Star | Network</div><div class="limitbody">You can create 1 Brand Alert</div><div class="margin-top10 limitHeader2">Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"healthreport",icon:"heartbeat",category:"research",color:"#f29b27",name:"Health Report",pages:[],summary:"Get an overall look at the health and performance of your channel",howToVideoId:"ZybNWMQQdA8",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to discover what's working and what isn't on your channel","You want quick access to analytics - demographics, search traffic, related videos, watch time, etc","You want to improve your channel based on data insights"],whereToFindIt:"TubeBuddy.com Website (click heartbeat icon next to channel)",tipsAndTricks:["Data is updated once per day when YouTube Analytics are refreshed","Use information to find out what is working and what is not on your channel and make adjustments"],limits:'<div class="limitHeader">Starter (FREE)</div><div class="limitbody">This tool is not available</div><div class="margin-top10 limitHeader2">Pro | Star | Network | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"commentcloud",icon:"cloud",category:"research",color:"#f29b27",name:"Comment Word Cloud",pages:[],summary:"Get a visual representation of what people are saying about your videos",howToVideoId:"jIiBOSvDM0M",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:true,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["Understand if people have a positive or negative sentiment about a video","Get new video ideas by seeing what people are talking most about in your videos","Get a quick overall sense for how a video performed and what people think about it"],whereToFindIt:'Video Watch pages </br></br><img src="/assets/images/tools/screenshots/wordcloud-where2.jpg" />',tipsAndTricks:["Click the button again after loading more comments to refresh the cloud"],limits:'<div class="limitHeader">Starter (FREE)</div><div class="limitbody">This tool is not available</div><div class="margin-top10 limitHeader2">Pro | Star | Network | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"clickmagnet",icon:"magnet",category:"research",color:"#f29b27",name:"Click Magnet",pages:[],summary:"Advanced analytics to help win the click and get viewers watching.",howToVideoId:"CruHf8SMY4c",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:false,Level2Access:false,Level3Access:true,Level4Access:true,whyYouNeedIt:["Determine which videos perform best for your channel","Discover which elements of your thumbnails and titles are driving the highest CTR","Identify high performing videos where slight tweaks can make the biggest impact","Group, sort, view and export your most important video performance data"],whereToFindIt:'On the Channel Videos Page, Click Bulk & Misc Tools <img src="/assets/images/tools/screenshots/CM Where.png" />',tipsAndTricks:["Videos are ranked relative to the videos on your channel, not any other channels videos","You may see a common thread of the types of content that performs, or doesnt perform, for your channel, and you should adjust your content strategy accordingly","Click on the bars in the Element Inspector graphs to see all of the thumbnails in that category","Export the data from the Advanced Analytics tab to build your own reports and analysis"],limits:'<div class="limitHeader">Starter (FREE)</div><div class="limitbody">This tool is not available</div><div class="margin-top10 limitHeader2">Pro | Star | Network | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"autotranslator",icon:"language",category:"optimization",color:"#9bba5c",name:"Tag Translator",pages:["Edit Video"],summary:"Translate video Tags into other languages to increase global viewership",howToVideoId:"25OHhrk5QyU",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level3Limitation:"Max 50 translations per day",Level0Access:false,Level1Access:false,Level2Access:false,Level3Access:true,Level4Access:true,whyYouNeedIt:["Your want people all around the world find and watch your video","You want your video showing up as a Related Video on other videos around the world","You recognize that YouTube is a global community and want to connect with everyone"],whereToFindIt:'Below your list of Tags on a Video Edit screen and on the Translations Tab on the video edit page <br><img src="/assets/images/tools/screenshots/autotranslatorwhere.png" />',tipsAndTricks:["You are limited in the total number of Tags on a video so only translate your most relevant Tags.","Check out your Analytics before deciding which Tags to translate and see what countries you are getting views from."],limits:'<div class="limitHeader">Starter (FREE) | Pro | Star</div><div class="limitbody">No access</div><div class="margin-top10 limitHeader2">Network | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"metaautotranslator",icon:"language",category:"optimization",color:"#9bba5c",name:"Auto Translator",pages:["Edit Video, Upload Page"],summary:"Translate video Title and Description into other languages to increase global viewership",howToVideoId:null,Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level3Limitation:"Max 50 translations per day",Level0Access:false,Level1Access:false,Level2Access:false,Level3Access:true,Level4Access:true,whyYouNeedIt:["Your want people all around the world find and read the video title and description in their own language","You want your video showing up as a Related Video on other videos around the world","You recognize that YouTube is a global community and want to connect with everyone"],whereToFindIt:'On a Video Edit screen on the Subtitles tab. <br><img src="/assets/images/tools/screenshots/metaautotranslatorwhere.png" />',tipsAndTricks:["You are limited in the total number of title and descriptions per day, 50.","Check out your Analytics before deciding which Tags to translate and see what countries you are getting views from."],limits:'<div class="limitHeader">Starter (FREE) | Pro | Star</div><div class="limitbody">No access</div><div class="margin-top10 limitHeader2">Network | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"videotopicplanner",icon:"edit",category:"productivity",color:"#445569",name:"Video Topic Planner",pages:["General Page","Edit Page","Watch Page"],summary:"Easily manage and get ideas for future video topics",howToVideoId:"BKf_y6zyV5I",Level0Limitation:"Maximum of 5 video topics and comment suggestions",Level1Limitation:"",Level2Limitation:"",Level3Limitation:"",Level0Access:false,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You have trouble coming up with ideas for new videos","You keep forgetting those great video suggestions from your audience in the video comments area","You don't have an easily accessible and reliable way of saving and tracking future video ideas"],whereToFindIt:'Click Video Topic Planner from the main TubeBuddy Menu<br><img src="/assets/images/tools/screenshots/videotopicplannerwhere.png" />',tipsAndTricks:["You can sort your list of topics by dragging them up/down in the list",'Head to the comments section of any of your videos, click the TubeBuddy icon next to a comment and then check the box next to "Comment Suggestion" and it will show up in the Video Topic Planner tool'],limits:'<div class="limitHeader">Starter (FREE)</div><div class="limitbody"><ul class="margin-left30"><li>Max of 5 Topics</li><li>Max of 5 Comment Suggestions</li></ul></div><div class="margin-top10 limitHeader2"> | Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"bestpractice",icon:"book",category:"optimization",color:"#445569",name:"Best Practice Audit",pages:["My Videos"],summary:"Automated checks to ensure you're following YouTube's recommendations",howToVideoId:"JeMrZmqpeSk",Level0Limitation:"",Level1Limitation:"",Level2Limitation:"",Level3Limitation:"",Level0Access:false,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You you want to ensure your video is set up correctly","You want to make sure there are no broken links in your video descriptions","You want to remember to add specific words or phrases in your titles/tags/descriptions"],whereToFindIt:"My Videos page, video edit page, and the TubeBuddy.com website",tipsAndTricks:["Create your own Best Practice items specific to your channel","Disable any Best Practice checks that don't apply to your channel"],limits:'<div class="limitHeader">Starter (FREE)</div><div class="limitbody"><ul class="margin-left30"><li>Max of 5 Topics</li><li>Max of 5 Comment Suggestions</li></ul></div><div class="margin-top10 limitHeader2"> | Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"opportunities",icon:"lightbulb-o",category:"optimization",color:"#445569",name:"Opportunity Finder",pages:["My Videos"],summary:"Suggestions for channel growth based on video performance and analytics",howToVideoId:"lkakEuHCY40",Level0Limitation:"",Level1Limitation:"",Level2Limitation:"",Level3Limitation:"",Level0Access:false,Level1Access:false,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You are missing out on opportunities outside of YouTube's website","It would take you too long to research items that TubeBuddy automatically finds for you","You can potentially gain views, subscribers and more engagement by following our recommendations"],whereToFindIt:"My Videos page and TubeBuddy.com website",tipsAndTricks:["You can disable Opportunities that don't apply to you","You can automate the Opportunity Finder on the Launch Pad Settings page if you have upgraded access"],limits:'<div class="limitHeader">Starter (FREE)</div><div class="limitbody"><ul class="margin-left30"><li>Max of 5 Topics</li><li>Max of 5 Comment Suggestions</li></ul></div><div class="margin-top10 limitHeader2"> | Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"bulkcopyendscreen",icon:"copy",category:"bulk",color:"#445569",pages:["My Videos"],name:"Bulk Copy End Screen",summary:"Automate the process of copying End Screens across some or all of your videos",howToVideoId:"_U4NewnOCNs",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:false,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["Manually adding End Screen Elements on all your videos one by one takes forever and is a pain in the &#^@@$","Copying End Screen Elements through TubeBuddy ensures you have a clean, consistent look across all your videos",'<a href="https://support.google.com/youtube/answer/6388789?p=end_screens&hl=en&rd=1" target="_blank">End Screens</a> are extremely important for marketing your brand on desktop and mobile'],whereToFindIt:'Go to your <a class="underline" target="_blank" href="https://www.youtube.com/my_videos">My Videos</a> page on YouTube and select "Bulk Copy End Screen" from the TubeBuddy menu next to the video that you want to copy Cards <i>from</i>.<br /><img src="/assets/images/tools/screenshots/bulkcopyendscreenwhere.png" />',tipsAndTricks:['Don\'t worry if your videos have different durations. TubeBuddy uses "Smart Timing" to figure out where to place the End Screen Elements on each destination video.','If want to get rid of all existing End Screen Elements from the destination videos before copying the new Elements, simply select the "Delete all existing End Screen Elements " option in Step 2.',"Each video is processed 1 at a time and takes a second or two. So 1,000 videos might take about 30 minutes to process. We recommend limiting bulk copying to 2,000 or less videos. If you have more, consider breaking them up into playlists and running the tool for each playlist separately.","After processing is complete, you can click on the video link in the <i>Completed</i> area to quickly verify that it was done correctly.","You can customize End Screen Element properties on individual destination videos in Step 3."],limits:'<div class="limitHeader">Starter (FREE) | Pro</div><div class="limitbody">Cannot copy End Screen Elements to more than one video at a time</div><div class="margin-top10 limitHeader2">Network | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"bulkdeleteendscreen",icon:"remove",category:"bulk",color:"#445569",pages:["My Videos"],name:"Bulk Delete End Screen",summary:"Automate the process of deleting End Screens Elements across some or all of your videos",howToVideoId:null,Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:false,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["Manually deleting End Screen Elements on all your videos one by one takes forever and is a pain in the &#^@@$","Delete an End Screen Element for a site, video or playlist you no longer want to promote"],whereToFindIt:'Go to your <a class="underline" target="_blank" href="https://www.youtube.com/my_videos">My Videos</a> page on YouTube and select the Bulk TubeBuddy menu above your list of videos.  Then select the "Delete" sub menu under the "End Screens" menu.<br /><img src="/assets/images/tools/screenshots/bulkdeleteendscreenwhere.png" />',tipsAndTricks:["Each video is processed 1 at a time and takes a second or two. So 1,000 videos might take about 30 minutes to process. We recommend limiting bulk copying to 2,000 or less videos. If you have more, consider breaking them up into playlists and running the tool for each playlist separately.","After processing is complete, you can click on the video link in the <i>Completed</i> area to quickly verify that it was done correctly."],limits:'<div class="limitHeader">Starter (FREE) | Pro</div><div class="limitbody">Cannot delete End Screen Elements to more than one video at a time</div><div class="margin-top10 limitHeader2">Network | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"endscreentemplates",icon:"th-large",category:"productivity",color:"#445569",name:"End Screen Templates",pages:["Video Upload, End Screen, My Videos"],summary:"Set any video as a <i>End Screen Template</i> then easily apply its End Screen Elements to new uploads",howToVideoId:"bzLZu7nO8ZA",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You are manually creating the same set of End Screen Elements on all new uploads","You want to handle all aspects of new uploads quickly and efficiently","You have different sets of End Screen Elements to apply depending on what type of video you upload"],whereToFindIt:'Set a video as a End Screen Template at the bottom of the End Screen page for that video (then you will be able to apply this template on the Upload screen after any new video has been uploaded and processed).<br /><img src="/assets/images/tools/endscreentemplateswhere2.png" /><br /><br /><b>Studio Beta:</b> Above on the Video Editor page. <br /><img src="/assets/images/tools/screenshots/endscreentemplateswhere.png" />',tipsAndTricks:["Set up different End Screen Templates for the different types of videos you create. Then on the Upload screen, choose a template based on the type of video being uploaded.",'TubeBuddy uses "Smart Timing" to ensure the End Screen get applied in the correct location on your new upload no matter what the duration of the video is.'],goals:["save time"],featureType:"extension",showInToolbox:true,toolBoxCopy:"Direct viewers to other videos or resources that you want them to see next, templates make this quicker.",highlight:"",limits:'<div class="limitHeader">Starter (FREE)</div><div class="limitbody">This tool is not available</div><div class="margin-top10 limitHeader2">Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"shareontwitter",icon:"twitter",category:"promotion",color:"#445569",name:"Share on Twitter",pages:["Video Upload, My Videos"],summary:"Easy share your YouTube videos on Twitter and automatically attach your thumbnail to it",howToVideoId:"69_I5MeVImk",Level0Limitation:"TubeBuddy branding on Post",Level1Limitation:null,Level2Limitation:null,Level0Access:true,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to easily share your videos on Twitter directly from YouTube","You want to attach your video thumbnail for a more eye-catching Tweet","You want to help drive more draffic and views to your videos"],whereToFindIt:'Any video list or video edit screen. <br /><img src="/assets/images/tools/screenshots/shareontwitterwhere.png" />',tipsAndTricks:["You can add as many Twitter accounts as you would like to post from","Check the box to attach your Thumbnail for a more visually appealing post"],limits:'<div class="limitHeader">Starter (FREE)</div><div class="limitbody">This tool is not available</div><div class="margin-top10 limitHeader2">Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"bulkupdateendscreens",icon:"list",category:"bulk",color:"#445569",name:"Bulk Update End Screens",pages:["My Videos"],summary:"Automate the process of updating End Screen across some or all of your videos",howToVideoId:"e2baTTR9ExU",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:false,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["Manually updating End Screens on all your videos one by one takes forever and is a pain in the &#^@@$","You want to replace an old promotion link on all End Screens to a new promotion link","You want to test different Titles or Images to see which converts better"],whereToFindIt:'Go to your <a class="underline" target="_blank" href="https://www.youtube.com/my_videos">My Videos</a> page on YouTube and select "Update" under "Bulk End Screen Updates" in the TubeBuddy menu at the top of the page. <br /><img src="/assets/images/tools/screenshots/bulkupdateendscreenswhere.png" />',tipsAndTricks:[],limits:'<div class="limitHeader">Starter (FREE) | Pro</div><div class="limitbody">Cannot update End Screens to more than one video at a time</div><div class="margin-top10 limitHeader2">Network | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"taglists",icon:"list-alt",category:"optimization",color:"#445569",name:"Tag Lists",pages:["General Page","Edit Page","Watch Page","Upload Page"],summary:"Create and manage centralized lists of Tags",howToVideoId:"ToVuDS_i49U",Level0Limitation:"Maximum of 3 lists",Level1Limitation:"",Level2Limitation:"",Level3Limitation:"",Level0Access:false,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to store related tags for later use","You want quick access to certain sets of tags","You want to ditch your Excel spreadsheets"],whereToFindIt:'My Videos page<br><img src="/assets/images/tools/screenshots/taglistswhere.png" /><br><br><br>[LOCATION 2] On a video edit screen, click the "Copy Tags" button<img src="/assets/images/tools/screenshots/copytags-where.png" />',tipsAndTricks:[],limits:'<div class="limitHeader">Starter (FREE)</div><div class="limitbody"><ul class="margin-left30"><li>Max of 3 Lists</li><li>Max of 3 Lists</li></ul></div><div class="margin-top10 limitHeader2"> | Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"keywordranktracking",icon:"list-ol",category:"optimization",color:"#9bba5c",name:"Search Rank Tracking",pages:[],summary:"Track your videos rankings (and your competitors) across YouTube and Google search for desired Keywords",howToVideoId:"sIKtzCzEiv4",Level0Limitation:null,Level1Limitation:null,Level2Limitation:"Max 5 Keywords, No Competitor Tracking, YouTube only (no Google)",Level3Limitation:"Max 50 Keywords",Level0Access:false,Level1Access:false,Level2Access:false,Level3Access:false,Level4Access:true,whyYouNeedIt:["You want to track your Video SEO efforts","You want to see where you rank compared to your Competitors for certain keywords","You want and overall status of how your channel is performing in YouTube and Google search"],whereToFindIt:"TubeBuddy Star, Legend or Enterprise Dashboard",tipsAndTricks:["Think about what people might search to find your product","Try to out-optimize your competitors"],limits:'<div class="limitHeader">Starter (FREE) | Network | Pro | Star </div><div class="limitbody">This tool is not available</div><div class="margin-top10 limitHeader2">Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"videolytics",icon:"line-chart",category:"research",color:"#9bba5c",name:"Videolytics",pages:[],summary:"Access advanced analytics and insights, instantly for any YouTube video",howToVideoId:"TI5bccXdNBk",Level0Limitation:"Can only compare video to channel's most popular video",Level1Limitation:null,Level2Limitation:null,Level3Limitation:null,Level0Access:false,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["Research competitor videos to see what's working and not working for them","Get insights on trending videos to see what's hot","Compare any video on YouTube with another video across a wide variety of stats"],whereToFindIt:"Video Watch Page",tipsAndTricks:[""],limits:'<div class="limitHeader">Starter (FREE) | Network | Pro | Star </div><div class="limitbody">This tool is not available</div><div class="margin-top10 limitHeader2">Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"scheduledvideoupdate",icon:"calendar",category:"productivity",color:"#445569",name:"Scheduled Video Update",pages:["My Videos","Edit Video","Upload"],summary:"Schedule video updates at a future date/time ",howToVideoId:"Tp1F7ERoSVQ",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:false,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to schedule a change to a video's Title, Tags, Description or Thumbnail in the future","You want to and or remove a video from playlists at a certain time in the future","You want to schedule a privacy change (Public / Unlisted / Private) to your video in the future"],whereToFindIt:'On the My Videos page and Edit Video page. <br /><img src="/assets/images/tools/screenshots/scheduledvideoupdatewhere.png" />',tipsAndTricks:["If you want to run a promotion, use the Rollback feature to automatically roll-back your changes at a later date/time."],limits:'<div class="limitHeader">Starter (FREE) | Pro </div><div class="limitbody">Cannot Sunset Videos</div><div class="margin-top10 limitHeader2">Star | Network | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"searchexplorer",icon:"search",category:"optimization",color:"#9bba5c",name:"Search Explorer",pages:["Search Results"],summary:"The ultimate Search Term research tool for YouTube",howToVideoId:"6F5HL6MVp5k",Level0Limitation:"Can only see top 3 results in each category, 25 searches per day. ",Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["Get your videos ranked higher in search results and ultimately get more views","Find long-tail search terms to better target what people are looking for on YouTube ","Discover search terms to target based on search volume, competition and overall score"],whereToFindIt:'On the Search page. *Only available on YouTube\'s new UI  <br /><img src="/assets/images/tools/screenshots/searchexplorerwhere.png" />',tipsAndTricks:["Find Tags that have a high keyword score meaning they are searched often but there is not too much competition.","Unless you are PewDiePie, it's hard to get your videos ranked high for broad search terms. Try targeting long-tail (more specific) keywords."],limits:'<div class="limitHeader">Starter (FREE)</div><div class="limitbody">Cannot view more than the top three results in each section</div><div class="margin-top10 limitHeader2">Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"searchinsights",icon:"lightbulb-o",category:"research",color:"#9bba5c",name:"Search Insights",pages:["Search Results"],summary:"Uncover information about videos and channels in the search results",howToVideoId:null,Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:true,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["YouTubes search results are built for the viewer in mind, not for a creator whos doing research","Gain insights into tags, channel subscriber counts, and likes/dislikes for videos that are ranking for a given search term - all within the search results page"],whereToFindIt:'On the YouTube Search Results page.  <br /><img src="/assets/images/tools/screenshots/searchinsightswhere.png" />',tipsAndTricks:["Click the View Details button at the top of the search results page to display tags, channel subscriber counts, and likes/dislikes for video search results.","Click the magnifying glass icon for a tag to research it further in Keyword Explorer.","Click the Copy Tags button to copy a videos tags to a Tag List or your clipboard."],limits:""},{id:"instasuggest",icon:"magic",category:"optimization",color:"#9bba5c",name:"Insta-Suggest",pages:["Edit Video","Upload"],summary:"See tag suggestions in real-time as you type",howToVideoId:"dQ3zTDZXYoQ",Level0Limitation:"Can only see top 3 results",Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to add tags matching what people are searching for",'You are <span style="text-decoration: line-through;">lazy</span> efficient and want to see results as you type',"You want helpful hints on popular trends and search phrases"],whereToFindIt:'<img src="/assets/images/tools/screenshots/instasuggestwhere.png" />',tipsAndTricks:["Click the Explore button at the bottom to dive deeper into the topic","Click the Suggest button at the bottom for more suggestions for the video"],limits:'<div class="limitHeader">Starter (FREE)</div><div class="limitbody">Cannot view more than the three results</div><div class="margin-top10 limitHeader2">Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"demonetizationaudit",icon:"dollar",category:"research",color:"#9bba5c",name:"Demonetization Audit",pages:["Edit Video","Upload"],summary:"Find words in your tile, description or tags that could potentially cause demonetization of your video.",howToVideoId:"esE-hbFc2lE",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:true,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to make sure you don't include words in your title, description or tags that could cause demonetization","You want to ensure you are making the most money possible from your channel"],whereToFindIt:'On the Video Edit page <img src="/assets/images/tools/screenshots/demonetizationauditwhere.png"/>',tipsAndTricks:["Can be disabled in TubeBuddy settings."],limits:'<div class="limitHeader">Starter (FREE) | Pro | Star</div><div class="limitbody">Cannot Sunset Videos</div><div class="margin-top10 limitHeader2">Network | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"seostudio",icon:"line-chart",category:"optimization",color:"#9bba5c",name:"SEO Studio",pages:["Edit Video","Upload (classic)"],summary:"Optimize your video metadata for a specific keyword.",howToVideoId:"EAqfpr91CCA",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want your video to show up in search and related"],whereToFindIt:'<span style="font-size:12px; font-weight:bold;">[LOCATION 1]</span><br> Click SEO Studio from the main TubeBuddy Menu <br /><img src="/assets/images/tools/seostudiowhere1.png" /> <br><Br><span style="font-size:12px; font-weight:bold;">[LOCATION 2]</span><br>Uploads (classic).<br/><img src="/assets/images/tools/seostudiowhere2.png" /><br/><br><br><Br><span style="font-size:12px; font-weight:bold;">[LOCATION 3]</span><br>On a Video Edit or Videos List screen in the Tools Menu.<br/><img src="/assets/images/tools/seostudiowhere3.png" /><br/><br>',tipsAndTricks:[],limits:""},{id:"commentformatting",icon:"font",category:"productivity",color:"#9bba5c",name:"Comment Formatting",pages:["Channel Comments","Video Watch Page"],summary:"Format your comments and replies with ease.",howToVideoId:"i6WZvXjoKHs",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:true,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to easily apply bold, italic or strikethrough formatting to one of your comments or replies - and know how it will look before clicking Save.","You want to easily remove all formatting from one of your comments or replies."],whereToFindIt:'<span style="font-size:12px; font-weight:bold;">[LOCATION 1]</span><br />On the Channel Comments page <br/> <img src="/assets/images/tools/screenshots/commentformattingwhere1.png" /> <br/><br/> <span style="font-size:12px; font-weight:bold;">[LOCATION 2]</span><br />On a Video Comments page<br/><img src="/assets/images/tools/screenshots/commentformattingwhere2.png"/><br/><br/>  <span style="font-size:12px; font-weight:bold;">[LOCATION 3]</span><br />On a Video Watch page<br/><img src="/assets/images/tools/screenshots/commentformattingwhere3.png"/><br/><br/>',tipsAndTricks:[],limits:""},{id:"bulkdeletecomments",icon:"remove",category:"bulk",color:"#9bba5c",name:"Bulk Delete Comments",pages:["Comments"],summary:"Bulk delete a user's comments with ease. <br/> Note: In Beta - only available to a small percentage of customers.",howToVideoId:null,Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:false,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to remove all the comments of a commenter on your channel."],whereToFindIt:'Go to  <a class="underline" target="_blank" href="https://studio.youtube.com/">YouTube Studio</a> and click the Comments button. Under a comment, click the 3 dots Action Menu button to find the Bulk Delete Comments button.<br /><img src="/assets/images/tools/bulkdeletecommentswhere1.png" />',tipsAndTricks:[],limits:""},{id:"chaptereditor",icon:"pencil",category:"productivity",color:"#9bba5c",name:"Chapter Editor",pages:["Video Details page"],summary:"Create and Edit Video Chapters.",howToVideoId:"",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to help your viewers find specific content without making them skip through, and potentially miss it.","You want to add chapters to your video without having to switch between the video and description box.","You want to easily edit existing chapters."],whereToFindIt:'<span style="font-size:12px; font-weight:bold;">[LOCATION 1]</span><br />On the Video Details page<br /> <img src="/assets/images/tools/chaptereditorwhere1.png" /><br /><span style="font-size:12px; font-weight:bold;">[LOCATION 2]</span><br /> From the TubeBuddy dropdown menu, click the \'Chapter Editor\' link. <br /><img src="/assets/images/tools/chaptereditorwhere2.png" />',tipsAndTricks:[],goals:["more views"],featureType:"extension",showInToolbox:true,toolBoxCopy:"Increase your views and watch time by allowing viewers to easily reference and find certain parts of your video.",highlight:"new",limits:""}];var m=function(){TBExtension.GetExtensionVersion();B();j();v()};var v=function(){u.push({key:"fullscreen",name:"Fullscreen",url:"http://www.fullscreen.com"});u.push({key:"vevo",name:"VEVO",url:"http://www.vevo.com"});u.push({key:"vevostandard",name:"VEVO",url:"http://www.vevo.com"});u.push({key:"rpmnetworks",name:"Maker Studios",url:"http://www.makerstudios.com/"});u.push({key:"thegamestation",name:"Maker Studios",url:"http://www.makerstudios.com/"});u.push({key:"thestation user",name:"Maker Studios",url:"http://www.makerstudios.com/"});u.push({key:"thestation+user",name:"Maker Studios",url:"http://www.makerstudios.com/"});u.push({key:"paramaker_affiliate",name:"Maker Studios",url:"http://www.makerstudios.com/"});u.push({key:"stylehaul_affiliate",name:"StyleHaul",url:"http://www.StyleHaul.com"});u.push({key:"stylehaul affiliate",name:"StyleHaul",url:"http://www.StyleHaul.com"});u.push({key:"stylehaul",name:"StyleHaul",url:"http://www.StyleHaul.com"});u.push({key:"mitu",name:"Mitu",url:"https://mitunetwork.com/"});u.push({key:"machinima",name:"Machinima",url:"http://www.machinima.com/"});u.push({key:"machinima_managed",name:"Machinima",url:"http://www.machinima.com/"});u.push({key:"machinima managed",name:"Machinima",url:"http://www.machinima.com/"});u.push({key:"collective",name:"Collective Digital Studios",url:"http://collectivedigitalstudio.com/"});u.push({key:"collective_affiliate",name:"Collective Digital Studios",url:"http://collectivedigitalstudio.com/"});u.push({key:"collective affiliate",name:"Collective Digital Studios",url:"http://collectivedigitalstudio.com/"});u.push({key:"cds_female",name:"Collective Digital Studios",url:"http://collectivedigitalstudio.com/"});u.push({key:"cds female",name:"Collective Digital Studios",url:"http://collectivedigitalstudio.com/"});u.push({key:"broadbandtv_gaming",name:"Broadband TV",url:"http://bbtv.com/"});u.push({key:"broadbandtv gaming",name:"Broadband TV",url:"http://bbtv.com/"});u.push({key:"broadbandtv_entertainment",name:"Broadband TV",url:"http://bbtv.com/"});u.push({key:"broadbandtv entertainment",name:"Broadband TV",url:"http://bbtv.com/"});u.push({key:"broadbandtv_music",name:"Broadband TV",url:"http://bbtv.com/"});u.push({key:"broadbandtv music",name:"Broadband TV",url:"http://bbtv.com/"});u.push({key:"bbtv_vip_gaming_managed",name:"Broadband TV",url:"http://bbtv.com/"});u.push({key:"bbtv vip gaming managed",name:"Broadband TV",url:"http://bbtv.com/"});u.push({key:"omniamediaco",name:"Omnia Media",url:"http://www.omniamedia.co/"});u.push({key:"topbeautyblog",name:"VSP Group",url:"https://youpartnerwsp.com"});u.push({key:"youpartnervsp",name:"VSP Group",url:"https://youpartnerwsp.com"});u.push({key:"alloy",name:"Defy Media",url:"http://www.defymedia.com/"});u.push({key:"makercurse",name:"Curse Network",url:"http://www.unionforgamers.com/"});u.push({key:"curse_network_managed",name:"Curse Network",url:"http://www.unionforgamers.com/"});u.push({key:"curse network managed",name:"Curse Network",url:"http://www.unionforgamers.com/"});u.push({key:"anytv",name:"Freedom! Network",url:"http://www.freedom.tm"});u.push({key:"anytv_affiliate",name:"Freedom! Network",url:"http://www.freedom.tm"});u.push({key:"anytv affiliate",name:"Freedom! Network",url:"http://www.freedom.tm"});u.push({key:"wmg",name:"WMG",url:"http://www.wmg.com/"});u.push({key:"bigframe",name:"Big Frame",url:"http://www.bigfra.me/"});u.push({key:"quiczgroupaggregator",name:"Quiz Group",url:"http://quizgroup.com/"});u.push({key:"3bdnetwork",name:"3BlackDot",url:"http://3blackdot.com/"});u.push({key:"theorchardmusic",name:"The Orchard Music",url:"http://www.theorchard.com/"});u.push({key:"mixicom",name:"Mixicom",url:"http://www.Mixicom.com"});u.push({key:"deca",name:"Kin Community",url:"http://www.kincommunity.com/"});u.push({key:"believe",name:"Believe Music",url:"http://www.believedigitalstudios.com/"});u.push({key:"divimove_es",name:"DIVIMOVE",url:"http://www.divimove.com/"});u.push({key:"divimove es",name:"DIVIMOVE",url:"http://www.divimove.com/"});u.push({key:"air",name:"Agency of Internet Rights",url:"http://www.air.io/"});u.push({key:"siriusstarnetwork",name:"SiriusXM",url:"http://www.siriusxm.com/"});u.push({key:"awesomenesstv_managed",name:"AwesomenessTV",url:"http://www.awesomenesstvnetwork.com/"});u.push({key:"awesomenesstv",name:"AwesomenessTV",url:"http://www.awesomenesstvnetwork.com/"});u.push({key:"google",name:"Google",url:"https://www.google.com"});u.push({key:"tastemade",name:"Tastemade",url:"https://www.tastemade.com/"});u.push({key:"channelfrederator+user",name:"Frederator",url:"http://frederator.com/"});u.push({key:"channelfrederator user",name:"Frederator",url:"http://frederator.com/"});u.push({key:"sonybmg",name:"Sony",url:"https://www.sonymusic.com/"});u.push({key:"yvxpxuyhsivj4fycb8mohg",name:"Screenwave Media",url:"http://screenwavemedia.com/"});u.push({key:"nextnewnetworks",name:"Next New Networks",url:"http://www.nextnewnetworks.com"});u.push({key:"roosterteeth",name:"RoosterTeeth",url:"http://roosterteeth.com/"});u.push({key:"ygent",name:"YG Entertainment Inc.",url:"http://www.ygfamily.com/"});u.push({key:"lifetube",name:"LifeTube",url:"http://www.lifetube.pl/"});u.push({key:"buzzfeed+user",name:"BuzzFeed",url:"http://www.BuzzFeed.com"});u.push({key:"buzzfeed user",name:"BuzzFeed",url:"http://www.BuzzFeed.com"});u.push({key:"uuum",name:"UUUM",url:"http://www.uuum.jp/"});u.push({key:"channelflip",name:"Channel Flip",url:"http://www.channelflip.com/"});u.push({key:"tseriesmusic",name:"T-Series Music",url:"https://www.youtube.com/user/tseries"});u.push({key:"movieclips",name:"Movie Clips - Fandango",url:"http://www.movieclips.com/"});u.push({key:"spinninrecords",name:"Spinnin Reports",url:"https://www.spinninrecords.com/"});u.push({key:"gmmgrammy",name:"GMM Grammy",url:"https://www.youtube.com/user/gmmgrammyofficial/about"});u.push({key:"moguldomstudios_user",name:"Moguldom Studios",url:"http://moguldomstudios.com"});u.push({key:"moguldomstudios user",name:"Moguldom Studios",url:"http://moguldomstudios.com"});u.push({key:"fremantle",name:"Fremantle Media",url:"http://www.fremantlemedia.com/"})};var g=function(){if(TBExtension.GetType()!="safari")return;jQuery(document).on("focus","select",function(){var e=jQuery(this);jQuery(e).find('option[style*="display:none"], option[style*="display: none"]').each(function(e,t){c.push(jQuery(t).detach())})});jQuery(document).on("blur","select",function(){if(c.length>0){var e=jQuery(this);jQuery(c).each(function(t,i){jQuery(e).append(i)});c=[]}});TBUtilities.CreateCookie("tbCorrectInstanceCookie",i,180)};var T=function(){jQuery(document).on("mousedown","[data-draggable=false]",function(e){e.stopPropagation()});jQuery(document).on("mousedown","div [data-draggable=true]",function(e){var t=jQuery(this).closest(".draggable-container");if(e.offsetX==undefined){x=e.pageX-t.offset().left;y=e.pageY-t.offset().top}else{x=e.offsetX;y=e.offsetY}t.addClass("tb-draggable");b=t;jQuery(document).on("mousemove",function(e){if(b){b.offset({top:e.pageY-y,left:e.pageX-x})}});jQuery(document).on("mouseup",function(e){if(b){b=null;jQuery(".tb-draggable").removeClass("tb-draggable");jQuery(document).off("mousemove");jQuery(document).off("mouseup")}})})};var w=function(){jQuery(document.body).on("TBGlobalUpdateBrowserMetaData",function(e,t){TBUtilities.Log("TBGlobalUpdateBrowserMetaData")});jQuery(document.body).on("TBGetAccessToken",function(e,i){if(i!=null){t=i.value;E()}else{if(!s){s=true;TBGlobal.LoadModules()}}});jQuery(document.body).on("TBGetCurrentChannelId",function(t,i){if(i!=null)e=i.value});jQuery(document.body).on("TBGlobalGetProfile",function(e,i){TBUtilities.Log("TBGlobal - TBGlobalGetProfile");TBUtilities.Log(i);if(i.success&&i.response.indexOf("<title>Login")==-1){r=JSON.parse(i.response);TBUtilities.Log(r);TBGlobal.versionNumber=r.Version;jQuery.each(l,function(e,t){t()});if(r.BrowserMetaUpdate==true){D()}try{TBUtilities.Log("Refresh Twitter Module if needed");if(i.data!=null){if(i.data.callback=="TBLayoutTwitterReloadProfile"){if(TubeBuddyTwitterPost!=null)TubeBuddyTwitterPost.Reload()}}}catch(e){}}else{t=null;if(TubeBuddyLayout){if(i.status==401){TubeBuddyMenu.RefreshTokenError()}else{TubeBuddyMenu.FailedToLoadProfile();return}}}if(!s){s=true;TBGlobal.LoadModules()}});jQuery(document.body).on("CRTBGlobalGetChannelSwitcher",function(e,t){if(t.success){var i=DOMPurify.sanitize(t.response,DOMPurifyConfig);var o=jQuery(".channel-switcher-caption:first",i).text().replace("All for","").trim();if(o==null)return;if(o.indexOf(" ")>-1)o=o.substring(o.lastIndexOf(" ")+1,o.length);r.Email=o;var n=TBUtilities.GetTimeZoneOffSetInHours()}else{}});jQuery(document.body).on("CRGlobalGetActionCount",function(e,t){try{if(t.success){var i=parseInt(t.response);t.data.callback(i)}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyGlobal] [CRGlobalGetActionCount]"})}});jQuery(document.body).on("TBGetCurrentAccount",function(e,t){if(t.success){var i="";if(t.response.indexOf('"channel_external_id":"')>0){var r=t.response.indexOf('"channel_external_id":"')+'"channel_external_id":"'.length;i=t.response.substring(r,r+24)}else{try{var n=jQuery.parseHTML(DOMPurify.sanitize(t.response,DOMPurifyConfig));var a=jQuery(n).find("a.yt-user-name").first().attr("href");if(a){i=a.substr(a.lastIndexOf("/")+1)}else{var s=TBUtilities.ParseResponseContextFromHtml(t.response);if(s&&s.responseContext&&s.responseContext.serviceTrackingParams){i=s.responseContext.serviceTrackingParams[2].params[0].value}}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyGlobal] [TBGetCurrentAccount]"})}}if(S(i)===false&&(t.response.indexOf("http://www.youtube.com/channel/")>0||t.response.indexOf("http:\\/\\/www.youtube.com\\/channel\\/")>0)){var l=-1;if(t.response.indexOf("http://www.youtube.com/channel/")>0){l=t.response.indexOf("http://www.youtube.com/channel/")+"http://www.youtube.com/channel/".length}else if(t.response.indexOf("http:\\/\\/www.youtube.com\\/channel\\/")>0){l=t.response.indexOf("http:\\/\\/www.youtube.com\\/channel\\/")+"http:\\/\\/www.youtube.com\\/channel\\/".length}if(l!==-1){i=t.response.substring(l,l+24)}}else if(S(i)===false){TBExtension.Get("https://studio.youtube.com",function(e,t,r){if(e&&r.indexOf('"externalChannelId":"')>0){var n=r.indexOf('"externalChannelId":"')+'"externalChannelId":"'.length;i=r.substring(n,n+24);if(S(i)){U(i);o="Found T10: "+i}}})}if(S(i)){U(i);o="Found T9: "+i}}});jQuery(document).on("TBGetCurrentStudioAccount",function(e,t){k(0)})};var k=function(e){if(e>240)return;setTimeout(function(){try{var t=jQuery("a#home-button").first();if(t){var i=jQuery(t).attr("href");if(i){extractedId=i.substr("/channel/".length);var o=extractedId.indexOf("?");if(o>-1){extractedId=extractedId.substring(0,o)}if(S(extractedId)){U(extractedId);return}}}}catch(e){TBUtilities.Log("Response failure on TBGetCurrentStudioAccount. Details: "+JSON.stringify(e))}k(++e)},250)};var B=function(){var e="";try{var t=jQuery("body")[0].outerHTML;var i=t.indexOf('"host_language":"')+'"host_language":"'.length;var o=t.indexOf('"',i+1);var r=t.substring(i,o);if(r.length>=2&&r.length<=7)e=r}catch(e){}if(e!=""){try{var t=jQuery("body")[0].outerHTML;var i=t.indexOf("'FEEDBACK_LOCALE_LANGUAGE': \"")+"'FEEDBACK_LOCALE_LANGUAGE': \"".length;var o=t.indexOf('"',i+1);var r=t.substring(i,o);if(r.length>=2&&r.length<=7)e=r}catch(e){}}if(e!=""){try{var t=jQuery("body")[0].outerHTML;var i=t.indexOf("//www.youtube.com/yt/about/")+"//www.youtube.com/yt/about/".length;var o=t.indexOf("/",i+1);var r=t.substring(i,o);if(r.length>=2&&r.length<=7)e=r}catch(e){}}try{var n=jQuery("#yt-picker-language-button")[0].outerHTML;var i=n.indexOf("yt-picker-button-label");i=n.indexOf("</span>",i)+"</span>".length;var o=n.indexOf("<",i);TBGlobal.language=n.substring(i,o)}catch(e){}if(e=="")e="en";TBGlobal.languageCode=e};var j=function(){_("Starting Page Extract for url "+window.location.href);TBUtilities.Log("TBGlobal - Starting Page Extract for url "+window.location.href);try{if(jQuery("li.guide-channel").length>0){var e=false;jQuery("li.guide-channel").each(function(){var t=jQuery(this).attr("id");if(t.indexOf("UC")==0){t=t.replace("-guide-item","");if(S(t)){U(t);o="Found T1: "+t;e=true;_("Found id in channel-guide TEST: "+t)}return false}});if(e)return}var t=jQuery("body").html().indexOf('"viewer_id": "')+'"viewer_id": "'.length;if(t>100){var i=jQuery("body").html().substring(t,t+24);if(S(i)){U(i);o="Found T2: "+i+" [["+document.URL+"]]";_("Found id in viewer_id: "+i);return}}var r=jQuery("body").html().indexOf("viewer_id\\u003d")+"viewer_id\\u003d".length;if(r>100){var i=jQuery("body").html().substring(r,r+24);if(S(i)){U(i);o="Found T3: "+i+" [["+document.URL+"]]";_("Found id in viewer_id2: "+i);return}}var n=jQuery("body").html().indexOf("/bulk_actions_ajax?o=U&amp;channel=")+"/bulk_actions_ajax?o=U&amp;channel=".length;if(n>100){var i="UC"+jQuery("body").html().substring(n,n+22);if(S(i)){U(i);o="Found T4: "+i+" [["+document.URL+"]]";_("Found id in viewer_id3: "+i);return}}var a=jQuery("body").html().indexOf("'userExternalId': \"")+"'userExternalId': \"".length;if(a>100){var i="UC"+jQuery("body").html().substring(a,a+22);if(S(i)){U(i);o="Found T5: "+i+" [["+document.URL+"]]";_("Found id in viewer_id4: "+i);return}}if(jQuery(".video-thumb.yt-thumb.yt-thumb-46.g-hovercard").length>0){var s=jQuery(".video-thumb.yt-thumb.yt-thumb-46.g-hovercard:first").attr("data-ytid");if(S(i)){U(i);o="Found T6: "+s+" [["+document.URL+"]]";_("Found id in hovercard: "+i);_("HC: "+jQuery(".video-thumb.yt-thumb.yt-thumb-46.g-hovercard")[0].outerHTML);return}}if(document.URL.indexOf("/comments")>0){if(jQuery(".yt-user-photo").length>0){var l=jQuery(".yt-user-photo:first")[0].outerHTML;if(l.indexOf("data-ytid")>0){var d=l.indexOf("data-ytid")+11;var u=d+24;var c=l.substring(d,u);if(S(c)){U(c);o="Found yt-user-photo "+c+" [["+document.URL+"]]";_("Found id in yt-user-photo: "+c);return}}}}var p=jQuery("body").html().indexOf("my_liked_videos&amp;list=LL")+"my_liked_videos&amp;list=LL".length;if(p>100){var i="UC"+jQuery("body").html().substring(p,p+22);if(S(i)){U(i);o="Found T7: "+i+" [["+document.URL+"]]";_("Found id in my_liked_videos: "+i);return}}var h=jQuery("body").html().indexOf('"channel_id": "')+'"channel_id": "'.length;if(h>100){var i="UC"+jQuery("body").html().substring(h,h+22);if(S(i)){U(i);o="Found T8: "+i+" [["+document.URL+"]]";_("Found id in channel_id: "+i);return}}if(jQuery("body").html().indexOf("yt-suggest-menu-item")>0){TBUtilities.Log("yt-suggest-menu-item");var y=jQuery(".yt-suggest-menu-item").first();if(y){TBUtilities.Log("yes yt-suggest-menu-item");var i="UC"+y.find("a:first").attr("data-channel-external-id");if(S(i)){TBUtilities.Log("T9: "+i);U(i);o="Found T9: "+i+" [["+document.URL+"]]";_("Found id in T9 yt-suggest-menu-item: "+i);return}}}if(jQuery("body").html().indexOf('channel_external_id":"')>0&&window.location.href.indexOf("timedtext_editor")==-1){TBUtilities.Log("channel_external_id");var b=jQuery("body").html().indexOf('channel_external_id":"')+'channel_external_id":"'.length;var f=jQuery("body").html().substring(b,b+24);if(S(f)){TBUtilities.Log("T10: "+f);U(f);o="Found T10: "+f+" [["+document.URL+"]]";_("Found id in T10 channel_external_id: "+f);return}}if(jQuery("body").html().indexOf('"key":"creator_channel_id","value":"')>0){var b=jQuery("body").html().indexOf('"key":"creator_channel_id","value":"')+'"key":"creator_channel_id","value":"'.length;var f=jQuery("body").html().substring(b,b+24);if(S(f)){TBUtilities.Log("T11: "+f);U(f);o="Found T11: "+f+" [["+document.URL+"]]";_("Found id in T11 channel_external_id: "+f);return}}if(jQuery("body").html().indexOf('"key":"creator_channel_id","value":"')>0){var b=jQuery("body").html().indexOf('"key":"creator_channel_id","value":"')+'"key":"creator_channel_id","value":"'.length;var f=jQuery("body").html().substring(b,b+24);if(S(f)){TBUtilities.Log("T11: "+f);U(f);o="Found T11: "+f+" [["+document.URL+"]]";_("Found id in T11 channel_external_id: "+f);return}}if(jQuery("body").html().indexOf('href="#/channel/')>0){var b=jQuery("body").html().indexOf('href="#/channel/')+'href="#/channel/'.length;var f=jQuery("body").html().substring(b,b+24);if(S(f)){TBUtilities.Log("T12: "+f);U(f);o="Found T12: "+f+" [["+document.URL+"]]";_("Found id in T12 channel_external_id: "+f);return}}if(window.location.hostname.toLowerCase()==="studio.youtube.com"){var m=location.pathname;var v=[];TBUtilities.Log(m);if(m){v=m.substring(1).split("/");TBUtilities.Log(v);for(var g=0;g<5-v.length;g++){v.push("")}if(v[1]&&v[1].length==24){U(v[1]);return}}}_("DNF!");M("dnfc");if(window.location.hostname.toLowerCase()==="www.tubebuddy.com"){L()}else if(window.location.hostname.toLowerCase()==="studio.youtube.com"){TBExtension.Get("https://studio.youtube.com/channel/","TBGetCurrentStudioAccount")}else{TBExtension.Get("https://www.youtube.com/account","TBGetCurrentAccount")}}catch(e){_("Exception searching for ID!: "+e.message);_(jQuery("body").html())}TBExtension.GetDbValue("currentChannelId","TBGetCurrentChannelId")};var L=function(){};var C=function(e,t){var i=TBGlobal.host+TBGlobal.apiUrls.channelActionGetCount+"?actionType="+e;TBExtension.Get(i,t)};var Q=function(){TBExtension.GetDbValue(TBGlobal.tokenKey+e,"TBGetAccessToken")};var U=function(t){TBUtilities.Log("TBGlobal - setCurrentChannelId: "+t);TBExtension.SetDbValue("currentChannelId",t);e=t;Q()};var I=function(e){return TBUtilities.GetInArray(u,"key",e)};var S=function(e){if(e==null)return false;if(e.substring(0,2)!="UC")return false;if(e.length!=24)return false;if(e.indexOf(" ")>=0||e.indexOf(">")>=0||e.indexOf("<")>=0||e.indexOf("=")>=0||e.indexOf("'")>=0||e.indexOf('"')>=0||e.indexOf(";")>=0)return false;return true};var A=function(){TBUtilities.Log("PROFILE UPDATES");TBUtilities.Log(l.length);jQuery.each(l,function(e,t){t()})};var E=function(e){var i=TBUtilities.GetTimeZoneOffSetInHours();if(t!=null&&t.length>0){var o=TBGlobal.host+TBGlobal.apiUrls.youtubeChannelGetProfile+"?timeZoneOffset="+TBUtilities.GetUrlEncoded(i);TBExtension.Get(o,"TBGlobalGetProfile",{callback:e})}else{if(!s){s=true;TBGlobal.LoadModules()}}};var D=function(){try{var e=Y();var t=z();if(t&&t.f6){e+=" - "+t.f6}var i=TBExtension.GetType();var o="pac"+"hck"+"jke"+"cff"+"pdp"+"hbp"+"mfo"+"lbl"+"odf"+"kgb"+"hl";R(o,function(t,o){var r={V:t,P:o,Pref:e,ExtensionType:i};var n=TBGlobal.host+TBGlobal.apiUrls.userUpdateBrowserMeta;TBExtension.Post(n,JSON.stringify(r),"TBGlobalUpdateBrowserMetaData",null,{contentType:"application/json"})})}catch(e){TBUtilities.Log("updateBrowserMetaData error");TBUtilities.Log(e)}};var R=function(e,t){var i=window.chrome,o=window.navigator,r=o.vendor,n=o.userAgent.indexOf("OPR")>-1,a=o.userAgent.indexOf("Edge")>-1,s=o.userAgent.match("CriOS");if(s){t(false,false)}else if(i!=null&&i!=undefined&&r=="Google Inc."&&n==false&&a==false){setTimeout(function(){var i;i=new Image;i.src="chr"+"ome-e"+"xtension://"+e+"/images/vi"+"diq"+"_pl"+"aypl"+"us.png";i.onload=function(){var e=false;try{var i=".vi"+"di"+"q-t"+"ool"+"ba"+"r-st"+"ats"+"-co"+"nta"+"iner";var o=".too"+"lba"+"r-upsell";if(jQuery(i).find(o).length==0){e=true}}catch(e){}t(true,e)};i.onerror=function(){t(false,false)}},8e3)}else{t(false,false)}};var P=function(e){var t=TBUtilities.GetTimeZoneOffSetInHours();var i=TBGlobal.host+TBGlobal.apiUrls.youtubeChannelGetProfile+"?timeZoneOffset="+TBUtilities.GetUrlEncoded(t)+"&extensiontype="+TBUtilities.GetUrlEncoded(TBExtension.GetType());TBExtension.Get(i,"TBGlobalGetProfile",{callback:e})};var G=function(e){if(e==null)e="";var t=TBGlobal.host+"/account/upgrade";t+="?id="+TBGlobal.CurrentChannelId();t+="&f="+e;t+="&utm_source=youtube";t+="&utm_medium=extension";t+="&utm_campaign="+e;return t};var O=function(e,t,i=false){TBUtilities.AddActivityLog({Data:t+" ["+e+"]"},TBUtilities.ActivityLogTypes.ShowUpgradePage);TBUtilities.ReportProductExposure("unified-paywall");var o=TBGlobal.IsExperimentEnabled("unified-paywall");if(!o){if(e!=null&&e!=""){TubeBuddyUpgradeScreen.Show(e,t,i)}else if(t!=null){var r=window.open(G(t),"_blank");r.focus()}return}jQuery("body").trigger("TBShowPaywall",{msg:e,feature:t,overrideDefaultMessage:i})};var V=function(e){TubeBuddyWordCloud.Show(e)};var V=function(e){TubeBuddyWordCloud.Show(e)};var V=function(e){TubeBuddyWordCloud.Show(e)};var _=function(e){TBUtilities.Log(e);if(d==""){d+="Started: "+new Date;if(TBGlobal.Profile()!=null){d+="<br/>Channel: "+TBGlobal.CurrentChannelId();d+="<br/>License: "+TBGlobal.Profile().LicenseTypeName;d+="<br/>Network: "+TBGlobal.Profile().NetworkType}d+="<br/>Channel: https://www.youtube.com/channel/"+TBGlobal.CurrentChannelId();d+="<br/><br/>-----------------------------"}if(TBUtilities!=null)d+="<br/>&gt; "+TBUtilities.GetHtmlEncoded(e);else d+="<br/>&gt; "+e};var M=function(e){p+="{"+e+"}"};var F=function(e){d=""};var N=function(e,t){TBUtilities.Log("loadModules");TubeBuddyYouTubeActions.Initialize();TBYouTubeApi.Initialize();TubeBuddyUpgradeScreen.Initialize();if(e.indexOf("https://www.youtube.com")!=0&&e.indexOf("https://studio.youtube.com")!=0&&e.indexOf("http://www.youtube.com")!=0&&e.indexOf("www.youtube.com")!=0&&e.indexOf("youtube.com")!=0){return}if(e.indexOf("https://www.youtube.com")>=0||e.indexOf("https://studio.youtube.com")>=0){TubeBuddyStatFire.Initialize();TubeBuddyMenu.Initialize();TubeBuddyWordCloud.Initialize();TubeBuddyKidsCenter.Initialize()}if(e.indexOf("https://studio.youtube.com")==0){TBUtilities.Log("Studio Beta Parsing");var i=location.pathname;var o=[];TBUtilities.Log(i);TubeBuddyUploadDefaultsStudio.Initialize();TubeBuddyUploadStudio.Initialize();var r="tb-coppa-open-"+TBGlobal.CurrentChannelId();TBExtension.GetDbValue(r,function(e,t){TBExtension.RemoveDbValue(e);if(t){var i=setInterval(function(){if(jQuery("#main:visible").length>0){clearInterval(i);TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyKidsCenter.Show()}},500)}});var r="tb-clickmagnet-open-"+TBGlobal.CurrentChannelId();TBExtension.GetDbValue(r,function(e,t){TBExtension.RemoveDbValue(e);if(t){var i=setInterval(function(){if(jQuery("#main:visible").length>0){clearInterval(i);TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyClickMagnet.Show()}},500)}});if(i){var o=i.substring(1).split("/");TBUtilities.Log(o);for(var n=0;n<5-o.length;n++)o.push("");if(o[0]=="channel"&&o[1]==TBGlobal.CurrentChannelId()&&o[2]==""){TBUtilities.Log("Studio Dashboard!");TubeBuddyABTests.Initialize()}else if(o[0]=="channel"&&o[1]==TBGlobal.CurrentChannelId()&&o[2]=="videos"){TBUtilities.Log("Studio Videos List!");TubeBuddyVideosStudioList.Initialize();TubeBuddyQuickEditToolbarStudio.Initialize();TubeBuddyDemonetizationChecker.Initialize();TubeBuddyKidsCenter.Initialize();TubeBuddySchedule.Initialize();if(o[2]=="videos"&&o[3]=="upload"&&jQuery(".ytcp-uploads-dialog").length>0){TBUtilities.Log("Studio Video Upload");TubeBuddyUploadStudio.LoadTubeBuddyTools()}}else if(o[0]=="channel"&&o[1]==TBGlobal.CurrentChannelId()&&o[2]=="comments"){TBUtilities.Log("Studio Comments!");TubeBuddyCommentFilterStudio.Initialize(t)}else if(o[0]=="channel"&&o[1]==TBGlobal.CurrentChannelId()&&o[2]=="monetization"&&o[3]=="overview"){TBUtilities.Log("Studio Monetization Overview!")}else if(o[0]=="channel"&&o[1]==TBGlobal.CurrentChannelId()&&o[2]=="monetization"&&o[3]=="merchandising"){TBUtilities.Log("Studio Monetization Merchandising!")}else if(o[0]=="channel"&&o[1]==TBGlobal.CurrentChannelId()&&o[2]=="analytics"&&o[3]=="tab-overview"){TBUtilities.Log("Studio Analytics Overview!")}else if(o[0]=="channel"&&o[1]==TBGlobal.CurrentChannelId()&&o[2]=="analytics"&&o[3]=="tab-reach_viewers"){TBUtilities.Log("Studio Analytics Reach Viewers!")}else if(o[0]=="channel"&&o[1]==TBGlobal.CurrentChannelId()&&o[2]=="analytics"&&o[3]=="tab-interest_viewers"){TBUtilities.Log("Studio Analytics Reach Viewers!")}else if(o[0]=="channel"&&o[1]==TBGlobal.CurrentChannelId()&&o[2]=="analytics"&&o[3]=="tab-build_audience"){TBUtilities.Log("Studio Analytics Build an Audience!");TubeBuddyBestTimeToPublish.Initialize()}else if(o[0]=="channel"&&o[1]==TBGlobal.CurrentChannelId()&&o[2]=="analytics"&&o[3]=="tab-earn_revenue"){TBUtilities.Log("Studio Analytics Earn Revenue!")}else if(o[0]=="video"&&o[2]=="edit"){var a=o[1];TBUtilities.Log("Studio Video Edit!");TubeBuddyEditVideoStudio.Initialize();TubeBuddyEditVideoStudioUploadDefaults.Initialize();TubeBuddyQuickEditToolbarStudio.Initialize();TubeBuddyVideoMenuStudio.Initialize()}else if(o[0]=="video"&&o[2]=="editor"){var a=o[1];TBUtilities.Log("Studio Video Editor!");TubeBuddyVideoMenuStudio.Initialize();TubeBuddyVideoEditorStudio.Initialize()}else if(o[0]=="video"&&o[2]=="comments"){var a=o[1];TBUtilities.Log("Studio Video Comments!");TubeBuddyCommentFilterStudio.Initialize(t);TubeBuddyVideoMenuStudio.Initialize()}else if(o[0]=="video"&&o[2]=="translations"){TBUtilities.Log("Studio Meta Auto Translator!");TubeBuddyMetaAutoTranslator.Initialize()}else if(o[0]=="video"&&o[2]=="analytics"&&o[3]=="tab-overview"){var a=o[1];TBUtilities.Log("Studio Video Ananlytics - Overview!");TubeBuddyVideoMenuStudio.Initialize()}else if(o[0]=="video"&&o[2]=="analytics"&&o[3]=="tab-reach_viewers"){var a=o[1];TBUtilities.Log("Studio Video Ananlytics - Reach Vieweres!")}else if(o[0]=="video"&&o[2]=="analytics"&&o[3]=="tab-interest_viewers"){var a=o[1];TBUtilities.Log("Studio Video Ananlytics - Interest Viewers!")}else if(o[0]=="video"&&o[2]=="analytics"&&o[3]=="tab-build_audience"){var a=o[1];TBUtilities.Log("Studio Video Ananlytics - Build Audience!")}else if(o[0]=="video"&&o[2]=="analytics"&&o[3]=="tab-earn_revenue"){var a=o[1];TBUtilities.Log("Studio Video Ananlytics - Earn Revenue!")}else if(o[0]=="video"&&o[2]=="monetization"&&o[3]=="ads"){TubeBuddyMonetizationAdsStudio.Initialize();TBUtilities.Log("Studio Video Monetization Ads")}else if(o[2]=="livestreaming"){TubeBuddyLivestreaming.Initialize();TBUtilities.Log("Studio Livestreaming")}else if(o[2]=="playlists"){TubeBuddyAllPlaylistsStudio.Initialize();TBUtilities.Log("Studio Playlists")}}}if(e.indexOf("youtube.com/results")>0){}if(e.indexOf("youtube.com/watch")>0){TubeBuddyCommentManager.Initialize();TubeBuddyVideolytics.Initialize(t)}if(e.indexOf("youtube.com/my_live_events?action_create_live_event=1")>0||e.indexOf("youtube.com/my_live_events?action_edit_live_event=1&event_id=")>0||e.indexOf("youtube.com/my_live_events?event_id=")>0||e.indexOf("youtube.com/my_live_events?action_edit_live_event=1&editor_tab=advanced&event_id=")>0){TubeBuddyLiveEventsVideo.Initialize()}if(e.indexOf("youtube.com/all_comments")>0||e.indexOf("https://apis.google.com")>=0&&e.indexOf("/_/widget/render/comments")>0&&jQuery("#root").length==1){TubeBuddyCommentManager.Initialize()}if(e.indexOf("youtube.com/results?search_query=")>0){TubeBuddySearchTermAnalysis.Initialize();TubeBuddySearchResults.Initialize()}if(e.indexOf("www.youtube.com/c/")>0||e.indexOf("www.youtube.com/user/")>0||e.indexOf("www.youtube.com/channel/")>0){TubeBuddyChannelytics.Initialize()}else if(jQuery('[rel="canonical"]').length>0){var s=jQuery('[rel="canonical"]').first().attr("href");if(s){if(s.indexOf("youtube.com/c/")>0||s.indexOf("youtube.com/user/")>0||s.indexOf("youtube.com/channel/")>0){TubeBuddyChannelytics.Initialize()}}}if(t===true){TubeBuddyVideolytics.CleanPage();TubeBuddyChannelytics.CleanPage();TubeBuddySearchTermAnalysis.CleanPage()}};var Y=function(){if(h==null){var e=document.documentElement.innerHTML.indexOf("ytd-app");if(e!=-1){TBUtilities.Log("getYouTubeUI - material");h="material"}else{TBUtilities.Log("getYouTubeUI - default");h="default"}if(document.URL.indexOf("https://studio.youtube.com")==0){TBUtilities.Log("getYouTubeUI - studio");h="studio"}}else{}return h};var H=function(){var e=jQuery("html").attr("dark")=="true";TBUtilities.Log(e);return e};var W=function(e){var t="default";if(e&&e.indexOf("ytd-app")!=-1){t="material"}else if(e&&e.indexOf("youtube_creator_studio")!=-1){t="studio"}return t};var z=function(){var e=null;var t=TBUtilities.GetCookie("PREF");if(t){try{e=t.split("&").reduce(function(e,t,i,o){var r=t.split("=");e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]);return e},{})}catch(e){}}return e};return{Initialize:function(){TBUtilities.Log("tbGlobal Initialize");i=(new Date).getTime();w();T();m();g()},GetPrefCookieObject:function(){return z()},GetYouTubeUI:function(){return Y()},GetYouTubeUIFromHtml:function(e){return W(e)},CurrentChannelId:function(){return e},GetToken:function(){return t},CanPublishFacebookOnUploadScreen:function(){if(r==null)return false;return r.CanPublishFacebookOnUploadScreen==true},CanAccessLevel1Tools:function(){if(r==null)return false;return r.CanAccessLevel1Tools==true},CanAccessLevel2Tools:function(){if(r==null)return false;return r.CanAccessLevel2Tools},CanAccessLevel3Tools:function(){if(r==null)return false;return r.CanAccessLevel3Tools},SetCurrentChannelId:function(e){U(e)},LoadModules:function(e,t){if(e==null)e=window.location.toString();N(e,t)},IsAuthenticated:function(){if(t==null||r==null)return false;return t.length>0&&r.HasAccessToken},IsCorrectInstance:function(){var e=TBUtilities.GetCookie("tbCorrectInstanceCookie");var t=i==e;return t},Profile:function(){return r},ReloadProfile:function(e){E(e)},ReloadToken:function(){P()},ShowUpgradePage:function(e,t,i){TBUtilities.AddActivityLog({Data:t+" ["+e+"]"},TBUtilities.ActivityLogTypes.ShowUpgradePage);O(e,t,i)},ShowWordCloud:function(e){V(e)},GetActionCount:function(e,t){C(e,t)},GetNetwork:function(e){return I(e)},ClassicForceParam:function(){return"&ar="+(new Date).getTime()},AddProfileUpdateListener:function(e){l.push(e)},AddUserDebugInfo:function(e){_(e)},AddDiagnostic:function(e){M(e)},GetDiagnostics:function(e){return p},ClearUserDebugInfo:function(){F()},UserDebugCode:function(){return d},TriggerProfileUpdated:function(){A()},GetAllTools:function(){return f},GetUpgradeLink:function(e){return G(e)},GetToolsInCategory:function(e){f.sort(function(e,t){var i=e.name;var o=t.name;return i==o?0:i>o?1:-1});var t=[];$.each(f,function(i,o){if(e==o.category){t.push(o)}});return t},GetToolsInCategoryByLevel:function(e,t){f.sort(function(e,t){var i=e.name;var o=t.name;return i==o?0:i>o?1:-1});var i=[];$.each(f,function(o,r){if(e==r.category&&(r.Level0Access&&!r.Level0Limitation&&t==-1||!r.Level0Access&&r.Level0Limitation&&t==0||r.Level1Access&&!r.Level0Access&&t==1&&!r.Level0Limitation||r.Level2Access&&!r.Level1Access&&t==2&&r.Level1Limitation||r.Level2Access&&!r.Level1Access&&t==3&&!r.Level1Limitation||r.Level3Access&&!r.Level2Access&&t==3&&r.Level2Limitation||r.Level3Access&&!r.Level2Access&&t==4&&!r.Level2Limitation||r.Level4Access&&!r.Level3Access&&t==4&&r.Level3Limitation||r.Level4Access&&!r.Level3Access&&t==4&&!r.Level0Limitation)){i.push(r)}});return i},GetToolById:function(e){const t=f.filter(t=>t.id.toLowerCase()==e.toLowerCase());if(t.length==0){return{id:"unknown",name:"Unknown"}}return t[0]},GetToolLicenseById:function(e){const t=this.GetToolById(e);if(t.id==="unknown"){return"Starter"}if(t.Level1Access){return"Pro"}else if(t.Level2Access){return"Star"}else if(t.Level3Access){return"Legend"}else{return"Starter"}},GoogleAuthUser:function(){return n},SetGoogleAuthUser:function(e){n=e},IsDarkMode:function(){return H()},GetToolsOnPage:function(e){var t=[];$.each(f,function(i,o){if(o.pages!=null){$.each(o.pages,function(i,r){if(r==e)t.push(o)})}});return t},GetExperiment:function(e){if(r===null){return null}if(r.Experiments===null){return null}if(!r.Experiments.hasOwnProperty(e)){return null}return r.Experiments[e]},IsExperimentEnabled:function(e){if(r===null){return false}if(r.Experiments===null){return false}if(!r.Experiments.hasOwnProperty(e)){return false}return r.Experiments[e].key==="treatment"},host:pluginHost,versionNumber:"1.0.0.3",tokenKey:"tubebuddyToken-",apiKey:"AIzaSyDW-hsukxcYtkBU7Mxe29gIUgxvWDaXFG0",language:"English",languageCode:"en",limitation:{bestTimeToPublish:"besttimetopublish",tagexplorer:"tagexplorer",subscriberexport:"subscriberexport",campaigns:"campaigns",defaultuploadprofiles:"defaultuploadprofiles",findandreplace:"findandreplace",cards:"cards",deleteCards:"bulkdeletecards",commentFilters:"commentfilters",thumbnails:"thumbnails",bulkthumbnail:"bulkthumbnail",bulkupdateplaylists:"bulkupdateplaylists",playlistactions:"playlistactions",searchRanking:"searchranking",cardTemplates:"cardtemplates",suggestedTags:"suggestedtags",tagtranslator:"autotranslator",videoScheduledAction:"videoscheduledaction",scheduledvideoupdate:"scheduledvideoupdate",updateCards:"bulkupdatecards",channelBackup:"channelbackup",bulkCopyToFacebook:"bulkpublishtofacebook",videoTopicPlanner:"videotopicplanner",bestpractice:"bestpractice",hideComments:"hideComments",exportComments:"exportComments",bulkUpdateEndScreens:"bulkUpdateEndScreens",tagLists:"tagLists",keywordranktracking:"keywordranktracking",autoTranslator:"autotranslator",bestpractices:"bestpractice",instasuggest:"instasuggest",seostudio:"seostudio",strategies:"strategies",bulkdeletecomments:"bulkdeletecomments",chaptereditor:"chaptereditor",placeholders:""},apiUrls:{abtestsGetVideosToGather:"/api/abtests/GetVideosToGather",brandingsAdd:"/api/branding/add",brandingsDelete:"/api/branding/delete",brandingsGetAll:"/api/branding/getall",brandingsFontAdd:"/api/branding/fontadd",brandingsGetAllFonts:"/api/branding/getallfonts",brandingsGetBackgroundImages:"/api/branding/getbackgroundimages",brandingsAddBackgroundImage:"/api/branding/addbackgroundimage",brandingsDeleteBackgroundImage:"/api/branding/deletebackgroundimage",brandingsAddStilFrameImage:"/api/branding/addstillframeimage",campaignDelete:"/api/campaign/delete",campaignAdd:"/api/campaign/add",campaignUpdate:"/api/campaign/update",campaignGetByYouTubeChannelId:"/api/campaign/getbyyoutubechannelid",channelActionGetCount:"/api/channelaction/getcount",contactHistoryAdd:"/api/contacthistory/add",contactHistoryGetContactHistoryByChannelId:"/api/contacthistory/getcontacthistorybychannelid",debugAddLog:"/api/debug/addlog",gifAdd:"/api/gif/add",grammerGetKeyWordMisspellings:"/api/Grammer/GetKeyWordMisspellings",imageGetBytes:"/api/image/getbytes",sharedVideoGetHistory:"/api/sharedvideo/gethistory",sharedVideoAdd:"/api/sharedvideo/add",sharedVideoRemove:"/api/sharedvideo/remove",socialAccountsGetFacebook:"/api/socialaccounts/getfacebook",socialAccountsGetTwitter:"/api/socialaccounts/gettwitter",socialAccountsPostAnimatedGifToTwitter:"/api/socialaccounts/postanimatedgiftotwitter",uploadDefaultsDelete:"/api/uploaddefaults/delete",uploadDefaultsAdd:"/api/uploaddefaults/add",uploadDefaultsUpdate:"/api/uploaddefaults/update",uploadDefaultsList:"/api/uploaddefaults/list",userCancelMembership:"/api/user/CancelMembership",userUpdateSettings:"/api/user/updatesettings",userUpdateBrowserMeta:"/api/user/updatebrowsermeta",playlistsUpdatePlaylist:"/api/playlists/UpdatePlaylist",getPlaylist:"/api/playlists/GetPlaylist",youtubeChannelGetProfile:"/api/youtubechannel/getprofile",youtubeChannelUpdate:"/api/youtubechannel/update",youtubeChannelUpdateMeta:"/api/youtubechannel/updatemeta",youtubeChannelUnlinkChannelFromProfile:"/api/youtubechannel/unlinkchannelfromprofile",youtubeChannelCheckNetwork:"/api/youtubechannel/checknetwork",youtubeChannelGetSubscribersRequiringRefresh:"/api/youtubechannel/getsubscribersrequiringrefresh",youtubeChannelGetSubscribersRequiringRefreshCount:"/api/youtubechannel/getsubscribersrequiringrefreshcount",youtubeChannelUpdateSubscriber:"/api/youtubechannel/updatesubscriber",youtubeChannelSyncSubscribers:"/api/youtubechannel/syncsubscribers",youtubeChannelGetSubscribers:"/api/youtubechannel/GetChannelSubscribers",youtubeChannelGetExportStatistics:"/api/youtubechannel/getexportstatistics",youtubeChannelKickOffExport:"/api/youtubechannel/kickoffexport",youtubeChannelActionGetCount:"/api/youtubechannelaction/getcount",youtubeChannelGetRelatedTitles:"/api/youtubechannel/getrelatedtitles",youtubeChannelGetRandomGuid:"/api/youtubechannel/GetRandomGuid",youtubeChannelGetMilestones:"/api/youtubechannel/getmilestones",youtubeChannelMarkAsSubscribedToTubeBuddy:"/api/youtubechannel/MarkAsSubscribedToTubeBuddy",youtubeChannelMarkAsNotSubscribedToTubeBuddy:"/api/youtubechannel/MarkAsNotSubscribedToTubeBuddy",youtubeChannelToggleChannelytics:"/api/youtubechannel/ToggleChannelytics",youtubeChannelToggleStrategies:"/api/youtubechannel/ToggleStrategies",youtubeApiGetApiSubscribers:"/api/youtubeapi/getapisubscribers",youtubeApiGetPageOfVideos:"/api/youtubeapi/getpageofvideos",youtubeApiGetChannelVideoSearch:"/api/youtubeapi/getchannelvideosearch",youtubeApiGetVideo:"/api/youtubeapi/getvideo",youtubeApiGetCommentsOnVideo:"/api/youtubeapi/getcommentsonvideo",youtubeApiGetCurrentChannel:"/api/youtubeapi/getcurrentchannel",youtubeApiGetChannelUploadPlaylist:"/api/youtubeapi/getchanneluploadplaylist",youtubeApiGetChannel:"/api/youtubeapi/getchannel",youtubeApiGetVideoTrafficSearchTerms:"/api/youtubeapi/getvideotrafficsearchterms",youtubeApiGetVideoRelatedVideos:"/api/youtubeapi/getrelatedvideos",youtubeApiGetChannelTrafficSearchTerms:"/api/youtubeapi/getchanneltrafficsearchterms",youtubeApiGetTrendingVideos:"/api/youtubeapi/gettrendingvideos",youtubeApiPostCommentReply:"/api/youtubeapi/postcommentreply",youtubeApiGetRecentVideos:"/api/youtubeapi/getrecentvideos",youtubeApiGetChannelPlaylists:"/api/youtubeapi/getchannelplaylists",commentManagerToggle:"/api/youtubechannel/togglecommentmanager",commentManagerGetContactHistory:"/api/commentmanager/getcontacthistory",magiclinksGetRecent:"/api/magiclinks/GetRecent",magiclinksCreateLink:"/api/magiclinks/CreateLink",topicsToggleCommentAudienceSuggestedTopic:"/api/topics/togglecommentaudiencesuggestedtopic",topicsGetCommentAudienceSuggestedTopic:"/api/topics/getcommentaudiencesuggestedtopic",topicsGetVideoTopics:"/api/topics/getvideotopics",topicsUpdateVideoTopicsOrder:"/api/topics/updatevideotopicsorder",topicsDeleteVideoTopic:"/api/topics/deletevideotopic",topicsUpdateVideoTopic:"/api/topics/updatevideotopic",topicsAddVideoTopic:"/api/topics/addvideotopic",topicsAddVideoTopics:"/api/topics/addvideotopics",topicsGetAudienceSuggestedTopics:"/api/topics/getaudiencesuggestedtopics",thumbnailAdd:"/api/thumbnail/add",thumbnailGet:"/api/thumbnail/get",thumbnailGetOriginalImageFromUrl:"/thumbnail/getoriginalimagefromurl",thumbnailGetImageFromUrl:"/thumbnail/getimagefromurl",thumbnailGetImageBytes:"/api/thumbnail/getimagebytes",thumbnailAddOverlay:"/api/thumbnail/addoverlay",thumbnailRemoveOverlay:"/api/thumbnail/removeoverlay",thumbnailGetThumbnailPreview:"/thumbnail/GetThumbnailPreview",thumbnailAddTemplate:"/api/thumbnail/addtemplate",thumbnailGetTemplates:"/api/thumbnail/gettemplates",thumbnailGetTemplate:"/api/thumbnail/gettemplate",thumbnailGetTemplateList:"/api/thumbnail/gettemplatelist",thumbnailDeleteTemplate:"/api/thumbnail/deletetemplate",thumbnailUploadBulkOverlayImage:"/api/thumbnail/uploadBulkOverlayImage",twitterGetMentions:"/api/twitter/GetMentions",twitterGetVideoMentions:"/api/twitter/GetVideoMentions",twitterGetMessages:"/api/twitter/GetMessages",twitterRetweet:"/api/twitter/ReTweet",twitterRemoveRetweet:"/api/twitter/RemoveReTweet",twitterFavorite:"/api/twitter/Favorite",twitterUnFavorite:"/api/twitter/UnFavorite",twitterReply:"/api/twitter/Reply",twitterPost:"/api/twitter/Post",twitterReadMentions:"/api/twitter/ReadMentions",twitterGetRefreshStatus:"/api/twitter/GetRefreshedStatus",youTubeVideosGetVideo:"/api/youtubevideos/getvideo",youTubeVideosGetVideoStatus:"/api/youtubevideos/getvideostatus",youTubeVideosGetDownloadUrl:"/api/youtubevideos/getdownloadurl",youTubeVideosGetVideoCardTemplates:"/api/youtubevideos/getvideocardtemplates",youTubeVideosGetVideoEndScreenTemplates:"/api/youtubevideos/getvideoendscreentemplates",youTubeVideosToggleCardTemplate:"/api/youtubevideos/togglecardtemplate",youTubeVideosToggleEndScreenTemplate:"/api/youtubevideos/toggleendscreentemplate",youTubeVideosGetYouTubeVideoScheduledAction:"/api/youtubevideos/getyoutubevideoscheduledaction",youTubeVideosGetYouTubeVideoScheduledActionsInFuture:"/api/youtubevideos/GetYouTubeVideoScheduledActionsInFuture",youTubeVideosAddYouTubeVideoScheduledAction:"/api/youtubevideos/addyoutubevideoscheduledaction",youTubeVideosDeleteYouTubeVideoScheduledAction:"/api/youtubevideos/deleteyoutubevideoscheduledaction",youTubeVideosUpdateYouTubeVideoScheduledAction:"/api/youtubevideos/updateyoutubevideoscheduledaction",youTubeVideosPublishToFacebook:"/api/youtubevideos/publishtofacebook",youTubeVideosBulkPublishToFacebook:"/api/youtubevideos/bulkpublishtofacebook",youTubeVideosGetLatestCopyToFacebook:"/api/youtubevideos/getlatestcopytofacebook",youTubeVideosGetTagsByCount:"/api/youtubevideos/gettagsbycount",youTubeVideosGradeTags:"/api/youtubevideos/gradetags",youTubeVideosGetPublishInterval:"/api/youtubevideos/getpublishinterval",youTubeVideosGetStats:"/api/youtubevideos/getstats",youTubeVideosGetUserNotes:"/api/youtubevideos/getusernotes",youTubeVideosSaveUserNotes:"/api/youtubevideos/saveusernotes",youTubeVideosGetFacebookThumbnail:"/api/youtubevideos/getfacebookthumbnail",scheduledMetaUpdatesGetByVideo:"/api/scheduledmetaupdates/getscheduledmetaupdatesbyvideo",scheduledMetaUpdatesCreate:"/api/scheduledmetaupdates/createscheduledmetaupdate",scheduledMetaUpdatesDelete:"/api/scheduledmetaupdates/deletescheduledmetaupdate",videolyticsGetVideoToCompare:"/api/videolytics/getvideotocompare",videolyticsGetVideoStats:"/api/videolytics/getvideostats",videoLyticsToggle:"/api/videolytics/toggle",searchTermAddSearchTerm:"/api/searchterm/addsearchterm",searchTermGetForVideo:"/api/searchterm/getforvideo",searchTermRemove:"/api/searchterm/removesearchterm",searchTermAnalysisToggle:"/api/searchtermanalysis/toggle",searchRankGetHistory:"/api/searchrank/gethistory",searchRankAddRankings:"/api/searchrank/addrankings",searchRankGetMostRecentBeforeToday:"/api/searchrank/getmostrecentbeforetoday",searchRankGetVideoRankings:"/api/searchrank/getvideorankings",searchRankGetTagRankingsForToday:"/api/searchrank/gettagrankingsfortoday",translateGetTranslation:"/api/translate/gettranslation",translateVideoMetadata:"/api/translate/translatevideometadata",translateGetUsage:"/api/translate/getusage",googlePlusGetSearchResults:"/api/googleplus/getsearchresults",dataGetChannelLanguageStatistics:"/api/data/GetChannelLanguageStatistics",dataGetMyVideosPageVideoInfo:"/api/data/GetMyVideosPageVideoInfo",dataGetChannelSubscriberCount:"/api/data/GetChannelSubscriberCount",launchPadChecklistTemplateItemsExist:"/api/launchpad/ChecklistTemplateItemsExist",launchPadCreateChecklist:"/api/launchpad/CreateChecklist",launchPadUpdateItemStatus:"/api/launchpad/UpdateItemStatus",launchPadGetVideoChecklist:"/api/launchpad/GetVideoChecklist",launchPadImportChecklistTemplateItemDefaults:"/api/launchpad/ImportChecklistTemplateItemDefaults",launchPadGetBestPractices:"/api/launchpad/GetBestPractices",launchpadBestPracticesToggle:"/api/launchpad/togglebestpractices",launchPadGetVideoSummary:"/api/launchpad/getvideosummary",launchPadRunBestPracticeList:"/api/launchpad/runbestpracticelist",musicGenerateTrack:"/api/music/GenerateTrack",musicGetJukedeckGenres:"/api/music/GetJukedeckGenres",commentsMarkAsRead:"/api/comments/MarkAsRead",commentsMarkAsUnRead:"/api/comments/MarkAsUnRead",commentsGetReadComments:"/api/comments/GetReadComments",taglistsGetLists:"/api/taglists/getlists",taglistsAddList:"/api/taglists/addlist",taglistsAddListWithTags:"/api/taglists/addlistwithtags",taglistsAddTag:"/api/taglists/addtag",taglistsAddTags:"/api/taglists/addtags",taglistsGetListTags:"/api/taglists/getlisttags",taglistsRemoveTags:"/api/taglists/removetags",taglistsDeleteList:"/api/taglists/deletelist",taglistsAddTagListWithTags:"/api/taglists/addlistwithtags",tagScoreGet:"/api/tagscore/get",tagScoreGetV2:"/api/tagscore/getv2",tagScoreGetStored:"/api/tagscore/getstored",patreonGetPatrons:"/api/patreon/getpatrons",highlightGetHighlights:"/api/Highlights/GetHighlights",seoScoreGetScores:"/api/seoscore/GetSeoScores",seoScoreAddScore:"/api/seoscore/AddSeoScore",seoScoreUpdateScore:"/api/seoscore/UpdateSeoScore",seoScoreDeleteScore:"/api/seoscore/DeleteSeoScore",seoScoreGetLatestKeyword:"/api/seoscore/GetLatestKeyword",seoScorePublishSavedThumbnailData:"/api/seoscore/PublishSavedThumbnailData",seoScoreGetByVideoId:"/api/seoscore/GetSeoScoreByVideoId",seoScoreGetCalculation:"/api/seoscore/calculate",strategiesGetAllGoals:"/api/strategies/GetStrategyGoals",strategiesGetStrategiesByGoalId:"/api/strategies/GetStrategiesByGoalId",strategiesGetStrategyById:"/api/strategies/GetStrategyById",reportYTDOMIssue:"/api/extensiondomissueapi/addissue",checkYTDOMIssue:"/api/extensiondomissueapi/detailsrequired",productEvents:"/api/productevents/addevent",productSiteEvents:"/api/productevents/addsiteevent"}}}();var TBExtension=function(){var e;var t;var i={};var o=function(){if(e){return e}var t=false;try{t=window.chrome&&chrome.runtime}catch(e){}var i=navigator.userAgent.toLowerCase().indexOf("firefox")>-1;if(t){e="chrome";if(TBGlobal.host.indexOf("localhost")>-1)jQuery("body").prepend("<span class='tb-env' style='background-color:black; color:white; z-index: 9999999999999; font-size:12px; position:fixed; left:0; top:0px; padding:1px 3px; font-weight:500; border:solid 1px white;'>Local - Chome - "+TBUtilities.GetTime()+"</span>");else if(TBGlobal.host.indexOf("staging")>-1)jQuery("body").prepend("<span class='tb-env' style='background-color:yellow; color:red; z-index: 9999999999999; font-size:12px; position:fixed; left:0; top:0px; padding:1px 3px; font-weight:500; border:solid 1px white;'>!! TubeBuddy Beta !! - "+TBUtilities.GetTime()+"</span>")}else if(i){e="firefox";if(TBGlobal.host.indexOf("localhost")>-1)jQuery("body").prepend("<span class='tb-env' style='background-color:black; color:white; z-index: 9999999999999; font-size:12px; position:fixed; left:0; top:0px; padding:1px 3px; font-weight:500; border:solid 1px white;'>Local - FireFox - "+TBUtilities.GetTime()+"</span>");else if(TBGlobal.host.indexOf("staging")>-1)jQuery("body").prepend("<span class='tb-env' style='background-color:black; color:white; z-index: 9999999999999; font-size:12px; position:fixed; left:0; top:0px; padding:1px 3px; font-weight:500; border:solid 1px white;'>Staging - FireFox - "+TBUtilities.GetTime()+"</span>")}return e};var r=function(e){if(o()==="safari"){return safari.extension.baseURI+e}else{return chrome.extension.getURL(e)}};var n=function(e,t){var i=o();switch(i){case"chrome":case"firefox":{chrome.storage.sync.get(e,function(i){var o=i[e];if(typeof t==="function"){t(e,o)}else{jQuery(document.body).trigger(t,[{key:e,value:o}])}});break}}};var a=function(e,t,i){var r=o();switch(r){case"chrome":case"firefox":{var n={};n[e]=t;chrome.storage.sync.set(n,function(){});break}case"safari":{if(window.top===window){var a=m(t);t=a+"|"+v(t,a);safari.extension.dispatchMessage("setDbValueSafari",{key:e,value:t,eventName:i})}break}}};var s=function(e){TBUtilities.Log("remove db value");TBUtilities.Log("key="+e);var t=o();switch(t){case"chrome":case"firefox":{chrome.storage.sync.remove(e,function(){TBUtilities.Log("removed value")});break}case"safari":{if(window.top===window){safari.extension.dispatchMessage("removeDbValueSafari",{key:e,eventName:eventName});TBUtilities.Log("removed value")}break}}};var l=function(e,t){var i=o();switch(i){case"firefox":{browser.runtime.sendMessage(e).then(e=>{t(e);return e});break}case"chrome":{chrome.runtime.sendMessage(e,t);break}}};var d=function(e,t,i){var r=o();switch(r){case"firefox":{browser.runtime.onMessage.addListener((o,r)=>{if(o.originId!=e&&o.action==t){return false}i(o);return o});break}case"chrome":{chrome.runtime.onMessage.addListener((o,r,n)=>{if(o.originId!=e&&o.action==t){return false}i(o);return true});break}}};var u=function(e,t,i,r){var n=o();r=r||{};r.cache=r.cache!==false;r.dataType=typeof r.dataType!="undefined"?r.dataType:"text";r.headers=r.headers||{};r.type="GET";r.url=e||r.url;r.hostname=window.location.hostname;var a=r.success;r.success=null;var s=r.error;r.error=null;r.useContent=false;r.headers.currentChannelId=TBGlobal.CurrentChannelId();r.headers.currentChannelToken=TBGlobal.GetToken();var l={type:"tb-xhr",data:{ajaxOptions:r},host:TBGlobal.host};if(y(e,window.location.href)){l.mode="same-origin";FetchUtilities.MakeFetchRequest(l,function(e){try{p(e,r,t,a,s,i)}catch(e){h(e,"GET",l);throw e}})}else{l.mode="cors";switch(n){case"firefox":{browser.runtime.sendMessage(l).then(e=>{try{p(e,r,t,a,s,i)}catch(e){h(e,"GET",l);throw e}});break}case"chrome":{chrome.runtime.sendMessage(l,function(e){try{p(e,r,t,a,s,i)}catch(e){h(e,"GET",l);throw e}});break}}}};var c=function(e,t,i,r,n,a){var s=o();n=n||{};n.data=t||n.data;n.dataType=typeof n.dataType!="undefined"?n.dataType:"text";n.headers=n.headers||{};n.type="POST";n.url=e||n.url;var l=n.success;n.success=null;var d=n.error;n.error=null;n.useContent=false;n.headers.currentChannelId=TBGlobal.CurrentChannelId();n.headers.currentChannelToken=TBGlobal.GetToken();if(a){n.contentType="application/json";n.headers={"x-origin":"https://studio.youtube.com",Authorization:"SA"+"PI"+"SI"+"DH"+"AS"+"H "+a,"X-Goog-AuthUser":TBGlobal.GoogleAuthUser(),Accept:"*/*"}}if(n.data instanceof FormData){try{n.data=JSON.stringify(Object.fromEntries(n.data));n.dataIsSearlizedFormData=true}catch(e){TBUtilities.LogError(e);TBUtilities.LogError("Polyfil used for Object.fromEntries");Object.fromEntriesPoly=(e=>Object.assign({},...Array.from(e,([e,t])=>({[e]:t}))));n.data=JSON.stringify(Object.fromEntriesPoly(n.data));n.dataIsSearlizedFormData=true}}var u={type:"tb-xhr",data:{ajaxOptions:n},host:TBGlobal.host};if(y(e,window.location.href)){u.mode="same-origin";if(s==="firefox"){u.data.ajaxOptions.useContent=true}FetchUtilities.MakeFetchRequest(u,function(e){try{p(e,n,i,l,d,r)}catch(e){h(e,"POST",u);throw e}})}else{switch(s){case"firefox":{browser.runtime.sendMessage(u).then(e=>{try{p(e,n,i,l,d,r)}catch(e){h(e,"POST",u);throw e}});break}case"chrome":{chrome.runtime.sendMessage(u,function(e){try{p(e,n,i,l,d,r)}catch(e){h(e,"POST",u);throw e}});break}}}};var p=function(e,t,i,o,r,n){if(e.success===true){var a=e.response;if(t.dataType&&t.dataType.toLowerCase()==="json"){try{a=JSON.parse(a)}catch(o){TBUtilities.Log("Parse JSON failure to URL "+t.url+". Details: "+JSON.stringify(o));if(r)r(e.response,e.responseText);if(typeof i==="function"){i(false,n,e.response,e.status)}else{jQuery(document.body).trigger(i,[{success:false,data:n,response:e.response,status:e.status}])}}}if(o){o(a)}if(typeof i==="function"){i(true,n,a,e.status)}else{jQuery(document.body).trigger(i,[{success:true,data:n,response:a,status:e.status}])}}else{if(r)r(e.response,e.responseText);if(typeof i==="function"){i(false,n,e.response,e.status)}else{jQuery(document.body).trigger(i,[{success:false,data:n,response:e.response,status:e.status}])}TBUtilities.Log("Response failure to URL "+t.url+". Details: "+JSON.stringify(e.response))}};var h=function(e,t,i){var o="";if(e.message){o+=e.message}if(e.stack){o+=" | stack: "+e.stack}TBUtilities.Log("Response failure on "+t+" to URL "+i.url+". Error: \n "+o)};const y=(e,t)=>{let i=false;try{let o=new URL(e);let r=new URL(t);if(o.host===r.host){i=true}}catch(e){console.log(e);i=false}return i};var b=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=Math.random()*16|0,i=e=="x"?t:t&3|8;return i.toString(16)})};var f=function(){if(t)return t;var e=o();switch(e){case"chrome":case"firefox":{t=chrome.runtime.getManifest().version;break}default:{t="unknown"}}};var m=function(e){if(typeof e==="undefined")return"undefined";else if(e===null)return"null";else if(typeof e==="object")return"object";else return"string"};var v=function(e,t){if(t=="undefined")return window.btoa("");else if(t=="null")return window.btoa("");else if(t=="object"){e=JSON.stringify(e);return window.btoa(e)}else if(t=="string"){return window.btoa(e)}else TBUtilities.Log("Unknown encrypt dataType: "+t)};var g=function(e,t){if(!t)return"unknown";else if(t=="undefined")return undefined;else if(t=="null")return null;else if(t=="object"){e=decodeURIComponent(escape(window.atob(e)));return JSON.parse(e)}else if(t=="string")return decodeURIComponent(escape(window.atob(e)));else TBUtilities.Log("Unknown decrypt dataType: "+t)};var T=function(e){var t=document.createElement("a");t.href=e;return t.hostname};var w=function(e){if(e.indexOf("?")==-1)return e;e=e.replace(/"/g,"%22");e=e.replace(/ /g,"%20");return e};return{GetType:function(){return o()},GetFilePath:r,Get:u,SendMessage:l,ReceiveMessage:d,GetExtensionVersion:function(){return f()},SetExtensionVersion:function(e){t=e},Post:c,SetDbValue:function(e,t,i){a(e,t,i)},GetDbValue:function(e,t){n(e,t)},RemoveDbValue:function(e){s(e)}}}();var TubeBuddyYouTubeActions=function(){var e=false;var t=null;var o=null;var r=null;var n=null;var a=null;var s={url:null,text:null};var d=0;var u=0;var c=0;var p=0;var h={};var y=0;var b=0;var f=null;var m=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi;var v={};var g={};var T="studioHtml-";var w="authedUser-";var k=false;var x=function(e,t,i,o){if(e){f=e}if(!f){TBUtilities.Log("Auto complete token not passed - "+t);TBExtension.Get("https://www.youtube.com/account",function(e,r,n){var a=n;var s=a.indexOf('PSUGGEST_TOKEN":"')+'PSUGGEST_TOKEN":"'.length;var l=a.indexOf('"',s);f=a.substring(s,l);B(f,t,i,o)},null,null)}else{B(f,t,i,o)}};var B=function(e,t,i,o){var r=TBGlobal.GetPrefCookieObject();var n="us";var a="en";if(r&&r.gl){n=r.gl}if(r&&r.hl){a=r.hl}var s="auto-"+t+o;var l=lscache.get(s);if(l==null){t=t.trim();b=i;var d="https://clients1.google.com/complete/search?client=youtube&hl="+a+"&gl="+n+"&gs_rn=23&gs_ri=youtube&tok="+f+"&ds=yt&cp=15&gs_id=a&q="+TBUtilities.GetUrlEncoded(t)+"&callback=google.sbox.p50&gs_gbg=3no8d";if(o=="google"){d="https://clients1.google.com/complete/search?client=youtube&hl="+a+"&gl="+n+"&gs_rn=23&gs_ri=youtube&tok="+f+"&cp=15&gs_id=a&q="+TBUtilities.GetUrlEncoded(t)+"&callback=google.sbox.p50&gs_gbg=3no8d"}TBExtension.Get(d,function(e,t,o){TBUtilities.Log("CRTBGetYouTubeSuggest success = "+e+" for term "+t.Term);var r=[];try{if(e===true){var n=o.indexOf("[");var a=o.indexOf("{");var s=o.substring(n,a);s=TBUtilities.ReplaceAll(s,'"',"'");var l=s.match(/'[^']*'/g);jQuery.each(l,function(e,t){t=j(t).trim();t=TBUtilities.ReplaceAll(t,"'","").trim();r.push(t)});var d=[];for(var u=0;u<r.length;u++){if(r[u]&&r[u].toLowerCase()===t.Term.toLowerCase()){d.push(u)}}for(var u=d.length-1;u>=0;u--){r.splice(d[u],1)}}}catch(e){TBUtilities.LogError({Exception:e,Location:"[YouTubeActions] makeAutoCompleteRequest"})}var c="auto-"+t.Term+t.Type;lscache.set(c,r,1440);i(r,t.Term)},{Term:t,Type:o})}else{i(l,t)}};var j=function(e){return e.replace(/\\u[\dA-Fa-f]{4}/g,function(e){return String.fromCharCode(parseInt(e.replace(/\\u/g,""),16))})};var L=function(e,t,i){o=i;var r="https://www.youtube.com/channel/"+e+"/about";TBExtension.Get(r,"CRTBLoadAboutPageForMessage",{message:t,channelid:e})};var C=function(e,t){r=t;var i="https://www.youtube.com/playlist?list="+e;TBUtilities.Log("YTFunctions - Getting Playlist: "+i);TBExtension.Get(i,"CRTBYTActionsLoadPlaylistPage",{})};var Q=function(e,i){t=i;var o="https://www.youtube.com/channel/"+e+"/about";TBExtension.Get(o,"CRTBLoadAboutPageForSubscribe",{channelId:e})};var U=function(e){TBUtilities.Log("TubeBuddyYouTubeActions - CRTBLoadAboutPageForSubscribe success = "+e.success);try{if(e.success){try{var i=e.response.lastIndexOf(',"subscribed":')+',"subscribed":'.length;var o=e.response.substring(i,i+1);if(o=="t"){TBUtilities.Log("Already subbed: cRTBLoadAboutPageForSubscribe");l;t(e)}}catch{}var r=TBUtilities.GetSessionToken(e.response);var n="https://www.youtube.com/subscription_ajax?action_create_subscription_to_channel=1&c="+e.data.channelId;var a="session_token="+r;TBExtension.Post(n,a,"CRTBPostSubscribe",e.data,{contentType:"application/x-www-form-urlencoded; charset=UTF-8"})}else{t(e)}}catch(e){TBUtilities.Log(e)}};var I=function(e){TBUtilities.Log("TubeBuddyYouTubeActions - CRTBLoadAboutPageForMessage result = "+e.success);try{if(e.success==false){o(e);return}var t=null;var i=null;try{t=TBUtilities.GetSessionToken(e.response);i=O(e.response)}catch(e){TBUtilities.Log(e)}if(i!=null&&t!=null){var r="&user_id="+i;r+="&channel_id";r+="&content="+e.data.message;r+="&session_token="+t;var n="https://www.youtube.com/comment_ajax?action_send_message=1";TBExtension.Post(n,r,"CRTBMessagePost",e.data,{contentType:"application/x-www-form-urlencoded; charset=UTF-8"})}else{e.success=false;o(e)}}catch(t){TBUtilities.Log(t);e.success=false;o(e)}};var S=function(e){TBUtilities.Log("TubeBuddyYouTubeActions - CRTBMessagePost result = "+e.success);o(e)};var A=function(e){t(e)};var E=function(e){n(e)};var D=function(e){try{if(e.success==false){TBUtilities.Log("cRTBYTActionsLoadPlaylistPage failed");r(e);return}}catch(e){TBUtilities.LogError("cRTBYTActionsLoadPlaylistPage exception"+e);r(false)}};var R=function(e,t,i,o,r,a,s){TBUtilities.Log("TubeBuddyYouTubeActions - getSearchResults");n=i;var l="https://www.youtube.com/results?search_query="+TBUtilities.GetUrlEncoded(t)+"&page="+o;if(typeof a!=="undefined"){l=l+"&search_sort="+a}if(typeof s!=="undefined"){l=l+"&filters="+s}var d="https://www.youtube.com/results?search_query="+TBUtilities.GetUrlEncoded(t)+"&page="+o;TBExtension.Get(d,"CRTBYouTubeActionGetSearchResults",{id:r,searchTerm:t,pageNumber:o})};var P=function(e,t,i){TBExtension.SendMessage({action:"SEARCH_QUERY"},o=>{TBExtension.SetDbValue("SEARCH_TAGS",{videoId:e,tabId:o.tabId,originId:o.originId,tags:t});TBExtension.ReceiveMessage(o.originId,"RELAY_SEARCH_RESULTS",e=>{try{const t=e.tag;const o=e.rank;const r=e.videoId;if(e.error){TBUtilities.Log(e.error)}i(r,t,o)}catch(e){TBUtilities.LogError(e)}})})};var G=function(e,t,o,r,n,a,s){TBUtilities.Log("TubeBuddyYouTubeActions - getVideoSearchRank");if(typeof r==="undefined"||r==null){r=1}if(n==null){n=1}var l=TBUtilities.GetUrlEncoded(t);var d=e+"-"+l;var u="https://www.youtube.com/results?search_query="+l+"&page="+r;y++;if(y>=10){TBUtilities.Log("TubeBuddyYouTubeActions - getVideoSearchRank clearing cache");y=0;lscache.flushExpired()}if(s&&s==true){TBUtilities.Log("TubeBuddyYouTubeActions - getVideoSearchRank removing cache value for "+t+" if available ");lscache.remove(d)}var c=lscache.get(d);if(c!=null){TBUtilities.Log("TubeBuddyYouTubeActions - getVideoSearchRank cached value found for "+t+" rank = "+c);o(e,t,parseInt(c),a)}else{var p=true;TBExtension.Get(u,function(s,l,u){try{if(s){var c=false;var p=20*(r-1);var h=null;if(TBExtension.GetType()==="safari"){h=TBGlobal.GetYouTubeUIFromHtml(u)}else{h=TBGlobal.GetYouTubeUI()}var y=TBUtilities.IsResponseContextFound(u);if(h=="default"&&y===true){h="material"}switch(h){case"studio":case"material":{if(y===true){var b=TBUtilities.ParseResponseContextFromHtml(u);if(b.contents.twoColumnSearchResultsRenderer.primaryContents!=null){var f=TBUtilities.GetVideoSearchCollection(b.contents.twoColumnSearchResultsRenderer.primaryContents);if(f&&f.length){jQuery.each(f,function(t,o){if(!o){return}if(o.shelfRenderer||o.videoRenderer||o.channelRenderer||o.horizontalCardListRenderer||o.radioRenderer||o.richSectionRenderer||o.richShelfRenderer||o.playlistRenderer){p++}if(o.richShelfRenderer){var r=[...o.richShelfRenderer.contents].length;for(i=0;i<r;i++){if(o.richShelfRenderer.contents[i]&&o.richShelfRenderer.contents[i].richItemRenderer&&o.richShelfRenderer.contents[i].richItemRenderer.content&&o.richShelfRenderer.contents[i].richItemRenderer.content.videoRenderer){if(e==o.richShelfRenderer.contents[i].richItemRenderer.content.videoRenderer.videoId){c=true;return false}if(i!=0){p++}}}}else if(o.shelfRenderer){if(o.shelfRenderer.content.verticalListRenderer){var n=o.shelfRenderer.content.verticalListRenderer.collapsedItemCount;for(i=0;i<n;i++){if(o.shelfRenderer.content.verticalListRenderer.items[i]&&o.shelfRenderer.content.verticalListRenderer.items[i].videoRenderer){if(e==o.shelfRenderer.content.verticalListRenderer.items[i].videoRenderer.videoId){c=true;return false}if(i!=0){p++}}}}}else if(o.videoRenderer){if(e==o.videoRenderer.videoId){c=true;return false}}})}}}break}case"default":{u=u.replace(/__ytRIL/g,"");u=TBUtilities.ReplaceAll(u,"window. &amp;&amp;","");var m=jQuery.parseHTML(DOMPurify.sanitize(u,DOMPurifyConfig));jQuery(".item-section",m).find("li > div").each(function(){if(jQuery(this).hasClass("spell-correction"))return;p++;jQuery(this).find("a").attr("target","_blank");jQuery(this).find(".yt-uix-menu-trigger").remove();var t=jQuery(this).find(".yt-lockup-byline").find("a:first").attr("data-ytid");var i=jQuery(this).find("h3 > a:first");if(i!=null){var o=i.attr("href");if(o==null)o="";if(o.indexOf("watch?")>0){var r=o.indexOf("v=")+2;var n=o.substring(r,r+11);if(e==n){c=true;return false}}}})}}if(c){lscache.set(d,p,5);o(e,t,p,a)}else{if(r<n){G(e,t,o,r+1,n,a)}else{lscache.set(d,0,5);o(e,t,0,a)}}}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|getVideoSearchRank",Data:l,Response:u});lscache.set(d,-1,30);o(e,t,-1,a)}}catch(i){TBUtilities.LogError({Exception:i,Location:"YouTubeActions.js|getVideoSearchRank"});lscache.set(d,-1,30);o(e,t,-1,a)}},null,{dataType:"text/html",forceSameOrigin:true})}};var O=function(e){TBUtilities.Log("TubeBuddyYouTubeActions - parseUserId");var t='data-user-id="';var i=null;var o=e.indexOf(t);if(o!=-1){o=o+t.length;var r=e.indexOf('"',o+1);i=e.substring(o,r)}return i};var V=function(e,t,i,o,r){TBUtilities.Log("TubeBuddyYouTubeActions - copyCard");if(!g[r]){g[r]=1}else{let e=g[r];e++;g[r]=e}var n=new FormData;n.append("key","");n.append("start_ms",t.start_ms);n.append("session_token",i);switch(t.type){case"playlist":n.append("type","video");n.append("video_url",t.target_url);n.append("video_item_id",t.playlist_id);n.append("show_warnings","False");n.append("action_create_video",1);n.append("show_warnings","False");n.append("custom_message",t.custom_message);n.append("teaser_text",t.teaser_text);break;case"video":n.append("type",t.type);n.append("video_url",t.target_url);n.append("video_item_id",t.video_id);n.append("show_warnings","False");n.append("action_create_video",1);n.append("show_warnings","False");n.append("custom_message",t.custom_message);n.append("teaser_text",t.teaser_text);break;case"merch":n.append("type",t.type);n.append("action_create_merch",1);n.append("target_url",t.target_url);n.append("title",t.title);n.append("custom_message",t.custom_message);n.append("teaser_text",t.teaser_text);if(t.imagefile){n.append("imagefile",t.imagefile)}break;case"fundraising":n.append("type",t.type);n.append("action_create_fundraising",1);n.append("target_url",t.target_url);n.append("title",t.title);n.append("custom_message",t.custom_message);n.append("teaser_text",t.teaser_text);if(t.imagefile){n.append("imagefile",t.imagefile)}break;case"product":case"associated":n.append("type",t.type);n.append("action_create_associated",1);n.append("target_url",t.target_url);n.append("title",t.title);n.append("custom_message",t.custom_message);n.append("teaser_text",t.teaser_text);if(t.imagefile){n.append("imagefile",t.imagefile)}break;case"tip":n.append("type",t.type);n.append("action_create_tip",1);break;case"collaborator":n.append("type",t.type);n.append("action_create_collaborator",1);n.append("channel_url",t.channel_url);n.append("title",t.title);n.append("custom_message",t.custom_message);n.append("teaser_text",t.teaser_text);break;case"poll":n.append("type",t.type);n.append("action_create_poll",1);n.append("title",t.title);n.append("teaser_text",t.teaser_text);n.append("choices_as_string",t.choices.join());break}var a="https://www.youtube.com/cards_ajax?v="+e;try{TBUtilities.Log("TubeBuddyYouTubeActions - copyCard - data = ");var s={};n.forEach(function(e,t){s[t]=e});TBUtilities.Log(s)}catch(e){TBUtilities.Log(e)}TBExtension.Post(a,n,function(n,a,s){try{if(n){if(s.indexOf('"errors":["')>0){try{TBUtilities.Log("TubeBuddyYouTubeActions - copyCard - error = ");TBUtilities.Log(s)}catch(e){TBUtilities.Log(e)}var l=s.indexOf('"errors":["')+'"errors":["'.length;var d=s.indexOf("]",l)-2;var u=s.substring(l,d);if(u=="Invalid Reques"){l=s.indexOf('message":"');if(l>0){l+='message":"'.length;d=s.indexOf('"',l)-2;u=s.substring(l,d)}}let n=g[r];if(u.toLowerCase()==="could not save card"&&n<=3){TBUtilities.Log("TubeBuddyYouTubeActions - copyCard - retry = "+n);V(e,t,i,o,r)}else{o(false,e,s,u)}return}o(true,e,a)}else{if(s===503){TBUtilities.Log("503 returned from cards post");dt(e,function(i){if(i&&i.feature_templates){var r=i.feature_templates;var n=false;switch(t.type){case"playlist":var l=r.find(e=>e.type==="playlist"&&t.playlist_id===e.playlist_id);if(l){n=true}break;case"video":var l=r.find(e=>e.type==="video"&&t.video_id===e.video_id);if(l){n=true}break;case"merch":var l=r.find(e=>e.type==="merch"&&t.target_url===e.target_url);if(l){n=true}break;case"fundraising":var l=r.find(e=>e.type==="fundraising"&&t.target_url===e.target_url);if(l){n=true}break;case"product":case"associated":var l=r.find(e=>(e.type==="associated"||e.type==="product")&&t.target_url===e.target_url);if(l){n=true}break;case"tip":n=true;break;case"collaborator":var l=r.find(e=>e.type==="collaborator"&&t.channel_url===e.channel_url);if(l){n=true}break;case"poll":var l=r.find(e=>e.type==="poll"&&t.title===e.title);if(l){n=true}break}TBUtilities.Log("found cards on video = "+n);if(n===true){o(true,e,a)}else{o(false,e,s,s)}}else{o(false,e,s,s)}})}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|copyCard",Data:a,Response:s});o(false,e,s,s)}}}catch(t){TBUtilities.LogError({Exception:t,Location:"YouTubeActions.js|copyCard"});o(false,e,s,s)}},null,{dataType:null,contentType:false,cache:false,timeout:18e4,contentTypeFireFox:"application/x-www-form-urlencoded"})};var _=function(e,t,i,o){TBUtilities.Log("TubeBuddyYouTubeActions - updateCard");var r=new FormData;r.append("key",t.key);r.append("start_ms",t.start_ms);r.append("session_token",i);switch(t.type){case"playlist":r.append("type","video");r.append("video_url",t.target_url);r.append("show_warnings","False");r.append("action_update_video",1);r.append("show_warnings","False");r.append("custom_message",t.custom_message);r.append("teaser_text",t.teaser_text);break;case"video":r.append("type",t.type);r.append("video_url",t.target_url);r.append("show_warnings","False");r.append("action_update_video",1);r.append("show_warnings","False");r.append("custom_message",t.custom_message);r.append("teaser_text",t.teaser_text);break;case"merch":r.append("type",t.type);r.append("action_update_merch",1);r.append("image_url",t.image_url);r.append("target_url",t.target_url);r.append("title",t.title);r.append("custom_message",t.custom_message);r.append("teaser_text",t.teaser_text);if(t.imagefile&&t.imagefile!=""){r.append("imagefile",t.imagefile)}else{r.append("imagefile","")}break;case"fundraising":r.append("type",t.type);r.append("action_update_fundraising",1);r.append("image_url",t.image_url);r.append("target_url",t.target_url);r.append("title",t.title);r.append("custom_message",t.custom_message);r.append("teaser_text",t.teaser_text);if(t.imagefile&&t.imagefile!=""){r.append("imagefile",t.imagefile)}else{r.append("imagefile","")}break;case"product":case"associated":r.append("type",t.type);r.append("action_update_associated",1);r.append("image_url",t.image_url);r.append("target_url",t.target_url);r.append("title",t.title);r.append("custom_message",t.custom_message);r.append("teaser_text",t.teaser_text);if(t.imagefile&&t.imagefile!=""){r.append("imagefile",t.imagefile)}else{r.append("imagefile","")}break;case"collaborator":r.append("type",t.type);r.append("action_update_collaborator",1);r.append("channel_url",t.channel_url);r.append("title",t.title);r.append("custom_message",t.custom_message);r.append("teaser_text",t.teaser_text);break}var n="https://www.youtube.com/cards_ajax?v="+e;TBExtension.Post(n,r,function(i,r,n){try{if(i){TBUtilities.Log({Success:i,Data:r,Response:n});if(n.indexOf('"errors":["')>0){var a=n.indexOf('"errors":["')+'"errors":["'.length;var s=n.indexOf("]",a)-2;var l=n.substring(a,s);if(n.indexOf('message":"',a)>=0){a=n.indexOf('message":"');if(a>0){a+='message":"'.length;s=n.indexOf('"',a)-1;l=n.substring(a,s)}}o(false,e,t,l);return}o(true,e,t)}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|updateCard",Data:r,Response:n});o(false,e,t)}}catch(i){TBUtilities.LogError({Exception:i,Location:"YouTubeActions.js|updateCard"});o(false,e,t)}},null,{dataType:null,cache:false,contentType:undefined})};var M=function(e,t,i,o,r,n,a,s,l){TBUtilities.Log("TubeBuddyYouTubeActions - addCard");var d=new FormData;d.append("key","");d.append("type",t);d.append("start_ms",i);d.append("show_warnings",o);d.append("video_item_id",r);d.append("video_url",n);d.append("action_create_video",a);d.append("session_token",s);var u="https://www.youtube.com/cards_ajax?v="+e;TBExtension.Post(u,d,function(t,i,o){try{if(t){l(true,e,o)}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|addCard",Data:i,Response:o});l(false,e,o)}}catch(t){TBUtilities.LogError({Exception:t,Location:"YouTubeActions.js|addCard"});l(false,e,o)}},null,{dataType:null,cache:false,contentType:undefined})};var F=function(e){return new Promise(function(t,i){re(e).then(function(o){if(o&&o.startMs){t(o.startMs)}else{TubeBuddyYouTubeActions.GetVideoDetailStudio(e).then(function(e){var i=2e4;if(e.videoDurationMs<=35e3){i=1e4}var o=e.videoDurationMs-i;t(o)}).catch(function(e){i(e)})}}).catch(function(e){i(e)})})};var N=function(e){let t={videoId:e,videoDurationMs:null,endscreenStartMs:null,endscreen:null};return new Promise(function(i,o){re(e).then(function(e){if(e&&e.startMs){t.endscreenStartMs=e.startMs;t.endscreen=e}}).then(function(){TubeBuddyYouTubeActions.GetVideoDetailStudio(e).then(function(e){t.videoDurationMs=e.videoDurationMs;i(t)}).catch(function(e){o(e)})}).catch(function(e){o(e)})})};var Y=function(e){let t={html:null,videoId:e,header:null,response:null};return new Promise(function(e,i){se(t).then(TBUtilities.ProcessHeader).then(le).then(W).then(function(t){e(t)}).catch(function(e){i(e)})})};var H=function(e){return new Promise(function(t,i){TBYouTubeApi.GetVideoDetails(e,null,function(e){try{TBUtilities.Log(e);TBGlobal.AddUserDebugInfo("getVideoDuration - callback");var o=new timelord(e.contentDetails.duration);var r=o.ticks();var n={videoId:e.id,videoDurationMs:r};t(n)}catch(e){i("error getting video duration")}})})};var W=function(e){return new Promise(function(t,i){var o=TBUtilities.BuildContextRequestObject(e.html);var r=[];r.push(e.videoId);var n={context:o,failOnError:true,mask:{channelId:true,videoId:true,lengthSeconds:true,premiere:{all:true},status:true,thumbnailDetails:{all:true},title:true,draftStatus:true,downloadUrl:true,watchUrl:true,permissions:{all:true},timeCreatedSeconds:true,timePublishedSeconds:true,origin:true,livestream:{all:true},privacy:true,features:{all:true},videoEditorProject:{all:true},videoDurationMs:true,audioLanguage:{all:true},adFormats:{all:true},adBreaks:{all:true},monetizedStatus:true,videoStreamUrl:true,responseStatus:{all:true}},videoIds:r};var a=TBUtilities.ParseInnerTubeApiKey(e.html);var s="https://studio.youtube.com/youtubei/v1/creator/get_creator_videos?alt=json&key="+a;TBExtension.Post(s,JSON.stringify(n),function(o,r,n){if(o===true&&n.videos.length>0){t(n.videos[0])}else{z();i("error getting video detail for video id "+e.videoId)}},null,{dataType:"json",cache:false,contentType:null},e.header)})};var z=function(){TBUtilities.Log("removedCachedStudioValues");lscache.remove(TBUtilities.HeaderCacheKey+TBGlobal.CurrentChannelId());lscache.remove(w+TBGlobal.CurrentChannelId());lscache.remove(T+TBGlobal.CurrentChannelId())};var q=function(e,t){let i={html:null,videoId:e,header:null,response:null,thumbnailDataUrl:t};return new Promise(function(e,t){se(i).then(TBUtilities.ProcessHeader).then(le).then(K).then(function(t){e(t)}).catch(function(e){t(e)})})};var K=function(e){return new Promise(function(t,i){var o=TBUtilities.BuildContextRequestObject(e.html);var r={context:o,encryptedVideoId:e.videoId,videoStill:{image:{dataUri:e.thumbnailDataUrl},operation:"UPLOAD_CUSTOM_THUMBNAIL"}};var n=TBUtilities.ParseInnerTubeApiKey(e.html);var a="https://studio.youtube.com/youtubei/v1/video_manager/metadata_update?alt=json&key="+n;TBExtension.Post(a,JSON.stringify(r),function(o,r,n){if(o===true){t(n)}else{i("error publishing custom thumbnail for video id "+e.videoId)}},null,{dataType:"json",cache:false,contentType:null},e.header)})};var J=function(){let e={html:null,header:null,response:null};return new Promise(function(t,i){se(e).then(TBUtilities.ProcessHeader).then(le).then(X).then(function(e){t(e)}).catch(function(e){i(e)})})};var X=function(e){return new Promise(function(t,i){var o=TBUtilities.BuildContextRequestObject(e.html);var r=TBGlobal.CurrentChannelId();var n={context:o,externalChannelId:r};var a=TBUtilities.ParseInnerTubeApiKey(e.html);var s="https://studio.youtube.com/youtubei/v1/feature_eligibility/get_creator_feature_eligibility?alt=json&key="+a;TBExtension.Post(s,JSON.stringify(n),function(e,o,n){if(e===true){t(n)}else{i("error getting feature eligibility for channel "+r)}},null,{dataType:"json",cache:false,contentType:null},e.header)})};var Z=function(){let e={html:null,header:null,response:null};return new Promise(function(t,i){se(e).then(TBUtilities.ProcessHeader).then(le).then($).then(function(e){t(e)}).catch(function(e){i(e)})})};var $=function(e){return new Promise(function(t,i){var o=TBUtilities.BuildContextRequestObject(e.html);var r=TBGlobal.CurrentChannelId();var n={context:o,externalChannelId:r};var a=TBUtilities.ParseInnerTubeApiKey(e.html);var s="https://studio.youtube.com/youtubei/v1/creator/get_supported_content_languages?alt=json&key="+a;TBExtension.Post(s,JSON.stringify(n),function(e,o,n){if(e===true){t(n)}else{i("error getting supported content languages "+r)}},null,{dataType:"json",cache:false,contentType:null},e.header)})};var ee=function(e,t,i){let o={html:null,videoId:e,header:null,response:null,filter:t?t:null,sort:i?i:"NEWEST"};return new Promise(function(e,t){se(o).then(TBUtilities.ProcessHeader).then(le).then(te).then(function(t){e(t)}).catch(function(e){t(e)})})};var te=function(e){return new Promise(function(t,i){var o=TBUtilities.BuildContextRequestObject(e.html);var r={context:o,maxReplies:10,moderationState:"PUBLISHED",searchQuery:"",sortOrder:e.sort,videoId:e.videoId};if(e.filter==="responded"){r.commentsFilter={commentCategoryIn:{values:["COMMENT_CATEGORY_ENGAGED"]}}}var n=TBUtilities.ParseInnerTubeApiKey(e.html);var a="https://studio.youtube.com/youtubei/v1/comment/get_comments?alt=json&key="+n;TBExtension.Post(a,JSON.stringify(r),function(o,r,n){if(o===true){t(n)}else{z();i("error getting comments for video id "+e.videoId)}},null,{dataType:"json",cache:false,contentType:null},e.header)})};var ie=function(e,t){let i={html:null,header:null,response:null,commentToken:e,videoId:t};return new Promise(function(e,t){se(i).then(TBUtilities.ProcessHeader).then(le).then(oe).then(function(t){e(t)}).catch(function(e){t(e)})})};var oe=function(e){return new Promise(function(t,i){var o=TBUtilities.BuildContextRequestObject(e.html);var r={context:o,continuation:e.commentToken};r.context.request={consistencyTokenJars:[],internalExperimentFlags:[],useSsl:true};r.context.user={lockedSafetyMode:false};r.context.client.mainAppWebInfo={graftUrl:"https://www.youtube.com/watch?v="+e.videoId,webDisplayMode:"WEB_DISPLAY_MODE_BROWSER",isWebNativeShareAvailable:true};r.context.client.originalUrl="https://www.youtube.com/watch?v="+e.videoId;r.context.client.clientName="WEB";var n=TBUtilities.ParseInnerTubeApiKey(e.html);var a="https://www.youtube.com/youtubei/v1/next?key="+n;TBExtension.Post(a,JSON.stringify(r),function(o,r,n){if(o===true){t(n)}else{z();i("error getting comments response for comment token "+e.commentToken)}},null,{dataType:"json",cache:false,contentType:null},e.header)})};var re=function(e){let t={html:null,videoId:e,header:null,response:null};return new Promise(function(e,i){se(t).then(TBUtilities.ProcessHeader).then(le).then(ue).then(function(t){ne(t.elements);e(t)}).catch(function(e){i(e)})})};var ne=function(e){jQuery.each(e,function(e,t){if(t.videoEndscreenElement){t.type="VIDEO"}else if(t.playlistEndscreenElement){t.type="PLAYLIST"}else if(t.channelEndscreenElement){t.type="CHANNEL"}else if(t.websiteEndscreenElement){t.type="WEBSITE"}else if(t.merchandiseEndscreenElement){t.type="MERCH"}})};const ae=(e,t,i)=>new Promise((o,r)=>{return e().then(o).catch(n=>{if(i-1>0){return wait(t).then(ae.bind(null,e,t,i-1)).then(o).catch(r)}return r(n)})});var se=function(e){return new Promise(function(t,i){TBUtilities.Log("getStudioHtml");try{var o=TBUtilities.ParseDelegatedSessionId(document.documentElement.innerHTML);var r=lscache.get(TBUtilities.DelegatedSessionIdKey());if(o&&r&&o!==r){z()}}catch(e){TBUtilities.LogError(e)}var n=lscache.get(T+TBGlobal.CurrentChannelId());if(n!==null){TBUtilities.Log("getStudioHtml - html cache found");e.html=n;t(e)}else{var a="https://studio.youtube.com/channel/"+TBGlobal.CurrentChannelId();TBUtilities.Log("getStudioHtml - getting "+a);TBExtension.Get(a,function(o,r,n){if(o===true){e.html=n;lscache.set(T+TBGlobal.CurrentChannelId(),n,15);t(e)}else{i("error getting studio html")}},null,null)}})};var le=function(e){return new Promise(function(t,i){var o=lscache.get(w+TBGlobal.CurrentChannelId());if(o!==null){TBUtilities.Log("getAuthedUser cache found");e.authedUser=o;TBGlobal.SetGoogleAuthUser(o);t(e)}else{var r="https://studio.youtube.com/";TBExtension.Get(r,function(r,n,a){o=0;if(r===true){for(const e of["authuser=","authuser\\u003d","SESSION_INDEX"]){var s=a.indexOf(e);if(s>=0&&e!=="SESSION_INDEX"){var l=a.substring(s+e.length,a.length);var d=l.indexOf('"');token=l.substring(0,d);var u=token.match(/\d+/);o=u[0];break}if(s>=0&&e==="SESSION_INDEX"){var c=a.indexOf('"SESSION_INDEX":"')+'"SESSION_INDEX":"'.length;var p=a.indexOf('"',c);o=a.substring(c,p);break}}TBUtilities.Log("authuser from page = "+o);e.authedUser=parseInt(o);TBGlobal.SetGoogleAuthUser(e.authedUser);lscache.set(w+TBGlobal.CurrentChannelId(),e.authedUser,15);t(e)}else{i("error getting authed user")}},null,null)}})};var de=function(e){return new Promise(function(t){const i="SA";const o="PIS";const r="ID";const n="HA";const a="SH";const s={"content-type":"application/json",accept:"*/*",authorization:`${i}${o}${r}${n}${a} ${e.header}`,"x-goog-authuser":e.authedUser,"x-goog-pageid":TBUtilities.ParseDelegatedSessionId(document.head.innerText),"x-origin":"https://www.youtube.com"};e.headers=s;t(e)})};var ue=function(e){return new Promise(function(t,i){var o=TBUtilities.BuildContextRequestObject(e.html);var r=[];r.push(e.videoId);var n={context:o,encryptedVideoIds:r};var a=TBUtilities.ParseInnerTubeApiKey(e.html);var s="https://studio.youtube.com/youtubei/v1/creator/get_creator_endscreens?alt=json&key="+a;TBExtension.Post(s,JSON.stringify(n),function(e,o,r){if(e===true){t(r.endscreens.length>0?r.endscreens[0]:null)}else{i("error getting endscreen elements")}},null,{dataType:"json",cache:false,contentType:null},e.header)})};var ce=function(e,t,i){TBUtilities.Log("Starting: analyticsGetSummaryChannelTotals");if(!e)e=new Date(2005,4,8);if(!t)t=new Date;let o={html:null,header:null,startDate:e,endDate:t,metrics:i,resultData:[]};return new Promise(function(r,n){se(o).then(TBUtilities.ProcessHeader).then(le).then(Le).then(function(e){r(e)}).catch(function(o){if(!k){k=true;z();r(ce(e,t,i))}else{n(o)}})})};var pe=function(e,t,i){TBUtilities.Log("Starting: analyticsGetDailyChannelTotals");if(!e)e=new Date(2005,4,8);if(!t)t=new Date;let o={html:null,header:null,startDate:e,endDate:t,metrics:i,resultData:[]};return new Promise(function(r,n){se(o).then(TBUtilities.ProcessHeader).then(le).then(Ce).then(function(e){r(e)}).catch(function(o){if(!k){k=true;z();r(pe(e,t,i))}else{n(o)}})})};var he=function(e,t,i,o){TBUtilities.Log("Starting: analyticsGetDailyVideoTotals");if(!t)t=new Date(2005,4,8);if(!i)i=new Date;let r={html:null,header:null,startDate:t,endDate:i,metrics:o,videoId:e,resultData:[]};return new Promise(function(n,a){se(r).then(TBUtilities.ProcessHeader).then(le).then(Qe).then(function(e){n(e)}).catch(function(r){if(!k){k=true;z();n(he(e,t,i,o))}else{a(r)}})})};var ye=function(e,t,i,o){TBUtilities.Log("Starting: analyticsGetVideoSearchTermTrafficTotals");if(!t)t=new Date(2005,4,8);if(!i)i=new Date;let r={html:null,header:null,startDate:t,endDate:i,metrics:o,videoId:e,resultData:[]};return new Promise(function(n,a){se(r).then(TBUtilities.ProcessHeader).then(le).then(Ue).then(function(e){n(e)}).catch(function(r){if(!k){k=true;z();n(ye(e,t,i,o))}else{a(r)}})})};var be=function(e,t,i,o){TBUtilities.Log("Starting: analyticsGetSummaryVideoTrafficSourcesTotals");if(!t)t=new Date(2005,4,8);if(!i)i=new Date;let r={html:null,header:null,startDate:t,endDate:i,metrics:o,videoId:e,resultData:[]};return new Promise(function(n,a){se(r).then(TBUtilities.ProcessHeader).then(le).then(Ie).then(function(e){n(e)}).catch(function(r){if(!k){k=true;z();n(be(e,t,i,o))}else{a(r)}})})};var fe=function(e){TBUtilities.Log("IN: submitVideoForManualReviewRequest");return new Promise(function(t,i){var o=TBUtilities.BuildContextRequestObject(e.html);var r={encryptedVideoId:e.videoId,monetizationAppeal:{reason:"MDE_MONETIZATION_APPEAL_REASON_AD_FRIENDLY"},context:o};var n=TBUtilities.ParseInnerTubeApiKey(e.html);var a="https://studio.youtube.com/youtubei/v1/video_manager/metadata_update?alt=json&key="+n;TBExtension.Post(a,JSON.stringify(r),function(o,r,n){if(o===true){TBUtilities.Log("Successfully submitted!");TBUtilities.Log(n);t(e)}else{TBUtilities.Log("Failed to submit!");i("error get submitVideoForManualReviewRequest")}},null,{dataType:"json",cache:false,contentType:"application/json"},e.header)})};var me=function(e){TBUtilities.Log("IN: submitVideoForManualReview");let t={html:null,header:null,videoId:e};return new Promise(function(i,o){se(t).then(TBUtilities.ProcessHeader).then(le).then(fe).then(function(e){i(e)}).catch(function(t){if(!k){k=true;z();i(me(e))}else{o(t)}})})};var ve=function(e,t,i,o){TBUtilities.Log("Starting: analyticsGetSummaryVideoTotals");if(!t)t=new Date(2005,4,8);if(!i)i=new Date;let r={html:null,header:null,startDate:t,endDate:i,metrics:o,videoId:e,resultData:[]};return new Promise(function(n,a){se(r).then(TBUtilities.ProcessHeader).then(le).then(Se).then(function(e){n(e)}).catch(function(r){if(!k){k=true;z();n(ve(e,t,i,o))}else{a(r)}})})};var ge=function(){TBUtilities.Log("Starting: analyticsGetAudienceOnlineData");let e={html:null,header:null,resultData:[]};return new Promise(function(t,i){se(e).then(TBUtilities.ProcessHeader).then(le).then(Ae).then(function(e){t(e)}).catch(function(e){if(!k){k=true;z();t(ge())}else{i(e)}})})};var Te=function(e,t){let i={html:null,header:null,pageToken:null,maxToReturn:e,publicOnly:t};return new Promise(function(o,r){se(i).then(TBUtilities.ProcessHeader).then(le).then(Pe).then(function(e){o(e)}).catch(function(i){if(!k){k=true;z();o(Be(e,t))}else{r(i)}})})};var we=function(e){let t={html:null,header:null,action:e};return new Promise(function(e,i){se(t).then(TBUtilities.ProcessHeader).then(le).then(deleteCommentStudioRequest).then(function(t){e(t)}).catch(function(e){i(e)})})};var ke=function(e,t){let i={html:null,header:null,pageToken:null,query:e,maxToReturn:t};return new Promise(function(e,t){se(i).then(TBUtilities.ProcessHeader).then(le).then(getCommentsStudioRequest).then(function(t){e(t)}).catch(function(e){t(e)})})};var xe=function(e){let t={html:null,header:null,pageToken:null,maxToReturn:e};return new Promise(function(e,i){se(t).then(TBUtilities.ProcessHeader).then(le).then(Ee).then(function(t){e(t)}).catch(function(e){i(e)})})};var Be=function(e,t,i=true){let o={html:null,header:null,pageToken:null,maxToReturn:e,publicOnly:t,filterPremiere:i};return new Promise(function(i,r){se(o).then(TBUtilities.ProcessHeader).then(le).then(De).then(function(e){i(e)}).catch(function(o){if(!k){k=true;z();i(Be(e,t))}else{r(o)}})})};var je=function(e,t){let i={html:null,header:null,pageToken:null,videoId:e,mask:t};return new Promise(function(e){const t=se(i).then(TBUtilities.ProcessHeader).then(le).then(Re);e(t)})};var Le=function(e){return new Promise(function(t,i){var o=TBUtilities.BuildContextRequestObject(e.html);TBUtilities.Log("Do not forget to eventually convert dates");var r={nodes:[{key:"0__KEY_METRIC_TOTAL_QUERY",value:{query:{dimensions:[],metrics:[],restricts:[{dimension:{type:"USER"},inValues:[""]}],orders:[],timeRange:{dateIdRange:{inclusiveStart:"",exclusiveEnd:""}},currency:"USD"}}}],context:o};TBUtilities.Log("analyticsGetSummaryChannelData nodes");r.nodes[0].value.query.restricts[0].inValues=TBGlobal.CurrentChannelId();r.nodes[0].value.query.timeRange.dateIdRange.inclusiveStart=new Date(e.startDate).getFullYear().toString()+(new Date(e.startDate).getMonth()+1).toString().padStart(2,"0")+new Date(e.startDate).getDate().toString().padStart(2,"0");r.nodes[0].value.query.timeRange.dateIdRange.exclusiveEnd=new Date(e.endDate).getFullYear().toString()+(new Date(e.endDate).getMonth()+1).toString().padStart(2,"0")+new Date(e.endDate).getDate().toString().padStart(2,"0");jQuery.each(e.metrics,function(e,t){r.nodes[0].value.query.metrics.push({type:t})});var n=TBUtilities.ParseInnerTubeApiKey(e.html);var a="https://studio.youtube.com/youtubei/v1/analytics_data/join?alt=json&key="+n;TBUtilities.Log("analyticsGetSummaryChannelData posting!");TBUtilities.Log(r);TBExtension.Post(a,JSON.stringify(r),function(o,r,n){if(o===true){jQuery.each(n.results[0].value.resultTable.resultColumns,function(t,i){e.resultData.push({Type:i.column.type,Value:i.values[0].double})});t(e)}else{i("error get videos list")}},null,{dataType:"json",cache:false,contentType:"application/json"},e.header)})};var Ce=function(e){return new Promise(function(t,i){var o=TBUtilities.BuildContextRequestObject(e.html);TBUtilities.Log("analyticsGetDailyChannelData");var r={nodes:[{key:"0__KEY_METRIC_DAILY_QUERY",value:{query:{dimensions:[{type:"DAY"}],metrics:[],restricts:[{dimension:{type:"USER"},inValues:[""]}],orders:[{dimension:{type:"DAY"},direction:"ANALYTICS_ORDER_DIRECTION_ASC"}],timeRange:{dateIdRange:{inclusiveStart:"",exclusiveEnd:""}},currency:"USD"}}}],context:o};TBUtilities.Log("analyticsGetDailyChannelData nodes");r.nodes[0].value.query.restricts[0].inValues=TBGlobal.CurrentChannelId();r.nodes[0].value.query.timeRange.dateIdRange.inclusiveStart=new Date(e.startDate).getFullYear().toString()+(new Date(e.startDate).getMonth()+1).toString().padStart(2,"0")+new Date(e.startDate).getDate().toString().padStart(2,"0");r.nodes[0].value.query.timeRange.dateIdRange.exclusiveEnd=new Date(e.endDate).getFullYear().toString()+(new Date(e.endDate).getMonth()+1).toString().padStart(2,"0")+new Date(e.endDate).getDate().toString().padStart(2,"0");jQuery.each(e.metrics,function(e,t){r.nodes[0].value.query.metrics.push({type:t})});var n=TBUtilities.ParseInnerTubeApiKey(e.html);var a="https://studio.youtube.com/youtubei/v1/analytics_data/join?alt=json&key="+n;TBUtilities.Log("analyticsGetDailyChannelData posting!");TBUtilities.Log(r);TBExtension.Post(a,JSON.stringify(r),function(o,r,n){if(o===true){if(n.results[0].value.resultTable.resultColumns[0].values){for(var a=0;a<n.results[0].value.resultTable.resultColumns[0].values.length;a++){var s={};s.Date=new Date(0).setUTCSeconds(n.results[0].value.resultTable.resultColumns[0].values[a].double);jQuery.each(e.metrics,function(e,t){s["'"+n.results[0].value.resultTable.resultColumns[e+1].column.type+"'"]=n.results[0].value.resultTable.resultColumns[e+1].values[a].double});e.resultData.push(s)}}t(e)}else{i("error get analyticsGetDailyChannelData")}},null,{dataType:"json",cache:false,contentType:"application/json"},e.header)})};var Qe=function(e){return new Promise(function(t,i){var o=TBUtilities.BuildContextRequestObject(e.html);var r={nodes:[{key:"0__KEY_METRIC_DAILY_QUERY",value:{query:{dimensions:[{type:"DAY"}],metrics:[],restricts:[{dimension:{type:"USER"},inValues:[""]},{dimension:{type:"VIDEO"},inValues:["#VIDEOID#"]}],orders:[{dimension:{type:"DAY"},direction:"ANALYTICS_ORDER_DIRECTION_ASC"}],timeRange:{dateIdRange:{inclusiveStart:"",exclusiveEnd:""}},currency:"USD"}}}],context:o};r.nodes[0].value.query.restricts[0].inValues=TBGlobal.CurrentChannelId();r.nodes[0].value.query.restricts[1].inValues=e.videoId;r.nodes[0].value.query.timeRange.dateIdRange.inclusiveStart=new Date(e.startDate).getFullYear().toString()+(new Date(e.startDate).getMonth()+1).toString().padStart(2,"0")+new Date(e.startDate).getDate().toString().padStart(2,"0");r.nodes[0].value.query.timeRange.dateIdRange.exclusiveEnd=new Date(e.endDate).getFullYear().toString()+(new Date(e.endDate).getMonth()+1).toString().padStart(2,"0")+new Date(e.endDate).getDate().toString().padStart(2,"0");jQuery.each(e.metrics,function(e,t){r.nodes[0].value.query.metrics.push({type:t})});var n=TBUtilities.ParseInnerTubeApiKey(e.html);var a="https://studio.youtube.com/youtubei/v1/analytics_data/join?alt=json&key="+n;TBExtension.Post(a,JSON.stringify(r),function(o,r,n){if(o===true){if(n.results[0].value.resultTable.resultColumns[0].values){for(var a=0;a<n.results[0].value.resultTable.resultColumns[0].values.length;a++){var s={};s.Date=new Date(0).setUTCSeconds(n.results[0].value.resultTable.resultColumns[0].values[a].double);jQuery.each(e.metrics,function(e,t){if(n.results[0].value.resultTable.resultColumns[e+1].values[a].double){s[n.results[0].value.resultTable.resultColumns[e+1].column.type]=n.results[0].value.resultTable.resultColumns[e+1].values[a].double}else{s[n.results[0].value.resultTable.resultColumns[e+1].column.type]=0}});e.resultData.push(s)}}e.html="";t(e)}else{i("error get analyticsGetDailyVideoData")}},null,{dataType:"json",cache:false,contentType:"application/json"},e.header)})};var Ue=function(e){return new Promise(function(t,i){var o=TBUtilities.BuildContextRequestObject(e.html);var r={nodes:[{key:"0__TOP_ENTITIES_TABLE_QUERY_KEY",value:{query:{dimensions:[{type:"TRAFFIC_SOURCE_DETAIL"}],metrics:[],restricts:[{dimension:{type:"TRAFFIC_SOURCE_TYPE"},inValues:["YT_SEARCH"]},{dimension:{type:"VIDEO"},inValues:["#VIDEOID#"]}],orders:[{metric:{type:"VIEWS"},direction:"ANALYTICS_ORDER_DIRECTION_DESC"}],timeRange:{dateIdRange:{inclusiveStart:"",exclusiveEnd:""}},currency:"USD"}}}],context:o};r.nodes[0].value.query.restricts[1].inValues=e.videoId;r.nodes[0].value.query.timeRange.dateIdRange.inclusiveStart=new Date(e.startDate).getFullYear().toString()+(new Date(e.startDate).getMonth()+1).toString().padStart(2,"0")+new Date(e.startDate).getDate().toString().padStart(2,"0");r.nodes[0].value.query.timeRange.dateIdRange.exclusiveEnd=new Date(e.endDate).getFullYear().toString()+(new Date(e.endDate).getMonth()+1).toString().padStart(2,"0")+new Date(e.endDate).getDate().toString().padStart(2,"0");jQuery.each(e.metrics,function(e,t){r.nodes[0].value.query.metrics.push({type:t})});var n=TBUtilities.ParseInnerTubeApiKey(e.html);var a="https://studio.youtube.com/youtubei/v1/analytics_data/join?alt=json&key="+n;TBExtension.Post(a,JSON.stringify(r),function(o,r,n){if(o===true){if(n.results[0].value.resultTable.resultColumns[0].values){for(var a=0;a<n.results[0].value.resultTable.resultColumns[0].values.length;a++){var s={};s.SearchTerm=n.results[0].value.resultTable.resultColumns[0].values[a].string;s.SearchTerm=TBUtilities.ReplaceAll(s.SearchTerm,"YT_SEARCH.","");s.VIEWS=n.results[0].value.resultTable.resultColumns[1].values[a].double;if(n.results[0].value.resultTable.resultColumns[1].values[a].double>0){e.resultData.push(s)}}}e.html="";t(e)}else{i("error get analyticsGetVideoSearchTermTrafficTotalsData")}},null,{dataType:"json",cache:false,contentType:"application/json"},e.header)})};var Ie=function(e){return new Promise(function(t,i){var o=TBUtilities.BuildContextRequestObject(e.html);var r={nodes:[{key:"0__TOTALS_SUMS_QUERY_KEY",value:{query:{dimensions:[{type:"TRAFFIC_SOURCE_TYPE"}],metrics:[],restricts:[{dimension:{type:"USER"},inValues:[""]},{dimension:{type:"VIDEO"},inValues:["#VIDEOID#"]}],orders:[],timeRange:{dateIdRange:{inclusiveStart:"",exclusiveEnd:""}},currency:"USD"}}}],context:o};r.nodes[0].value.query.restricts[0].inValues=TBGlobal.CurrentChannelId();r.nodes[0].value.query.restricts[1].inValues=e.videoId;r.nodes[0].value.query.timeRange.dateIdRange.inclusiveStart=new Date(e.startDate).getFullYear().toString()+(new Date(e.startDate).getMonth()+1).toString().padStart(2,"0")+new Date(e.startDate).getDate().toString().padStart(2,"0");r.nodes[0].value.query.timeRange.dateIdRange.exclusiveEnd=new Date(e.endDate).getFullYear().toString()+(new Date(e.endDate).getMonth()+1).toString().padStart(2,"0")+new Date(e.endDate).getDate().toString().padStart(2,"0");jQuery.each(e.metrics,function(e,t){r.nodes[0].value.query.metrics.push({type:t})});var n=TBUtilities.ParseInnerTubeApiKey(e.html);var a="https://studio.youtube.com/youtubei/v1/analytics_data/join?alt=json&key="+n;TBExtension.Post(a,JSON.stringify(r),function(o,r,n){if(o===true){if(n.results[0].value.resultTable.resultColumns[0].values){for(var a=0;a<n.results[0].value.resultTable.resultColumns[0].values.length;a++){var s={};s.TrafficSource=n.results[0].value.resultTable.resultColumns[0].values[a].string;jQuery.each(e.metrics,function(e,t){if(n.results[0].value.resultTable.resultColumns[e+1].values[a].double)s[t]=n.results[0].value.resultTable.resultColumns[e+1].values[a].double;else s[t]=0});e.resultData.push(s)}}e.html="";t(e)}else{i("error get analyticsGetSummaryVideoTrafficSourcesTotalsData")}},null,{dataType:"json",cache:false,contentType:"application/json"},e.header)})};var Se=function(e){return new Promise(function(t,i){var o=TBUtilities.BuildContextRequestObject(e.html);var r={nodes:[{key:"0__TOTALS_SUMS_QUERY_KEY",value:{query:{metrics:[],restricts:[{dimension:{type:"USER"},inValues:[""]},{dimension:{type:"VIDEO"},inValues:["#VIDEOID#"]}],orders:[],timeRange:{dateIdRange:{inclusiveStart:"",exclusiveEnd:""}},currency:"USD"}}}],context:o};r.nodes[0].value.query.restricts[0].inValues=TBGlobal.CurrentChannelId();r.nodes[0].value.query.restricts[1].inValues=e.videoId;r.nodes[0].value.query.timeRange.dateIdRange.inclusiveStart=new Date(e.startDate).getFullYear().toString()+(new Date(e.startDate).getMonth()+1).toString().padStart(2,"0")+new Date(e.startDate).getDate().toString().padStart(2,"0");r.nodes[0].value.query.timeRange.dateIdRange.exclusiveEnd=new Date(e.endDate).getFullYear().toString()+(new Date(e.endDate).getMonth()+1).toString().padStart(2,"0")+new Date(e.endDate).getDate().toString().padStart(2,"0");jQuery.each(e.metrics,function(e,t){r.nodes[0].value.query.metrics.push({type:t})});var n=TBUtilities.ParseInnerTubeApiKey(e.html);var a="https://studio.youtube.com/youtubei/v1/analytics_data/join?alt=json&key="+n;TBUtilities.Log("analyticsGetSummaryVideoData posting!");TBUtilities.Log(r);TBExtension.Post(a,JSON.stringify(r),function(o,r,n){TBUtilities.Log("Back!"+e.videoId);TBUtilities.Log(n);if(o===true){var a={};jQuery.each(e.metrics,function(e,t){if(n.results[0].value.resultTable.resultColumns[e].values){if(n.results[0].value.resultTable.resultColumns[e].values[0].double)a[n.results[0].value.resultTable.resultColumns[e].column.type]=n.results[0].value.resultTable.resultColumns[e].values[0].double;else a[n.results[0].value.resultTable.resultColumns[e].column.type]=0}});e.resultData=a;e.html="";t(e)}else{i("error get analyticsGetSummaryVideoData")}},null,{dataType:"json",cache:false,contentType:"application/json"},e.header)})};var Ae=function(e){return new Promise(function(t,i){var o=TBUtilities.BuildContextRequestObject(e.html);var r={nodes:[{key:"0__AUDIENCE_ONLINE_QUERY_KEY",value:{query:{dimensions:[{type:"HOUR_OF_WEEK"}],limitedToBatchedData:false,metrics:[{type:"USERS_ONLINE"}],restricts:[{dimension:{type:"USER"},inValues:[""]}],returnDataInNewFormat:true,orders:[{dimension:{type:"HOUR_OF_WEEK"},direction:"ANALYTICS_ORDER_DIRECTION_ASC"}],timeRange:{unboundedRange:{}}}}}],context:o};TBUtilities.Log("analyticsGetAudienceOnlineHourlyData nodes");r.nodes[0].value.query.restricts[0].inValues=TBGlobal.CurrentChannelId();var n=TBUtilities.ParseInnerTubeApiKey(e.html);var a="https://studio.youtube.com/youtubei/v1/analytics_data/join?alt=json&key="+n;TBUtilities.Log("analyticsGetAudienceOnlineHourlyData posting!");TBUtilities.Log(r);TBExtension.Post(a,JSON.stringify(r),function(o,r,n){if(o===true){jQuery.each(n.results[0].value.resultTable.metricColumns[0].ratios.values,function(t,i){e.resultData.push({Value:i})});t(e)}else{i("error get analyticsGetAudienceOnlineHourlyData")}},null,{dataType:"json",cache:false,contentType:"application/json"},e.header)})};deleteCommentStudioRequest=function(e){return new Promise(function(t,i){var o=TBUtilities.BuildContextRequestObject(e.html);var r={context:o,actions:[e.action]};var n=TBUtilities.ParseInnerTubeApiKey(e.html);var a="https://studio.youtube.com/youtubei/v1/comment/perform_comment_action?alt=json&key="+n;TBExtension.Post(a,JSON.stringify(r),function(o,r,n){if(o===true){t(e.action)}else{i(n.error.message)}},null,{dataType:"json",cache:false,contentType:"application/json"},e.header)})};getCommentsStudioRequest=function(e){return new Promise(function(t,i){var o=TBUtilities.BuildContextRequestObject(e.html);var r={context:o,channelId:TBGlobal.CurrentChannelId(),commentsFilter:{commentContains:{value:e.query}},commentsFilterForHeldForReviewTab:{},commentsFilterForSpamTab:{},maxReplies:10,moderationState:"PUBLISHED",searchQuery:"",sortOrder:"NEWEST"};if(e.continuation){r.continuation=e.continuation}var n=TBUtilities.ParseInnerTubeApiKey(e.html);var a="https://studio.youtube.com/youtubei/v1/comment/get_comments?alt=json&key="+n;if(e.commentsList==null)e.commentsList=[];if(e.commentsList.length>=e.maxToReturn){t(e)}TBExtension.Post(a,JSON.stringify(r),function(o,r,n){if(o===true){const o=n.continuationContents!=undefined?n.continuationContents.itemSectionContinuation:n.contents.itemSectionRenderer;const r=o.contents;if(!r.length){i({message:"No comments were found.",response:JSON.stringify(n)})}jQuery.each(r,function(t,i){if(i.commentThreadRenderer==undefined){return}if(i.commentThreadRenderer.comment.commentRenderer.authorIsChannelOwner){return}if(i.commentThreadRenderer.comment.commentRenderer.authorText.simpleText!=e.query){return}const o=i.commentThreadRenderer.comment.commentRenderer;const r=o.actionMenu.menuRenderer.items;const n=r.filter(e=>e.menuServiceItemRenderer!=undefined).filter(e=>e.menuServiceItemRenderer.icon.iconType=="DELETE");const a=r.filter(e=>e.menuServiceItemRenderer!=undefined).filter(e=>e.menuServiceItemRenderer.icon.iconType=="BLOCK");const s={id:o.commentId,name:o.authorText.simpleText,comment:o.contentText.runs[0].text,videoId:o.videoThumbnail.commentVideoThumbnailRenderer.videoId,thumbnail:o.videoThumbnail.commentVideoThumbnailRenderer.thumbnail.thumbnails[1].url,title:o.videoThumbnail.commentVideoThumbnailRenderer.title.simpleText,delete:n[0].menuServiceItemRenderer.serviceEndpoint.performCommentActionEndpoint.action,block:a[0].menuServiceItemRenderer.serviceEndpoint.performCommentActionEndpoint.action};e.commentsList.push(s)});const a=o.continuations!=undefined?o.continuations[0]:null;if(a){e.continuation=a.nextContinuationData.continuation;getCommentsStudioRequest(e).then(e=>{t(e)})}else{t(e)}}else{i({message:"Error retrieving comments.",response:JSON.stringify(n)})}},null,{dataType:"json",cache:false,contentType:"application/json"},e.header)})};var Ee=function(e){return new Promise(function(t,i){var o=TBUtilities.BuildContextRequestObject(e.html);var r={context:o,channelId:TBGlobal.CurrentChannelId(),commentsFilterForHeldForReviewTab:{},commentsFilterForSpamTab:{},maxReplies:10,moderationState:"PUBLISHED",searchQuery:"",sortOrder:"NEWEST"};if(e.continuation){r.continuation=e.continuation}var n=TBUtilities.ParseInnerTubeApiKey(e.html);var a="https://studio.youtube.com/youtubei/v1/comment/get_comments?alt=json&key="+n;if(e.commentsList==null)e.commentsList=[];if(e.commentsList.length>=e.maxToReturn){t(e)}if(!e.commentGrouping){e.commentGrouping={}}TBExtension.Post(a,JSON.stringify(r),function(o,r,n){if(o===true){const o=n.continuationContents!=undefined?n.continuationContents.itemSectionContinuation:n.contents.itemSectionRenderer;const r=o.contents;if(!r.length){i({message:"No comments were found.",response:JSON.stringify(n)})}jQuery.each(r,function(t,i){if(i.commentThreadRenderer==undefined){return}if(i.commentThreadRenderer.comment.commentRenderer.authorIsChannelOwner){return}const o=i.commentThreadRenderer.comment.commentRenderer;const r=o.authorText.simpleText;const n=o.actionMenu.menuRenderer.items;const a=o.authorEndpoint.urlEndpoint.url.split("/");const s=a[a.length-1];const l=n.filter(e=>e.menuServiceItemRenderer!=undefined).filter(e=>e.menuServiceItemRenderer.icon.iconType=="DELETE");const d=o.videoThumbnail.commentVideoThumbnailRenderer.videoId;const u={comment_id:o.commentId,commenter_channel_id:s,comment:o.contentText.runs[0].text};if(e.commentGrouping[d]===undefined){e.commentGrouping[d]={video_id:d,comments:[]};e.commentGrouping[d].comments.push(u)}else{e.commentGrouping[d].comments.push(u)}e.commentsList.push({commenter_name:r,delete:l[0].menuServiceItemRenderer.serviceEndpoint.performCommentActionEndpoint.action,...u})});const a=o.continuations!=undefined?o.continuations[0]:null;if(a){e.continuation=a.nextContinuationData.continuation;Ee(e).then(e=>{e.commentGrouping=Object.keys(e.commentGrouping).map(t=>{return e.commentGrouping[t]}).filter(e=>e.comments.length>0);t(e)})}else{e.commentGrouping=Object.keys(e.commentGrouping).map(t=>{return e.commentGrouping[t]}).filter(e=>e.comments.length>0);t(e)}}else{i({message:"Error retrieving comments.",response:JSON.stringify(n)})}},null,{dataType:"json",cache:false,contentType:"application/json"},e.header)})};var De=function(e){return new Promise(function(t,i){var o=TBUtilities.BuildContextRequestObject(e.html);var r={filter:{and:{operands:[{channelIdIs:{value:""}},{videoOriginIs:{value:"VIDEO_ORIGIN_UPLOAD"}}]}},order:"VIDEO_ORDER_DISPLAY_TIME_DESC",pageSize:50,mask:{videoId:true,status:true,title:true,timeCreatedSeconds:true,timePublishedSeconds:true,origin:true,privacy:true,thumbnailDetails:{all:true},metrics:{all:true},premiere:{all:true},remix:{all:true},audienceRestriction:{all:true},ageRestriction:true},context:o};if(e.pageToken){r.pageToken=e.pageToken}r.filter.and.operands[0].channelIdIs.value=TBGlobal.CurrentChannelId();var n=TBUtilities.ParseInnerTubeApiKey(e.html);var a="https://studio.youtube.com/youtubei/v1/creator/list_creator_videos?alt=json&key="+n;if(e.videosList==null)e.videosList=[];TBExtension.Post(a,JSON.stringify(r),function(o,r,n){if(o===true){jQuery.each(n.videos,function(t,i){TBUtilities.Log("Skip check");if(e.publicOnly&&i.privacy!="VIDEO_PRIVACY_PUBLIC"){TBUtilities.Log("Skipping because not public");return}if(e.filterPremiere){if(i.premiere!=undefined&&!i.premiere.isArchived){return}}if(e.maxToReturn==null||e.videosList.length<e.maxToReturn)e.videosList.push(i)});if(n.nextPageToken&&(e.maxToReturn==null||e.videosList.length<e.maxToReturn)){e.pageToken=n.nextPageToken;e.response=n;De(e).then(e=>{t(e)})}else{TBUtilities.Log("no, nextPageToken or found MaxNeeded");e.response=n;t(e)}}else{i("error get videos list")}},null,{dataType:"json",cache:false,contentType:"application/json"},e.header)})};var Re=function(e){return new Promise(function(t,i){var o=TBUtilities.BuildContextRequestObject(e.html);let r={channelId:true,videoId:true,videoDurationMs:true,status:true,title:true,description:true,timeCreatedSeconds:true,timePublishedSeconds:true,origin:true,privacy:true,thumbnailDetails:{all:true},metrics:{all:true},premiere:{all:true},remix:{all:true},audienceRestriction:{all:true},ageRestriction:true};if(e.mask!=undefined){r=e.mask}var n={mask:r,criticalRead:false,failOnError:true,context:o,videoIds:[e.videoId]};var a=TBUtilities.ParseInnerTubeApiKey(e.html);var s="https://studio.youtube.com/youtubei/v1/creator/get_creator_videos?alt=json&key="+a;TBExtension.Post(s,JSON.stringify(n),function(e,o,r){if(e===false||r.videos==undefined||r.videos.length==0){i(r)}const n=r.videos[0];t(n)},null,{dataType:"json",cache:false,contentType:"application/json"},e.header)})};var Pe=function(e){return new Promise(function(t,i){var o=TBUtilities.BuildContextRequestObject(e.html);var r={filter:{and:{operands:[{channelIdIs:{value:""}},{and:{operands:[{or:{operands:[{and:{operands:[{classicMonetizationIs:{value:"CLASSIC_MONETIZATION_STATUS_LIMITED_ADS"}},{not:{operand:{isDraft:{}}}}]}}]}},{videoOriginIs:{value:"VIDEO_ORIGIN_UPLOAD"}}]}}]}},order:"VIDEO_ORDER_DISPLAY_TIME_DESC",pageSize:50,mask:{videoId:true,status:true,title:true,timeCreatedSeconds:true,timePublishedSeconds:true,origin:true,privacy:true,thumbnailDetails:{all:true},allRestrictions:{all:true}},context:o};if(e.pageToken){r.pageToken=e.pageToken}r.filter.and.operands[0].channelIdIs.value=TBGlobal.CurrentChannelId();var n=TBUtilities.ParseInnerTubeApiKey(e.html);var a="https://studio.youtube.com/youtubei/v1/creator/list_creator_videos?alt=json&key="+n;if(e.videosList==null)e.videosList=[];TBExtension.Post(a,JSON.stringify(r),function(o,r,n){if(o===true){jQuery.each(n.videos,function(t,i){TBUtilities.Log("Skip check");if(e.publicOnly&&i.privacy!="VIDEO_PRIVACY_PUBLIC"){TBUtilities.Log("Skipping because not public");return}if(i.status=="VIDEO_STATUS_REJECTED"){TBUtilities.Log("Video was rejected");return}if(e.maxToReturn==null||e.videosList.length<e.maxToReturn)e.videosList.push(i)});if(n.nextPageToken&&(e.maxToReturn==null||e.videosList.length<e.maxToReturn)){e.pageToken=n.nextPageToken;e.response=n;Pe(e).then(e=>{t(e)})}else{TBUtilities.Log("no, nextPageToken or found MaxNeeded");e.response=n;t(e)}}else{i("error get videos list")}},null,{dataType:"json",cache:false,contentType:"application/json"},e.header)})};var Ge=function(e,t,i){let o={html:null,videoIdToEdit:e,endScreenStartMs:t,elementsToCopy:i,header:null,copyResponse:null};return new Promise(function(e,t){se(o).then(TBUtilities.ProcessHeader).then(le).then(lt).then(_e).then(function(t){e(t)}).catch(function(e){t(e)})})};var Oe=function(e){let t={html:null,videoId:e,header:null,response:null};return new Promise(function(e,i){se(t).then(TBUtilities.ProcessHeader).then(le).then(Ve).then(function(t){e(t)}).catch(function(e){i(e)})})};var Ve=function(e){return new Promise(function(t,i){TBUtilities.Log("IN: editVideoStudio");var o=TBUtilities.BuildContextRequestObject(e.html);var r={encryptedVideoId:e.videoId,remix:{newRemixSourceOption:"MDE_REMIX_SOURCE_OPTION_OPT_OUT_AND_MUTE_DERIVATIVES",operation:"MDE_REMIX_UPDATE_OPERATION_SET"},context:o,videoReadMask:{origin:true}};if(o.user.delegationContext!=undefined){r.delegationContext=o.user.delegationContext}var n=TBUtilities.ParseInnerTubeApiKey(e.html);var a="https://studio.youtube.com/youtubei/v1/video_manager/metadata_update?alt=json&key="+n;TBExtension.Post(a,JSON.stringify(r),function(o,r,n){if(o===true){TBUtilities.Log("Successfully submitted!");TBUtilities.Log(n);t(e)}else{TBUtilities.Log("Failed to submit!");i("error editVideoStudio")}},null,{dataType:"json",cache:false,contentType:"application/json"},e.header)})};var _e=function(e){return new Promise(function(t,i){var o=TBUtilities.BuildContextRequestObject(e.html);e.elementsToCopy=We(e.elementsToCopy);var r={endscreenEdit:{endscreen:{responseStatus:{statusCode:"CREATOR_ENTITY_STATUS_OK"},encryptedVideoId:e.videoIdToEdit,startMs:e.endScreenStartMs,elements:e.elementsToCopy}},externalVideoId:e.videoIdToEdit,context:o};var n=TBUtilities.ParseInnerTubeApiKey(e.html);var a="https://studio.youtube.com/youtubei/v1/video_editor/edit_video?alt=json&key="+n;TBExtension.Post(a,JSON.stringify(r),function(o,r,n,a){if(o===true){e.response=n;t(e)}else{var s="Error copying end screen elements";try{var l=JSON.parse(n);if(l.error&&l.error.message){if(l.error.message.indexOf("Width must remain within allowed range")>-1){s="Video aspect ratio / resolution mismatch. Try copying from videos of same the aspect ratio or resolution."}else{s=l.error.message}}}catch(e){TBUtilities.Log(e)}i(s)}},null,{dataType:"json",cache:false,contentType:"application/json"},e.header)})};var Me=function(e,t,i,o,r,n,a){TBUtilities.Log("YouTubeActions.js|copyEndCardElements");var s={action_save:1,encrypted_video_id:e,impressionUrls:[],isNonStandardAspectRatio:"False",minStartMs:o,session_token:n,skip:"False",startMs:i,status:200,v:e,elements:[]};s.elements=Fe(r);var l="https://www.youtube.com/endscreen_ajax?v="+e;TBExtension.Post(l,JSON.stringify(s),function(t,i,o){try{if(t){if(o["errors"]!=undefined&&o.errors.length>=1){var n=o.errors[0];if(n&&n.indexOf("Width must remain within allowed range")>-1){n="Video aspect ratio / resolution mismatch. Try copying from videos of same the aspect ratio or resolution."}a(false,e,o,n);return}if(o["elements"]!=undefined&&o.for_editor.elements.length!=r.length){var n="";a(false,e,o,n);return}else{a(true,e,o);return}}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|copyEndCardElements",Data:i,Response:o});a(false,e,o,o)}}catch(t){TBUtilities.LogError({Exception:t,Location:"YouTubeActions.js|copyEndCardElements"});a(false,e,o,o)}},null,{dataType:"json",cache:false,contentType:"application/json"})};var Fe=function(e){var t=[];jQuery.each(e,function(e,i){switch(i.type){case"CHANNEL":{if(i.isSubscribe){delete i["clickUrls"];delete i["cta"];delete i["dismissUrls"];delete i["fallbackReason"];delete i["hoverUrls"];i.id=TBUtilities.CreateGuid();delete i["imageUrl"];delete i["impressionUrls"];delete i["playlistId"];delete i["playlistLength"];delete i["sessionData"];delete i["urlCheckOk"];delete i["websiteType"];t.push(i)}else{delete i["clickUrls"];delete i["cta"];delete i["dismissUrls"];delete i["fallbackReason"];delete i["hoverUrls"];delete i["htmlBlob"];delete i["iconUrl"];i.id=TBUtilities.CreateGuid();delete i["imageUrl"];delete i["impressionUrls"];delete i["playlistId"];delete i["playlistLength"];delete i["sessionData"];delete i["subscriberCount"];delete i["urlCheckOk"];delete i["websiteType"];delete i["videoDuration"];delete i["videoId"];delete i["videoType"];t.push(i)}break}case"WEBSITE":{delete i["channelId"];delete i["clickUrls"];delete i["dismissUrls"];delete i["fallbackReason"];delete i["hoverUrls"];delete i["htmlBlob"];i.id=TBUtilities.CreateGuid();delete i["impressionUrls"];delete i["isSubscribe"];delete i["playlistId"];delete i["playlistLength"];delete i["sessionData"];delete i["subscriberCount"];delete i["urlCheckOk"];delete i["imageUrl"];delete i["imageBlob"];delete i["imagefile"];if(i.websiteEndscreenElement){delete i.websiteEndscreenElement["customUploadedImage"];delete i.websiteEndscreenElement["icon"]}t.push(i);break}case"VIDEO":{delete i["callToAction"];delete i["channelId"];delete i["clickUrls"];delete i["cta"];delete i["dismissUrls"];delete i["fallbackReason"];delete i["hoverUrls"];delete i["htmlBlob"];delete i["iconUrl"];i.id=TBUtilities.CreateGuid();delete i["imageUrl"];delete i["impressionUrls"];delete i["isSubscribe"];delete i["playlistId"];delete i["playlistLength"];delete i["sessionData"];delete i["subscriberCount"];delete i["urlCheckOk"];delete i["websiteType"];t.push(i);break}case"PLAYLIST":{delete i["callToAction"];delete i["channelId"];delete i["clickUrls"];delete i["cta"];delete i["dismissUrls"];delete i["fallbackReason"];delete i["hoverUrls"];delete i["htmlBlob"];delete i["iconUrl"];i.id=TBUtilities.CreateGuid();delete i["imageUrl"];delete i["impressionUrls"];delete i["isSubscribe"];delete i["sessionData"];delete i["subscriberCount"];delete i["urlCheckOk"];delete i["websiteType"];delete i["videoType"];t.push(i);break}}});return t};var Ne=function(e){let t={videoId:e,html:document.documentElement.outerHTML,header:null,authedUser:null,www:true,headers:{}};return new Promise(function(e,i){TBUtilities.ProcessHeader(t).then(le).then(de).then(Ye).then(function(t){e(t)}).catch(function(e){i(e)})})};var Ye=function(e){return new Promise(function(t,i){let o=TBUtilities.BuildContextRequestObject(e.html);if(o.client!=undefined&&o.client.visitorData!=undefined){n.headers["x-google-visitor-id"]=o.client.visitorData}const r={contentCheckOk:false,context:o,racyCheckOk:false,videoId:e.videoId};const n={method:"POST",headers:e.headers,mode:"same-origin",body:JSON.stringify(r),credentials:"same-origin"};const a=TBUtilities.ParseInnerTubeApiKey(e.html);const s=`https://www.youtube.com/youtubei/v1/player?key=${a}`;if(TBExtension.GetType()=="firefox"){fetch=content.fetch}console.log("makeVideoPlayerRequest",n);fetch(s,n).then(e=>e.json()).then(e=>t(e))})};var He=function(e){return new Promise(function(t,i){let o=JSON.parse(TBUtilities.ParseInnerTubeContext(document.head.innerText));o.client.originalUrl=`https://www.youtube.com/results?search_query=${e.query}`;o.client.mainAppWebInfo={webDisplayMode:"WEB_DISPLAY_MODE_BROWSER",graftUrl:`/results?search_query=${e.query}`};const r={context:o,query:e.query};const n=TBUtilities.ParseInnerTubeApiKey(e.html);const a=`https://www.youtube.com/youtubei/v1/search?key=${n}`;const s={method:"POST",headers:e.headers,mode:"same-origin",body:JSON.stringify(r),credentials:"same-origin"};if(TBExtension.GetType()=="firefox"){fetch=content.fetch}fetch(a,s).then(e=>e.json()).then(e=>t(e))})};var We=function(e){var t=[];jQuery.each(e,function(e,i){if(!i.existing){delete i["id"]}switch(i.type){case"CHANNEL":{if(i.channelEndscreenElement.isSubscribe){delete i.channelEndscreenElement["icon"];i.channelEndscreenElement.channelId=TBGlobal.CurrentChannelId();t.push(i)}else{t.push(i)}break}case"WEBSITE":{if(i.websiteEndscreenElement&&!i.existing){delete i.websiteEndscreenElement["customUploadedImage"];delete i.websiteEndscreenElement["icon"]}t.push(i);break}case"VIDEO":{if(i.videoEndscreenElement&&!i.existing){delete i.videoEndscreenElement["playbackStartMs"]}t.push(i);break}case"PLAYLIST":{t.push(i);break}case"MERCH":{t.push(i);break}}delete i["type"]});return t};var ze=function(e){var t=[];jQuery.each(e,function(e,i){switch(i.type){case"CHANNEL":{if(i.channelEndscreenElement.isSubscribe){i.channelEndscreenElement.channelId=TBGlobal.CurrentChannelId()}t.push(i);break}case"WEBSITE":{t.push(i);break}case"VIDEO":{t.push(i);break}case"PLAYLIST":{t.push(i);break}case"MERCH":{t.push(i);break}}});return t};var qe=function(e,t,i,o){TBUtilities.Log("YouTubeActions.js|deleteAllEndCardElementsWithUrl");return new Promise(function(r,n){re(e).then(function(a){if(typeof a.elements!=="undefined"&&a.elements&&a.elements.length>0){var s=a.elements.length;var l=[];var d=i.replace(/^http:\/\//i,"https://");var u=i.replace(/^https:\/\//i,"http://");for(var c=0;c<s;c++){var p="";var h=a.elements[c];switch(h.type){case"WEBSITE":{p=h.websiteEndscreenElement.targetUrl;break}case"VIDEO":{switch(h.videoEndscreenElement.videoType){case"VIDEO_TYPE_RECENT_UPLOAD":{break}case"VIDEO_TYPE_FIXED":{p=h.videoEndscreenElement.encryptedVideoId;break}case"VIDEO_TYPE_BEST_FOR_VIEWER":{break}}break}case"PLAYLIST":{p=h.playlistEndscreenElement.playlistId;break}}if(p!=""){if(o===true&&(p.toLowerCase().trim().indexOf(d.toLowerCase().trim())>=0||p.toLowerCase().trim().indexOf(u.toLowerCase().trim())>=0)||!o&&(p.toLowerCase().trim()==u.toLowerCase().trim()||p.toLowerCase().trim()==d.toLowerCase().trim())){l.push(h)}}}jQuery.each(l,function(e,t){var i=jQuery.inArray(t,a.elements);if(i!==-1){a.elements.splice(i,1)}});if(l.length>0){Ge(e,t,a.elements).then(function(){r()}).catch(function(e){n(e)})}else{r()}}else{r()}}).catch(function(e){n(e)})})};var Ke=function(e,t,i,o){TBUtilities.Log("TubeBuddyYouTubeActions - deleteAllEndCardElements");var r={action_save:1,encrypted_video_id:e.videoId,impressionUrls:[],isNonStandardAspectRatio:"False",minStartMs:t.destVideoMilliseconds-2e4,session_token:i,skip:"False",startMs:t.destVideoMilliseconds-2e4,v:e.videoId,elements:[]};var n="https://www.youtube.com/endscreen_ajax?v="+e.videoId;TBExtension.Post(n,JSON.stringify(r),function(i,r,n){try{if(i){if(n.for_editor.elements.length!=0){var a="Error deleting endscreen elements";o(false,e,t,n,a)}else{o(true,e,t,n)}}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|deleteAllEndCardElements",Data:r,Response:n});o(false,e,t,n)}}catch(i){TBUtilities.LogError({Exception:i,Location:"YouTubeActions.js|deleteAllEndCardElements"});o(false,e,t,n)}},null,{contentType:"application/json",dataType:"json",cache:false})};var Je=function(e,t,i,o,r){TBUtilities.Log("TubeBuddyYouTubeActions - addEndCardElement");var n=new FormData;n.append("id","");n.append("type",t);n.append("encrypted_video_id",e);n.append("start_ms",i);n.append("video_type",showWarnings);n.append("video_item_id",videoItemId);n.append("video_url",videoUrl);n.append("action_create_video",actionCreateVideo);n.append("session_token",o);var a="https://www.youtube.com/endscreen_ajax?v="+e;TBExtension.Post(a,n,function(t,i,o){try{if(t){r(true,e,o)}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|addEndCardElement",Data:i,Response:o});r(false,e,o)}}catch(t){TBUtilities.LogError({Exception:t,Location:"YouTubeActions.js|addEndCardElement"});r(false,e,o)}},null,{cache:false,contentType:undefined,dataType:null})};var Xe=function(e,t,i,o){TBUtilities.Log("YouTubeActions.js|addWebsiteElementUpload");var r=new FormData;r.append("id","");r.append("type","associated");r.append("encrypted_video_id",e);r.append("endscreen",'{"skip":false,"startMs":'+t.startMs+',"impressionUrls":["https://www.youtube.com/player_204?id=endscreen&v='+e+'&event=iv&a-type=500&iv-event=2"],"minStartMs":'+t.startMs+',"elements":[],"isNonStandardAspectRatio":false,"trackingParams":""}');r.append("end_ms",0);r.append("start_ms",t.startMs);r.append("image_url","");r.append("target_url",t.targetUrl);r.append("title",t.title);r.append("cta",3);r.append("imagefile",t.imagefile);r.append("action_create_associated",1);var n="https://www.youtube.com/endscreen_ajax?v="+e;TBExtension.Post(n,r,function(e,i,r){try{TBUtilities.Log("YouTubeActions.js|addWebsiteElementUpload success = "+e);if(e){try{var n=jQuery.parseHTML(DOMPurify.sanitize(r,DOMPurifyConfig));TBUtilities.Log("YouTubeActions.js|addWebsiteElementUpload html = "+n);var a={};try{a=jQuery.parseJSON(n[4].innerHTML)}catch(e){TBUtilities.LogError({Exception:e,Location:"YouTubeActions.js|addWebsiteElementUpload method 1 fail"});try{a=jQuery.parseJSON(n[2].innerHTML)}catch(e){TBUtilities.LogError({Exception:e,Location:"YouTubeActions.js|addWebsiteElementUpload method 2 fail"});a=jQuery.parseJSON(n[5].innerHTML)}}var s=a.for_editor.elements["0"].uploadedImage;t.uploadedImage=s;o(t)}catch(e){TBUtilities.LogError({Exception:e,Location:"YouTubeActions.js|addWebsiteElementUpload method 3 fail"});t.uploadedImage=null;o(t)}}else{TBUtilities.LogFailedWebRequest({Location:loggingLocation,Data:i,Response:r});o()}}catch(e){TBUtilities.LogError({Exception:e,Location:loggingLocation});o()}},null,{timeout:28e4,cache:false,contentType:undefined,dataType:null,processData:false})};var Ze=function(e,t,i){TBUtilities.Log("TubeBuddyYouTubeActions - unpublishAnnotations");var o=new FormData;o.append("action_unpublish_annotations","1");o.append("session_token",t);var r="https://www.youtube.com/endscreen_ajax?v="+e+"&encrypted_video_id="+e;TBExtension.Post(r,o,function(t,o,r){try{if(t){i(true,e,r)}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|unpublishAnnotations",Data:o,Response:r});i(false,e,r)}}catch(t){TBUtilities.LogError({Exception:t,Location:"YouTubeActions.js|unpublishAnnotations"});i(false,e,r)}},null,{dataType:null,contentType:undefined,cache:false})};var $e=function(e){let t={html:null,videoId:e,header:null,response:null};return new Promise(function(e,i){se(t).then(TBUtilities.ProcessHeader).then(le).then(et).then(function(t){if(t){tt(t)}e(t)}).catch(function(e){i(e)})})};var et=function(e){return new Promise(function(t,i){var o=TBUtilities.BuildContextRequestObject(e.html);var r={context:o,videoId:e.videoId};var n=TBUtilities.ParseInnerTubeApiKey(e.html);var a="https://studio.youtube.com/youtubei/v1/creator/list_creator_info_cards?alt=json&key="+n;TBExtension.Post(a,JSON.stringify(r),function(e,o,r){if(e===true){t(r.infoCards)}else{i("error getting cards")}},null,{dataType:"json",cache:false,contentType:null},e.header)})};var tt=function(e){jQuery.each(e,function(e,t){if(t.videoInfoCard){t.type="video"}else if(t.playlistInfoCard){t.type="playlist"}else if(t.collaboratorInfoCard){t.type="collaborator"}else if(t.associatedWebsiteInfoCard){t.type="associated"}else if(t.merchandiseInfoCard){t.type="merch"}else if(t.merchInfoCard){t.type="merch"}else if(t.fundraisingInfoCard){t.type="fund"}else if(t.productInfoCard){t.type="product"}})};var it=function(e,t,i,o){return new Promise(function(r,n){let a={videoId:e,success:false,cards:[],url:t,text:i,includePartial:o,cardsDeleted:0};$e(e).then(function(e){a.cards=e;if(a.cards){var t=[];a.cards.forEach(function(e,i){if(a.url){var o=a.url.replace(/^http:\/\//i,"https://");var r=a.url.replace(/^https:\/\//i,"http://");var n="";switch(e.type){case"fund":{n=e.fundraisingInfoCard.targetUrl;break}case"product":{n=e.productInfoCard.targetUrl;break}case"associated":{n=e.associatedWebsiteInfoCard.targetUrl;break}}if(a.includePartial===true&&(n.toLowerCase().trim().indexOf(o.toLowerCase().trim())>=0||n.toLowerCase().trim().indexOf(r.toLowerCase().trim())>=0)||!a.includePartial&&(n.toLowerCase().trim()==r.toLowerCase().trim()||n.toLowerCase().trim()==o.toLowerCase().trim())){t.push(e)}}else if(a.text){var s;if(e.teaserText){s=e.teaserText;TBUtilities.Log("text: "+s.toLowerCase().trim());TBUtilities.Log("includePartialMatches: "+a.includePartial);TBUtilities.Log("Teaser Text Contains: "+(a.includePartial===true&&s.toLowerCase().trim().indexOf(a.text.toLowerCase().trim())>=0)||!a.includePartial&&s.toLowerCase().trim()==a.text.toLowerCase().trim());if(a.includePartial===true&&s.toLowerCase().trim().indexOf(a.text.toLowerCase().trim())>=0||!a.includePartial&&s.toLowerCase().trim()==a.text.toLowerCase().trim()){t.push(e)}}}});if(t.length>0){t.forEach(function(e,t){TBUtilities.Log("Removing card: "+e.infoCardId);TBUtilities.RemoveFromArray(a.cards,"infoCardId",e.infoCardId)});a.cardsDeleted=t.length;ot(a.videoId,a.cards).then(function(){a.success=true;r(a)}).catch(function(e){n("Error copying video cards")})}else{a.success=true;r(a)}}else{a.success=true;r(a)}}).catch(function(e){n("Error getting video cards")})})};var ot=function(e,t,i){let o={html:null,videoIdToEdit:e,cardsToCopy:t,header:null,copyResponse:null,isUpdate:i};return new Promise(function(e,t){se(o).then(TBUtilities.ProcessHeader).then(le).then(st).then(rt).then(function(t){e(t)}).catch(function(e){t(e)})})};var rt=function(e){return new Promise(function(t,i){var o=TBUtilities.BuildContextRequestObject(e.html);var r=0;e.cardsToCopy.forEach(function(t){if(t.newAddition&&t.newAddition===true){at(e.videoIdToEdit,t,r);r++}else{nt(e.videoIdToEdit,t)}});var n={infoCardEdit:{infoCards:e.cardsToCopy},externalVideoId:e.videoIdToEdit,context:o};var a=TBUtilities.ParseInnerTubeApiKey(e.html);var s="https://studio.youtube.com/youtubei/v1/video_editor/edit_video?alt=json&key="+a;TBUtilities.Log("copyCardsStudioRequest request - "+JSON.stringify(n));TBUtilities.Log("copyCardsStudioRequest url - "+s);TBExtension.Post(s,JSON.stringify(n),function(o,r,n,a){if(o===true){e.response=n;t(e)}else{var s="Error copying cards";try{var l=JSON.parse(n);if(l.error&&l.error.message){s=l.error.message}}catch(e){TBUtilities.Log(e)}i(s)}},null,{dataType:"json",cache:false,contentType:"application/json"},e.header)})};var nt=function(e,t){delete t["type"];t.videoId=e;return t};var at=function(e,t,i){delete t["infoCardId"];delete t["type"];delete t["newAddition"];t.infoCardEntityId="new-addition-"+i;t.videoId=e;if(t.customUploadedImage){delete t["customUploadedImage"]}if(t.responseStatus){delete t["responseStatus"]}if(t.associatedWebsiteInfoCard&&t.associatedWebsiteInfoCard.displayDomain){t.associatedWebsiteInfoCard.displayDomain=""}return t};var st=function(e){return new Promise(function(t,i){let o=[];let r=0;jQuery.each(e.cardsToCopy,function(e,t){if(t.newAddition&&t.newAddition===true)switch(t.type){case"product":case"fund":case"merch":case"associated":{if(t.customUploadedImage&&t.customUploadedImage.url){o.push(t.customUploadedImage.url)}else if(t.externalImageUrl){o.push(t.externalImageUrl)}break}}});if(o.length>0){var n=[];o.forEach(function(a){var s=TBGlobal.host+TBGlobal.apiUrls.imageGetBytes+"?url="+encodeURIComponent(a);TBExtension.Get(s,function(a,s,l){r++;if(a===true){var d=JSON.parse(l).split(",")[1];var u={url:s,dataUrl:d};n.push(u)}else{i("error converting image to data url = "+s)}if(r>=o.length){jQuery.each(e.cardsToCopy,function(e,t){if(t.type==="associated"||t.type==="fund"||t.type==="product"||t.type==="merch"){let e=null;if(t.customUploadedImage&&t.customUploadedImage.url){e=n.find(e=>e.url===t.customUploadedImage.url)}else if(t.externalImageUrl){e=n.find(e=>e.url===t.externalImageUrl)}if(e){t.imageDataUrl=e.dataUrl}}});t(e)}},a)})}else{t(e)}})};var lt=function(e){return new Promise(function(t,i){let o=[];let r=0;jQuery.each(e.elementsToCopy,function(e,t){if(!t.existing){switch(t.type){case"WEBSITE":{if(t.websiteEndscreenElement.customUploadedImage&&t.websiteEndscreenElement.customUploadedImage.url){o.push(t.websiteEndscreenElement.customUploadedImage.url)}else if(t.websiteEndscreenElement.externalImageUrl){o.push(t.websiteEndscreenElement.externalImageUrl)}break}}}});if(o.length>0){var n=[];o.forEach(function(a){var s=TBGlobal.host+TBGlobal.apiUrls.imageGetBytes+"?url="+encodeURIComponent(a);TBExtension.Get(s,function(a,s,l){r++;if(a===true){var d=JSON.parse(l).split(",")[1];var u={url:s,dataUrl:d};n.push(u)}else{i("error converting image to data url = "+s)}if(r>=o.length){jQuery.each(e.elementsToCopy,function(e,t){if(t.type==="WEBSITE"){let e=null;if(t.websiteEndscreenElement.customUploadedImage&&t.websiteEndscreenElement.customUploadedImage.url){e=n.find(e=>e.url===t.websiteEndscreenElement.customUploadedImage.url)}else if(t.websiteEndscreenElement.externalImageUrl){e=n.find(e=>e.url===t.websiteEndscreenElement.externalImageUrl)}if(e){t.websiteEndscreenElement.imageDataUrl=e.dataUrl}}});t(e)}},a)})}else{t(e)}})};var dt=function(e,t){TBUtilities.Log("TubeBuddyYouTubeActions - getCardList");var i="https://www.youtube.com/cards_ajax?v="+e+"&action_list=1";TBUtilities.Log(i);TBExtension.Get(i,function(e,i,o){try{if(e){t(o)}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|getCardList",Data:i,Response:o});t(null)}}catch(e){TBUtilities.LogError({Exception:e,Location:"YouTubeActions.js|getCardList"});t(null)}},null,{dataType:"json"})};var ut=function(e,t){TBUtilities.Log("TubeBuddyYouTubeActions - getEndScreenList");var i="https://www.youtube.com/endscreen_ajax?v="+e+"&encrypted_video_id="+e+"&action_load=1";TBUtilities.Log(i);TBExtension.Get(i,function(e,i,o){try{if(e){t(o)}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|getEndScreenList",Data:i,Response:o});t(null)}}catch(e){TBUtilities.LogError({Exception:e,Location:"YouTubeActions.js|getEndScreenList"});t(null)}},null,{dataType:"json"})};var ct=function(e,t,i,o,r,n){TBUtilities.Log("TubeBuddyYouTubeActions - deleteAllCards");a=i;d=0;u=0;p=0;c=0;s={url:o,text:n,videoId:e};var l="https://www.youtube.com/cards_ajax?v="+e+"&action_list=1";TBUtilities.Log("getting all cards from url = "+l);TBExtension.Get(l,function(i,a,s){try{if(i){d=s.feature_templates.length;TBUtilities.Log("card count = "+d);if(d==0){Bt(true,e)}else{var l=0;jQuery.each(s.feature_templates,function(i,a){l++;TBUtilities.Log("CARD DETAILS");TBUtilities.Log(a);if(o){var s=o.replace(/^http:\/\//i,"https://");var d=o.replace(/^https:\/\//i,"http://");var u=a.target_url;if(!u)u=a.channel_url;if(!u)u="";if(r===true&&(u.toLowerCase().trim().indexOf(s.toLowerCase().trim())>=0||u.toLowerCase().trim().indexOf(d.toLowerCase().trim())>=0)||!r&&(u.toLowerCase().trim()==d.toLowerCase().trim()||u.toLowerCase().trim()==s.toLowerCase().trim())){let i=TubeBuddyCards.CardDeleteDelay()*l;setTimeout(function(){TubeBuddyYouTubeActions.DeleteCard(e,a.key,a.type,a.start_ms,"False",e,"","",t,TubeBuddyYouTubeActions.BulkCardDeleted)},i)}else{Bt(true,e,a.key)}}else if(n){var c=a.title;var p=a.teaser_text;TBUtilities.Log("Card Title: "+c.toLowerCase().trim());TBUtilities.Log("text: "+n.toLowerCase().trim());TBUtilities.Log("includePartialMatches: "+r);TBUtilities.Log("Title Contains: "+(r===true&&c.toLowerCase().trim().indexOf(n.toLowerCase().trim())>=0)||!r&&c.toLowerCase().trim()==n.toLowerCase().trim());TBUtilities.Log("Teaser Text Contains: "+(r===true&&p.toLowerCase().trim().indexOf(n.toLowerCase().trim())>=0)||!r&&p.toLowerCase().trim()==n.toLowerCase().trim());if(r===true&&c.toLowerCase().trim().indexOf(n.toLowerCase().trim())>=0||!r&&c.toLowerCase().trim()==n.toLowerCase().trim()||(r===true&&p.toLowerCase().trim().indexOf(n.toLowerCase().trim())>=0||!r&&p.toLowerCase().trim()==n.toLowerCase().trim())){TBUtilities.Log("Text Match, Delete. ");let i=TubeBuddyCards.CardDeleteDelay()*l;setTimeout(function(){TubeBuddyYouTubeActions.DeleteCard(e,a.key,a.type,a.start_ms,"False",e,"","",t,TubeBuddyYouTubeActions.BulkCardDeleted)},i)}else{Bt(true,e,a.key)}}else{let i=TubeBuddyCards.CardDeleteDelay()*l;setTimeout(function(){TubeBuddyYouTubeActions.DeleteCard(e,a.key,a.type,a.start_ms,"False",e,"","",t,TubeBuddyYouTubeActions.BulkCardDeleted)},i)}})}}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|deleteAllCards",Data:a,Response:s});Bt(false,e)}}catch(t){TBUtilities.LogError({Exception:t,Location:"YouTubeActions.js|deleteAllCards"});Bt(false,e)}},null,{dataType:"json"})};var pt=function(e,t,i,o,r,n,a,s,l,d){TBUtilities.Log("YouTubeActions.js|deleteCard");var u=new FormData;u.append("key",t);u.append("type",i);u.append("start_ms",o);u.append("show_warnings",r);u.append("video_item_id",n);u.append("video_url",a);u.append("start_time",s);u.append("session_token",l);if(!v[t]){v[t]=1}else{let e=v[t];e++;v[t]=e}var c="https://www.youtube.com/cards_ajax?v="+e+"&action_delete=1";TBExtension.Post(c,u,function(u,c,p){try{if(u){d(true,e,t)}else{let u=v[t];if(u&&u<=3){pt(e,t,i,o,r,n,a,s,l,d)}else{if(u){delete v[t]}TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|deleteCard",Data:c,Response:p});d(false,e,t)}}}catch(i){TBUtilities.LogError({Exception:i,Location:"YouTubeActions.js|deleteCard"});d(false,e,t)}},null,{contentType:undefined,dataType:null,cache:false})};var ht=function(e,t){var i="https://www.youtube.com/watch?v="+e;TBExtension.Get(i,function(e,i,o){try{if(e){var r=[];if(o.indexOf('"keywords":"')>0){var n=o.indexOf('"keywords":"')+'"keywords":"'.length;var a=o.indexOf('"',n);var s=o.substring(n,a);jQuery.each(s.split(","),function(e,t){if(t!=""){var i=ft(t);if(i){r.push(i)}}})}else if(o.indexOf('","keywords":[')>0){var n=o.indexOf('","keywords":[')+'","keywords":['.length;var a=o.indexOf("],",n);var s=o.substring(n,a-1);jQuery.each(s.split(","),function(e,t){if(t!=""){var i=ft(t);if(i){r.push(i)}}})}else if(o.indexOf('true,"keywords":[')>0){var n=o.indexOf('true,"keywords":[')+'true,"keywords":['.length;var a=o.indexOf("],",n);var s=o.substring(n,a-1);jQuery.each(s.split(","),function(e,t){if(t!=""){var i=ft(t);if(i){r.push(i)}}})}if(r.length==0&&o.indexOf('window["ytInitialPlayerResponse"] = ')!=-1){var l=TBUtilities.ParsePlayerResponseFromHtml(o);if(l&&l.videoDetails.keywords&&l.videoDetails.keywords.length>0){r=l.videoDetails.keywords}}if(r.length==0){try{var d=o.indexOf('<meta property="og:video:tag" content="');var u=o.lastIndexOf('<meta property="og:video:tag" content="');if(d!=-1&&u!=-1){var c=o.indexOf('">',u);var p=o.substring(d,c+1);p=p.replace(m,"");var h=jQuery(p).filter('meta[property="og:video:tag"]');jQuery.each(h,function(e,t){var i=jQuery(t).attr("content");if(i&&i!=""){var o=ft(i);if(o){r.push(o)}}})}}catch(e){TBUtilities.Log(e)}}t(r)}else{t([])}}catch(e){t([])}})};var yt=function(e,t){TBUtilities.Log("YouTubeActions.js|getVideoInfo "+e);if(e===null){t(null);return}var i="https://www.youtube.com/watch?v="+e;TBExtension.Get(i,function(i,o,r){try{if(i){var n={tags:[],channelid:null,channelname:null,channelsubscribers:null,title:null,description:null,views:null,likes:null,dislikes:null,publishDate:null,channelThumbnail:null,isNew:false,age:null};try{if(r.indexOf('"keywords":"')>0){var a=r.indexOf('"keywords":"')+'"keywords":"'.length;var s=r.indexOf('"',a);var l=r.substring(a,s);jQuery.each(l.split(","),function(e,t){if(t!==""){var i=ft(t);if(i){n.tags.push(i)}}})}else if(r.indexOf('","keywords":[')>0){var a=r.indexOf('","keywords":[')+'","keywords":['.length;var s=r.indexOf("]",a);var l=r.substring(a,s);jQuery.each(l.split(","),function(e,t){if(t!=""){var i=ft(t);if(i){n.tags.push(i)}}})}if(n.tags.length==0&&r.indexOf('window["ytInitialPlayerResponse"] = ')!=-1){var d=TBUtilities.ParsePlayerResponseFromHtml(r);if(d.videoDetails.keywords&&d.videoDetails.keywords.length>0){jQuery.each(d.videoDetails.keywords,function(e,t){if(t&&t!=""){var i=ft(t);if(i){n.tags.push(i)}}})}}if(n.tags.length==0){var u=DOMPurify.sanitize(r,DOMPurifyConfig);var c=jQuery(u).filter('meta[property="og:video:tag"]');jQuery.each(c,function(e,t){var i=jQuery(t).attr("content");if(i&&i!=""){var o=ft(i);if(o){n.tags.push(o)}}})}var p=TBUtilities.ParseResponseContextFromHtml(r);var h=0;var y=0;for(var b=0;b<p.contents.twoColumnWatchNextResults.results.results.contents.length;b++){if(p.contents.twoColumnWatchNextResults.results.results.contents[b].videoSecondaryInfoRenderer){h=b;break}}for(var b=0;b<p.contents.twoColumnWatchNextResults.results.results.contents.length;b++){if(p.contents.twoColumnWatchNextResults.results.results.contents[b].videoPrimaryInfoRenderer){y=b;break}}try{n.channelThumbnail=p.contents.twoColumnWatchNextResults.results.results.contents[h].videoSecondaryInfoRenderer.owner.videoOwnerRenderer.thumbnail.thumbnails["0"].url}catch(e){TBUtilities.Log(e)}n.channelsubscribers=0;if(p.contents.twoColumnWatchNextResults.results.results.contents[y].videoPrimaryInfoRenderer.title.runs){n.title=p.contents.twoColumnWatchNextResults.results.results.contents[y].videoPrimaryInfoRenderer.title.runs[0].text}if(p.contents.twoColumnWatchNextResults.results.results.contents[h].videoSecondaryInfoRenderer.description&&p.contents.twoColumnWatchNextResults.results.results.contents[h].videoSecondaryInfoRenderer.description.simpleText){n.description=p.contents.twoColumnWatchNextResults.results.results.contents[h].videoSecondaryInfoRenderer.description.simpleText}else if(p.contents.twoColumnWatchNextResults.results.results.contents[h].videoSecondaryInfoRenderer.description&&p.contents.twoColumnWatchNextResults.results.results.contents[h].videoSecondaryInfoRenderer.description.runs&&p.contents.twoColumnWatchNextResults.results.results.contents[h].videoSecondaryInfoRenderer.description.runs.length>0){var f="";try{jQuery.each(p.contents.twoColumnWatchNextResults.results.results.contents[h].videoSecondaryInfoRenderer.description.runs,function(e,t){f+=t.text})}catch(e){TBUtilities.Log(e)}n.description=f}else{n.description=""}var m=p.contents.twoColumnWatchNextResults.results.results.contents[y].videoPrimaryInfoRenderer.viewCount.videoViewCountRenderer.viewCount.simpleText;g=null;if(m)g=m.match(/\d/g);if(g==null){g=0}else{g=g.join("")}n.views=parseInt(g);var v=p.contents.twoColumnWatchNextResults.results.results.contents[y].videoPrimaryInfoRenderer.videoActions.menuRenderer.topLevelButtons["0"].toggleButtonRenderer.accessibility.label;var g=v.match(/\d/g);if(g==null){g=0}else{g=g.join("")}n.likes=parseInt(g);var T=p.contents.twoColumnWatchNextResults.results.results.contents[y].videoPrimaryInfoRenderer.videoActions.menuRenderer.topLevelButtons[1].toggleButtonRenderer.accessibility.label;var g=T.match(/\d/g);if(g==null){g=0}else{g=g.join("")}n.dislikes=parseInt(g);if(p.contents.twoColumnWatchNextResults.results.results.contents[h].videoSecondaryInfoRenderer.owner.videoOwnerRenderer.navigationEndpoint.browseEndpoint.browseId){n.channelid=p.contents.twoColumnWatchNextResults.results.results.contents[h].videoSecondaryInfoRenderer.owner.videoOwnerRenderer.navigationEndpoint.browseEndpoint.browseId}if(p.contents.twoColumnWatchNextResults.results.results.contents[h].videoSecondaryInfoRenderer.owner.videoOwnerRenderer.title&&p.contents.twoColumnWatchNextResults.results.results.contents[h].videoSecondaryInfoRenderer.owner.videoOwnerRenderer.title.runs.length>0){n.channelname=p.contents.twoColumnWatchNextResults.results.results.contents[h].videoSecondaryInfoRenderer.owner.videoOwnerRenderer.title.runs[0].text}try{if(p.contents.twoColumnWatchNextResults.results.results.contents[h].videoSecondaryInfoRenderer.owner.videoOwnerRenderer.subscriberCountText){if(p.contents.twoColumnWatchNextResults.results.results.contents[h].videoSecondaryInfoRenderer.owner.videoOwnerRenderer.subscriberCountText.runs&&p.contents.twoColumnWatchNextResults.results.results.contents[h].videoSecondaryInfoRenderer.owner.videoOwnerRenderer.subscriberCountText.runs.length>0){n.channelsubscribers=p.contents.twoColumnWatchNextResults.results.results.contents[h].videoSecondaryInfoRenderer.owner.videoOwnerRenderer.subscriberCountText.runs[0].text}else if(p.contents.twoColumnWatchNextResults.results.results.contents[h].videoSecondaryInfoRenderer.owner.videoOwnerRenderer.subscriberCountText.simpleText){n.channelsubscribers=p.contents.twoColumnWatchNextResults.results.results.contents[h].videoSecondaryInfoRenderer.owner.videoOwnerRenderer.subscriberCountText.simpleText}}}catch(e){TBUtilities.LogError({Exception:e,Location:"YouTubeActions.GetVideoInfo - channel subscribers"})}try{var w=p.contents.twoColumnWatchNextResults.results.results.contents[y].videoPrimaryInfoRenderer.dateText.simpleText;if(w&&w.indexOf("Published on ")!==-1){var k=bt(w," ",2);var x=w.substring(k,w.length);var B=new Date(x.trim());n.publishDate=B}}catch(e){console.log(e)}try{const e='publishDate":"';let t=r.indexOf(e);if(t!==-1){let i=r.indexOf('","',t+e.length);n.publishDate=r.substring(t+e.length,i);let o=moment(n.publishDate);let a=moment();n.age=a.diff(o,"days");if(n.age<=3){n.isNew=true}}}catch(e){console.log(e)}}catch(e){TBUtilities.LogError(e)}finally{t(n)}}else{TBUtilities.Log("YouTubeActions.js|getVideoInfo - error getting video info for video id "+e);t(null)}}catch(i){TBUtilities.LogError({Exception:i,Location:"YouTubeActions.js|getVideoInfo "+e});t(null)}})};var bt=function(e,t,i){return e.split(t,i).join(t).length};var ft=function(e){var t=e.replace(/["']/g,"");t=t.replace("\\u0027","");t=t.replace("\\u0026","&");t=t.replace("&","&");t=t.replace(/\\\//g,"/");if(t){return t.toLowerCase()}else{return null}};var mt=function(e,t){TBUtilities.Log("YouTubeActions.js|getChannelInfoFromPage");TBUtilities.Log(e);TBExtension.Get(e,function(i,o,r){try{if(i){var n={ChannelId:null,Tags:null,Title:null};try{var a=TBUtilities.IsResponseContextFound(r);var s=TBGlobal.GetYouTubeUI();if(s=="default"&&a===true)s="material";switch(s){case"studio":case"material":{n.Title=jQuery("#channel-title").text();var l=TBUtilities.ParseResponseContextFromHtml(r);try{if(l.metadata&&l.header){n.Tags=l.metadata.channelMetadataRenderer.keywords;n.ChannelId=l.header.c4TabbedHeaderRenderer.channelId}else if(l.contents.twoColumnWatchNextResults){n.ChannelId=l.contents.twoColumnWatchNextResults.results.results.contents[1].videoSecondaryInfoRenderer.subscribeButton.subscribeButtonRenderer.channelId}else{throw"Unable to find channel id"}}catch(e){try{var d=r.indexOf('window["ytInitialData"] = ');d=d+26;var u=r.substring(d,r.length);var c=u.indexOf("};")+1;var u=u.substring(0,c);var l=jQuery.parseJSON(u);n.ChannelId=l.metadata.channelMetadataRenderer.externalId}catch(e){}}break}case"default":{var p=jQuery.parseHTML(DOMPurify.sanitize(r,DOMPurifyConfig));n.ChannelId=jQuery(p).find("meta[itemprop=channelId]").first().attr("content");if(!n.ChannelId){try{TBUtilities.Log("TubeBuddyYouTubeActions _currentChannelId is not found, second attempt");var h=e.substr(e.lastIndexOf("/")+1);if(h.length==24){_currentChannelId=h}}catch(e){n.ChannelId=null}}break}}}catch(e){n.ChannelId=null}t(n)}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|getChannelInfoFromPage",Data:o,Response:r});t(null)}}catch(e){TBUtilities.LogError({Exception:e,Location:"YouTubeActions.js|getChannelInfoFromPage"});t(null)}},null,{cache:false})};var vt=function(e){var t=e;var i=["mil","tis.","mln.","???.","k"];var o=["mio.","mil.","???","m"];for(var r=0;r<i.length;r++){if((e.indexOf(i[r])>=0||e.toLowerCase().indexOf(i[r])>=0)&&e.toLowerCase().indexOf("mil.")==-1){e=TBUtilities.ReplaceAll(e.toLowerCase(),i[r],"");e=TBUtilities.ReplaceAll(e.toLowerCase(),",",".");return 1e3*Number(e)}}for(var r=0;r<o.length;r++){if(e.indexOf(o[r])>=0||e.toLowerCase().indexOf(o[r])>=0){e=TBUtilities.ReplaceAll(e.toLowerCase(),o[r],"");e=TBUtilities.ReplaceAll(e.toLowerCase(),",",".");return 1e6*Number(e)}}e=TBUtilities.ReplaceAll(e.toLowerCase(),".","");e=TBUtilities.ReplaceAll(e.toLowerCase(),",","");return num};var gt=function(e,t,i){var o={success:true,channelViews:null,channelViewsFormatted:null,channelPublishDate:null,subscribers:null,subscribersFormatted:null,socialProfiles:[],channelId:null,subscribersDisplay:""};var r=null;if(typeof e=="undefined"||e==null){o.success=false;t(o);return}e=e.replace(/^http:\/\//i,"https://");var n=e.substr(e.lastIndexOf("/")+1);if(n&&n.length==24&&typeof i==="undefined"){TBUtilities.Log("getChannelInfoFromAboutPage - channelid = "+n);r=n;o=h[r];if(o){TBUtilities.Log("getChannelInfoFromAboutPage - cached channelInfo found for channel id = "+r);t(o);return}}var a=e+"/about";TBExtension.Get(a,function(e,i,o){try{if(!e){TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|getChannelInfoFromAboutPage",Data:i,Response:o})}var r={success:true,channelViews:null,channelViewsFormatted:null,channelPublishDate:null,subscribers:null,subscribersFormatted:null,socialProfiles:[],channelId:null,subscribersFromHeader:null,subscribersFromHeaderFormatted:null,subscribersDisplay:""};var n="";try{var a=TBGlobal.GetYouTubeUI();if(o.indexOf('window["ytInitialData"] = ')>-1){a="material"}if(o.indexOf('"canonical"')>10){var s=o.indexOf('"canonical"');s=o.indexOf('href="https://www.youtube.com/channel/',s)+'href="https://www.youtube.com/channel/'.length;r.channelId=o.substring(s,s+24);n=r.channelId}switch(a){case"studio":case"material":{r.success=false;TBUtilities.Log("PHIL ytUI");var l=TBUtilities.ParseResponseContextFromHtml(o);var d=null;jQuery.each(l.contents.twoColumnBrowseResultsRenderer.tabs,function(e,t){if(t.tabRenderer&&t.tabRenderer.endpoint.commandMetadata.webCommandMetadata.url.indexOf("about")!=-1){d=t;return true}});TBUtilities.Log("PHIL b4Views");var u="0";try{if(d.tabRenderer.content.sectionListRenderer.contents["0"].itemSectionRenderer.contents["0"].channelAboutFullMetadataRenderer.viewCountText.runs){u=d.tabRenderer.content.sectionListRenderer.contents["0"].itemSectionRenderer.contents["0"].channelAboutFullMetadataRenderer.viewCountText.runs["0"].text}else if(d.tabRenderer.content.sectionListRenderer.contents["0"].itemSectionRenderer.contents["0"].channelAboutFullMetadataRenderer.viewCountText.simpleText){u=d.tabRenderer.content.sectionListRenderer.contents["0"].itemSectionRenderer.contents["0"].channelAboutFullMetadataRenderer.viewCountText.simpleText}var c=u.match(/\d/g);c=c.join("");r.channelViews=c;r.channelViewsFormatted=TBUtilities.FormatNumberAbbreviated(r.channelViews)}catch{r.channelViews=0;r.channelViewsFormatted="NA"}var p="";if(d.tabRenderer.content.sectionListRenderer.contents["0"].itemSectionRenderer.contents["0"].channelAboutFullMetadataRenderer.joinedDateText.runs){p=d.tabRenderer.content.sectionListRenderer.contents["0"].itemSectionRenderer.contents["0"].channelAboutFullMetadataRenderer.joinedDateText.runs["1"].text}else if(d.tabRenderer.content.sectionListRenderer.contents["0"].itemSectionRenderer.contents["0"].channelAboutFullMetadataRenderer.joinedDateText.simpleText){p=d.tabRenderer.content.sectionListRenderer.contents["0"].itemSectionRenderer.contents["0"].channelAboutFullMetadataRenderer.joinedDateText.simpleText}try{r.channelPublishDate=moment(p.trim(),"MMM DD, YYYY")}catch(e){TBUtilities.Log(e)}var y="";try{if(l.header.c4TabbedHeaderRenderer.subscribeButton.subscribeButtonRenderer.subscriberCountText!=undefined){y=l.header.c4TabbedHeaderRenderer.subscribeButton.subscribeButtonRenderer.subscriberCountText.simpleText}else if(l.header.c4TabbedHeaderRenderer.subscriberCountText.simpleText!=undefined){y=l.header.c4TabbedHeaderRenderer.subscriberCountText.simpleText.split(" ")[0]}}catch{try{y=l.header.c4TabbedHeaderRenderer.subscriberCountText.runs[0].text;if(y.indexOf(" ")>0){y=y.substring(0,y.indexOf(" "))}}catch{}}r.subscribersDisplay=y;try{y=vt(y);var b=y;r.subscribers=b;r.subscribersFormatted=TBUtilities.FormatNumberAbbreviated(r.subscribers);r.subscribersFromHeader=y;r.subscribersFromHeaderFormatted=TBUtilities.FormatNumberAbbreviated(r.subscribersFromHeader)}catch{r.subscribers=y;r.subscribersFormatted=y;r.subscribersFromHeader=y;r.subscribersFromHeaderFormatted=y}r.success=true;if(d.tabRenderer.content.sectionListRenderer.contents["0"].itemSectionRenderer.contents["0"].channelAboutFullMetadataRenderer.primaryLinks){jQuery.each(d.tabRenderer.content.sectionListRenderer.contents["0"].itemSectionRenderer.contents["0"].channelAboutFullMetadataRenderer.primaryLinks,function(e,t){try{var i={image:t.icon.thumbnails["0"].url,url:t.navigationEndpoint.urlEndpoint.url,title:t.title.simpleText};r.socialProfiles.push(i)}catch(e){console.log(e)}})}try{if(l.header.c4TabbedHeaderRenderer.subscriberCountText&&l.header.c4TabbedHeaderRenderer.subscriberCountText.simpleText){var f=l.header.c4TabbedHeaderRenderer.subscriberCountText.simpleText;var m=f.match(/\d/g);m=m.join("");r.subscribersFromHeader=parseInt(m);r.subscribersFromHeaderFormatted=TBUtilities.FormatNumberAbbreviated(r.subscribersFromHeader)}else if(l.header.c4TabbedHeaderRenderer.subscriberCountText&&l.header.c4TabbedHeaderRenderer.subscriberCountText.runs){var f=l.header.c4TabbedHeaderRenderer.subscriberCountText.runs["0"].text;var m=f.match(/\d/g);m=m.join("");r.subscribersFromHeader=parseInt(m);r.subscribersFromHeaderFormatted=TBUtilities.FormatNumberAbbreviated(r.subscribersFromHeader)}}catch(e){console.log(e)}TBUtilities.Log("Final");TBUtilities.Log(r);break}case"default":{var v=jQuery.parseHTML(DOMPurify.sanitize(o,DOMPurifyConfig));r.socialProfiles=[];jQuery(v).find(".about-channel-link.yt-uix-redirect-link").each(function(e,t){try{var i={image:jQuery(this).find("img:first").attr("src"),url:jQuery(this).attr("href"),title:jQuery(this).attr("title")};r.socialProfiles.push(i)}catch(e){console.log(e)}});var g=jQuery(v).find(".about-stat").length;if(g==2){r.subscribers=null;r.subscribersFormatted=null}jQuery(v).find(".about-stat").each(function(e){var t=jQuery(this).html();var i=t.match(/\d/g);i=i.join("");if(g==3){if(e==0){r.subscribers=i;r.subscribersFormatted=TBUtilities.FormatNumberAbbreviated(r.subscribers)}else if(e==1){r.channelViews=i;r.channelViewsFormatted=TBUtilities.FormatNumberAbbreviated(r.channelViews)}else if(e==2){var o=t.indexOf(" ");var n=t.substring(o,t.length);r.channelPublishDate=moment(n.trim(),"MMM DD, YYYY")}}else if(g==2){if(e==0){r.channelViews=i;r.channelViewsFormatted=TBUtilities.FormatNumberAbbreviated(r.channelViews)}else if(e==1){var o=t.indexOf(" ");var n=t.substring(o,t.length);r.channelPublishDate=moment(n.trim(),"MMM DD, YYYY")}}});r.success=true;break}}}catch(e){r={success:true,channelViews:null,channelViewsFormatted:null,channelPublishDate:null,subscribers:null,subscribersFormatted:null,socialProfiles:[],channelId:n};r.success=false;TBUtilities.Log(e)}if(r.success==true){h[n]=r}t(r)}catch(e){TBUtilities.LogError({Exception:e,Location:"YouTubeActions.js|getChannelInfoFromAboutPage"})}},null,{cache:false,contentType:false})};var Tt=function(e,t,i){TBUtilities.Log("YouTubeActions.js|DeleteAnnotations");var o="https://www.youtube.com/my_videos_annotate?feature=vm&v="+e;TBExtension.Get(o,function(o,r,n){try{if(o){var a="";var s=n.match(/"auth_token": "(\S+)"/);if(s!==null)a=s[1];else{var l=n.indexOf('"auth_token":"')+'"auth_token":"'.length;var d=n.indexOf('"',l);a=n.substring(l,d)}var u='<?xml version="1.0" encoding="UTF-8" ?><document>';u+='<requestHeader video_id="'+e+'"/>';u+='<authenticationHeader video_id="'+e+'" '+'auth_token="'+a+'"/>';u+="<deletedItems>";jQuery.each(t,function(e,t){u+='<deletedItem id="'+t.id+'" author="'+t.author+'" />'});u+="</deletedItems>";u+="</document>";var c="https://www.youtube.com/annotations_auth/update2";TBExtension.Post(c,u,function(e,t,o){try{if(e){var r="https://www.youtube.com/annotations_auth/publish2";TBExtension.Post(r,u,function(e,t,o){try{if(e){i()}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|DeleteAnnotations",Data:t,Response:o});i()}}catch(e){TBUtilities.LogError({Exception:e,Location:"YouTubeActions.js|DeleteAnnotations"});i()}},null,{dataType:null,contentType:undefined})}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|DeleteAnnotations",Data:t,Response:o});i()}}catch(e){TBUtilities.LogError({Exception:e,Location:"YouTubeActions.js|DeleteAnnotations"});i()}},null,{dataType:null,contentType:undefined,cache:false})}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|DeleteAnnotations",Data:r,Response:n});i([])}}catch(e){TBUtilities.LogError({Exception:e,Location:"YouTubeActions.js|DeleteAnnotations"});i([])}})};var wt=function(e,t){TBUtilities.Log("YouTubeActions.js|getChannelId");try{if(!e)return null;if(e.substring(0,2)=="UC"&&e.length=="UCvubOhuUIhYoYnRyXHtcygQ".length){t(e);return}if(e.indexOf("/channel/")>0){var i=e.substring(e.indexOf("/channel/")+"/channel/".length,e.indexOf("/channel/")+"/channel/".length+"UCvubOhuUIhYoYnRyXHtcygQ".length);t(i);return}TBUtilities.Log("getting "+e);var o=e;if(e.indexOf("youtube.com")==-1)o="https://www.youtube.com/user/"+e;TBExtension.Get(o,function(i,r,n){try{if(i){TBUtilities.Log("in done1");var a=n.indexOf('itemprop="channelId"');if(a<50)return null;a=n.indexOf('content="',a)+'content="'.length;var s=n.substring(a,a+"UCvubOhuUIhYoYnRyXHtcygQ".length);t(s);TBUtilities.Log("in done done1 "+s)}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|getChannelId",Data:r,Response:n});o="https://www.youtube.com/"+e;TBExtension.Get(o,function(e,i,o){try{if(e){TBUtilities.Log("in done2");var r=o.indexOf('itemprop="channelId"');if(r<50)return null;r=o.indexOf('content="',r)+'content="'.length;var n=o.substring(r,r+"UCvubOhuUIhYoYnRyXHtcygQ".length);t(n);TBUtilities.Log("in done done2 "+n)}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|getChannelId",Data:i,Response:o});t(null)}}catch(e){TBUtilities.LogError({Exception:e,Location:"YouTubeActions.js|getChannelId"});t(null)}})}}catch(e){TBUtilities.LogError({Exception:e,Location:"YouTubeActions.js|getChannelId"})}})}catch(e){return null}};var kt=function(e,t,i,o){TBUtilities.Log("TubeBuddyYouTubeActions - processAnnotationData");var r=[];var n=0;var a="";jQuery(e).find("annotation").each(function(){a+="0";var e={};e.id=jQuery(this).attr("id");e.author=jQuery(this).attr("author");if(e.author==null)e.author="";e.index=n;n=n+1;e.type=jQuery(this).attr("type");e.style=jQuery(this).attr("style");e.log_data=jQuery(this).attr("log_data");e.logable=jQuery(this).attr("logable");e.text=jQuery(this).find("TEXT").text();e.ref=jQuery(this).find("condition").attr("ref");e.url=jQuery(this).find("url").attr("value");e.dockAtStart=false;e.dockAtEnd=false;if(e.url==null)e.url=jQuery(this).find("action").find("url").attr("value");a+="1";switch(e.style){case"anchored":e.display="Speech Bubble";break;case"popup":e.display="Note";break;case"title":e.display="Title";break;case"highlightText":case"highlighttext":e.display="Spotlight";break;case"label":e.display="Label";break;default:e.display="Spotlight Text";break}a+="[Display: "+e.display+"]";e.startTime=jQuery(this).find("movingRegion rectRegion:nth-child(1)").attr("t");if(!e.startTime){e.startTime=jQuery(this).find("movingRegion anchoredRegion:nth-child(1)").attr("t")}if(!e.startTime){e.startTime="never"}var o=[];var s="";var l=[];var d=0;var u=0;var c=0;if(e.startTime!="never"&&e.endTime!="0:00.000"){o=e.startTime.split(".");s=parseInt(o[1]);l=o[0].split(":");d=0;u=0;c=0;if(l.length==3){d=parseInt(l[0]);u=parseInt(l[1]);c=parseInt(l[2])}else{u=parseInt(l[0]);c=parseInt(l[1])}e.startTimeTimeSpan=new TimeSpan(s,c,u,d);e.startTimeTimeMiliseconds=e.startTimeTimeSpan.totalMilliseconds();e.dockAtStart=e.startTimeTimeMiliseconds<i*.15}e.endTime=jQuery(this).find("movingRegion rectRegion:nth-child(2)").attr("t");if(!e.endTime)e.endTime=jQuery(this).find("movingRegion anchoredRegion:nth-child(2)").attr("t");if(!e.endTime)e.endTime="never";var o=[];var s="";var l=[];var d=0;var u=0;var c=0;if(e.startTime!="never"&&e.endTime!="0:00.000"){o=e.startTime.split(".");s=parseInt(o[1]);l=o[0].split(":");d=0;u=0;c=0;if(l.length==3){d=parseInt(l[0]);u=parseInt(l[1]);c=parseInt(l[2])}else{u=parseInt(l[0]);c=parseInt(l[1])}}if(e.endTime!="never"&&e.endTime!="0:00.000"){o=e.endTime.split(".");s=parseInt(o[1]);l=o[0].split(":");d=0;u=0;c=0;if(l.length==3){d=parseInt(l[0]);u=parseInt(l[1]);c=parseInt(l[2])}else{u=parseInt(l[0]);c=parseInt(l[1])}e.endTimeTimeSpan=new TimeSpan(s,c,u,d);e.endTimeTimeMiliseconds=e.endTimeTimeSpan.totalMilliseconds();e.dockAtEnd=e.endTimeTimeMiliseconds>i*.85;e.distanceFromEnd=i-e.endTimeTimeMiliseconds;if(e.distanceFromEnd<0)e.distanceFromEnd=0}if(e.startTimeTimeMiliseconds!=null){if(e.endTimeTimeMiliseconds!=null)e.totalTimeMiliseconds=e.endTimeTimeMiliseconds-e.startTimeTimeMiliseconds;else e.totalTimeMiliseconds=i-e.startTimeTimeMiliseconds}else if(e.endTimeTimeMiliseconds!=null){e.totalTimeMiliseconds=e.endTimeTimeMiliseconds}e.fullXML=jQuery(this).html();e.fullXML=TBUtilities.ReplaceAll(e.fullXML,"highlightfontcolor","highlightFontColor");e.fullXML=TBUtilities.ReplaceAll(e.fullXML,"textsize","textSize");e.fullXML=TBUtilities.ReplaceAll(e.fullXML,"fgcolor","fgColor");e.fullXML=TBUtilities.ReplaceAll(e.fullXML,"borderalpha","borderAlpha");e.fullXML=TBUtilities.ReplaceAll(e.fullXML,"spacerelative","spaceRelative");e.fullXML=TBUtilities.ReplaceAll(e.fullXML,"bgalpha","bgAlpha");e.fullXML=TBUtilities.ReplaceAll(e.fullXML,"bgcolor","bgColor");e.fullXML=TBUtilities.ReplaceAll(e.fullXML,"anchoredregion","anchoredRegion");e.fullXML=TBUtilities.ReplaceAll(e.fullXML,"movingregion","movingRegion");e.fullXML=TBUtilities.ReplaceAll(e.fullXML,"rectregion","rectRegion");if(e.fullXML.indexOf('"></padding>')>0||e.fullXML.indexOf(" ></padding>")>0)e.fullXML=TBUtilities.ReplaceAll(e.fullXML,"></padding>","/>");if(e.fullXML.indexOf('"></appearance>')>0||e.fullXML.indexOf(" ></appearance>")>0)e.fullXML=TBUtilities.ReplaceAll(e.fullXML,"></appearance>","/>");e.fullXML=TBUtilities.ReplaceAll(e.fullXML,"</text>","</TEXT>");e.fullXML=TBUtilities.ReplaceAll(e.fullXML,"<text>","<TEXT>");e.fullXML=TBUtilities.ReplaceAll(e.fullXML,"></condition>","/>");if(e.fullXML.indexOf('"></appearance>')>0||e.fullXML.indexOf(" ></appearance>")>0)e.fullXML=TBUtilities.ReplaceAll(e.fullXML,"></appearance>","/>");e.fullXML=TBUtilities.ReplaceAll(e.fullXML,"></rectregion>","/>");e.fullXMLOriginal=e.fullXML;e.videoId=t;if(e.type!="branding"&&e.type!="promotion"&&e.type!="card"){r.push(e)}});o(r)};var xt=function(e,t){TBUtilities.Log("YouTubeActions.js|getAnnotations");var i=9999;try{i=new timelord(e.contentDetails.duration).ticks()}catch(e){}var o="https://www.youtube.com/annotations_auth/read2?video_id="+e.id;TBExtension.Get(o,function(o,r,n){try{if(o){kt(n,e.id,i,t)}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|getAnnotations",Data:r,Response:n});var a="https://www.youtube.com/annotations_invideo?features=1&legacy=1&video_id="+e.id;TBExtension.Get(a,function(o,r,n){try{if(o){kt(n,e.id,i,t)}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|getAnnotations",Data:r,Response:n});t(null)}}catch(e){TBUtilities.LogError({Exception:e,Location:"YouTubeActions.js|getAnnotations"});t(null)}})}}catch(e){TBUtilities.LogError({Exception:e,Location:"YouTubeActions.js|getAnnotations"});t(null)}})};var Bt=function(e,t,i){TBUtilities.Log("TubeBuddyYouTubeActions - bulkCardDeleted");u++;if(e){c++}else{p++}TBUtilities.Log(u+", "+d+", "+p);if(u==d||d==0){if(p>0&&s.url==null&&s.text==null){TBUtilities.Log("bulkCardDeleted failed to delete, checking to see if there are any cards on video");var o="https://www.youtube.com/cards_ajax?v="+t+"&action_list=1";TBUtilities.Log("getting all cards from url = "+o);TBExtension.Get(o,function(e,i,o){try{if(e){if(o.feature_templates.length==0){TBUtilities.Log("bulkCardDeleted failed to delete all cards, 0 cards found, returning success");p=0}a(p==0,t)}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|get cards - delete recheck",Data:i,Response:o});a(p==0,t)}}catch(e){TBUtilities.LogError({Exception:e,Location:"YouTubeActions.js|get cards - delete recheck"});a(p==0,t)}},null,{dataType:"json"})}else{a(p==0,t)}}};var jt=function(e,t,i){TBUtilities.Log("TubeBuddyYouTubeActions - getVideoChannelId for video id = "+e);Ne(e).then(e=>{if(e.videoDetails==undefined||e.videoDetails.channelId==undefined){throw"Channel id not found"}const t=e.videoDetails.channelId;return t}).then(i).catch(()=>null)};var Lt=function(e){var t=null;try{var i=TBGlobal.GetYouTubeUIFromHtml(e);switch(i){case"studio":case"material":{var o=e.indexOf('],"channelId"');var r=e.indexOf('"',o+13);var n=e.indexOf('"',r+1);t=e.substring(r+1,n);if(t.length!==24){TBUtilities.Log("TubeBuddyYouTubeActions - parseChannelIdFromHtml - first attempt failed");o=e.indexOf('"ucid"');r=e.indexOf('"',o+6);n=e.indexOf('"',r+1);t=e.substring(r+1,n)}if(t.length!==24){TBUtilities.Log("TubeBuddyYouTubeActions - parseChannelIdFromHtml - second attempt failed");var a='externalChannelId":"';o=e.indexOf(a);if(o!==-1){t=e.substring(o+a.length,o+a.length+24)}TBUtilities.Log("TubeBuddyYouTubeActions - parseChannelIdFromHtml - third attempt failed");a='externalChannelId\\":\\"';o=e.indexOf(a);if(o!==-1){t=e.substring(o+a.length,o+a.length+24)}}if(t.length!==24){t=null}TBUtilities.Log("TubeBuddyYouTubeActions - parseChannelIdFromHtml - "+t);break}case"default":{var s=jQuery.parseHTML(DOMPurify.sanitize(e,DOMPurifyConfig));t=jQuery(s).find("meta[itemprop=channelId]").attr("content");break}}}catch(e){TBUtilities.Log(e)}return t};var Ct=function(e,t){try{e=e.replace(/([#0-9]\u20E3)|[\xA9\xAE\u203C\u2047-\u2049\u2122\u2139\u3030\u303D\u3297\u3299][\uFE00-\uFEFF]?|[\u2190-\u21FF][\uFE00-\uFEFF]?|[\u2300-\u23FF][\uFE00-\uFEFF]?|[\u2460-\u24FF][\uFE00-\uFEFF]?|[\u25A0-\u25FF][\uFE00-\uFEFF]?|[\u2600-\u27BF][\uFE00-\uFEFF]?|[\u2900-\u297F][\uFE00-\uFEFF]?|[\u2B00-\u2BF0][\uFE00-\uFEFF]?|(?:\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDEFF])[\uFE00-\uFEFF]?/g,"");var i="https://www.youtube.com/results?search_query="+TBUtilities.GetUrlEncoded(e);TBExtension.Get(i,function(e,i,o){try{if(e){TBUtilities.Log("TubeBuddyYouTubeActions - getVideoSearchResults ajax call done");var r=TBGlobal.GetYouTubeUI();if(r==="default"&&TBUtilities.IsResponseContextFound(o)===true)r="material";var n=[];switch(r){case"studio":case"material":{var a=TBUtilities.ParseResponseContextFromHtml(o);if(a!==null){var s=TBUtilities.GetVideoSearchCollection(a.contents.twoColumnSearchResultsRenderer.primaryContents);if(s.length){jQuery.each(s,function(e,t){if(!t){return}try{if(t.videoRenderer){var i={id:null,title:null,description:"",views:null,thumbnail:null,channelId:null,channelName:null,channelUrl:null};i.id=t.videoRenderer.videoId;i.channelId="";if(t.videoRenderer.longBylineText&&t.videoRenderer.longBylineText.runs&&t.videoRenderer.longBylineText.runs.length>0){try{i.channelId=t.videoRenderer.longBylineText.runs["0"].navigationEndpoint.browseEndpoint.browseId;i.channelName=t.videoRenderer.longBylineText.runs["0"].text;i.channelUrl="https://www.youtube.com/channel/"+i.channelId}catch(e){TBUtilities.LogError(e)}}i.thumbnail=t.videoRenderer.thumbnail.thumbnails[0].url;if(t.videoRenderer.title.simpleText){i.title=t.videoRenderer.title.simpleText}else{i.title=t.videoRenderer.title.runs[0].text}if(t.videoRenderer.descriptionSnippet&&t.videoRenderer.descriptionSnippet.runs){for(var o=0;o<t.videoRenderer.descriptionSnippet.runs.length;o++){i.description+=t.videoRenderer.descriptionSnippet.runs[o].text}}if(t.videoRenderer.viewCountText&&t.videoRenderer.viewCountText.simpleText){i.views=t.videoRenderer.viewCountText.simpleText}else{if(t.videoRenderer.viewCountText&&t.videoRenderer.viewCountText.runs){i.views=t.videoRenderer.viewCountText.runs[0].text}else{i.views=0}}if(i.id!=null){n.push(i)}}}catch(e){TBUtilities.LogError(e)}})}t(n)}break}case"default":{o=o.replace(/__ytRIL/g,"");o=TBUtilities.ReplaceAll(o,"window. &amp;&amp;","");var l=jQuery.parseHTML(DOMPurify.sanitize(o,DOMPurifyConfig));jQuery(".item-section",l).find("li > div").each(function(){try{var e=jQuery(this);if(jQuery(this).hasClass("spell-correction"))return;var t={id:null,title:null,description:"",views:null,thumbnail:null,channelId:null,channelName:null,channelUrl:null};jQuery(this).find("a").attr("target","_blank");jQuery(this).find(".yt-uix-menu-trigger").remove();t.channelId=jQuery(this).find(".yt-lockup-byline").find("a:first").attr("data-ytid");var i=jQuery(this).find("h3 > a:first");if(i!=null){var o=i.attr("href");if(o==null)o="";if(o.indexOf("watch?")>0){var r=o.indexOf("v=")+2;t.id=o.substring(r,r+11)}t.title=i.attr("title");t.description=e.find(".yt-lockup-description").text();t.views=e.find("ul.yt-lockup-meta-info").children().eq(1).text();t.thumbnail=e.find("img").attr("src");t.channelName=e.find("a[data-ytid]").text();t.channelUrl="https://youtube.com/channel"+t.channelId;if(t.id!=null){n.push(t)}}}catch(e){TBUtilities.LogError(e)}});t(n);break}}}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|getVideoSearchResults",Data:i,Response:o});t(null)}}catch(e){TBUtilities.LogError({Exception:e,Location:"YouTubeActions.js|getVideoSearchResults"});t(null)}},null,{forceSameOrigin:true})}catch(e){TBUtilities.Log(e);t(null)}};var Qt=function(){jQuery(document.body).on("CRTBMessagePost",function(e,t){TubeBuddyYouTubeActions.CRTBMessagePost(t)});jQuery(document.body).on("CRTBLoadAboutPageForMessage",function(e,t){TubeBuddyYouTubeActions.CRTBLoadAboutPageForMessage(t)});jQuery(document.body).on("CRTBYTActionsLoadPlaylistPage",function(e,t){TubeBuddyYouTubeActions.CRTBYTActionsLoadPlaylistPage(t)});jQuery(document.body).on("CRTBLoadAboutPageForSubscribe",function(e,t){TubeBuddyYouTubeActions.CRTBLoadAboutPageForSubscribe(t)});jQuery(document.body).on("CRTBPostSubscribe",function(e,t){TubeBuddyYouTubeActions.CRTBPostSubscribe(t)});jQuery(document.body).on("CRTBYouTubeActionGetSearchResults",function(e,t){TubeBuddyYouTubeActions.CRTBYouTubeActionGetSearchResults(t)});jQuery(document.body).on("CRPostCard",function(e,t){TBUtilities.Log(t)})};var Ut=function(e){return new Promise(function(t,i){var o=TBUtilities.BuildContextRequestObject(e.html);var r=[];r.push(e.videoId);var n={channelId:TBGlobal.CurrentChannelId(),context:o,failOnError:true,mask:{playlistId:true,title:true},memberVideoIds:r,pageSize:500};var a=TBUtilities.ParseInnerTubeApiKey(e.html);var s="https://studio.youtube.com/youtubei/v1/creator/list_creator_playlists?alt=json&key="+a;TBExtension.Post(s,JSON.stringify(n),function(i,o,r){e.response=r;t(e)},null,{dataType:"json",cache:false,contentType:null},e.header)})};var It=function(e){let t={html:null,videoId:e,header:null,response:null,inPlaylist:false};return new Promise(function(e,i){se(t).then(TBUtilities.ProcessHeader).then(le).then(Ut).then(function(i){if(i.response&&i.response.playlistMemberships&&i.response.playlistMemberships.length>0){let e=i.response.playlistMemberships.find(e=>e.containsRequestedVideos=="CONTAINS_REQUESTED_VIDEOS_ALL");if(e){t.inPlaylist=true}}e(i)}).catch(function(e){i(e)})})};var St=function(e){let t={html:null,videoId:e,header:null,response:null,inPlaylist:false};return new Promise(function(e,i){se(t).then(TBUtilities.ProcessHeader).then(le).then(Ut).then(function(t){let i={videoId:t.videoId,playlists:[]};if(t.response.playlistMemberships==undefined||t.response.playlistMemberships.length==0||t.response.playlists==undefined||t.response.playlists.lenght==0){e(i)}const o=t.response.playlistMemberships;const r=t.response.playlists;i.playlists=r.filter(e=>o.filter(t=>t.playlistId==e.playlistId&&t.containsRequestedVideos=="CONTAINS_REQUESTED_VIDEOS_ALL").length);e(i)}).catch(function(e){i(e)})})};var At=function(e){return new Promise(function(t,i){var o=false;var r="https://www.youtube.com/results?search_query="+TBUtilities.GetUrlEncoded(e);TBUtilities.Log("getSearchEstimatedResultCount = "+r);TBExtension.Get(r,function(e,o,r){try{if(e===true){var n=null;var a=TBUtilities.IsResponseContextFound(r);var s=TBGlobal.GetYouTubeUIFromHtml(r);if(s=="default"&&a===true)s="material";switch(s){case"studio":case"material":{if(a===true){var l=TBUtilities.ParseResponseContextFromHtml(r);n=parseInt(l.estimatedResults)}break}case"default":{var d=DOMPurify.sanitize(r,DOMPurifyConfig);jQuery("#tb-tag-explorer-search-result-count").text(jQuery(".num-results",d).text());var u=jQuery(".num-results",d).html();if(!u)u="";u=u.replace(/\D/g,"");n=parseInt(u)}}if(isNaN(n)===false){t(n)}else{i("Error getting number of results")}}}catch(e){TBUtilities.LogError(e);i("Error getting number of results")}},{query:e},{forceSameOrigin:true})})};var Et=function(e){let t={html:document.documentElement.outerHTML,header:null,query:e,authedUser:null,www:true};return new Promise(function(e,i){TBUtilities.ProcessHeader(t).then(le).then(de).then(He).then(function(t){e(t)}).catch(function(e){i(e)})})};var Dt=function(e){return new Promise(function(t,i){let o="https://www.youtube.com/results?search_query="+TBUtilities.GetUrlEncoded(e.Query)+"&page="+e.Page;if(e.Sort){o=o+"&search_sort="+e.Sort}if(e.Filter){o=o+"&filters="+e.Filter}let r=true;TBUtilities.Log("search url = "+o);TBExtension.Get(o,function(o,r,n){try{if(o===true){var a=TBUtilities.IsResponseContextFound(n);let i=TBGlobal.GetYouTubeUIFromHtml(n);if(i=="default"&&a===true)i="material";switch(i){case"studio":case"material":{if(a){var s=TBUtilities.ParseResponseContextFromHtml(n);if(s.contents.twoColumnSearchResultsRenderer.primaryContents!=null){e.NumberOfResults=parseInt(s.estimatedResults);var l=TBUtilities.GetVideoSearchCollection(s.contents.twoColumnSearchResultsRenderer.primaryContents);if(l&&l.length){jQuery.each(l,function(t,i){try{if(i.videoRenderer){let t={};t.Type="video";t.Id=i.videoRenderer.videoId;t.URL="https://www.youtube.com/watch?v="+i.videoRenderer.videoId;t.ChannelId="";t.ChannelName="";t.ChannelUrl="";if(i.videoRenderer.longBylineText&&i.videoRenderer.longBylineText.runs.length>0){try{t.ChannelId=i.videoRenderer.longBylineText.runs["0"].navigationEndpoint.browseEndpoint.browseId;t.ChannelName=i.videoRenderer.longBylineText.runs["0"].text;t.ChannelUrl="https://www.youtube.com/channel/"+t.ChannelId}catch(e){TBUtilities.LogError(e)}}t.Thumbnail="";if(i.videoRenderer.thumbnail&&i.videoRenderer.thumbnail.thumbnails.length>0){t.Thumbnail=i.videoRenderer.thumbnail.thumbnails[0].url}t.Title="";if(i.videoRenderer.title.simpleText){t.Title=i.videoRenderer.title.simpleText}else{if(i.videoRenderer.title.runs){t.Title=i.videoRenderer.title.runs[0].text}}t.ViewCount="";if(i.videoRenderer.viewCountText&&i.videoRenderer.viewCountText.simpleText){t.ViewCount=i.videoRenderer.viewCountText.simpleText}else{if(i.videoRenderer.viewCountText&&i.videoRenderer.viewCountText.runs){t.ViewCount=i.videoRenderer.viewCountText.runs[0].text}else{t.ViewCount="0"}}t.Desc="";if(i.videoRenderer.descriptionSnippet&&i.videoRenderer.descriptionSnippet.runs){for(var o=0;o<i.videoRenderer.descriptionSnippet.runs.length;o++){t.Desc+=i.videoRenderer.descriptionSnippet.runs[o].text}}if(i.videoRenderer.descriptionSnippet&&i.videoRenderer.descriptionSnippet.simpleText){t.Desc=i.videoRenderer.descriptionSnippet.simpleText}t.PublishedTime="";if(i.videoRenderer.publishedTimeText&&i.videoRenderer.publishedTimeText.simpleText){t.PublishedTime=i.videoRenderer.publishedTimeText.simpleText}e.Results.push(t)}else if(i.channelRenderer){let t={};t.Type="channel";t.Id=i.channelRenderer.channelId;t.Url="";t.Name="";t.Thumbnail="";if(i.channelRenderer.shortBylineText.runs){t.Url=i.channelRenderer.shortBylineText.runs[0].navigationEndpoint.commandMetadata.webCommandMetadata.url;t.Name=i.channelRenderer.shortBylineText.runs[0].text;t.Thumbnail=i.channelRenderer.thumbnail.thumbnails[0].url}e.Results.push(t)}}catch(e){TBUtilities.Log(e)}})}}}break}default:{throw"unsupported UI type"}}t(e)}}catch(e){TBUtilities.LogError(e);i("Error getting search")}},{searchRequest:e},{forceSameOrigin:true})})};return{Initialize:function(){if(!e){Qt();e=true}},GetVideoSearchRankTabbed:function(e,t,i){P(e,t,i)},GetVideoSearchRank:function(e,t,i,o,r,n){G(e,t,i,null,o,r,n)},GetVideoSearchRankPromise:function(e,t,i,o,r){return new Promise((n,a)=>{try{G(e,t,(e,t,i,o)=>{n({videoId:e,searchTerm:t,rank:i,extraData:o})},null,i,o,r)}catch(e){a(e)}})},GetVideoSearchResults:function(e,t){Ct(e,t)},AddCard:function(e,t,i,o,r,n,a,s,l){M(e,t,i,o,r,n,a,s,l)},CopyCard:function(e,t,i,o){V(e,t,i,o,TBUtilities.CreateGuid())},CopyCardsStudio:function(e,t){return ot(e,t,false)},UnpublishAnnotations:function(e,t,i){Ze(e,t,i)},CopyEndScreenElementsStudio:function(e,t,i){return Ge(e,t,i)},DeleteAllEndScreenElementsStudio:function(e,t){return Ge(e,t,[])},DeleteAllEndCardElementsWithUrlStudio:function(e,t,i,o){return qe(e,t,i,o)},DeleteCommentStudio:function(e){return we(e)},GetCommentsStudio:function(e,t=10){return ke(e,t)},GetCommentsToxicity:function(e=10){return xe(e)},GetVideosListStudio:function(e,t,i){return Be(e,t,i)},GetCreatorVideosStudio:function(e,t){return je(e,t)},GetVideoListLimitedAdsStudio:function(e,t){return Te(e,t)},GetCardsListStudio:function(e){return $e(e)},DeleteAllCardsStudio:function(e){return ot(e,[])},DeleteAllCardsWithUrlOrTextStudio:function(e,t,i,o){return it(e,t,i,o)},DeleteAllCardsWithTextStudio:function(e,t){return deleteAllCardsWithTextStudio(e,t)},CopyEndCardElements:function(e,t,i,o,r,n,a){var s=[];jQuery.each(r,function(e,t){switch(t.type){case"WEBSITE":{s.push(t);break}}});if(s.length>0){var l=0;jQuery.each(s,function(d,u){Xe(e,u,n,function(d){if(d&&d.uploadedImage!=null){l++;if(l>=s.length){Me(e,t,i,o,r,n,a)}}else{TBUtilities.Log("Failed to upload website element for \n");TBUtilities.Log(d);a(false,null,null,"Error uploading image")}})})}else{Me(e,t,i,o,r,n,a)}},UpdateEndCardElements:function(e,t,i,o,r,n){var a=[];jQuery.each(o,function(e,t){switch(t.type){case"WEBSITE":{if(t.imagefile){a.push(t)}break}}});if(a.length>0){var s=0;jQuery.each(a,function(l,d){Xe(e,d,r,function(l){if(l&&l.uploadedImage!=null){s++;if(s>=a.length){Me(e,null,t,i,o,r,n)}}else{n(false,null,null,"Error uploading image")}})})}else{Me(e,null,t,i,o,r,n)}},DeleteAllEndCardElements:function(e,t,i,o){Ke(e,t,i,o)},DeleteAllEndCardElementsWithUrl:function(e,t,i,o,r,n){deleteAllEndCardElementsWithUrl(e,t,i,o,r,n)},UpdateCard:function(e,t,i,o){_(e,t,i,o)},GetCardsList:function(e,t){dt(e,t)},GetEndScreenList:function(e,t){ut(e,t)},GetEndScreenListStudio:function(e){return re(e)},GetVideoEndScreenStartMs:function(e){return F(e)},GetVideoEnscreenData:function(e){return N(e)},GetVideoDetailStudio:function(e){return Y(e)},GetVideoDuration:function(e){return H(e)},GetVideoCommentsStudio:function(e,t,i){return ee(e,t,i)},PostEditVideoStudio:function(e){return Oe(e)},GetCommentsResponse:function(e,t){return ie(e,t)},PostCustomThumbnailStudio:function(e,t){return q(e,t)},BulkCardDeleted:function(e,t,i){Bt(e,t,i)},DeleteAllCards:function(e,t,i){ct(e,t,i)},DeleteAllCardsWithUrl:function(e,t,i,o,r){ct(e,t,o,i,r)},DeleteAllCardsWithText:function(e,t,i,o,r){ct(e,t,o,null,r,i)},DeleteCard:function(e,t,i,o,r,n,a,s,l,d){pt(e,t,i,o,r,n,a,s,l,d)},DeleteAnnotations:function(e,t,i){Tt(e,t,i)},GetAnnotations:function(e,t){xt(e,t)},SendMessage:function(e,t,i){L(e,t,i)},SetPlaylistOrderingToManual:function(e,t){C(e,t)},GetSearchResults:function(e,t,i,o,r,n,a){R(e,t,i,o,r,n,a)},Search:function(e){return Dt(e)},YouTubeSearch:function(e){return Et(e)},GetChannelId:function(e,t){return wt(e,t)},GetVideoChannelId:function(e,t,i){jt(e,t,i)},SubscribeToChannel:function(e,t){Q(e,t)},GetVideoTags:function(e,t){ht(e,t)},GetVideoInfo:function(e,t){yt(e,t)},GetChannelInfoFromPage:function(e,t){mt(e,t)},GetYouTubeAutoComplete:function(e,t,i){x(e,t,i,"youtube")},GetGoogleAutoComplete:function(e,t,i){x(e,t,i,"google")},GetChannelInfoFromAboutPage:function(e,t,i){gt(e,t,i)},GetFullNumberFromAbbreviation:function(e){return vt(e)},CRTBLoadAboutPageForMessage:function(e){I(e)},CRTBMessagePost:function(e){S(e)},CRTBLoadAboutPageForSubscribe:function(e){U(e)},CRTBPostSubscribe:function(e){A(e)},CRTBYouTubeActionGetSearchResults:function(e){E(e)},CRTBYTActionsLoadPlaylistPage:function(e){D(e)},IsVideoInPlaylist:function(e){return It(e)},GetPlaylistsThatContainVideoStudio:function(e){return St(e)},AnalyticsGetSummaryChannelTotals:function(e,t,i){return ce(e,t,i)},AnalyticsGetDailyChannelTotals:function(e,t,i){return pe(e,t,i)},AnalyticsGetDailyVideoTotals:function(e,t,i,o){return he(e,t,i,o)},AnalyticsGetVideoSearchTermTrafficTotals:function(e,t,i,o){return ye(e,t,i,o)},AnalyticsGetSummaryVideoTrafficSourcesTotals:function(e,t,i,o){return be(e,t,i,o)},AnalyticsGetSummaryVideoTotals:function(e,t,i,o){return ve(e,t,i,o)},AnalyticsGetAudienceOnlineData:function(){return ge()},SubmitVideoForManualReview:function(e){return me(e)},GetSearchEstimatedResultCount:function(e){return At(e)},RemovedCachedStudioValues:function(){return z()},GetChannelFeatureEligibility:function(){return J()},GetSupportedContentLanguages:function(){return Z()}}}();const TBApiMetrics={VIEWS:"VIEWS",COMMENTS:"COMMENTS",RATINGS_LIKES:"RATINGS_LIKES",AVERAGE_WATCH_PERCENTAGE:"AVERAGE_WATCH_PERCENTAGE",AVERAGE_WATCH_TIME:"AVERAGE_WATCH_TIME",WATCH_TIME:"WATCH_TIME",SUBSCRIBERS_NET_CHANGE:"SUBSCRIBERS_NET_CHANGE",TOTAL_ESTIMATED_EARNINGS:"TOTAL_ESTIMATED_EARNINGS",IMPRESSIONS:"IMPRESSIONS",CLICKS:"CLICKS",VIDEO_THUMBNAIL_IMPRESSIONS:"VIDEO_THUMBNAIL_IMPRESSIONS",VIDEO_THUMBNAIL_IMPRESSIONS_VTR:"VIDEO_THUMBNAIL_IMPRESSIONS_VTR"};var TubeBuddyABTests=function(){var e=false;var t=[];var i=0;var o="";var r=0;var n={};var a=function(){jQuery("#tb-ctr-error-debug").val(o);jQuery("#tb-abtests-error").show();jQuery("#tb-abtests-container").show();jQuery("#tb-abtests-processing").hide()};var s=function(e){r++;o+="\r\n"+r+". "+e};var l=function(){var e=TBGlobal.host+"/ModuleManager/abtests/abtests?v="+TBGlobal.versionNumber;if(loadLocalHTML&&(TBExtension.GetType()=="chrome"||TBExtension.GetType()=="firefox")){e=chrome.extension.getURL("modules/abtests.html")}else if(loadLocalHTML&&TBExtension.GetType()=="safari"){e="modules/abtests.html"}TBExtension.Get(e,function(e,t,i){if(e){i=TBUtilities.FixLocalHtml(DOMPurify.sanitize(i,DOMPurifyConfig));jQuery("body").append(i);if(TBGlobal.CanAccessLevel3Tools()){TBUtilities.Log("getAbTestsToGatherActivated");var o=jQuery("#tb-abtests-container")[0].outerHTML;jQuery("#main").after(o);d()}}})};var d=function(){TBUtilities.Log("getAbTestsToGather");s("AB Gather Status for "+TBGlobal.CurrentChannelId());var e='<div style="line-height:19px;"><img src="'+TBGlobal.host+'/images/general/loading1.gif" style="position:relative; top:3px;" /> Looking for A/B Tests that need CTR gathering...</div>';jQuery("#tb-abtests-processing").html(DOMPurify.sanitize(e,DOMPurifyConfig));var i=TBGlobal.host+TBGlobal.apiUrls.abtestsGetVideosToGather;s("Fetching tests to gather...");TBExtension.Get(i,function(e,i,o,r){if(e==false){if(r==401){var n=TBUtilities.GetTimeZoneOffSetInHours();var l="";if(TBGlobal.Profile()!=null)l="&agencyid="+encodeURIComponent(TBGlobal.Profile().AgencyId);if(l==null)l="";var d='<div style="line-height:16px; color:Red;"><b>We not longer have a valid Access Token for your channel.</b><br><br><a href="'+TBGlobal.host+"/oauth/AuthRedirect?channelid="+TBGlobal.CurrentChannelId()+"&redirectUrl="+encodeURIComponent("https://studio.youtube.com")+"&timeZoneOffset="+encodeURIComponent(n)+"&agencyId="+l+"&via=extension&channelId="+TBGlobal.CurrentChannelId()+'">CLICK HERE</a> to re-link your channel and fix it.</div>';jQuery("#tb-abtests-processing").html(DOMPurify.sanitize(d,DOMPurifyConfig))}else{s("Error fetching videos to gather: "+o);a()}return}try{t=JSON.parse(o);TBUtilities.Log("Items to Process");TBUtilities.Log(t);s("Number of videos to gather: "+t.length);if(t.length==0){TBUtilities.Log("NO ITEMS TO PROCESS");jQuery("#tb-abtests-container").hide()}else{jQuery("#tb-abtests-container").show();u()}}catch(e){}})};var u=function(){if(i==t.length){var e='<div style="color:green"><img style="position:relative; top:2px; height:15px;" src="'+TBGlobal.host+'/images/icons/check.png"> CTR Gathering Complete!</div>';jQuery("#tb-abtests-processing").html(DOMPurify.sanitize(e,DOMPurifyConfig));setTimeout(function(){jQuery("#tb-abtests-container").hide()},3e3);return}var o=t[i];s("Gather index: "+i);s("Gather video: "+o.VideoId);TBUtilities.Log("CurItem");TBUtilities.Log(o);var e='<div style="padding-bottom:5px; margin-bottom:6px; border-bottom:solid 1px #eee; margin-right:10px;"><div style="padding-bottom:5px;">Video '+(i+1)+" of "+t.length+'</div><div style="padding-bottom:5px;">Processing CTR Data for</div><img src="'+o.VideoThumbnail+'" style="height:30px; float:left; margin-right:3px;" /> <b>'+o.VideoTitle+'</b><div style="clear:both"></div></div>';jQuery("#tb-abtests-processing").html(DOMPurify.sanitize(e,DOMPurifyConfig));n.StartDate=o.StartDate;n.EndDate=o.EndDate;n.VideoId=o.VideoId;new Promise(function(e,t){try{h().then(p).then(function(t){i++;u();e(t)}).catch(function(e){s("ER-A: "+e);a();t(e)})}catch(e){s("ER-B: "+e);a()}}).catch(function(e){s("ER-C: "+e);a();reject(e)})};var c=function(e){jQuery("#tb-abtests-processing").find("img").remove();var t='<div style="padding-top:5px;"><img src="'+TBGlobal.host+'/images/general/loading1.gif" style="position:relative; top:2px; height:12px; width:12px;" /> '+e+"</div>";jQuery("#tb-abtests-processing").append(DOMPurify.sanitize(t,DOMPurifyConfig))};var p=function(){return new Promise(function(e,t){try{console.log(n);var i=jQuery.param(n);c("Saving Data...");s("Saving Data...");TBExtension.Post(TBGlobal.host+"/api/AbTests/AddCtrData",i,function(i,o,r){TBUtilities.Log("Back!");if(i){c("Data successfully saved!");s("Saved Data...")}else{TBUtilities.Alert("Sorry, failed to save CTR Data");c("Failed to store data...");s("Failed to store Data..."+r);a();t(r);return}TBUtilities.Log("Process next");e()},null,{contentType:"application/x-www-form-urlencoded; charset=UTF-8"})}catch(e){s("ER-D: "+e)}e(n)})};var h=function(){c("Fetching Data...");s("Fetching Data for "+n.VideoId);return new Promise(function(e,t){try{var i=[TBApiMetrics.VIEWS,TBApiMetrics.VIDEO_THUMBNAIL_IMPRESSIONS,TBApiMetrics.VIDEO_THUMBNAIL_IMPRESSIONS_VTR];TubeBuddyYouTubeActions.AnalyticsGetDailyVideoTotals(n.VideoId,n.StartDate,n.EndDate,i).then(function(t){var i=t.resultData;n.Items=[];s("# Results: "+i.length);jQuery.each(i,function(e,t){if(!t.VIDEO_THUMBNAIL_IMPRESSIONS)t.VIDEO_THUMBNAIL_IMPRESSIONS=0;if(!t.VIDEO_THUMBNAIL_IMPRESSIONS_VTR)t.VIDEO_THUMBNAIL_IMPRESSIONS_VTR=0;var i={Date:TBUtilities.GetDateFromAnalyticsTimeStamp(t.Date),Views:t.VIEWS,CtrImpressions:t.VIDEO_THUMBNAIL_IMPRESSIONS,CtrViews:parseInt(t.VIDEO_THUMBNAIL_IMPRESSIONS*t.VIDEO_THUMBNAIL_IMPRESSIONS_VTR)};if(i.CtrImpressions>0||i.Views>0)n.Items.push(i)});e()},function(e){s("ER-E: "+e)}).catch(function(e){s("ER-F: "+e)})}catch(e){s("ER-F: "+e)}})};var y=function(){};return{Initialize:function(){if(!e){e=true;y();l()}}}}();var TubeBuddyStatFire=function(){var e=false;var t;var i;var o;var r;var n=function(e,t,i,o){var r=TBGlobal.host+"/api/data/getchannelcompetitorstatistics?channelId="+e+"&competitorChannelId="+t+"&type="+i+"&days="+o;TBExtension.Get(r,"CRTBStatFireLoadChannelCompetitorStats",{channelId:e,competitorChannelId:t})};var a=function(e,t,i){var o=TBGlobal.host+"/api/data/getchannelstatistics?channelId="+e+"&type="+t+"&days="+i;TBExtension.Get(o,"CRTBStatFireLoadChannelStats",{channelId:e})};var s=function(e,t,i){var o=TBGlobal.host+"/api/data/getvideostatistics?channelId="+e+"&type="+t+"&count="+i;TBExtension.Get(o,"CRTBLoadVideoStats",{channelId:e})};var l=function(e){var t=TBGlobal.host+"/api/data/getchannelinfo?channelId="+e;TBExtension.Get(t,"CRTBStatFireGetChannelInfo",{channelId:e})};var d=function(){jQuery(document.body).on("CRTBStatFireLoadChannelStats",function(e,i){var o=[];if(i.success){o=JSON.parse(i.response)}t(i.data.channelId,o)});jQuery(document.body).on("CRTBStatFireLoadChannelCompetitorStats",function(e,t){var i=[];if(t.success){i=JSON.parse(t.response)}r(t.data,i)});jQuery(document.body).on("CRTBStatFireGetChannelInfo",function(e,t){var i=[];if(t.success){i=JSON.parse(t.response)}o(t.data.channelId,i)});jQuery(document.body).on("CRTBLoadVideoStats",function(e,t){var o=[];if(t.success){o=JSON.parse(t.response)}i(t.data.channelId,o)})};return{Initialize:function(){if(!e){d();e=true}},GetCompetitorChannelStats:function(e,t,i,o,a){r=a;n(e,t,i,o)},GetChannelStats:function(e,i,o,r){t=r;a(e,i,o)},GetVideoStats:function(e,t,o,r){i=r;s(e,t,o)},GetChannelInfo:function(e,t){o=t;l(e)}}}();var TubeBuddyLayout=function(){var e=false;var t=false;var i=false;var o=false;var r=false;var n;var a;var s=false;var l=false;var d=false;var u=-1;var c=null;var p=[];var h;var y;var b=null;var f={general:{name:"General Page",tubeBuddyTools:[{title:"How-To Videos",description:"There are no tools specific to the page you are on. Check out our how-to playlist.",url:"https://www.youtube.com/playlist?list=PLpzjxyndddwKn0VuIEn8vMvKkczsPhmgB",thumbnailUrl:TBGlobal.host+"/images/icons/how-to.png"}],resources:[{title:"YouTube Creators Blog",source:"YouTube",sourceUrl:"http://www.youtube.com/",url:"http://youtubecreator.blogspot.com/",thumbnailUrl:TBGlobal.host+"/images/icons/social/youtube-video.png"},{title:"ReelSEO - YouTube Marketing",source:"ReelSEO",sourceUrl:"http://www.reelseo.com/",url:"http://www.reelseo.com/video/youtube-marketing/",thumbnailUrl:TBGlobal.host+"/images/icons/social/reelseo-video.png"},{title:"YouTube Creator Playbook",source:"YouTube",sourceUrl:"http://www.youtube.com",url:"http://www.youtube.com/yt/playbook/",thumbnailUrl:TBGlobal.host+"/images/icons/social/youtube-video.png"}]},search_results:{name:"Search Results",tubeBuddyTools:[{title:"Tag Explorer",description:"Find trending and popular Tags related to the term you just searched for.",url:"https://www.youtube.com/watch?v=3X80E-_b-mI&index=1&list=PLpzjxyndddwKn0VuIEn8vMvKkczsPhmgB",thumbnailUrl:"https://i.ytimg.com/vi/3X80E-_b-mI/mqdefault.jpg"}],resources:[{title:"How To Write Optimized YouTube Tags for Video SEO",source:"Video Creators",sourceUrl:"https://www.youtube.com/channel/UCcB3bcWy0_QK7uPQvTD0LwQ",url:"https://www.youtube.com/watch?v=BL1dPTHbjj0",thumbnailUrl:"https://i.ytimg.com/vi/BL1dPTHbjj0/mqdefault.jpg"},{title:"YouTube Optimization: Myths Busted, Secrets Revealed! [Case Study]",source:"ReelSEO",sourceUrl:"https://www.reelseo.com",url:"http://www.reelseo.com/youtube-optimization-case-study/",thumbnailUrl:TBGlobal.host+"/images/icons/social/reelseo-video.png"},{title:"How to Properly Tag your YouTube Videos",source:"Derral Eves",sourceUrl:"https://www.youtube.com/channel/UC3pV6eELigzhTjzBUPmT6_A",url:"https://www.youtube.com/watch?v=YGZOm_dCgMg",thumbnailUrl:"https://i.ytimg.com/vi/YGZOm_dCgMg/mqdefault.jpg"}]},video_edit:{name:"Edit Video",tubeBuddyTools:[{title:"Tag Explorer",description:"Find trending and popular Tags related to the term you just searched for.",url:"https://www.youtube.com/watch?v=3X80E-_b-mI&index=1&list=PLpzjxyndddwKn0VuIEn8vMvKkczsPhmgB",thumbnailUrl:"https://i.ytimg.com/vi/3X80E-_b-mI/mqdefault.jpg"},{title:"Copy Tags",description:"Easily copy your video tags to the clipboard",url:"https://www.youtube.com/watch?v=mfxV5xJI4kI&index=5&list=PLpzjxyndddwKn0VuIEn8vMvKkczsPhmgB",thumbnailUrl:"https://i.ytimg.com/vi/mfxV5xJI4kI/mqdefault.jpg"}],resources:[{title:"How to create the best Titles &amp; Thumbnails",source:"YouTube Creator Academy",sourceUrl:"https://www.youtube.com/channel/UCkRfArvrzheW2E7b6SVT7vQ",url:"https://www.youtube.com/watch?v=7zLUm7BeCGE",thumbnailUrl:"https://i.ytimg.com/vi_webp/7zLUm7BeCGE/mqdefault.webp"},{title:"How to Properly Tag your YouTube Videos",source:"Derral Eves",sourceUrl:"https://www.youtube.com/channel/UC3pV6eELigzhTjzBUPmT6_A",url:"https://www.youtube.com/watch?v=YGZOm_dCgMg",thumbnailUrl:"https://i.ytimg.com/vi/YGZOm_dCgMg/mqdefault.jpg"},{title:"Optimizing Video SEO for Reach vs Retention",source:"Video Creators",sourceUrl:"https://www.youtube.com/channel/UCcB3bcWy0_QK7uPQvTD0LwQ",url:"https://www.youtube.com/watch?v=erfgDfzPILo",thumbnailUrl:"https://i.ytimg.com/vi/erfgDfzPILo/mqdefault.jpg"}]},video_watch:{name:"Watch Video",tubeBuddyTools:[{title:"Community Connect",description:"Quickly and easily reach out to contact video and channel commenters.",url:"https://www.youtube.com/watch?v=lSJh2TE_8Vg&index=1&list=PLpzjxyndddwKn0VuIEn8vMvKkczsPhmgB",thumbnailUrl:"https://i.ytimg.com/vi/lSJh2TE_8Vg/mqdefault.jpg"},{title:"Tag Explorer",description:"Find trending and popular Tags related to the term you just searched for.",url:"https://www.youtube.com/watch?v=3X80E-_b-mI&index=1&list=PLpzjxyndddwKn0VuIEn8vMvKkczsPhmgB",thumbnailUrl:"https://i.ytimg.com/vi/3X80E-_b-mI/mqdefault.jpg"},{title:"Bulk Copy Annotations",description:"Copy multiple annotations from a video to any of your other videos with just a couple clicks.",url:"https://www.youtube.com/watch?v=D7Q94YWj6RE&index=2&list=PLpzjxyndddwKn0VuIEn8vMvKkczsPhmgB",thumbnailUrl:"https://i.ytimg.com/vi/D7Q94YWj6RE/mqdefault.jpg"},{title:"Bulk Description Promotion",description:"Drive traffic to a particular videos of yours using Bulk Description Promotions.",url:"https://www.youtube.com/watch?v=y9p_f5PLkhg&index=3&list=PLpzjxyndddwIdctzlTk-MCljMFzR9gwqV",thumbnailUrl:"https://i.ytimg.com/vi/y9p_f5PLkhg/mqdefault.jpg"},{title:"Share Tracker",description:"Keep track of which social networks you have shared your video with.",url:"https://www.youtube.com/watch?v=p0PmCuCu0x4&index=2&list=PLpzjxyndddwIdctzlTk-MCljMFzR9gwqV",thumbnailUrl:"https://i.ytimg.com/vi/p0PmCuCu0x4/mqdefault.jpg"},{title:"Advanced Embed",description:"Easily create stunning video thumbnails using video still frames.",url:"https://www.youtube.com/watch?v=9RXiuBCRBLo&t=227",thumbnailUrl:"https://i.ytimg.com/vi/9RXiuBCRBLo/mqdefault.jpg"}],resources:[{title:"How Dominate Related Videos on YouTube",source:"Video Creators",sourceUrl:"https://www.youtube.com/channel/UCcB3bcWy0_QK7uPQvTD0LwQ",url:"https://www.youtube.com/watch?v=9frnl4TGurM",thumbnailUrl:"https://i.ytimg.com/vi/9frnl4TGurM/mqdefault.jpg"},{title:"YouTube Creators Blog",source:"YouTube",sourceUrl:"http://www.youtube.com/",url:"http://youtubecreator.blogspot.com/",thumbnailUrl:TBGlobal.host+"/images/icons/social/youtube-video.png"},{title:"YouTube Creator Playbook",source:"YouTube",sourceUrl:"http://www.youtube.com",url:"http://www.youtube.com/yt/playbook/",thumbnailUrl:TBGlobal.host+"/images/icons/social/youtube-video.png"}]},channel_discussion:{name:"Watch Video",tubeBuddyTools:[{title:"Community Connect",description:"Quickly and easily reach out to contact video and channel commenters.",url:"https://www.youtube.com/watch?v=lSJh2TE_8Vg&index=1&list=PLpzjxyndddwKn0VuIEn8vMvKkczsPhmgB",thumbnailUrl:"https://i.ytimg.com/vi/lSJh2TE_8Vg/mqdefault.jpg"}],resources:[{title:"YouTube Creator Playbook",source:"YouTube",sourceUrl:"http://www.youtube.com",url:"http://www.youtube.com/yt/playbook/",thumbnailUrl:TBGlobal.host+"/images/icons/social/youtube-video.png"}]},upload_defaults:{name:"Upload Defaults",tubeBuddyTools:[{title:"Multiple Sets of Upload Defaults",description:"Create multiple sets of upload defaults for each type of video you make.",url:"https://www.youtube.com/watch?v=u3ENBfEimIc&list=PLpzjxyndddwKn0VuIEn8vMvKkczsPhmgB&index=3",thumbnailUrl:"https://i.ytimg.com/vi/u3ENBfEimIc/mqdefault.jpg"}],resources:[{title:"How to create the best Titles &amp; Thumbnails",source:"YouTube Creator Academy",sourceUrl:"https://www.youtube.com/channel/UCkRfArvrzheW2E7b6SVT7vQ",url:"https://www.youtube.com/watch?v=7zLUm7BeCGE",thumbnailUrl:"https://i.ytimg.com/vi_webp/7zLUm7BeCGE/mqdefault.webp"},{title:"How to Properly Tag your YouTube Videos",source:"Derral Eves",sourceUrl:"https://www.youtube.com/channel/UC3pV6eELigzhTjzBUPmT6_A",url:"https://www.youtube.com/watch?v=YGZOm_dCgMg",thumbnailUrl:"https://i.ytimg.com/vi/YGZOm_dCgMg/mqdefault.jpg"},{title:"Optimizing Video SEO for Reach vs Retention",source:"Video Creators",sourceUrl:"https://www.youtube.com/channel/UCcB3bcWy0_QK7uPQvTD0LwQ",url:"https://www.youtube.com/watch?v=erfgDfzPILo",thumbnailUrl:"https://i.ytimg.com/vi/erfgDfzPILo/mqdefault.jpg"},{title:"How Dominate Related Videos on YouTube",source:"Video Creators",sourceUrl:"https://www.youtube.com/channel/UCcB3bcWy0_QK7uPQvTD0LwQ",url:"https://www.youtube.com/watch?v=9frnl4TGurM",thumbnailUrl:"https://i.ytimg.com/vi/9frnl4TGurM/mqdefault.jpg"}]},channel:{name:"Channel Page",tubeBuddyTools:[{title:"Community Connect",description:"Quickly and easily reach out to contact video and channel commenters.",url:"https://www.youtube.com/watch?v=lSJh2TE_8Vg&index=1&list=PLpzjxyndddwKn0VuIEn8vMvKkczsPhmgB",thumbnailUrl:"https://i.ytimg.com/vi/lSJh2TE_8Vg/mqdefault.jpg"},{title:"See Social Blade data in YouTube",description:"No need to leave YouTube - get access to all Social Blade data in YouTube.",url:"https://www.youtube.com/watch?v=dSuLZejPgFE&index=4&list=PLpzjxyndddwKn0VuIEn8vMvKkczsPhmgB",thumbnailUrl:"https://i.ytimg.com/vi/dSuLZejPgFE/mqdefault.jpg"}],resources:[{title:"YouTube Creators Blog",source:"YouTube",sourceUrl:"http://www.youtube.com/",url:"http://youtubecreator.blogspot.com/",thumbnailUrl:TBGlobal.host+"/images/icons/social/youtube-video.png"},{title:"ReelSEO - YouTube Marketing",source:"ReelSEO",sourceUrl:"http://www.reelseo.com/",url:"http://www.reelseo.com/video/youtube-marketing/",thumbnailUrl:TBGlobal.host+"/images/icons/social/reelseo-video.png"},{title:"YouTube Creator Playbook",source:"YouTube",sourceUrl:"http://www.youtube.com",url:"http://www.youtube.com/yt/playbook/",thumbnailUrl:TBGlobal.host+"/images/icons/social/youtube-video.png"}]},upload:{name:"Video Upload",tubeBuddyTools:[{title:"Multiple Sets of Upload Defaults",description:"Create multiple sets of upload defaults for each type of video you make.",url:"https://www.youtube.com/watch?v=u3ENBfEimIc&list=PLpzjxyndddwKn0VuIEn8vMvKkczsPhmgB&index=3",thumbnailUrl:"https://i.ytimg.com/vi/u3ENBfEimIc/mqdefault.jpg"}],resources:[{title:"How to create the best Titles &amp; Thumbnails",source:"YouTube Creator Academy",sourceUrl:"https://www.youtube.com/channel/UCkRfArvrzheW2E7b6SVT7vQ",url:"https://www.youtube.com/watch?v=7zLUm7BeCGE",thumbnailUrl:"https://i.ytimg.com/vi_webp/7zLUm7BeCGE/mqdefault.webp"},{title:"How to Properly Tag your YouTube Videos",source:"Derral Eves",sourceUrl:"https://www.youtube.com/channel/UC3pV6eELigzhTjzBUPmT6_A",url:"https://www.youtube.com/watch?v=YGZOm_dCgMg",thumbnailUrl:"https://i.ytimg.com/vi/YGZOm_dCgMg/mqdefault.jpg"},{title:"Optimizing Video SEO for Reach vs Retention",source:"Video Creators",sourceUrl:"https://www.youtube.com/channel/UCcB3bcWy0_QK7uPQvTD0LwQ",url:"https://www.youtube.com/watch?v=erfgDfzPILo",thumbnailUrl:"https://i.ytimg.com/vi/erfgDfzPILo/mqdefault.jpg"},{title:"How Dominate Related Videos on YouTube",source:"Video Creators",sourceUrl:"https://www.youtube.com/channel/UCcB3bcWy0_QK7uPQvTD0LwQ",url:"https://www.youtube.com/watch?v=9frnl4TGurM",thumbnailUrl:"https://i.ytimg.com/vi/9frnl4TGurM/mqdefault.jpg"}]},comments:{name:"Comments",tubeBuddyTools:[{title:"Comment Filters",description:"Quickly and easily find the comments that matter by filtering out the ones that don't.",url:"https://www.youtube.com/watch?v=NmC8Jc5A9K0&list=PLpzjxyndddwKn0VuIEn8vMvKkczsPhmgB&index=3",thumbnailUrl:"https://i.ytimg.com/vi/u3ENBfEimIc/mqdefault.jpg"}],resources:[{title:"How to create the best Titles &amp; Thumbnails",source:"YouTube Creator Academy",sourceUrl:"https://www.youtube.com/channel/UCkRfArvrzheW2E7b6SVT7vQ",url:"https://www.youtube.com/watch?v=7zLUm7BeCGE",thumbnailUrl:"https://i.ytimg.com/vi_webp/7zLUm7BeCGE/mqdefault.webp"},{title:"How to Properly Tag your YouTube Videos",source:"Derral Eves",sourceUrl:"https://www.youtube.com/channel/UC3pV6eELigzhTjzBUPmT6_A",url:"https://www.youtube.com/watch?v=YGZOm_dCgMg",thumbnailUrl:"https://i.ytimg.com/vi/YGZOm_dCgMg/mqdefault.jpg"},{title:"Optimizing Video SEO for Reach vs Retention",source:"Video Creators",sourceUrl:"https://www.youtube.com/channel/UCcB3bcWy0_QK7uPQvTD0LwQ",url:"https://www.youtube.com/watch?v=erfgDfzPILo",thumbnailUrl:"https://i.ytimg.com/vi/erfgDfzPILo/mqdefault.jpg"},{title:"How Dominate Related Videos on YouTube",source:"Video Creators",sourceUrl:"https://www.youtube.com/channel/UCcB3bcWy0_QK7uPQvTD0LwQ",url:"https://www.youtube.com/watch?v=9frnl4TGurM",thumbnailUrl:"https://i.ytimg.com/vi/9frnl4TGurM/mqdefault.jpg"}]},my_videos:{name:"My Videos",tubeBuddyTools:[{title:"Bulk Copy Cards",description:"Copy multiple cards from a video to any of your other videos with just a couple clicks.",url:"https://www.youtube.com/watch?v=jlANfsXXbPU&index=2&list=PLpzjxyndddwKn0VuIEn8vMvKkczsPhmgB",thumbnailUrl:"https://i.ytimg.com/vi/jlANfsXXbPU/mqdefault.jpg"},{title:"Bulk Copy Annotations",description:"Copy multiple annotations from a video to any of your other videos with just a couple clicks.",url:"https://www.youtube.com/watch?v=D7Q94YWj6RE&index=2&list=PLpzjxyndddwKn0VuIEn8vMvKkczsPhmgB",thumbnailUrl:"https://i.ytimg.com/vi/D7Q94YWj6RE/mqdefault.jpg"},{title:"Bulk Find / Rreplace / Append",description:"Find / Replace / Append video titles and descriptions in bulk.",url:"https://www.youtube.com/watch?v=kRWO6ymiSO0&index=2&list=PLpzjxyndddwKn0VuIEn8vMvKkczsPhmgB",thumbnailUrl:"https://i.ytimg.com/vi/kRWO6ymiSO0/mqdefault.jpg"},{title:"Advanced Embed",description:"Easily create stunning video thumbnails using video still frames.",url:"https://www.youtube.com/watch?v=9RXiuBCRBLo&t=227",thumbnailUrl:"https://i.ytimg.com/vi/9RXiuBCRBLo/mqdefault.jpg"},{title:"Share Tracker",description:"Keep track of which social networks you have shared your video with.",url:"https://www.youtube.com/watch?v=p0PmCuCu0x4&index=2&list=PLpzjxyndddwIdctzlTk-MCljMFzR9gwqV",thumbnailUrl:"https://i.ytimg.com/vi/p0PmCuCu0x4/mqdefault.jpg"},{title:"Thumbnail Generator",description:"Easily create stunning video thumbnails using video still frames.",url:"https://www.youtube.com/watch?v=S8UdKj7GtG0&t=173",thumbnailUrl:"https://i.ytimg.com/vi/S8UdKj7GtG0/mqdefault.jpg"}],resources:[{title:"Drive Fan Engagement",source:"Creator Academy",sourceUrl:"https://www.youtube.com/user/creatoracademy",url:"https://www.youtube.com/watch?v=vEj2iqsQLqw&list=PLpjK416fmKwTpjMX227XZjciduCo1-EkD",thumbnailUrl:"https://i.ytimg.com/vi/vEj2iqsQLqw/mqdefault.jpg"},{title:"Encourage Viewers to Watch More",source:"Creator Academy",sourceUrl:"https://www.youtube.com/user/creatoracademy",url:"https://www.youtube.com/watch?v=tZIHFNcK1vE&list=PLpjK416fmKwQMugNHzCUl_NrbLy021HwY",thumbnailUrl:"https://i.ytimg.com/vi/tZIHFNcK1vE/mqdefault.jpg"}]},subscribers:{name:"Subscribers",tubeBuddyTools:[{title:"Welcome new Subscribers",description:"Use TubeBuddy to quickly send pre-formatted welcome messages to your new subscribers.",url:"https://www.youtube.com/watch?v=P3yXe-XLEtY&list=PLpzjxyndddwKn0VuIEn8vMvKkczsPhmgB&index=7",thumbnailUrl:"https://i.ytimg.com/vi/P3yXe-XLEtY/mqdefault.jpg"},{title:"Find Twitter Influencers on YouTube",description:"Export a full list of your subscribers along with their Twitter/Facebook info.",url:"https://www.youtube.com/watch?v=rodGhLkNXw0&list=PLpzjxyndddwKn0VuIEn8vMvKkczsPhmgB&index=8",thumbnailUrl:"https://i.ytimg.com/vi/rodGhLkNXw0/mqdefault.jpg"}],resources:[{title:"How to grow with 0 Views and 0 Subscribers",source:"Video Creators",sourceUrl:"https://www.youtube.com/user/videocreators",url:"https://www.youtube.com/watch?v=boBex_v3_eA",thumbnailUrl:"https://i.ytimg.com/vi/boBex_v3_eA/mqdefault.jpg"},{title:"How to get more Views on YouTube",source:"Darral Eves",sourceUrl:"https://www.youtube.com/channel/UC3pV6eELigzhTjzBUPmT6_A",url:"https://www.youtube.com/watch?v=bBFlwytJu_4",thumbnailUrl:"https://i.ytimg.com/vi/bBFlwytJu_4/mqdefault.jpg"}]},playlists:{name:"Playlists",tubeBuddyTools:[{title:"How-To Videos",description:"There are no tools specific to the page you are on. Check out our how-to playlist.",url:"https://www.youtube.com/playlist?list=PLpzjxyndddwKn0VuIEn8vMvKkczsPhmgB",thumbnailUrl:TBGlobal.host+"/images/icons/how-to.png"}],resources:[{title:"YouTube Creator Playbook [Playlists]",source:"YouTube",sourceUrl:"http://www.youtube.com",url:"http://www.youtube.com/yt/playbook/playlists.html",thumbnailUrl:TBGlobal.host+"/images/icons/social/youtube-video.png"},{title:"YouTube Playlists: The Complete Guide Intro - Vidpow",source:"Vidpow",sourceUrl:"http://www.youtube.com/user/vidpowbam",url:"https://www.youtube.com/watch?v=Fxq4sgOsVMQ",thumbnailUrl:"https://i.ytimg.com/vi/Fxq4sgOsVMQ/mqdefault.jpg"},{title:"Increase Watch Time by Sharing your Video's Playlist URL",source:"ReelSEO",sourceUrl:"http://www.reelseo.com/",url:"https://www.youtube.com/watch?v=UKjNEGISOlM",thumbnailUrl:"https://i.ytimg.com/vi/UKjNEGISOlM/mqdefault.jpg"}]},cards:{name:"Cards",tubeBuddyTools:[{title:"How-To Videos",description:"There are no tools specific to the page you are on. Check out our how-to playlist.",url:"https://www.youtube.com/playlist?list=PLpzjxyndddwKn0VuIEn8vMvKkczsPhmgB",thumbnailUrl:TBGlobal.host+"/images/icons/how-to.png"}],resources:[{title:"YouTube Creator Playbook [Playlists]",source:"YouTube",sourceUrl:"http://www.youtube.com",url:"http://www.youtube.com/yt/playbook/playlists.html",thumbnailUrl:TBGlobal.host+"/images/icons/social/youtube-video.png"},{title:"YouTube Playlists: The Complete Guide Intro - Vidpow",source:"Vidpow",sourceUrl:"http://www.youtube.com/user/vidpowbam",url:"https://www.youtube.com/watch?v=Fxq4sgOsVMQ",thumbnailUrl:"https://i.ytimg.com/vi/Fxq4sgOsVMQ/mqdefault.jpg"},{title:"Increase Watch Time by Sharing your Video's Playlist URL",source:"ReelSEO",sourceUrl:"http://www.reelseo.com/",url:"https://www.youtube.com/watch?v=UKjNEGISOlM",thumbnailUrl:"https://i.ytimg.com/vi/UKjNEGISOlM/mqdefault.jpg"}]},annotations:{name:"Annotations",tubeBuddyTools:[{title:"How-To Videos",description:"There are no tools specific to the page you are on. Check out our how-to playlist.",url:"https://www.youtube.com/playlist?list=PLpzjxyndddwKn0VuIEn8vMvKkczsPhmgB",thumbnailUrl:TBGlobal.host+"/images/icons/how-to.png"}],resources:[{title:"YouTube Creator Playbook [Playlists]",source:"YouTube",sourceUrl:"http://www.youtube.com",url:"http://www.youtube.com/yt/playbook/playlists.html",thumbnailUrl:TBGlobal.host+"/images/icons/social/youtube-video.png"},{title:"YouTube Playlists: The Complete Guide Intro - Vidpow",source:"Vidpow",sourceUrl:"http://www.youtube.com/user/vidpowbam",url:"https://www.youtube.com/watch?v=Fxq4sgOsVMQ",thumbnailUrl:"https://i.ytimg.com/vi/Fxq4sgOsVMQ/mqdefault.jpg"},{title:"Increase Watch Time by Sharing your Video's Playlist URL",source:"ReelSEO",sourceUrl:"http://www.reelseo.com/",url:"https://www.youtube.com/watch?v=UKjNEGISOlM",thumbnailUrl:"https://i.ytimg.com/vi/UKjNEGISOlM/mqdefault.jpg"}]}};var m=function(){if(TBExtension.GetType()=="chrome"){jQuery(".tb-layout-chrome-icon").show();TBExtension.GetDbValue("tb-rated-chrome-store",function(e,t){TBUtilities.Log("tb-rated-chrome-store: "+t);if(t==true)jQuery(".tb-layout-goto-rating-container").hide()})}else if(TBExtension.GetType()=="firefox"){jQuery(".tb-layout-firefox-icon").show();TBExtension.GetDbValue("tb-rated-firefox-store",function(e,t){TBUtilities.Log("tb-rated-firefox-store: "+t);if(t==true)jQuery(".tb-layout-goto-rating-container").hide()})}jQuery(".tb-layout-channel-launch-pad-link").attr("href",TBGlobal.host+"/launchpad/dashboard/"+TBGlobal.CurrentChannelId());jQuery(".tb-layout-channel-health-report-link").attr("href",TBGlobal.host+"/channel/healthreport/"+TBGlobal.CurrentChannelId());jQuery(".tb-layout-channel-valuation-link").attr("href",TBGlobal.host+"/channel/valuation/"+TBGlobal.CurrentChannelId());jQuery(".tb-layout-channel-competitor-scorecard-link").attr("href",TBGlobal.host+"/channel/competitors/"+TBGlobal.CurrentChannelId());jQuery(".tb-layout-channel-brand-alerts-link").attr("href",TBGlobal.host+"/channel/brandalertlist/"+TBGlobal.CurrentChannelId());jQuery(".tb-layout-channel-ab-tests-link").attr("href",TBGlobal.host+"/channel/abtestlist/"+TBGlobal.CurrentChannelId());jQuery(".tb-layout-channel-backups-and-export-link").attr("href",TBGlobal.host+"/channel/backup/"+TBGlobal.CurrentChannelId());jQuery(".tb-layout-channel-canned-responses-link").attr("href",TBGlobal.host+"/channel/cannedresponses/"+TBGlobal.CurrentChannelId());jQuery(".tb-layout-channel-settings-link").attr("href",TBGlobal.host+"/channel/preferences/"+TBGlobal.CurrentChannelId());jQuery(".tb-layout-channel-promo-materials-link").attr("href",TBGlobal.host+"/promomaterials/channel/"+TBGlobal.CurrentChannelId());jQuery(".tb-layout-channel-search-rank-tracking-link").attr("href",TBGlobal.host+"/keywordranktracking/keywordrankingreport/"+TBGlobal.CurrentChannelId());jQuery(".tb-layout-channel-usage-statistics-link").attr("href",TBGlobal.host+"/channel/usage/"+TBGlobal.CurrentChannelId())};var v=function(){try{var e=TBUtilities.GetUrlParameter("tbft");o=e==1||e=="1";var t=TBGlobal.host+"/ModuleManager/layout?v="+TBGlobal.versionNumber+"&hl="+TBGlobal.languageCode;if(loadLocalHTML&&(TBExtension.GetType()=="chrome"||TBExtension.GetType()=="firefox")){t=chrome.extension.getURL("modules/layout.html")}else if(loadLocalHTML&&TBExtension.GetType()=="safari"){t="modules/layout.html"}TBExtension.Get(t,"TBLoadLayoutTemplate")}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyLayout] loadHtml"})}};var g=function(){try{}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyLayout] loadCss"})}};var T=function(){};var w=function(){if(jQuery("#tb-industry-milestones-loading").css("display")!="none"){TBUtilities.Log("Loading Milestones");TBExtension.Get(TBGlobal.host+TBGlobal.apiUrls.youtubeChannelGetMilestones,"TBLoadLayoutLoadMilestones")}};var k=function(){t=false;jQuery(".tb-layout-menu-dropdown:first").hide();q();clearTimeout(n);n=null};var x=false;var B=function(){jQuery(document.body).on("tbGetLastMilestone",function(e,t){TBUtilities.Log("tbGetLastMilestone response");TBUtilities.Log(t);if(t){var i=new Date(new Date(t.value).getTime()+60*60*12*1e3);TBUtilities.Log(i);if(new Date<i){TBUtilities.Log("Done since yesterday");return}}TBUtilities.Log("Trigger Click");w()});jQuery(document.body).on("tbGetLastMilestoneItem",function(e,t){TBUtilities.Log("tbGetLastMilestoneItem response");TBUtilities.Log(t);if(t){b=t.value}});jQuery(document).on("click",".tb-site-login-dialog-closex",function(){jQuery("#tb-site-login-dialog").hide();TubeBuddyLayout.HideBackground()});jQuery(document).on("click","#tb-layout-tb-tools-subscribe-tb-button",function(){TBUtilities.Log("Clicked Subscirbe");TBExtension.Get(TBGlobal.host+TBGlobal.apiUrls.youtubeChannelMarkAsSubscribedToTubeBuddy,"")});jQuery(document).on("click","[data-action]",function(){X(jQuery(this).data("action"))});jQuery(document).on("click",".ytd-notification-topbar-button-renderer",function(){if(x==true)return;x=true;setTimeout(function(){jQuery("ytd-notification-renderer").each(function(){if(jQuery(this).parent().attr("id")!="items")return;TBUtilities.Log("BB");var e=jQuery(this).find("a").attr("href");if(!e){TBUtilities.Log("No link");return}var t=e.indexOf("lc=")+3;var i=e.length;var o=e.substring(t,i);TBUtilities.Log("Link: "+e);TBUtilities.Log(o);if(!o)return;if(o.indexOf("?")>=0)return;if(o.indexOf("=")>=0)return;var r=TBUtilities.ReplaceAll(o,".","_");if(jQuery("#tb-layout-notification-item-"+r).length>0)return;var n=jQuery(this).find(".text.style-scope.ytd-notification-renderer").height()+15;jQuery(this).prepend('<div id="tb-layout-notification-reply-'+r+'" class="tb-layout-notification-reply" data-comment-id="'+r+'" style="position:absolute; text-align:center; height:20px; top:'+(n-15)+'px; left:13px; cursor:pointer; width:50px; color:blue;"><img id="tb-layout-notification-'+r+'" src="'+TBGlobal.host+'/images/branding/icon_tiny.png" style="margin-right: 2px; vertical-align: text-bottom; position:relative; top:-1px;" /> <span style="opacity:.5">reply</span></div>');TBUtilities.Log(n);var a=" ";try{var s=jQuery(this).find("yt-formatted-string.message:first").text();s=s.substring(0,s.indexOf(":"));var l=s.split(" ");for(var d=0;d<l.length-1;d++)a+=l[d]+" "}catch(e){}var u=jQuery(".tb-layout-notification2-comment-block:last")[0].outerHTML;u=TBUtilities.ReplaceAll(u,"#COMMENT_ID#",r);u=TBUtilities.ReplaceAll(u,"#TOP#",n-20+"px");u=TBUtilities.ReplaceAll(u,"#COMMENTER#",a);jQuery(this).prepend(u)});jQuery(".feed-item-container").removeClass("yt-uix-tile");jQuery(".feed-item-container").each(function(){jQuery(this).removeClass("yt-uix-tile")})},1050)});jQuery(document).on("click",".tb-env",function(){});jQuery(document).on("click","#tb-popout-milestones-tab-header",function(){TBUtilities.Log("Clicked Milestones");w()});jQuery(document).on("change",".requiredCheckbox",function(){if(jQuery(".requiredCheckbox:checked").length==2){jQuery("#tb-sign-in-link").attr("href",jQuery("#tb-sign-in-link").attr("data-url"));jQuery("#tb-sign-in-link").css("cursor","pointer");jQuery("#tb-sign-in-link").attr("title","");var e=jQuery("#tb-sign-in-img").attr("src");jQuery("#tb-sign-in-img").attr("src",e.replace("login-disabled.png","login.png"));jQuery("#tb-sign-in-link").off("click");jQuery("#tb-sign-in-link").click(function(){var e=new Date;e.setFullYear(e.getFullYear()+10);TBUtilities.CreateCookie("GdprApprovalDate","true",10*365)})}else{I()}});jQuery(document).on("click","#yt-masthead-notifications-button",function(){setTimeout(function(){jQuery(".feed-item-container").each(function(){TBUtilities.Log("BB");var e=jQuery(this).find(".yt-lockup-content:first").find("h3").find("a").attr("href");if(!e){TBUtilities.Log("No link");return}var t=e.indexOf("lc=")+3;var i=e.length;var o=e.substring(t,i);TBUtilities.Log("Link: "+e);TBUtilities.Log(o);if(!o)return;if(o.indexOf("?")>=0)return;if(o.indexOf("=")>=0)return;var r=TBUtilities.ReplaceAll(o,".","_");if(jQuery("#tb-layout-notification-item-"+r+"-post").length>0)return;jQuery(this).find(".yt-lockup-byline").first("li").append('&nbsp; <img id="tb-layout-notification-'+r+'" src="'+TBGlobal.host+'/images/branding/icon_tiny.png" style="margin-right: 2px; vertical-align: text-bottom; position:relative; top:-1px;"><a id="tb-layout-notification-reply-'+r+'" class="tb-layout-notification-reply" data-comment-id="'+r+'">Reply</a>');var n=jQuery(".tb-layout-notification-comment-block:first")[0].outerHTML;n=TBUtilities.ReplaceAll(n,"#COMMENT_ID#",r);jQuery(this).find(".yt-lockup-byline").after(n)});jQuery(".feed-item-container").removeClass("yt-uix-tile");jQuery(".feed-item-container").each(function(){jQuery(this).removeClass("yt-uix-tile")})},1050)});jQuery(document).on("click",".tb-notification-comment-reply",function(e){e.stopPropagation()});jQuery(document).on("click",".tb-layout-notification-reply",function(e){TBUtilities.Log(".tb-layout-notification-reply");var t=jQuery(this).attr("data-comment-id");TBUtilities.Log(t);if(jQuery("#tb-layout-notification-item-"+t).is(":visible")){jQuery("#tb-layout-notification-item-"+t).hide()}else{jQuery("#tb-layout-notification-item-"+t).show()}TBUtilities.Log("#tb-layout-notification-item-"+t);TBUtilities.Log(jQuery("#tb-layout-notification-item-"+t).length);e.stopPropagation()});jQuery(document).on("click",".tb-layout-notification-cancel-button",function(e){TBUtilities.Log(".tb-layout-notification-cancel-button");jQuery(this).closest(".tb-layout-notification-comment-block").hide();jQuery(this).closest(".tb-layout-notification2-comment-block").hide();e.stopPropagation()});jQuery(document).on("click",".tb-layout-notification-reply-button",function(e){TBUtilities.Log(".tb-layout-notification-reply-button");var t=jQuery(this).attr("data-comment-id");var i=jQuery("#tb-notification-comment-reply-"+t).val();TBUtilities.Log(i);TBUtilities.Log(t);if(!i){TBUtilities.Alert("You must enter a Comment");return}var o=TBUtilities.ReplaceAll(t,"_",".");jQuery(this).attr("disabled","disabled");var r=jQuery.param({ParentCommentId:o,CommentText:i});TBExtension.Post(TBGlobal.host+TBGlobal.apiUrls.youtubeApiPostCommentReply,r,"TBLayoutPostCommentReply",{commentId:t});jQuery("#tb-layout-notification-reply-loading-"+t).show();TBUtilities.AddAction(null,TBUtilities.ActionTypes.NotificationMenu_PostCommentReply,"navwindowcomments");e.stopPropagation()});TBGlobal.AddProfileUpdateListener(S);var e=document.querySelector("title");if(c==null){c=window.location.toString()}var i=new MutationObserver(function(e){if(e&&e.length>0){TBUtilities.Log(e[0].target.nodeValue)}if(c!=window.location.toString()){c=window.location.toString();TBUtilities.Log("tile and url updated");TBGlobal.LoadModules(null,true)}});var o={subtree:true,characterData:true,childList:true};i.observe(e,o);jQuery(document).on("click","#tb-layout-debug-toggle",function(){if(jQuery(this).hasClass("yt-uix-button-destructive")){jQuery(this).removeClass("yt-uix-button-destructive");jQuery(this).addClass("yt-uix-button-payment");jQuery(this).find("span").text("Debug mode ON");jQuery("body").append(jQuery("#tb-debug-modal-template").html());h=jQuery("html").html()}else{jQuery(this).addClass("yt-uix-button-destructive");jQuery(this).removeClass("yt-uix-button-payment");jQuery(this).find("span").text("Debug mode OFF");jQuery("#tb-debug-modal:first").remove()}});jQuery(document).on("click","#tb-layout-debug-send",function(){jQuery(this).prop("disabled",true);jQuery(this).find("span").text("Sending....");L()});jQuery(document).on("click",".tb-module-close",function(){jQuery(this).closest(".tb-module-template").hide();TubeBuddyLayout.HideBackground()});jQuery(document).on("click",".tb-layout-realtime-analytics",function(){q();k()});jQuery(document).on("click","#tb-popout-messages-tab-header",function(){jQuery.each(TBGlobal.Profile().SystemMessageProductUpdates,function(e,t){TBExtension.SetDbValue("tbMessage"+t.Id,true)})});jQuery(document).on("click",".tb-show-upgrade-page",function(){TBGlobal.ShowUpgradePage()});jQuery(document).on("click",".tb-layout-view-diagnostics",function(){jQuery(".tb-layout-diagnostics").show();jQuery(this).hide()});jQuery(document).on("click",".tb-show-upgrade-page-featured",function(){TBGlobal.ShowUpgradePage(null,"featured")});jQuery(document).on("click",".tb-show-upgrade-page-support",function(){TBGlobal.ShowUpgradePage(null,"support")});jQuery(document).on("click",".tb-layout-feature-suggest-link",function(){K(TubeBuddyLayout.Tabs.SubmitIdea)});jQuery(document).on("click",".tb-layout-send-to-tubebuddy",function(){var e=TBGlobal.GetDiagnostics()+"<br><br><br>\n\n\n"+TBGlobal.UserDebugCode();TBUtilities.AddActivityLog({Data:diagnostics},TBUtilities.ActivityLogTypes.Layout_SubmitDebugCode);jQuery(".tb-layout-diagnostics").hide();TBUtilities.Alert("Thanks! We will look at the data and get back to you if needed.")});jQuery(document).on("focus",".yt-commentbox-text, .comment-simplebox-text, textarea.iron-autogrow-textarea, textarea.tp-yt-iron-autogrow-textarea",function(){jQuery(".tb-emoji-toggle").hide();jQuery(this).before('<span style="position:absolute; right:2px; top:-1px; opacity:.7; z-index:99999999" class="tb-emoji-toggle"><img src="'+TBGlobal.host+'/images/modules/emoji/face.png" style=" cursor:pointer; position:relative; top:5px;" /></span>')});jQuery(document).on("click",".tb-emoji-toggle",function(){if(TBExtension.GetType()=="safari"){window.open("http://getemoji.com")}else{var e=jQuery(this).next();if(e.attr("tb-emoji-added")!=="1"){e.emojiPicker({height:"300px",width:"450px",button:false});e.attr("tb-emoji-added","1")}e.emojiPicker("toggle")}});jQuery(document).on("click",".tb-layout-goto-rating",function(){TBExtension.SetDbValue("tb-rated-chrome-store",true);jQuery(".tb-layout-goto-rating-container").hide()});jQuery(document).on("click",".tb-layout-goto-firefox-rating",function(){TBExtension.SetDbValue("tb-rated-firefox-store",true);jQuery(".tb-layout-goto-firefox-rating-container").hide()});jQuery(document).on("click","#tb-modal-overlay",function(){if(t){J();jQuery(".tb-layout-menu-dropdown:first").hide()}if(!s)z()});jQuery(document).on("click","#tb-modal-overlay-menu",function(){J();jQuery(".tb-layout-menu-dropdown:first").hide()});jQuery(document).on("click",".tb-manage-account-close",function(){z()});jQuery(document).on("click",".tb-popout-tab-header",function(){try{var e=jQuery(this).attr("data-tab-id");switch(e){case"tb-popout-home-tab":_();break}jQuery(".tb-popout-tab").hide();jQuery("#"+jQuery(this).attr("data-tab-id")).fadeIn();jQuery(".tb-popout-tab-header").removeClass("selected");jQuery(this).addClass("selected")}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyLayout] tb-popout-tab-header [click]"})}});jQuery(document).on("click","#tb-layout-home-subscribe-to-tubebuddy",function(){TubeBuddyYouTubeActions.SubscribeToChannel("UCo33niDKpTpgwZ_dohqvylg","");jQuery("#tb-layout-home-issubscribed").show();jQuery("#tb-layout-home-subscribe-to-tubebuddy").hide()});jQuery(document).on("click",".tb-layout-links-my-account",function(){K(TubeBuddyLayout.Tabs.Profile)});jQuery(document).on("click",".tb-layout-links-home",function(){K(TubeBuddyLayout.Tabs.Home)});jQuery(document).on("click",".tb-layout-links-submit-idea",function(){K(TubeBuddyLayout.Tabs.SubmitIdea)});jQuery(document).on("click",".tb-my-videos, .tb-pop-out-token-error",function(){if(jQuery(".tb-layout-menu-dropdown:first").is(":visible")){J();jQuery(".tb-layout-menu-dropdown:first").hide()}else{G(d||l)}});jQuery(document).on("click","#yt-masthead-content",function(){if(jQuery(".tb-layout-menu-dropdown:first").is(":visible")){J();jQuery(".tb-layout-menu-dropdown:first").hide()}});jQuery(document).on("click","#tb-modal-overlay",function(){if(!s)z();k()});jQuery(document).on("click",".tb-layout-tag-explorer-link",function(){s=true;k();H();var e=jQuery(this);TBUtilities.Log(jQuery(".video-settings-tag-chips-container").length);if(jQuery(".video-settings-tag-chips-container").length>0)e=jQuery(".video-settings-add-tag:first");TBUtilities.Log(jQuery(".video-settings-add-tag:first").length);TubeBuddyKeywordExplorer.Show(null,e)});jQuery(document).on("click",".tb-layout-topic-generator-link",function(){s=true;k();H();TubeBuddyTopicGenerator.Show()});jQuery(document).on("click",".tb-layout-best-time-to-publish-link",function(){s=true;k();H();TubeBuddyBestTimeToPublish.ShowBestTimeToPublish()});jQuery(document).on("click",".tb-layout-tag-lists-link",function(){s=true;k();H();TubeBuddyTagLists.Show()})};var j=function(){jQuery("#tb-layout-support-widget-loading").hide()};var L=function(e){jQuery("#tb-layout-debug-toggle").addClass("yt-uix-button-destructive");jQuery("#tb-layout-debug-toggle").removeClass("yt-uix-button-payment");jQuery("#tb-layout-debug-toggle").find("span").text("Debug mode OFF");var t=jQuery("html").html();var i=TBUtilities.GetDebugEntries();html2canvas(document.body,{onrendered:function(e){var o=jQuery.param({StartingHTML:h,EndingHTML:t,ScreenShot:e.toDataURL(),Logs:i});TBExtension.Post(TBGlobal.host+TBGlobal.apiUrls.debugAddLog,o);jQuery("#tb-debug-modal:first").remove();h="";TBUtilities.Alert("Thanks! We will review the info and get back to you.")}})};var C=function(){jQuery(".tb-pop-out-token-error").show()};var Q=function(){jQuery(".tb-pop-out-token-error").hide()};var U=function(){var e=TBGlobal.GetYouTubeUI();var t=null;switch(e){case"material":{t="#page-manager";break}case"studio":case"default":{t="#content";break}}return t};var I=function(){var e="Please review our Privacy Policy and Terms of Use and check the boxes that you agree before logging in.";jQuery("#tb-sign-in-link").attr("href","#");jQuery("#tb-sign-in-link").css("cursor","default");jQuery("#tb-sign-in-link").attr("title",e);var t=jQuery("#tb-sign-in-img").attr("src");jQuery("#tb-sign-in-img").attr("src",t.replace("login.png","login-disabled.png"));jQuery("#tb-privacy").css("display","block");jQuery("#tb-sign-in-link").off("click");jQuery("#tb-sign-in-link").click(function(t){t.preventDefault();alert(e);jQuery(".required-checkbox-container").css("background-color","yellow");return false})};var S=function(){try{if(TBGlobal.Profile()==null){TBGlobal.ReloadProfile();TBYouTubeApi.GetChannelDetails(TBGlobal.CurrentChannelId(),null,P);var e=TBUtilities.GetCookie("GdprApprovalDate");if(!e){I()}return}jQuery("#tb-layout-settings-comment-canned-responses").prop("checked",TBGlobal.Profile().SettingsShowCommentCannedResponses);jQuery("#tb-layout-settings-community-connect").prop("checked",TBGlobal.Profile().SettingsShowCommunityConnect);jQuery("#tb-popout-channel-thumbnail").attr("src",TBGlobal.Profile().ThumbnailUrl);jQuery("#tb-popout-insider-thumbnail").attr("src",TBGlobal.Profile().ThumbnailUrl);jQuery("#tb-popout-channel-title").text(TBGlobal.Profile().Title);var t=TBGlobal.Profile().LicenseName;if(TBGlobal.Profile().NetworkType>=1){t+=' | <img style="height:16px; position:relative; top:2px;" src="'+TBGlobal.host+TBGlobal.Profile().NetworkLogoUrl+'" /> <a target="_blank" href="'+TBGlobal.Profile().NetworkWebsite+'">'+TBGlobal.Profile().NetworkName+"</a>"}jQuery("#tb-layout-license-name").html(t);jQuery(".tb-popout-channel-thumbnail").attr("src",TBGlobal.Profile().ThumbnailUrl);jQuery(".tb-popout-channel-title").text(TBGlobal.Profile().Title);if(TBGlobal.Profile().ThumbnailUrl==null||TBGlobal.Profile().ThumbnailUrl==""){TBYouTubeApi.GetChannelDetails(TBGlobal.CurrentChannelId(),null,P)}if(TBGlobal.Profile().UserIdForLoginLink!=null)jQuery("#tb-layout-my-account").attr("href",TBGlobal.host+"/account?UserIdForLoginLink="+TBGlobal.Profile().UserIdForLoginLink);else jQuery("#tb-layout-my-account").attr("href",TBGlobal.host+"/account?EmailHint="+TBGlobal.Profile().GoogleEmail);TBUtilities.Log("LOOKING FOR SYSTEM MESSAGES");if(TBGlobal.Profile().SystemMessages.length>0){jQuery("#tb-popout-messages-tab-header").show();jQuery("#tb-layout-messages-list").empty();if(TBGlobal.Profile().SystemMessageAlerts.length>0){l=true;var i='<div style="padding:7px 0px 0px 8px; margin-bottom:6px; margin-right:15px; background-color:red;"> <span style="color:white; font-size:18px; position:relative; top:-3px; font-weight:500">Alerts</span></div>';jQuery("#tb-layout-messages-list").append(i);jQuery.each(TBGlobal.Profile().SystemMessageAlerts,function(e,t){var i='<div style="padding:5px 5px 7px">';i+='<div style="font-size:13px; font-weight:500; padding-left:5px; color:red; margin-bottom:3px;"><img src="'+TBGlobal.host+'/images/icons/button-red.png" style="padding-right:2px; height:10px; position:relative; top:0px;" />'+t.DisplayOnDateFriendly+"</div>";i+='<div style="font-size:14px; padding-left:15px; padding-right:20px; color:#333; line-height:20px; font-weight:normal;">'+t.Message+"</div>";i+="</div>";jQuery("#tb-layout-messages-list").append(i)})}jQuery.each(TBGlobal.Profile().SystemMessageProductUpdates,function(e,t){TBExtension.GetDbValue("tbMessage"+t.Id,function(e,i){TBUtilities.Log("Unread blue: "+t.Id+": "+i);if(!i){d=true;jQuery(".tb-layout-messages-image").attr("src",TBGlobal.host+"/images/icons/button-blue.png");jQuery(".tb-layout-menu-image").css("display","none");jQuery(".tb-layout-messages-image").show()}})});if(TBGlobal.Profile().SystemMessageProductUpdates.length>0){jQuery(".tb-layout-messages-icon").attr("src",TBGlobal.host+"/images/icons/button-blue.png");jQuery(".tb-layout-messages-icon").show();var i='<div style="padding:8px 0px 0px 8px; margin-bottom:6px; margin-right:15px; background-color:#3399cc;"> <span style="color:white; font-size:18px; position:relative; top:-3px; font-weight:500">TubeBuddy Updates</span></div>';jQuery("#tb-layout-messages-list").append(i);jQuery.each(TBGlobal.Profile().SystemMessageProductUpdates,function(e,t){var i='<div style="padding:5px 5px 7px">';i+='<div style="font-size:13px; font-weight:500; padding-left:5px; color:#3399cc; margin-bottom:3px;"><img src="'+TBGlobal.host+'/images/icons/button-blue.png" style="padding-right:2px; height:10px; position:relative; top:0px;" />'+t.DisplayOnDateFriendly+"</div>";i+='<div style="font-size:14px; padding-left:15px; padding-right:20px; color:#333; line-height:20px; font-weight:normal;">'+t.Message+"</div>";i+="</div>";jQuery("#tb-layout-messages-list").append(i)})}TBUtilities.Log("Buddont");if(l){jQuery(".tb-layout-messages-icon").attr("src",TBGlobal.host+"/images/icons/button-red.png");jQuery(".tb-layout-messages-image").attr("src",TBGlobal.host+"/images/icons/button-red.png");jQuery(".tb-layout-menu-image").css("display","none");jQuery(".tb-layout-messages-icon").show();jQuery(".tb-layout-messages-image").show()}else if(d){TBUtilities.Log("blue");jQuery(".tb-layout-messages-image").attr("src",TBGlobal.host+"/images/icons/button-blue.png");jQuery(".tb-layout-menu-image").css("display","none");jQuery(".tb-layout-messages-image").show()}}else{jQuery("#tb-popout-messages-tab-header").hide()}var o=TBUtilities.GetTimeZoneOffSetInHours();var r="";if(TBGlobal.Profile()!=null)r="&agencyid="+encodeURIComponent(TBGlobal.Profile().AgencyId);if(r==null)r="";jQuery(".tb-missing-token-oauth-link-add").attr("href",TBGlobal.host+"/oauth/AuthRedirect?channelid="+TBGlobal.CurrentChannelId()+"&redirectUrl="+encodeURIComponent(window.location)+"&timeZoneOffset="+encodeURIComponent(o)+"&agencyId="+r+"&via=extension&channelId="+TBGlobal.CurrentChannelId());jQuery("#tb-layout-linked-channels-list").empty();if(TBGlobal.Profile().NetworkType>=1){jQuery("#tb-layout-profile-network-checking").hide();jQuery("#tb-layout-profile-network-check").hide();jQuery("#tb-popout-profile-has-network").html('<img src="'+TBGlobal.host+TBGlobal.Profile().NetworkLogoUrl+'" style="height:15px; margin-right:3px; position:relative; top:1px; left:1px" /> '+TBGlobal.Profile().NetworkName);jQuery("#tb-popout-profile-has-network").attr("href",TBGlobal.Profile().NetworkWebsite);jQuery("#tb-popout-profile-has-network").show()}if(TBGlobal.Profile().EnableDebug&&TBGlobal.Profile().EnableDebug==true){jQuery("#tb-layout-debug-panel").show();jQuery("#tb-layout-support-panel").css("margin-bottom","0px")}if(TBGlobal.Profile().IsSubscribedToTubeBuddy===true){TBUtilities.Log("Is Subscribed to TubeBuddy")}else if(TBGlobal.Profile().IsSubscribedToTubeBuddy===false){TBUtilities.Log("Is NOT Subscribed to TubeBuddy");jQuery("#tb-layout-tb-tools-container").css("max-height","320px");jQuery("#tb-layout-tb-tools-subscribe-tb").show()}else{TBUtilities.Log("NULL Subscribed to TubeBuddy");TBExtension.Get("https://www.youtube.com/channel/UCo33niDKpTpgwZ_dohqvylg","tbLayoutGetTubeBuddyPage")}if(TBGlobal.Profile().IsLoggedIn){jQuery("#tb-layout-web-signed-out").hide();jQuery("#tb-layout-web-signed-in").show()}else{var o=TBUtilities.GetTimeZoneOffSetInHours();jQuery("#tb-layout-sign-in-button").attr("href",TBGlobal.host+"/oauth/AuthRedirectLogin/?channelid="+TBGlobal.CurrentChannelId()+"&redirectUrl="+encodeURIComponent(window.location)+"&timeZoneOffset="+encodeURIComponent(o)+"&via=extension&channelId="+TBGlobal.CurrentChannelId());jQuery("#tb-layout-web-signed-out").show();jQuery("#tb-layout-web-signed-in").hide()}jQuery("#tb-layout-logged-in-email").text(TBGlobal.Profile().Email)}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyLayout] loadProfile"})}};var A;var E=function(e){try{A=chanel;TBYouTubeApi.GetChannelDetails(TBUtilities.GetUrlParameter("cid"),null,D)}catch(e){}};var D=function(e){try{var t=""}catch(e){}};var R=function(){jQuery(document.body).on("tbLayoutGetTubeBuddyPage",function(e,t){TBUtilities.Log("tbLayoutGetTubeBuddyPage");try{if(t.success){TBUtilities.Log(t.response.length);var i=t.response.lastIndexOf(',"subscribed":')+',"subscribed":'.length;TBUtilities.Log("START: "+i);TBUtilities.Log("VAL: "+t.response.substring(i,i+1));var o=t.response.substring(i,i+1);if(o!="t"){TBUtilities.Log("Not Subscribed");jQuery("#tb-layout-tb-tools-container").css("max-height","320px");jQuery("#tb-layout-tb-tools-subscribe-tb").show();TBExtension.Get(TBGlobal.host+TBGlobal.apiUrls.youtubeChannelMarkAsNotSubscribedToTubeBuddy,"")}else{TBUtilities.Log("Subscribed");TBExtension.Get(TBGlobal.host+TBGlobal.apiUrls.youtubeChannelMarkAsSubscribedToTubeBuddy,"")}}}catch(e){}});jQuery(document.body).on("TBLayoutPostCommentReply",function(e,t){TBUtilities.Log("TBLayoutPostCommentReply");TBUtilities.Log(e);TBUtilities.Log(t);try{if(t.success){var i=t.data.commentId;if(t.response=='"success"'){jQuery("#tb-layout-notification-item-"+i+"-post").hide();jQuery("#tb-layout-notification-item-"+i+"-posted").show();jQuery("#tb-layout-notification-reply-"+i).hide();jQuery("#tb-layout-notification-reply-loading-"+i).hide();jQuery("#tb-layout-notification-"+i).hide()}else{TBUtilities.Alert("Sorry, there was a problem posting your comment.\r\n\r\nError: "+t.response)}}else{TBUtilities.Alert("Sorry, there was a problem posting your comment.\r\n\r\nIf this continues, contact TubeBuddy")}}catch(e){}});jQuery(document.body).on("TBWindowMessage",function(e,t){try{if(t.settings.tab==null)t.settings.tab="profile";var i=0;switch(t.settings.tab){case"support":i=3;break}z();TubeBuddyLayout.ShowTubeBuddyPanel(i)}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyLayout] CRTBWindowMessage"})}});jQuery(document.body).on("TBGetRandomGuid",function(e,t){try{if(t.success){var i=jQuery.parseJSON(t.response);if(i!=null&&i.length==36){jQuery(".tb-missing-token-oauth-link").each(function(e,t){var o=jQuery(this).prop("href");var r=TBUtilities.UpdateUrlParameter(o,"agencyid",i);jQuery(this).prop("href",r)})}}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyLayout] CRTBGetRandomGuid"})}});jQuery(document.body).on("TBLoadLayoutLoadMilestones",function(e,t){TBUtilities.Log("TBLoadLayoutLoadMilestones");TBUtilities.Log(t);try{if(t.success){TBExtension.SetDbValue("tb-last-milestone-fetch-"+TBGlobal.CurrentChannelId(),(new Date).toString(),"");TBUtilities.Log("Added DB Value - "+new Date);var i=JSON.parse(t.response);if(i.Milestones.length>0){var o=false;var r=0;jQuery.each(i.Milestones,function(e,t){TBUtilities.Log("Loop : foundRecent="+o+"   and newItems="+r);TBUtilities.Log(t.MilestoneText);TBUtilities.Log("_recentMilestoneItem: "+b);if(b==t.MilestoneText)o=true;if(!o)r++;var i=jQuery("#tb-milestone-item-template").html();i=TBUtilities.ReplaceAll(i,"{0}",TBGlobal.host+"/content/images/mobile/icons/Milestone"+t.MilestoneTypeFriendly+".png");i=TBUtilities.ReplaceAll(i,"{1}",t.MilestoneValueFriendly+" "+t.MilestoneTypeFriendly);i=TBUtilities.ReplaceAll(i,"{2}",t.MilestoneText);i=TBUtilities.ReplaceAll(i,"{3}",TBGlobal.host+t.CertificateUrl);i=TBUtilities.ReplaceAll(i,"{4}","https://www.facebook.com/sharer/sharer.php?u="+TBUtilities.GetUrlEncoded(TBGlobal.host+t.CertificateUrl));i=TBUtilities.ReplaceAll(i,"{5}","https://twitter.com/intent/tweet?text="+"My channel reached the "+t.MilestoneValueFriendly+" "+t.MilestoneTypeFriendly+" Milestone! &#x1f3c6; via @TubeBuddy "+TBUtilities.GetUrlEncoded(TBGlobal.host+t.CertificateUrl));jQuery("#tb-industry-milestones-container").append(i)});TBExtension.SetDbValue("tb-last-milestone-fetch-item-"+TBGlobal.CurrentChannelId(),i.Milestones[0].MilestoneText,"");if(r>0){jQuery("#tb-popout-milestones-tab-header-count").text(r);jQuery("#tb-popout-milestones-tab-header-count").fadeIn(1e3)}}else{jQuery("#tb-industry-milestones-container").append('<div style="padding:10px 14px">Sorry, no Milestones found in the last 30 days. <div style="padding-top:6px;">Come back when you hit your next Milestone (listed below)</div></div>')}jQuery("#tb-layout-views-next").html(DOMPurify.sanitize(i.NextViewsMilestone.MilestoneValueFriendly,DOMPurifyConfig));jQuery("#tb-layout-sub-next").html(DOMPurify.sanitize(i.NextSubscribersMilestone.MilestoneValueFriendly,DOMPurifyConfig));jQuery("#tb-layout-uploads-next").html(DOMPurify.sanitize(i.NextUploadsMilestone.MilestoneValueFriendly,DOMPurifyConfig));jQuery("#tb-layout-views-to-go").html(DOMPurify.sanitize("~"+i.NextViewsMilestone.MilestoneToGoValueFriendly+" to go",DOMPurifyConfig));jQuery("#tb-layout-sub-to-go").html(DOMPurify.sanitize("~"+i.NextSubscribersMilestone.MilestoneToGoValueFriendly+" to go",DOMPurifyConfig));jQuery("#tb-layout-uploads-to-go").html(DOMPurify.sanitize("~"+i.NextUploadsMilestone.MilestoneToGoValueFriendly+" to go",DOMPurifyConfig));jQuery("#tb-industry-milestones-loading").hide();jQuery("#tb-industry-milestones-container").show();jQuery("#tb-industry-milestones-container-next").show()}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyLayout] CRTBProfileUpdated"})}});jQuery(document.body).on("TBProfileUpdated",function(e,t){try{if(t.success){jQuery("#tb-popout-profile-save-button").text("Save Changes");jQuery("#tb-popout-success-message").hide();jQuery("#tb-popout-success-message").fadeIn();jQuery("#tb-popout-success-message-text").text("Your changes have been successfully saved!");TBGlobal.ReloadProfile()}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyLayout] CRTBProfileUpdated"})}});jQuery(document.body).on("TBLoadLayoutTemplate",function(e,t){try{if(t.success){t.response=TBUtilities.FixLocalHtml(DOMPurify.sanitize(t.response,DOMPurifyConfig));jQuery("body").append(t.response);jQuery("#tb-modal-overlay-menu").insertBefore("#body-container");jQuery("#tb-layout-login-webiste").attr("href",TBGlobal.host+"/oauth/AuthRedirectLogin/?channelid="+TBGlobal.CurrentChannelId()+"&redirectUrl="+encodeURIComponent(window.location)+"&timeZoneOffset="+encodeURIComponent(d)+"&via=extension&channelId="+TBGlobal.CurrentChannelId());var i=TBGlobal.GetYouTubeUI();TBUtilities.Log("TBLayout - TBLoadLayoutTemplate YouTubeUI = "+i);switch(i){case"material":{if(jQuery("#end").length>0){jQuery("#end").prepend(jQuery(".tb-layout-menu-container:last")[0].outerHTML);jQuery("#tb-modal-overlay-menu").css("z-index",2e3)}else{jQuery("#yt-masthead-user").prepend(jQuery(".tb-layout-menu-container:last")[0].outerHTML)}break}case"default":{jQuery("#yt-masthead-user").prepend(jQuery(".tb-layout-menu-container:last")[0].outerHTML);break}case"studio":{jQuery("#tb-layout-youtube-dashboard").attr("href","https://studio.youtube.com/channel/"+TBGlobal.CurrentChannelId());jQuery("#tb-layout-youtube-my-videos").attr("href","https://studio.youtube.com/channel/"+TBGlobal.CurrentChannelId()+"/videos/upload");jQuery("#tb-layout-youtube-my-playlists").attr("href","https://www.youtube.com/view_all_playlists");jQuery("#tb-layout-youtube-live-streaming").attr("href","https://studio.youtube.com/channel/"+TBGlobal.CurrentChannelId()+"/videos/live");jQuery("#tb-layout-youtube-comments").attr("href","https://studio.youtube.com/channel/"+TBGlobal.CurrentChannelId()+"/comments");jQuery("#tb-layout-youtube-subscribers").attr("href","https://www.youtube.com/subscribers");jQuery("#tb-layout-youtube-analytics").attr("href","https://studio.youtube.com/channel/"+TBGlobal.CurrentChannelId()+"/analytics/tab-overview/period-4_weeks");jQuery("#tb-layout-youtube-real-time").attr("href","https://www.youtube.com/analytics?o=U#r=realtime");jQuery("#tb-layout-youtube-messages").attr("href","https://www.youtube.com/messages");jQuery("#tb-layout-youtube-my-playlists").text("Playlists (Classic)");jQuery("#tb-layout-youtube-subscribers").text("Subscribers (Classic)");jQuery("#tb-layout-youtube-real-time").css("display","none");jQuery(document).on("click",".tb-layout-youtube-menu-item",function(){k()});jQuery("#left-nav").css("border-right","0");jQuery("#video-list").css("border-left","solid 1px #ddd");var r=jQuery("ytcp-icon-button#search-icon").css("visibility");if(r=="hidden")jQuery("ytcp-icon-button#search-icon").after(jQuery(".tb-layout-menu-container:last")[0].outerHTML);else jQuery("ytcp-icon-button#search-icon").before(jQuery(".tb-layout-menu-container:last")[0].outerHTML);var n=jQuery("#tb-modal-overlay-menu")[0].outerHTML;jQuery("#tb-modal-overlay-menu").remove();jQuery("#main-container").prepend(n);jQuery("#tb-modal-overlay-menu").css("z-index","2");jQuery(".tb-layout-menu-container").css("bottom","-5px");jQuery("#tb-main-menu").removeClass("tb-button-default");var a=TBExtension.GetFilePath("images/branding/icon_tiny_white.png");var s=TBExtension.GetFilePath("images/icons/menu_white.png");jQuery("#tb-main-menu").find("img:first").attr("src",a);jQuery(".tb-layout-menu-image").attr("src",s);jQuery("#main-container").prepend("<style type='text/css'> #tb-main-menu { background-color:#bf3730 !important; border:0px !important; border-radius:2px; }</style>");break}}jQuery(".tb-my-videos").show();jQuery(".tb-layout-channel-dashboard-link").attr("href",TBGlobal.host+"/channel/healthreport/"+TBGlobal.CurrentChannelId());var l=U();jQuery(l).append(jQuery(".tb-content-flag").clone().attr("data-is-flag","true")[0].outerHTML);jQuery("#tb-popout-channel-title").attr("href","https://www.youtube.com/channel/"+TBGlobal.CurrentChannelId());var d=TBUtilities.GetTimeZoneOffSetInHours();var u="";if(TBGlobal.Profile()!=null)u="&agencyid="+encodeURIComponent(TBGlobal.Profile().AgencyId);if(u==null)u="";jQuery(".tb-missing-token-oauth-link").attr("href",TBGlobal.host+"/oauth/AuthRedirect?channelid="+TBGlobal.CurrentChannelId()+"&redirectUrl="+encodeURIComponent(window.location)+"&timeZoneOffset="+encodeURIComponent(d)+u+"&via=extension&channelId="+TBGlobal.CurrentChannelId());jQuery(".tb-missing-token-oauth-link").attr("data-url",TBGlobal.host+"/oauth/AuthRedirect?channelid="+TBGlobal.CurrentChannelId()+"&redirectUrl="+encodeURIComponent(window.location)+"&timeZoneOffset="+encodeURIComponent(d)+u+"&via=extension&channelId="+TBGlobal.CurrentChannelId());if(TBGlobal.Profile()==null||!TBGlobal.Profile().HasAccessToken){if(TBGlobal.Profile()==null)TBGlobal.AddDiagnostic("lllt:PN");else if(!TBGlobal.Profile().HasAccessToken)TBGlobal.AddDiagnostic("lllt:NAT");C()}else{Q();jQuery("#tb-layout-research-tools").show();jQuery("#tb-layout-web-tools").show();jQuery("#tb-industry-news-container").empty();jQuery.each(TBGlobal.Profile().NewsItems,function(e,t){var i=jQuery("#tb-news-item-template").html();i=TBUtilities.ReplaceAll(i,"{0}",TBGlobal.host+"/images/mobile/industrynews/"+t.SourceNameNoSpace+".png");i=TBUtilities.ReplaceAll(i,"{1}",t.ShortenedUrl);i=TBUtilities.ReplaceAll(i,"{2}",t.Title);i=TBUtilities.ReplaceAll(i,"{3}",t.Preview);i=TBUtilities.ReplaceAll(i,"{4}",t.DateFriendly);TBUtilities.Log(t);jQuery("#tb-industry-news-container").append(i)})}if(o){jQuery("#tb-layout-logged-in").show();if(TBGlobal.GetYouTubeUI()=="studio"){jQuery("#tb-layout-logged-in-link").css("color","white")}jQuery("#tb-layout-logged-in-link").attr("href","https://www.youtube.com/channel/"+TBUtilities.GetUrlParameter("cid"));if(jQuery("#tb-pop-out-token-error-id").is(":visible")){jQuery("#tb-layout-logged-in").hide();var c='<div><b style="color:red; font-size:1.2em">Oops! You selected the wrong channel.</b></div>';c+='<div style="padding:13px 0 10px;">Here is a link to the channel you selected: <br><a target="_blank" href="https://www.youtube.com/channel/'+TBUtilities.GetUrlParameter("cid")+'">https://www.youtube.com/channel/'+TBUtilities.GetUrlParameter("cid")+"</a></div>";c+='<div style="padding:13px 0 10px;">This is the channel you\'re logged into YouTube with and should be selecting: <br><a target="_blank" href="https://www.youtube.com/channel/'+TBGlobal.CurrentChannelId()+'">https://www.youtube.com/channel/'+TBGlobal.CurrentChannelId()+"</a></div>";c+="<div style=\"padding:3px 0 10px;\">Sometimes the channel you select has the same logo and/or name so you think it's the same channel but it's actually not. So please try signing in again and selecting the channel that you're currently logged into YouTube with.</div>";TBUtilities.Alert(c)}}m();_();S()}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyLayout] CRTBLoadLayoutTemplate"})}})};var P=function(e){try{if(!e||!e.Snippet||!e.Snippet.Thumbnails)return;TBUtilities.Log(e);jQuery("#tb-popout-channel-thumbnail").attr("src",e.Snippet.Thumbnails.ThumbnailDefault);jQuery("#tb-popout-insider-thumbnail").attr("src",e.Snippet.Thumbnails.ThumbnailDefault);jQuery("#tb-popout-channel-title").text(e.Snippet.Title);if(TBGlobal.Profile()==null||TBGlobal.Profile().ThumbnailUrl==null||TBGlobal.Profile().ThumbnailUrl==""){var t=jQuery.param({id:TBGlobal.CurrentChannelId(),thumbnailUrl:e.snippet.thumbnails.default.url,title:e.snippet.title})}}catch(t){TBUtilities.LogError({Exception:t,Location:"[TubeBuddyLayout] gotChannelDetails [[[Channel Results: "+JSON.stringify(e)+"]]]"})}};var G=function(e){jQuery(".tb-layout-version-number").text("v"+TBExtension.GetExtensionVersion());try{var t=jQuery("#player").length>0;var i=navigator.userAgent.indexOf("Firefox")>-1;var o=document.location.href.indexOf("/watch")>-1;if(t&&i&&o){jQuery("#watch-header")[0].scrollIntoView()}}catch(e){}N();O();jQuery(".tb-layout-menu-dropdown").show();if(u==-1){if(TBGlobal.IsAuthenticated())if(e==true)K(TubeBuddyLayout.Tabs.Messages,true);else K(TubeBuddyLayout.Tabs.ThisPage,true);else K(TubeBuddyLayout.Tabs.Profile,true)}clearTimeout(n);n=null};var O=function(){TBUtilities.Log("Checking Milestones");TBExtension.GetDbValue("tb-last-milestone-fetch-"+TBGlobal.CurrentChannelId(),"tbGetLastMilestone");TBExtension.GetDbValue("tb-last-milestone-fetch-item-"+TBGlobal.CurrentChannelId(),"tbGetLastMilestoneItem")};var V=function(){try{if(TBGlobal.GetToken()==null||TBGlobal.GetToken().trim()==""){if(TBGlobal.GetToken()==null)TBGlobal.AddDiagnostic("lrte:GT");if(TBGlobal.GetToken()=="")TBGlobal.AddDiagnostic("lrte:ES");C()}else{Q()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyLayout] refreshTokenError"})}};var _=function(){var e=f.general;var t=window.location.href;if(t.indexOf("/discussion")>0){e=f.channel_discussion}if(t.indexOf("youtube.com/edit")>0){e=f.video_edit}if(t.indexOf("youtube.com/my_videos")>0&&t.indexOf("youtube.com/my_videos_annotate")==-1){e=f.my_videos}if(t.indexOf("youtube.com/results")>0){e=f.search_results}if(t.indexOf("youtube.com/subscribers")>0){e=f.subscribers}if(t.indexOf("youtube.com/upload_defaults")>0){e=f.upload_defaults}else if(t.indexOf("youtube.com/upload")>0){e=f.upload}if(t.indexOf("youtube.com/my_videos_annotate")>0){e=f.annotations}if(t.indexOf("youtube.com/cards")>0){e=f.cards}if(t.indexOf("youtube.com/watch")>0){e=f.video_watch}if(t.indexOf("youtube.com/comments")>0){e=f.comments}if(t.indexOf("youtube.com/c/")>0||t.indexOf("youtube.com/user/")>0||t.indexOf("youtube.com/channel/")>0){e=f.channel}if(t.indexOf("youtube.com/playlist")>0||t.indexOf("/playlist")>0&&(t.indexOf("youtube.com/channel/")>0||t.indexOf("youtube.com/user/")>0||t.indexOf("youtube.com/c/")>0)){e=f.playlists}jQuery("#tb-layout-current-page-label").text(e.name);jQuery("#tb-layout-tb-tools-container").empty();jQuery("#tb-layout-tb-resources-container").empty();jQuery.each(TBGlobal.GetToolsOnPage(e.name),function(e,t){var i=jQuery(".tb-layout-tb-feature-container:last")[0].outerHTML;i=TBUtilities.ReplaceAll(i,"#TITLE#",t.name);i=TBUtilities.ReplaceAll(i,"#DESCRIPTION#",t.summary);i=TBUtilities.ReplaceAll(i,"#TOOLTIP#","");i=TBUtilities.ReplaceAll(i,"#URL#",TBGlobal.host+"/tools?tool="+t.id);if(t.howToVideoId)i=TBUtilities.ReplaceAll(i,"#THUMBNAILURL#","https://i.ytimg.com/vi/"+t.howToVideoId+"/mqdefault.jpg");else i=TBUtilities.ReplaceAll(i,"#THUMBNAILURL#","https://yt3.ggpht.com/-ajEGKkfBLmM/AAAAAAAAAAI/AAAAAAAAAAA/LvxQt9F7it0/s176-c-k-no/photo.jpg");jQuery("#tb-layout-tb-tools-container").append(i)})};var M=function(){jQuery("#tb-popout-success-message").hide()};var F=function(e){p.push(e)};var N=function(){jQuery("#tb-modal-overlay-menu").show()};var Y=function(){s=false;jQuery("#tb-modal-overlay").css("cursor","default");jQuery("#tb-modal-overlay").show();q()};var H=function(){s=true;jQuery("#tb-modal-overlay").css("cursor","no-drop");jQuery("#tb-modal-overlay").show();q()};var W=function(){var e='<a target="_blank" href="http://status.tubebuddy.com" onclick="TBUtilities.Alert(\'Sorry, it looks like the TubeBuddy.com website is currently down. This can temporarily happen while we publish updates to our tools.\\n\\nThis message will automatically go away and TubeBuddy functionality will come back when the site is back online.\\n\\nIn the meantime, you can visit http://status.tubebuddy.com to get the current status.\');" class="yt-uix-button yt-uix-button-default yt-uix-button-size-default" style="margin-right: 10px; padding-right:5px;"><span class="yt-uix-button-content" style="vertical-align: middle; color:red; font-size:11px; font-weight:500">TubeBuddy &#9888;&nbsp;</span></a>';jQuery("#yt-masthead-user").prepend(e)};var z=function(){jQuery("#tb-modal-overlay").hide();jQuery.each(p,function(e,t){t()})};var q=function(){jQuery("#tb-modal-overlay-menu").hide()};var K=function(e,i){try{S();t=true;if(i==null)N();if(e==null)e=8;if(!TBGlobal.IsAuthenticated()){jQuery("#tb-popout-profile-missing-tab-header").show();jQuery("#tb-popout-submit-idea-tab-header").hide();jQuery("#tb-popout-settings-tab-header").hide();jQuery("#tb-popout-this-page-tab-header").hide()}if(e!=u){switch(e){case 0:if(TBGlobal.IsAuthenticated()){jQuery("#tb-popout-account-tabs-missing-token").hide();jQuery("#tb-popout-profile-tab").show();jQuery("#tb-popout-profile-tab-header").trigger("click")}else{jQuery("#tb-popout-account-tabs-missing-token").show();jQuery("#tb-popout-profile-tab").hide();jQuery("#tb-popout-profile-missing-tab-header").trigger("click")}break;case 3:break;case 4:jQuery("#tb-popout-welcome-tab-header").trigger("click");break;case 6:jQuery("#tb-popout-submit-idea-tab-header").trigger("click");break;case 7:if(TBGlobal.IsAuthenticated())jQuery("#tb-popout-home-tab-header").trigger("click");else jQuery("#tb-popout-profile-missing-tab-header").trigger("click");break;case 8:jQuery("#tb-popout-this-page-tab-header").trigger("click");break;case 9:jQuery("#tb-popout-messages-tab-header").trigger("click");break}}if(TBGlobal.Profile()!=null){if(TBGlobal.Profile().IsBanned==true){jQuery("#tb-popout-profile-missing-tab-header").hide();jQuery("#tb-popout-submit-idea-tab-header").hide();jQuery("#tb-popout-settings-tab-header").hide();jQuery("#tb-popout-this-page-tab-header").hide();jQuery(".tb-layout-menu-links-list").hide();jQuery("#tb-popout-banned-tab-header").show();jQuery("#tb-popout-banned-tab-header").trigger("click")}}jQuery(".tb-layout-menu-dropdown").find('li[style*="display:none"], li[style*="display: none"]').each(function(e,t){jQuery(t).remove()});jQuery(".tb-layout-menu-dropdown:first").show();clearTimeout(n);n=null;u=e}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyLayout] showTubeBuddyPanel"})}};var J=function(){t=false;q()};var X=function(e){var t=TBUtilities.GetActivityLogTypeValueFromString(e);switch(t){case TBUtilities.ActivityLogTypes.QuickLinksMenu_MyAccount:case TBUtilities.ActivityLogTypes.QuickLinksMenu_HealthReport:case TBUtilities.ActivityLogTypes.QuickLinksMenu_CompetitorScorecard:case TBUtilities.ActivityLogTypes.QuickLinksMenu_BrandAlerts:case TBUtilities.ActivityLogTypes.QuickLinksMenu_ABTests:case TBUtilities.ActivityLogTypes.QuickLinksMenu_BackupsAndExports:case TBUtilities.ActivityLogTypes.QuickLinksMenu_CannedResponses:case TBUtilities.ActivityLogTypes.QuickLinksMenu_Settings:case TBUtilities.ActivityLogTypes.QuickLinksMenu_CommunityForums:case TBUtilities.ActivityLogTypes.QuickLinksMenu_TipsAndTricks:case TBUtilities.ActivityLogTypes.QuickLinksMenu_SuggestAFeature:case TBUtilities.ActivityLogTypes.QuickLinksMenu_KnowledgeBase:case TBUtilities.ActivityLogTypes.QuickLinksMenu_TagExplorer:case TBUtilities.ActivityLogTypes.QuickLinksMenu_VideoTopicPlanner:case TBUtilities.ActivityLogTypes.QuickLinksMenu_BestTimeToPublish:case TBUtilities.ActivityLogTypes.QuickLinksMenu_PrivacyPolicy:case TBUtilities.ActivityLogTypes.QuickLinksMenu_TermsOfUse:TBUtilities.AddActivityLog(null,e,"quicklinksmenu");break;case TBUtilities.ActivityLogTypes.QuickLinksMenu_Dashboard:case TBUtilities.ActivityLogTypes.QuickLinksMenu_MyVideos:case TBUtilities.ActivityLogTypes.QuickLinksMenu_Playlists:case TBUtilities.ActivityLogTypes.QuickLinksMenu_LiveStreaming:case TBUtilities.ActivityLogTypes.QuickLinksMenu_Comments:case TBUtilities.ActivityLogTypes.QuickLinksMenu_Subscribers:case TBUtilities.ActivityLogTypes.QuickLinksMenu_Analytics:case TBUtilities.ActivityLogTypes.QuickLinksMenu_Realtime:TBUtilities.AddAction(null,TBUtilities.ActionTypes.QuickLinksMenu_Click,"quicklinksmenu");TBUtilities.AddActivityLog(null,e,"quicklinksmenu");break}};var Z=function(){var e=TBGlobal.GetYouTubeUI();if(!y){y=true;TBUtilities.Log(e)}switch(e){case"material":{var t=jQuery("#yt-masthead-user").is(":visible");var i=jQuery("#end").length>0;if(t===true||i===true){v()}else{setTimeout(Z,500)}break}case"studio":{var o=jQuery("div.ytcp-header").is(":visible");if(o===true){v()}else{setTimeout(Z,500)}break}case"default":{v();break}}};return{Initialize:function(){if(document.URL.indexOf("youtube.com")==-1||document.URL.indexOf("tubebuddy.com")>=0||document.URL.indexOf("localhost")>=0)return;if(!e){if(TBGlobal.CurrentChannelId()=="U"+"C"+"jbhDmV6Yl-nS7OQOnmgdSA"||TBGlobal.CurrentChannelId()=="U"+"C"+"3XArDZvhJ6j2697yTTPSmQ"||TBGlobal.CurrentChannelId()=="U"+"C"+"b6EhLOlLuL2PkJYGfmslGw"||TBGlobal.CurrentChannelId()=="U"+"C"+"4S0693-QVZqxBKLj7vq0Zw"){TBUtilities.ForceDebugging()}R();Z();g();T();B();e=true;var t=TBExtension.GetExtensionVersion();TBUtilities.Log("TubeBuddyLayout - Extension Version: "+t)}},AddHideBackgroundListener:function(e){F(e)},LoadProfile:function(){S()},ShowComingSoon:function(e){showComingSoon(e)},ShowBackground:function(){Y()},ShowBackgroundSticky:function(){H()},HideBackground:function(){z()},ShowTubeBuddyPanel:function(e){K(e)},RefreshTokenError:function(){V()},FailedToLoadProfile:function(){W()},Tabs:{Profile:0,Support:3,Features:4,Insiders:5,SubmitIdea:6,Home:7,ThisPage:8,Messages:9}}}();var TubeBuddyKeywordExplorer=function(){var e=false;var t=false;var o=false;var r;var n="";var a=null;var s=null;var l=null;var d;var u;var c;var p=false;var h=false;var y="weighted";var b=[];var f=["#F40000","#F87E00","#FDED01","#7FD500","#00AE00"];var m=null;var v=null;var g=false;var T=null;var w=false;var k=false;var x=false;var B=false;var j=[];var L="the, it is, we all, a, an, by, to, you, me, he, she, they, we, how, it, i, are, to, for, of, in, and";var C=[{country:"Argentina",code:"AR"},{country:"Australia",code:"AU"},{country:"Austria",code:"AT"},{country:"Belgium",code:"BE"},{country:"Brazil",code:"BR"},{country:"Canada",code:"CA"},{country:"Chile",code:"CL"},{country:"Colombia",code:"CO"},{country:"Czechia",code:"CZ"},{country:"Denmark",code:"DK"},{country:"Egypt",code:"EG"},{country:"Finland",code:"FI"},{country:"France",code:"FR"},{country:"Germany",code:"DE"},{country:"Greece",code:"GR"},{country:"Hong Kong",code:"HK"},{country:"Hungary",code:"HU"},{country:"India",code:"IN"},{country:"Indonesia",code:"ID"},{country:"Ireland",code:"IE"},{country:"Israel",code:"IL"},{country:"Italy",code:"IT"},{country:"Japan",code:"JP"},{country:"Kenya",code:"KE"},{country:"Malaysia",code:"MY"},{country:"Mexico",code:"MX"},{country:"Netherlands",code:"NL"},{country:"New Zealand",code:"NZ"},{country:"Nigeria",code:"NG"},{country:"Norway",code:"NO"},{country:"Philippines",code:"PH"},{country:"Poland",code:"PL"},{country:"Portugal",code:"PT"},{country:"Romania",code:"RO"},{country:"Russia",code:"RU"},{country:"Saudi Arabia",code:"SA"},{country:"Singapore",code:"SG"},{country:"South Africa",code:"ZA"},{country:"South Korea",code:"KR"},{country:"Sweden",code:"SE"},{country:"Switzerland",code:"CH"},{country:"Taiwan",code:"TW"},{country:"Thailand",code:"TH"},{country:"Turkey",code:"TR"},{country:"Ukraine",code:"UA"},{country:"United Kingdom",code:"GB"},{country:"United States",code:"US"},{country:"Vietnam",code:"VN"}];var Q={videoCount:0,titles:"",tags:"",numberOfResults:0,topResult:null,topResultVideoId:null,yourChannelCount:0,totalResults:0,topChannelId:"",topChannelTitle:"",topChannelThumbnail:"",topChannelCount:0,totalViewCount:0,searchVolumeValue:0,searchVolumeName:"",difficultyValue:0,difficultyName:"",videosFetched:0,videosTotal:0,numberOfExactViews:0,numberOfExactResults:0,tagScore:null};var U=function(){var e=chrome.extension.getURL("modules/keywordexplorer.html");TBExtension.Get(e,function(e,t,i){try{if(e){if(jQuery("#tb-keyword-explorer-container").length>0){jQuery("#tb-keyword-explorer-container").remove()}i=TBUtilities.FixLocalHtml(DOMPurify.sanitize(i,DOMPurifyConfig));if(a){a.append(i)}else{jQuery("body").append(i)}if(!TBGlobal.Profile().IsPaidLicense){$("#tb-keyword-explorer-total-results-label").hide();$(".tb-keyword-explorer-search-result-count-area").hide();$("#tb-keyword-explorer-search-results-tab-results").hide()}I();be(n)}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyKeywordExplorer] LoadHtml"})}})};var I=function(){if(!TBGlobal.GetExperiment("keyword-explorer-video-learnings")){jQuery("#learn-button").hide()}var e=TBGlobal.GetYouTubeUI();if(e==="studio"){var i=location.pathname;var o=[];TBUtilities.Log(i);if(i){var o=i.substring(1).split("/");for(var r=0;r<5-o.length;r++)o.push("");if(o[0]=="video"&&o[2]=="edit"){var n=o[1];TBUtilities.Log("Studio Video Edit!");if(o[0]=="video"&&o[2]=="edit"){t=true}}else if(o[2]=="videos"&&o[3]=="upload"&&jQuery(".ytcp-uploads-dialog").length>0){TBUtilities.Log("Studio Beta Uploads!");if(jQuery("ytcp-uploads-extras .tags").length>0){t=true}}}}else{if(document.URL.indexOf("youtube.com/upload")>0||document.URL.indexOf("youtube.com/edit")>0||document.URL.indexOf("youtube.com/my_live_events")>0){t=true}else{t=false}}};var S=function(e){var i='<div><span class="tb-spinner"></span>'+'<span style="margin-left:10px;" class="tb-font-color-gray tb-font-size-lg">Loading trend data</span></div>';jQuery(".tb-keyword-explorer-trends-section").block({message:i,css:{display:"flex",justifyContent:"center",alignItems:"center",border:"2px solid #77889",width:"100% ",height:"100%"},overlayCSS:{backgroundColor:"#fff",opacity:.8,cursor:"unavailable"}});_trendingTabLoaded=false;p=false;h=false;w=false;k=false;x=false;B=false;_videoInfos=[];jQuery("#tb-keyword-explorer-container").show();H();se();jQuery(".tb-keyword-explorer-tag-checkbox").each(function(){jQuery(this).prop("checked",false)});if(e.trim().length>0){jQuery(".tb-keyword-explorer-tag-checkbox-explore").prop("checked",true);jQuery(".tb-keyword-explorer-tag-checkbox-explore").attr("data-tag-value",encodeURIComponent(e));jQuery(".tb-keyword-explorer-tag-checkbox-explore").prop("disabled",false)}else{jQuery(".tb-keyword-explorer-tag-checkbox-explore").prop("checked",false);jQuery("#tb-keyword-explorer-tab-container").hide();jQuery("#tb-keyword-explorer-tab-none").show();jQuery("#tb-keyword-explorer-trending-related-container").show()}if(t){jQuery(".tb-keyword-explorer-single-tag-warning").show()}else{jQuery(".tb-keyword-explorer-single-tag-warning").hide()}R();u=e.toLowerCase().trim().replace(/\u00A0/g," ");jQuery("#tb-keyword-explorer-recent-list").find('[data-tag="'+u+'"]').parent().remove();jQuery("#tb-keyword-explorer-recent-list").prepend('<span class="tb-keyword-explorer-recent-container"><span data-tag="'+u+'">&#187;</span> <a data-tag="'+u+'" style="margin-right:2px;padding:0px" class="tb-video-info-suggested-tag tb-keyword-explorer-recent">'+TBUtilities.GetHtmlEncoded(u)+"</a></span>");jQuery("#tb-keyword-explorer-input").val(u);jQuery(".tb-video-info-selected-tag").text(u);if(e==""){jQuery("#tb-keyword-explorer-input").focus();return}if(jQuery("#tb-keyword-explorer-recent-list").is(":empty")==false){jQuery(".tb-keyword-explorer-recent-list-container").show()}jQuery("#tb-keyword-explorer-action-dropup-button").show();jQuery("#tb-keyword-explorer-tab-container").show();jQuery("#tb-keyword-explorer-tab-none").hide();jQuery("#tb-keyword-explorer-trending-related-container").hide();jQuery(".tb-video-info-selected-tag-link").attr("href","https://www.youtube.com/results?search_query="+TBUtilities.GetUrlEncoded(u));jQuery(".tb-keyword-explorer-external-links").attr("href","https://www.youtube.com/results?search_query="+TBUtilities.GetUrlEncoded(u));jQuery("#tb-keyword-explorer-borrowed-tab-no-results").hide();jQuery("#tb-keyword-explorer-borrowed-tab-results").show();jQuery("#tb-keyword-explorer-most-used-tags-loading").show();jQuery("#tb-keyword-explorer-long-loading").hide();_debugText="Start";_debugText+="\nCID: "+TBGlobal.CurrentChannelId();_debugText+="\nBT: "+TBExtension.GetType();_debugText+="\nEV: "+TBExtension.GetExtensionVersion();_debugText+="\nOS: "+TBUtilities.GetOs();_debugText+="\nTag: "+u;_debugText+="\nCL1: "+TBGlobal.CanAccessLevel1Tools();_debugText+="\nUI: "+TBGlobal.GetYouTubeUI();jQuery("#tb-keyword-explorer-most-used-tags").hide();jQuery("#tb-keyword-explorer-top-ranking-container-loading").show();jQuery("#tb-keyword-explorer-top-ranking-container").hide();jQuery("#tb-keyword-explorer-keyword-score-container-loading").show();jQuery("#tb-keyword-explorer-keyword-score-container").hide();jQuery(".tb-keyword-explorer-most-used-tags-upgrade-img").hide();jQuery("#tb-keyword-explorer-weighted-score-loading").show();jQuery("#tb-keyword-explorer-weighted-score-container").hide();jQuery("#tb-keyword-explorer-most-used-tags-list").empty();jQuery(".tb-keyword-explorer-upgrade-container").hide();jQuery(".tb-keyword-explorer-error").removeClass("tb-keyword-explorer-error");jQuery(".tb-keyword-explorer-total-score-low").hide();jQuery(".tb-keyword-explorer-total-score-low-list-loading").hide();jQuery(".tb-keyword-explorer-total-score-low-list").hide();jQuery(".tb-keyword-explorer-total-score-low-list").empty();jQuery(".tb-keyword-explorer-tab-header-error").hide();TBUtilities.Log("Getting search results for tag : "+u);jQuery("#tb-keyword-explorer-borrowed-tab-header").click();jQuery("#tb-keyword-explorer-rising-queries").empty().append(jQuery(".tb-keyword-explorer-loading-section:last")[0].outerHTML);jQuery("#tb-keyword-explorer-top-queries").empty().append(jQuery(".tb-keyword-explorer-loading-section:last")[0].outerHTML);jQuery("#tb-video-info-youtube-auto-suggest").empty().append(jQuery(".tb-keyword-explorer-loading-section:last")[0].outerHTML);jQuery("#tb-video-info-google-auto-suggest").empty().append(jQuery(".tb-keyword-explorer-loading-section:last")[0].outerHTML);jQuery("#tb-keyword-explorer-top-hits").empty().append(jQuery(".tb-keyword-explorer-loading-section:last")[0].outerHTML);var o="youtube";TBExtension.GetDbValue("tb-keyword-explorer-common-tags-default-option"+TBGlobal.CurrentChannelId(),function(e,t){if(t){o="common";jQuery("#tb-keyword-explorer-common-tags-default").attr("checked","checked")}F(o);M(o)});var r='"'+u+'"';var n={};n.Query=r;n.Page=1;n.Incognito=true;n.Results=[];TubeBuddyYouTubeActions.Search(n).then(e=>{e.Query=u;e.Page=1;e.Incognito=true;e.ExactCount=e.NumberOfResults;e.Results=[];TubeBuddyYouTubeActions.Search(e).then(e=>{var t=e.Results.filter(e=>e.Type==="video");var i=[{Tag:u.toLowerCase(),ExactCount:e.ExactCount,SearchResults:t,TotalSearchResultCount:e.NumberOfResults}];var o=TBGlobal.GetPrefCookieObject();var r={Region:"us",Tags:[],Language:"en",WeightScore:true,TagsWithExactCounts:[],TagsWithExactCountAndSearchResults:i};if(o&&o.gl){r.Region=o.gl}if(o&&o.hl){r.Language=o.hl}var n=TBGlobal.host+TBGlobal.apiUrls.tagScoreGet;TBExtension.Post(n,JSON.stringify(r),function(t,i,o,r){A(e,t,i,o,r)},null,{contentType:"application/json"})})}).catch(function(e){try{var t=[{Tag:u.toLowerCase(),ExactCount:null,SearchResults:[],TotalSearchResultCount:null}];var i=TBGlobal.GetPrefCookieObject();var o={Region:"us",Tags:[],Language:"en",WeightScore:true,TagsWithExactCounts:[],TagsWithExactCountAndSearchResults:t};if(i&&i.gl){o.Region=i.gl}if(i&&i.hl){o.Language=i.hl}var r=TBGlobal.host+TBGlobal.apiUrls.tagScoreGet;TBExtension.Post(r,JSON.stringify(o),function(e,t,i,o){A(n,e,t,i,o)},null,{contentType:"application/json"})}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyKeywordExplorer] TubeBuddyYouTubeActions.Search"});le();E([])}})};var A=function(e,t,i,o,r){try{if(t){var n=jQuery.parseJSON(o);if(n.length>0&&n[0].Score!=null){c=n[0];TBUtilities.Log(c);const e=TBGlobal.GetToolById("tagexplorer").name;var a=c;delete a.WeightedScoreDescription;delete a.ScoreDescription;TBUtilities.ReportProductEvent("Feature Used",{Tool:e,Data:a});Z(c);ie(c);if(TBGlobal.CanAccessLevel1Tools()==true){N(y,c)}else{N("unweighted",c)}H();jQuery(".tb-keyword-explorer-header-characters").hide();if(c.Tag!==u.toLowerCase()){jQuery("#tb-keyword-explorer-input").val(c.Tag);jQuery(".tb-video-info-selected-tag").text(c.Tag);jQuery(".tb-keyword-explorer-header-characters").show()}}}else{c=null;if(r===430){TBUtilities.Alert("Sorry, due to YouTube API restrictions you've reached the daily limit of 500 keywords.  Please come back in 24 hours.")}else if(TBGlobal.CanAccessLevel1Tools()==false&&r==429){TBGlobal.ShowUpgradePage("retrieve any more keyword scores","Pro")}}}catch(e){c=null;TBUtilities.LogError({Exception:e,Location:"[TubeBuddyKeywordExplorer] tagScoreGet"})}b=[];Q={videoCount:0,titles:"",tags:"",numberOfResults:0,topResult:null,topResultVideoId:null,topResultSet:false,yourChannelCount:0,totalResults:0,topChannelId:"",topChannelTitle:"",topChannelThumbnail:"",topChannelCount:0,totalViewCount:0,searchVolumeValue:0,searchVolumeName:"",difficultyValue:0,difficultyName:"",videosFetched:0,videosTotal:0,numberOfExactResults:e.ExactCount,numberOfExactViews:0,resultNum:0,videoIds:[],newVideoCount:0};TBUtilities.Log(Q);TBUtilities.Log(e.NumberOfResults);jQuery("#tb-keyword-explorer-top-hits").empty();jQuery("#tb-keyword-explorer-top-hits").scrollTop(0);if(e.NumberOfResults==null||e.NumberOfResults==undefined){jQuery(".tb-keyword-explorer-search-result-count").hide();jQuery("#tb-keyword-explorer-total-results-label").hide();jQuery("#tb-keyword-explorer-search-analysis-tab-header").hide()}else{jQuery(".tb-keyword-explorer-search-result-count").text(TBUtilities.FormatNumberAbbreviated(e.NumberOfResults))}var s=[];if(e.Results.length>0){e.Results.forEach(function(e){Q.resultNum++;if(e.Type==="video"){if(Q.videoIds.indexOf(e.Id)===-1){if(e.ChannelId===TBGlobal.CurrentChannelId()){Q.yourChannelCount++}s.push(e.ChannelId)}Q.totalResults++;if(Q.topResultVideoId===null)Q.topResultVideoId=e.Id;Q.videosTotal++;TubeBuddyYouTubeActions.GetVideoInfo(e.Id,function(e){Q.videosFetched++;if(e){_videoInfos.push(e);var t="";if(e.tags&&e.tags.length>0){t=e.tags.join(",")}var i={videoId:e.videoId,title:e.title,tags:t,channelTitle:e.channelname,channelId:e.channelid,channelThumbnail:e.channelThumbnail,viewCount:e.views};if(Q.topResultVideoId===i.videoId){Q.topResult=i}X(i)}if(Q.videosFetched===Q.videosTotal){E(_videoInfos)}});let n=jQuery("#tb-keyword-explorer-video-template").html();var t=isNaN(parseInt(e.ViewCount.replace(/\D/g,"")))?0:parseInt(e.ViewCount.replace(/\D/g,""));var i=TBUtilities.FormatNumberAbbreviated(t)+" views";let a=n.formatTemplate(e.Id,e.URL,e.Title,i,e.ChannelName,e.ChannelUrl,e.Desc,Q.resultNum);a=TBUtilities.HighlightText(u.trim(),a);var o=ce(u,L);if(o.length>1){for(var r=0;r<o.length;r++){a=TBUtilities.HighlightText(o[r],a,"tb-keyword-explorer-highlight-light")}}jQuery("#tb-keyword-explorer-top-hits").append(a);Q.videoIds.push(e.Id)}else if(e.Type==="channel"){Q.resultNum++;Q.totalResults++;if(e.Id==TBGlobal.CurrentChannelId()){Q.yourChannelCount++}s.push(e.Id);let t=jQuery("#tb-keyword-explorer-channel-template").html();let i=t.formatTemplate(e.Id,e.Thumbnail,e.Url,e.Name,Q.resultNum);jQuery("#tb-keyword-explorer-top-hits").append(i)}})}else{E([])}var l=new Object;jQuery.each(s,function(e,t){if(t){if(t.trim()!=""){if(l[t]==null)l[t]=1;else l[t]++}}});var d=Object.keys(l).sort(function(e,t){return l[t]-l[e]});var p=null;if(d[0]!==null)jQuery.each(d,function(e,t){if(p===null)p=t});Q.topChannelId=p;Q.topChannelCount=l[p];jQuery("#tb-keyword-explorer-your-channel-how-many").text(" Owns "+Q.yourChannelCount+" of "+Q.totalResults+" search results");jQuery("#tb-keyword-explorer-top-hits").find(".tb-keyword-explorer-video-result-channel-link").find("span").removeClass("tb-keyword-explorer-highlight");if(Q.totalResults==0){jQuery("#tb-keyword-explorer-most-used-tags-loading").hide();jQuery("#tb-keyword-explorer-most-used-tags").show();jQuery("#tb-keyword-explorer-top-ranking-container-loading").hide();jQuery("#tb-keyword-explorer-top-ranking-container").show();jQuery("#tb-keyword-explorer-most-used-tags-list").hide();jQuery("#tb-keyword-explorer-borrowed-tab-no-results").show();jQuery("#tb-keyword-explorer-borrowed-tab-results").show()}var h=jQuery("#tb-keyword-explorer-top-hits").find(".tb-highlight").length;jQuery(".tb-keyword-explorer-search-result-keyword-count").text(TBUtilities.FormatNumberWithCommas(h));var f=pe();TBUtilities.Log("strength: "+f);ne(f);B=true;te()};var E=function(e){V(u).then(function(t){D("youtube",u);D("google",u);jQuery(".tb-keyword-explorer-keyword-trends-carousel-confirm").hide();jQuery(".tb-keyword-explorer-keyword-trends-carousel-reject").hide();if(t===true){jQuery(".tb-keyword-explorer-keyword-trends-carousel-confirm").show()}else{jQuery(".tb-keyword-explorer-keyword-trends-carousel-reject").show()}let i=e.filter(e=>e.isNew===true);jQuery(".tb-keyword-explorer-keyword-trends-new-count").text(i.length);jQuery(".tb-keyword-explorer-keyword-trends-new-count-total").text(e.length)})};var D=function(e,t){var i="today 12-m";var o=jQuery('[data-chart-id="'+e+'"] .tb-keyword-explorer-keyword-trends-history-option.tb-keyword-explorer-keyword-trends-history-option-active');if(o){i=o.attr("data-history-months")}var r="https://trends.google.com/trends/embed/explore/TIMESERIES?req=%7B%22comparisonItem%22%3A%5B%7B%22keyword%22%3A%22"+TBUtilities.GetUrlEncoded(t)+"%22%2C%22geo%22%3A%22%22%2C%22time%22%3A%22"+TBUtilities.GetUrlEncoded(i)+"%22%7D%5D%2C%22category%22%3A0%2C%22property%22%3A%22youtube%22%7D&tz=420&forceMobileMode=false&isPreviewMode=true&eq=gprop%3Dyoutube%26q%3D"+TBUtilities.GetUrlEncoded(t)+"%26date%3D"+TBUtilities.GetUrlEncoded(i)+"&hl=enUS";if(e=="google")r="https://trends.google.com/trends/embed/explore/TIMESERIES?req=%7B%22comparisonItem%22%3A%5B%7B%22keyword%22%3A%22"+TBUtilities.GetUrlEncoded(t)+"%22%2C%22geo%22%3A%22%22%2C%22time%22%3A%22"+TBUtilities.GetUrlEncoded(i)+"%22%7D%5D%2C%22category%22%3A0%2C%22property%22%3A%22%22%7D&tz=420&forceMobileMode=false&isPreviewMode=true&eq="+TBUtilities.GetUrlEncoded(t)+"%26date%3D"+TBUtilities.GetUrlEncoded(i)+"&hl=enUS";jQuery("#tb-keyword-explorer-keyword-trends-history-frame-"+e+"").attr("src",r);jQuery(".tb-keyword-explorer-trends-section").unblock()};var R=function(){var e=0;var t=[];jQuery(".tb-keyword-explorer-tag-checkbox").each(function(){if(jQuery(this).is(":checked")&&jQuery(this).parent().hasClass("tb-keyword-explorer-tag-checkbox-hidden")==false){e++;var i=decodeURIComponent(jQuery(this).attr("data-tag-value"));if(i){t.push(i)}}});jQuery(".tb-keyword-explorer-selected-count").text(e);if(e>0){jQuery("#tb-keyword-explorer-action-dropup-button").attr("disabled",false);jQuery("#tb-keyword-explorer-action-dropup-button").removeAttr("title")}else{jQuery("#tb-keyword-explorer-action-dropup-button").attr("disabled",true);jQuery("#tb-keyword-explorer-action-dropup-button").attr("title","No keyword(s) selected.")}var i="";var o=t.length;if(t.length>0){jQuery.each(t,function(e,t){if(e==o-1){i+=t}else{i+=t+", "}})}jQuery("#tb-keyword-explorer-action-dropup-menu").attr("data-clipboard-text",i);return e};var P=function(){var e=[];jQuery(".tb-keyword-explorer-tag-checkbox").each(function(t,i){if(jQuery(this).is(":checked")&&jQuery(this).hasClass("tb-keyword-explorer-tag-checkbox-hidden")==false){var o=decodeURIComponent(jQuery(this).attr("data-tag-value"));if(o){e.push(o)}}});var t="";var i=e.length;if(e.length>0){jQuery.each(e,function(e,o){if(e==i-1){t+=o}else{t+=o+", "}})}if(d){d.destroy()}jQuery("#tb-keyword-explorer-action-dropup-menu").attr("data-clipboard-text",t);if(!s){d=new ClipboardJS("#tb-keyword-explorer-action-dropup-menu")}else{d=new ClipboardJS("#tb-keyword-explorer-action-dropup-menu",{container:jQuery(s)[0]})}};var G=function(e){var t=500;var i=TBUtilities.GetTagCharacterCount(j);if(i>0){t=500-i}var o=[];jQuery("#tb-keyword-explorer-container").find(".tb-keyword-explorer-tag-checkbox").each(function(){if(jQuery(this).is(":checked")==true){var e=decodeURIComponent(jQuery(this).attr("data-tag-value"));if(e){o.push(e)}}});var r;switch(e){case"common":{r=jQuery("#tb-keyword-explorer-most-used-tags");break}case"youtube":{r=jQuery(".tb-keyword-explorer-related-keyword-tab-youtube-list");break}case"google":{r=jQuery(".tb-keyword-explorer-related-keyword-tab-google-list");break}case"related":{r=jQuery(".tb-keyword-explorer-related-keyword-tab-related-list");break}}r.find(".tb-keyword-explorer-tag-checkbox").each(function(){if(jQuery(this).find(".tb-keyword-explorer-tag-checkbox-confirm").is(":visible")==false){var e=decodeURIComponent(jQuery(this).attr("data-tag-value"));if(e){o.push(e)}var i=TBUtilities.GetTagCharacterCount(o);if(i>=t){jQuery("#tb-keyword-explorer-most-used-tags").find(".tb-keyword-explorer-tag-checkbox").last().prop("checked",false);return false}else{jQuery(this).prop("checked",true)}}})};var O=function(){jQuery("#tb-keyword-explorer-action-dropup-menu").hide()};var V=function(e){return new Promise(function(t,i){var o="https://google.com/search?q="+encodeURIComponent(e);TBExtension.Get(o,function(e,i,o){var r=false;var n=o.indexOf("https://www.youtube.com/watch?v");if(n!==-1){r=true}t(r)})}).catch(function(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyKeywordExplorer] googleCarouselCheck"});resolve(false)})};var _=function(){var e=jQuery("body")[0].outerHTML;var t=e.indexOf('PSUGGEST_TOKEN":"')+'PSUGGEST_TOKEN":"'.length;var i=e.indexOf('"',t);var o=e.substring(t,i);return o};var M=function(e){var t=_();switch(e){case"youtube":{if(w==false){jQuery(".tb-keyword-explorer-related-keyword-tab-container-youtube-loading").show();jQuery(".tb-keyword-explorer-related-keyword-tab-youtube-list").hide();jQuery(".tb-keyword-explorer-related-keyword-tab-youtube-list").empty();jQuery(".tb-keyword-explorer-related-keyword-tab-container-youtube-content").hide();TubeBuddyYouTubeActions.GetYouTubeAutoComplete(t,u,function(e){w=true;var t=[];t.push(u);var i=0;var o=0;jQuery.each(e,function(e,r){var n=TBUtilities.GetInArray(t,null,r);if(n==null){t.push(r);if(i==3&&!TBGlobal.CanAccessLevel1Tools()){o++}else{var a=TBUtilities.GetTubeBuddyCheckboxHtml(r,"tb-keyword-explorer-tag-checkbox","data-tag-value="+encodeURIComponent(r.trim()));var s='<div class="tb-tag-has-external"><img class="tb-keyword-explorer-tag-checkbox-confirm tb-keyword-explorer-tag-checkbox-hidden" src="'+TBGlobal.host+'/images/icons/check.png" />'+a+'<a class="tb-video-info-suggested-tag tb-video-info-suggested-tag-adjusted" style="cursor:pointer">'+TBUtilities.GetHtmlEncoded(r)+'</a> <a class="tb-video-info-suggested-tag-adjusted" target="_blank" href="https://www.youtube.com/results?search_query='+TBUtilities.GetUrlEncoded(r)+'"><img src="'+TBGlobal.host+'/images/icons/external.png" /></a></div> ';jQuery(".tb-keyword-explorer-related-keyword-tab-youtube-list").append(DOMPurify.sanitize(s,DOMPurifyConfig));i++}}});jQuery(".tb-keyword-explorer-related-keyword-tab-container-youtube-loading").hide();jQuery(".tb-keyword-explorer-related-keyword-tab-youtube-list").show();jQuery(".tb-keyword-explorer-select-option-container-youtube").show();jQuery(".tb-keyword-explorer-related-keyword-tab-container-youtube-content").show();if(t.length==1){jQuery(".tb-keyword-explorer-related-keyword-tab-youtube-list").empty();jQuery(".tb-keyword-explorer-related-keyword-tab-youtube-list").append('<div class="tb-keyword-explorer-related-keyword-tab-related-list-empty" style="color:#999; font-size:15px; position:relative; top:10px;">No related video searches found.<br><br>Try exploring a more general Keyword if you are looking for specific search phrases that people enter for when looking for videos online.</div>')}if(o>0){jQuery(".tb-keyword-explorer-related-youtube-upgrade-img").show();jQuery(".tb-keyword-explorer-related-youtube-upgrade-count").text(o+i);var r=jQuery(".tb-keyword-explorer-related-keyword-tab-youtube-list").position();var n=200;var a=0;var s=r.left+n-a-10+"px";var l=130+r.top+"px";jQuery(".tb-keyword-explorer-related-youtube-upgrade-container").css({position:"absolute",zIndex:5e3,left:s,top:l});jQuery(".tb-keyword-explorer-related-youtube-upgrade-container").show();jQuery("#tb-keyword-explorer-action-dropup-menu").css("z-index","10000");TBUtilities.ReportProductEvent("Subscription Paywall",{ChannelId:TBGlobal.CurrentChannelId(),LicenseName:TBGlobal.Profile().LicenseName,Tool:TBGlobal.GetToolById("tagexplorer").name,Platform:"extension"})}})}else{jQuery(".tb-keyword-explorer-related-keyword-tab-container-youtube-loading").hide();jQuery(".tb-keyword-explorer-related-keyword-tab-youtube-list").show()}break}case"google":{if(k==false){jQuery(".tb-keyword-explorer-related-keyword-tab-container-google-loading").show();jQuery(".tb-keyword-explorer-related-keyword-tab-google-list").hide();jQuery(".tb-keyword-explorer-related-keyword-tab-google-list").empty();TubeBuddyYouTubeActions.GetGoogleAutoComplete(t,u,function(e){k=true;var t=[];t.push(u);var i=0;var o=0;jQuery.each(e,function(e,r){var n=TBUtilities.GetInArray(t,null,r);if(n==null){t.push(r);if(i==3&&!TBGlobal.CanAccessLevel1Tools()){o++}else{var a=TBUtilities.GetTubeBuddyCheckboxHtml(r,"tb-keyword-explorer-tag-checkbox","data-tag-value="+encodeURIComponent(r.trim()));var s='<div class="tb-tag-has-external"><img class="tb-keyword-explorer-tag-checkbox-confirm tb-keyword-explorer-tag-checkbox-hidden" src="'+TBGlobal.host+'/images/icons/check.png" />'+a+'<a class="tb-video-info-suggested-tag tb-video-info-suggested-tag-adjusted" style="cursor:pointer">'+TBUtilities.GetHtmlEncoded(r)+'</a> <a class="tb-video-info-suggested-tag-adjusted" target="_blank" href="https://www.google.com/search?q='+TBUtilities.GetUrlEncoded(r)+'"><img src="'+TBGlobal.host+'/images/icons/external.png" /></a></div>';jQuery(".tb-keyword-explorer-related-keyword-tab-google-list").append(DOMPurify.sanitize(s,DOMPurifyConfig));i++}}});jQuery(".tb-keyword-explorer-related-keyword-tab-container-google-loading").hide();jQuery(".tb-keyword-explorer-related-keyword-tab-google-list").show();jQuery(".tb-keyword-explorer-select-option-container-google").show();jQuery(".tb-keyword-explorer-related-keyword-tab-container-google-content").show();if(t.length==1){jQuery(".tb-keyword-explorer-related-keyword-tab-google-list").append('<div class="tb-keyword-explorer-related-keyword-tab-related-list-empty" style="color:#999; font-size:15px; position:relative; top:10px;">No related web searches found.<br><br>Try exploring a more general Keyword if you are looking for specific search phrases that people enter when searching on the web (Google).</div>')}if(o>0){jQuery(".tb-keyword-explorer-related-google-upgrade-img").show();jQuery(".tb-keyword-explorer-related-google-upgrade-count").text(o+i);var r=jQuery(".tb-keyword-explorer-related-keyword-tab-google-list").position();var n=200;var a=0;var s=r.left+n-a-10+"px";var l=130+r.top+"px";jQuery(".tb-keyword-explorer-related-google-upgrade-container").css({position:"absolute",zIndex:5e3,left:"667.5px",top:"407px"});jQuery(".tb-keyword-explorer-related-google-upgrade-container").show()}})}else{jQuery(".tb-keyword-explorer-related-keyword-tab-container-google-loading").hide();jQuery(".tb-keyword-explorer-related-keyword-tab-google-list").show()}break}case"related":{if(x==false){jQuery(".tb-keyword-explorer-related-keyword-tab-container-related-loading").show();jQuery(".tb-keyword-explorer-related-keyword-tab-related-list").hide();jQuery(".tb-keyword-explorer-related-keyword-tab-related-list").empty();var i=0;var o=0;var r=[];r.push("how "+u);r.push("how to "+u);r.push("why "+u);r.push("what "+u);r.push("where "+u);r.push("did "+u);r.push("can "+u);r.push("do "+u);r.push("does "+u);r.push("is "+u);var n=0;var a=[];jQuery.each(r,function(e,s){TubeBuddyYouTubeActions.GetYouTubeAutoComplete(t,s,function(e){n++;x=true;jQuery.each(e,function(e,t){var r=TBUtilities.GetInArray(a,null,t);if(r==null){a.push(t);if(i==3&&!TBGlobal.CanAccessLevel1Tools()){o++}else{var n=TBUtilities.GetTubeBuddyCheckboxHtml(t,"tb-keyword-explorer-tag-checkbox","data-tag-value="+encodeURIComponent(t.trim()));var s='<div class="tb-tag-has-external"><img class="tb-keyword-explorer-tag-checkbox-confirm tb-keyword-explorer-tag-checkbox-hidden" src="'+TBGlobal.host+'/images/icons/check.png" />'+n+'<a class="tb-video-info-suggested-tag tb-video-info-suggested-tag-adjusted" style="cursor:pointer">'+TBUtilities.GetHtmlEncoded(t)+'</a> <a class="tb-video-info-suggested-tag-adjusted" target="_blank" href="https://www.youtube.com/results?search_query='+TBUtilities.GetUrlEncoded(t)+'"><img src="'+TBGlobal.host+'/images/icons/external.png" /></a></div>';jQuery(".tb-keyword-explorer-related-keyword-tab-related-list").append(DOMPurify.sanitize(s,DOMPurifyConfig));i++}}});jQuery(".tb-keyword-explorer-related-keyword-tab-container-related-loading").hide();jQuery(".tb-keyword-explorer-related-keyword-tab-related-list").show();jQuery(".tb-keyword-explorer-select-option-container-related").show();if(n>=r.length&&jQuery(".tb-keyword-explorer-related-keyword-tab-related-list").find("div").length==0){jQuery(".tb-keyword-explorer-related-keyword-tab-related-list").append('<div class="tb-keyword-explorer-related-keyword-tab-related-list-empty" style="color:#999; font-size:15px; position:relative; top:10px;">No related video topics found.<br><br>Please try exploring a more general Keyword if you are looking for video topic suggestions.</div>')}if(n>=r.length&&TBGlobal.CanAccessLevel1Tools()==false){if(o>0){jQuery(".tb-keyword-explorer-related-topic-upgrade-img").show();jQuery(".tb-keyword-explorer-related-topic-upgrade-count").text(o+i);var t=jQuery(".tb-keyword-explorer-related-keyword-tab-related-list").position();var s=200;var l=0;var d=t.left+s-l-10+"px";var u=130+t.top+"px";jQuery(".tb-keyword-explorer-related-topic-upgrade-container").css({position:"absolute",zIndex:5e3,left:d,top:u});jQuery(".tb-keyword-explorer-related-topic-upgrade-container").show()}}})})}else{jQuery(".tb-keyword-explorer-related-keyword-tab-container-related-loading").hide();jQuery(".tb-keyword-explorer-related-keyword-tab-related-list").show()}break}}};var F=function(e){jQuery(".tb-keyword-explorer-related-keyword-desc").removeClass("tb-keyword-explorer-tab-active");jQuery(".tb-keyword-explorer-related-keyword-tab-container").hide();switch(e){case"youtube":{jQuery(".tb-keyword-explorer-related-keyword-tab-container-youtube").show();jQuery(".tb-keyword-explorer-related-youtube-option").addClass("tb-keyword-explorer-tab-active");break}case"google":{jQuery(".tb-keyword-explorer-related-keyword-tab-container-google").show();jQuery(".tb-keyword-explorer-related-google-option").addClass("tb-keyword-explorer-tab-active");break}case"related":{jQuery(".tb-keyword-explorer-related-keyword-tab-container-related").show();jQuery(".tb-keyword-explorer-related-related-option").addClass("tb-keyword-explorer-tab-active");break}case"common":{jQuery(".tb-keyword-explorer-related-keyword-tab-container-common").show();jQuery(".tb-keyword-explorer-related-common-option").addClass("tb-keyword-explorer-tab-active");break}}};var N=function(e,t){y=e;var i=0;jQuery(".tb-keyword-explorer-keyword-score-weighted-desc").removeClass("tb-keyword-explorer-tab-active");switch(e){case"weighted":{jQuery(".tb-keyword-explorer-keyword-score-weighted-option ").addClass("tb-keyword-explorer-tab-active");if(t){ee(t.WeightedScore,t.WeightedScoreRating);he(t.Tag,t.WeightedScore);i=t.WeightedScore;jQuery(".tb-keyword-explorer-unweighted-score-area").hide();jQuery(".tb-keyword-explorer-weighted-score-area").show();jQuery(".tb-keyword-explorer-total-score-desc").html(t.WeightedScoreDescription)}break}case"unweighted":{jQuery(".tb-keyword-explorer-keyword-score-unweighted-option ").addClass("tb-keyword-explorer-tab-active");if(t){ee(t.Score,t.ScoreRating);he(t.Tag,c.Score);i=t.Score;jQuery(".tb-keyword-explorer-unweighted-score-area").show();jQuery(".tb-keyword-explorer-weighted-score-area").hide();jQuery(".tb-keyword-explorer-total-score-desc").html(t.ScoreDescription);if(TBGlobal.CanAccessLevel1Tools()==false){jQuery(".tb-keyword-explorer-weighted-score-area-chart").show();jQuery(".tb-keyword-explorer-weighted-score-area-chart-label").show();jQuery(".tb-keyword-explorer-weighted-prompt").hide()}else{jQuery(".tb-keyword-explorer-weighted-prompt").show()}}break}}if(i<=40){jQuery(".tb-keyword-explorer-total-score-warning").show()}else{jQuery(".tb-keyword-explorer-total-score-warning").hide()}};var Y=function(e,t,i){try{if(e.toLowerCase()!=u.toLowerCase()){_inputAutoCompleteMenuLoaded=true;var o=jQuery(".tb-keyword-explorer-header-auto-complete");var r=jQuery("#tb-keyword-explorer-input");var n=0;var a=o.find(".tb-keyword-explorer-header-auto-complete-items:first");a.empty();jQuery.each(t,function(t,i){if(TBGlobal.CanAccessLevel1Tools()==true||TBGlobal.CanAccessLevel1Tools()==false&&n<3){n++;var o=q(i,e);var r="<div class='tb-keyword-explorer-auto-complete-item' data-tag="+encodeURI(i)+"><span class='tb-keyword-explorer-auto-complete-item-text tb-video-info-suggested-tag-suggestion'>"+o+"</span></div>";var s=TBUtilities.FixLocalHtml(r);a.append(s)}});var s=jQuery(r).position();var l=0;var d=0;var c=s.left+l-d+"px";var p=36+s.top+"px";o.css({position:"absolute",zIndex:1e4,left:c,top:p});if(o.is(":visible")==false){o.hide().fadeIn()}}else{H()}}catch(e){TBUtilities.Log(e)}};var H=function(){try{g=false;_inputAutoCompleteMenuLoaded=false;var e=jQuery(".tb-keyword-explorer-header-auto-complete");e.hide()}catch(e){TBUtilities.Log(e)}};var W=function(){try{var e=jQuery(".tb-keyword-explorer-auto-complete-item.tb-keyword-explorer-auto-complete-item-highlight").first();if(e.length>0){jQuery("#tb-keyword-explorer-input").val(e.text());S(e.text())}}catch(e){TBUtilities.Log(e)}};var z=function(e){try{g=true;var t=jQuery(".tb-keyword-explorer-auto-complete-item.tb-keyword-explorer-auto-complete-item-highlight");if(t.length>0){var i=null;if(e===true){i=t.nextAll(".tb-keyword-explorer-auto-complete-item:first")}else{i=t.prevAll(".tb-keyword-explorer-auto-complete-item:first")}jQuery(".tb-keyword-explorer-auto-complete-item").removeClass("tb-keyword-explorer-auto-complete-item-highlight");i.addClass("tb-keyword-explorer-auto-complete-item-highlight");i.focus()}else{var o=jQuery(".tb-keyword-explorer-auto-complete-item:not(.tb-keyword-explorer-auto-complete-item-highlight)").first();jQuery(".tb-keyword-explorer-auto-complete-item").removeClass("tb-keyword-explorer-auto-complete-item-highlight");o.addClass("tb-keyword-explorer-auto-complete-item-highlight");o.focus()}}catch(e){TBUtilities.Log(e)}};var q=function(e,t){var i=new RegExp(t,"g");return e.replace(i,'<span style="font-weight:normal !important">'+t+"</span>")};var K=function(){jQuery(document).on("click",".tb-keyword-explorer-keyword-trends-history-option",function(e){jQuery(this).siblings().removeClass("tb-keyword-explorer-keyword-trends-history-option-active");jQuery(this).addClass("tb-keyword-explorer-keyword-trends-history-option-active");if(jQuery(this).parent().attr("data-chart-id")==="youtube"){D("youtube",u)}else if(jQuery(this).parent().attr("data-chart-id")==="google"){D("google",u)}});jQuery(document).on("click",".tb-keyword-explorer-limit-tags",function(e){var t=jQuery(this).attr("data-target-id");G(t);R()});jQuery(document).on("click",".tb-keyword-explorer-related-keyword-desc",function(e){var t=jQuery(this).attr("data-tab-id");if(t!=="common"){M(t)}F(t)});jQuery(document).on("click",".tb-keyword-explorer-keyword-score-weighted-desc",function(e){if(TBGlobal.CanAccessLevel1Tools()==true){var t="weighted";if(jQuery(this).hasClass("tb-keyword-explorer-keyword-score-unweighted-option")==true){t="unweighted"}TBExtension.SetDbValue("tb-keyword-explorer-weighted-option"+TBGlobal.CurrentChannelId(),t,null);N(t,c)}});jQuery(document).on("click",".tb-keyword-explorer-keyword-score-weighted-disabled",function(e){TBGlobal.ShowUpgradePage("view your Weighted score",TBGlobal.limitation.tagexplorer)});jQuery(document).on("click","#tb-modal-overlay, #tb-keyword-explorer-container",function(e){if(jQuery(".tb-keyword-explorer-action-select").find(".tb-keyword-explorer-action-dropdown").length>0||jQuery("#tb-keyword-explorer-action-dropup-menu").is(":visible")){O()}});jQuery(document).on("click",".tb-keyword-explorer-all-tags",function(e){var t=jQuery(this).attr("data-target-id");switch(t){case"common":{jQuery("#tb-keyword-explorer-most-used-tags").find(".tb-keyword-explorer-tag-checkbox").each(function(){if(jQuery(this).find(".tb-keyword-explorer-tag-checkbox-confirm").is(":visible")==false){jQuery(this).prop("checked",true)}});break}case"youtube":{jQuery(".tb-keyword-explorer-related-keyword-tab-youtube-list").find(".tb-keyword-explorer-tag-checkbox").each(function(){if(jQuery(this).find(".tb-keyword-explorer-tag-checkbox-confirm").is(":visible")==false){jQuery(this).prop("checked",true)}});break}case"google":{jQuery(".tb-keyword-explorer-related-keyword-tab-google-list").find(".tb-keyword-explorer-tag-checkbox").each(function(){if(jQuery(this).find(".tb-keyword-explorer-tag-checkbox-confirm").is(":visible")==false){jQuery(this).prop("checked",true)}});break}case"related":{jQuery(".tb-keyword-explorer-related-keyword-tab-related-list").find(".tb-keyword-explorer-tag-checkbox").each(function(){if(jQuery(this).find(".tb-keyword-explorer-tag-checkbox-confirm").is(":visible")==false){jQuery(this).prop("checked",true)}});break}}R();P()});jQuery(document).on("click",".tb-keyword-explorer-none-tags",function(e){var t=jQuery(this).attr("data-target-id");switch(t){case"common":{jQuery("#tb-keyword-explorer-most-used-tags").find(".tb-keyword-explorer-tag-checkbox").each(function(){if(jQuery(this).find(".tb-keyword-explorer-tag-checkbox-confirm").is(":visible")==false){jQuery(this).prop("checked",false)}});break}case"youtube":{jQuery(".tb-keyword-explorer-related-keyword-tab-youtube-list").find(".tb-keyword-explorer-tag-checkbox").each(function(){if(jQuery(this).find(".tb-keyword-explorer-tag-checkbox-confirm").is(":visible")==false){jQuery(this).prop("checked",false)}});break}case"google":{jQuery(".tb-keyword-explorer-related-keyword-tab-google-list").find(".tb-keyword-explorer-tag-checkbox").each(function(){if(jQuery(this).find(".tb-keyword-explorer-tag-checkbox-confirm").is(":visible")==false){jQuery(this).prop("checked",false)}});break}case"related":{jQuery(".tb-keyword-explorer-related-keyword-tab-related-list").find(".tb-keyword-explorer-tag-checkbox").each(function(){if(jQuery(this).find(".tb-keyword-explorer-tag-checkbox-confirm").is(":visible")==false){jQuery(this).prop("checked",false)}});break}}R();P()});jQuery(document).on("change",".tb-keyword-explorer-tag-checkbox",function(e){R();P()});jQuery(document).on("click",".tb-video-info-suggested-tag, .tb-video-info-suggested-tag-suggestion",function(){var e=jQuery(this).text().trim();S(e)});jQuery(document).on("click",".tb-video-info-suggested-tag-image",function(){var e=jQuery(this).attr("data-tag-name");if(e==null||e=="")return;jQuery(this).css("cursor","default");jQuery(this).attr("data-tag-name","");jQuery(this).hide("fast",function(){jQuery(this).attr("src",TBGlobal.host+"/images/icons/check.png");jQuery(this).fadeIn()});var t=r.parents(".basic-info-form-input");t.find(".video-settings-add-tag:first").val(e);t.find(".video-settings-add-tag:first").focus();t.find(".video-settings-title:first").focus();t.find(".video-settings-add-tag").trigger("blur");jQuery("#tb-layout-tag-inserted").fadeIn().delay(1e3).fadeOut()});jQuery(document).on("click","#tb-keyword-explorer-insert",function(){var e=jQuery("#tb-keyword-explorer-input").val();if(!e){TBUtilities.Alert("You must enter a Tag before inserting it into your tag list");return}jQuery(".video-settings-add-tag:first").val(e);jQuery(".video-settings-add-tag:first").focus();jQuery(".video-settings-title:first").focus();jQuery(".video-settings-add-tag").trigger("blur");jQuery("#tb-layout-tag-inserted").fadeIn().delay(1e3).fadeOut()});jQuery(document).on("click",".tb-keyword-explorer-upgrade",function(){TBGlobal.ShowUpgradePage(null,TBGlobal.limitation.tagexplorer)});jQuery(document).on("click","#tb-keyword-explorer-close, .tb-keyword-explorer-closex",function(){TubeBuddyMenu.HideBackground();O();jQuery("#tb-keyword-explorer-container").hide();jQuery("#tb-keyword-explorer-action-dropup-button").hide()});jQuery(document).on("click",".tb-keyword-explorer-custom-analysis-upgrade-link",function(){TBGlobal.ShowUpgradePage(null,TBGlobal.limitation.tagexplorer)});jQuery(document).on("click","#tb-keyword-explorer-explore",function(){if(jQuery("#tb-keyword-explorer-input").val()==""){TBUtilities.Alert("Enter a Keyword to explore");return}var e=jQuery("#tb-keyword-explorer-input").val();jQuery(".tb-keyword-explorer-tag-checkbox-explore").removeAttr("disabled");jQuery(".tb-keyword-explorer-tag-checkbox-explore").prop("disabled",false);jQuery("#tb-keyword-explorer-h-frame").attr("src","about:blank");jQuery("#tb-keyword-explorer-m-frame").attr("src","about:blank");S(e);jQuery("#tb-keyword-explorer-back").show()});jQuery(document).on("keyup","#tb-keyword-explorer-input",function(e){if(e.keyCode==13){jQuery("#tb-keyword-explorer-explore").trigger("click")}});jQuery(document).on("mouseover",".tb-keyword-explorer-auto-complete-item",function(e,t){jQuery(".tb-keyword-explorer-auto-complete-item").removeClass("tb-keyword-explorer-auto-complete-item-highlight");jQuery(this).addClass("tb-keyword-explorer-auto-complete-item-highlight")});jQuery(document).on("keydown","#tb-keyword-explorer-input",function(e){try{clearTimeout(m);if(e.which==40||e.which==38){if(_inputAutoCompleteMenuLoaded==true){z(e.which==40)}}if(e.which==13||e.which==9){if(e.which==13&&_inputAutoCompleteMenuLoaded==true&&g==true){W();e.preventDefault();e.stopPropagation();return false}else{H()}}if(e.which==27){H()}m=setTimeout(function(){var t=jQuery("#tb-keyword-explorer-input").val();if(_inputAutoCompleteMenuLoaded==false||t!=T){var i=J(t);if(i===true){if(v==null){var o=jQuery("body")[0].outerHTML;var r=o.indexOf('PSUGGEST_TOKEN":"')+'PSUGGEST_TOKEN":"'.length;var n=o.indexOf('"',r);var a=o.substring(r,n);if(a.length==22){v=a}}T=t;_autoCompleteMenuLoaded=true;TubeBuddyYouTubeActions.GetYouTubeAutoComplete(v,t,function(i){if(i&&i.length>0&&t!=u&&T==t){Y(t,i,e)}else{H()}})}else{H()}}},250);return true}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyKeywordExplorer] #tb-keyword-explorer-input keydown"})}});jQuery(document).on("click",".tb-keyword-explorer-tab-header",function(){try{var e=jQuery(this).attr("data-tab-id");jQuery(".tb-keyword-explorer-tab").hide();jQuery("#"+e).fadeIn();jQuery(".tb-keyword-explorer-tab-header").removeClass("selected");jQuery(this).addClass("selected");switch(e){case"tb-keyword-explorer-map-tab":{if(h==false){h=true;TBUtilities.ReportProductEvent("Feature Used",{Tool:TBGlobal.GetToolById("tagexplorer").name,Action:"map clicked"});var t="https://trends.google.com/trends/embed/explore/GEO_MAP?req=%7B%22comparisonItem%22%3A%5B%7B%22keyword%22%3A%22"+TBUtilities.GetUrlEncoded(u)+"%22%2C%22geo%22%3A%22%22%2C%22time%22%3A%22today%2012-m%22%7D%5D%2C%22category%22%3A0%2C%22property%22%3A%22youtube%22%7D&tz=420&forceMobileMode=false&isPreviewMode=true&eq=gprop%3Dyoutube%26q%3D"+TBUtilities.GetUrlEncoded(u)+"%26date%3Dtoday%2012-m&hl=enUS";TBExtension.Get(t,function(e,t,i,r){try{if(e){var n=i;var a=n.indexOf("token\\x22:\\x22")+"token\\x22:\\x22".length;var s=n.indexOf("\\x22",a);var l=n.substring(a,s);var d=n.indexOf("value\\x22:\\x22")+"value\\x22:\\x22".length;var c=n.indexOf("\\x22",d);var p=n.substring(d,c);var h=new Date;var y=h.getFullYear()+"-"+(h.getMonth()+1).toString().padLeft(2,"0")+"-"+h.getDate().toString().padLeft(2,"0");var b=h.getFullYear()-1+"-"+(h.getMonth()+1).toString().padLeft(2,"0")+"-"+h.getDate().toString().padLeft(2,"0");var f=new Date;f.setDate(f.getDate()-366);var m="https://trends.google.com/trends/api/widgetdata/comparedgeo?req=%7B%22geo%22:%7B%7D,%22comparisonItem%22:%5B%7B%22time%22:%22"+b+"+"+y+"%22,%22complexKeywordsRestriction%22:%7B%22keyword%22:%5B%7B%22type%22:%22BROAD%22,%22value%22:%22"+p+"%22%7D%5D%7D%7D%5D,%22resolution%22:%22COUNTRY%22,%22locale%22:%22en-US%22,%22requestOptions%22:%7B%22property%22:%22youtube%22,%22backend%22:%22IZG%22,%22category%22:0%7D%7D&token="+l;TBExtension.Get(m,function(e,t,i,r){if(o)return;jQuery("#tb-keyword-explorer-map-data-container").empty();jQuery("#tb-video-info-map-container-none").hide();jQuery("#tb-video-info-map-container").show();jQuery("#tb-video-info-map-container-apiquota").hide();jQuery("#tb-keyword-explorer-m-frame").attr("src","https://trends.google.com/trends/embed/explore/GEO_MAP?req=%7B%22comparisonItem%22%3A%5B%7B%22keyword%22%3A%22"+TBUtilities.GetUrlEncoded(u)+"%22%2C%22geo%22%3A%22%22%2C%22time%22%3A%22today%2012-m%22%7D%5D%2C%22category%22%3A0%2C%22property%22%3A%22youtube%22%7D&tz=420&forceMobileMode=false&isPreviewMode=true&eq=gprop%3Dyoutube%26q%3D"+TBUtilities.GetUrlEncoded(u)+"%26date%3Dtoday%2012-m&hl=enUS");try{if(e){if(i.toLowerCase().indexOf("enough search volume")>0){jQuery("#tb-video-info-map-container-none").show();jQuery("#tb-keyword-explorer-map-data-container").hide();jQuery("#tb-video-info-map-container").hide()}else if(i.toLowerCase().indexOf("error")>0){jQuery("#tb-video-info-map-container-none").hide();jQuery("#tb-keyword-explorer-map-data-container").hide();jQuery("#tb-video-info-map-container").hide();jQuery("#tb-video-info-map-container-apiquota").show()}else{jQuery("#tb-keyword-explorer-map-data-container").append('<div style="border-bottom:dashed 1px #ccc; color:#999; text-align:center; padding-right:4px; padding-bottom:2px; margin-bottom:3px;">Search Volume Index</div>');var n=JSON.parse(i.substring(i.indexOf("{")));jQuery.each(n.default.geoMapData,function(e,t){var i="<div><span>"+t.geoName+'</span> <div style="float:right; background-color:red; display:inline-block; color:white; font-size:12px; font-weight:bold; text-align:right; height:13px; width:'+parseInt(t.value)/100*70+"px; opacity:"+parseInt(t.value)/100+';"><span style="position:relative; top:-2px; left:-2px;">'+t.value+"</span></div>";jQuery("#tb-keyword-explorer-map-data-container").append(DOMPurify.sanitize(i,DOMPurifyConfig))})}}else{jQuery("#tb-keyword-explorer-map-data-container").append('<span style="color:#999; font-size:13px; position:relative; top:10px;">Not enough search volume to show results.<br>Try exploring a more broad Tag.<br>Google restricts this data. If you check this frequently and it\'s not returning results check back in 15 minutes.</span>');jQuery("#tb-video-info-map-container-none").show();jQuery("#tb-keyword-explorer-map-data-container").hide();jQuery("#tb-video-info-map-container").hide()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyKeywordExplorer] tb-keyword-explorer-map-tab [click]"})}})}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyKeywordExplorer] tb-keyword-explorer-map-tab [click]"})}})}break}}try{TBUtilities.AddAction({Data:"tabselected = "+e},TBUtilities.ActionTypes.TagExplorer_TagExplored,"tagexplorer")}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyTagTabSelected] [addAction]"})}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyKeywordExplorer] tb-keyword-explorer-tab-header [click]"})}});jQuery(document).on("click",".tb-keyword-explorer-trending-topic-explore",function(e){var t=jQuery(this).attr("data-title");jQuery("#tb-keyword-explorer-input").val(t);jQuery("#tb-keyword-explorer-explore").click()});jQuery(document).on("click","#tb-keyword-explorer-back",function(e){jQuery("#tb-keyword-explorer-tab-container").hide();jQuery("#tb-keyword-explorer-trending-related-container").show();jQuery("#tb-keyword-explorer-tab-none").show();jQuery("#tb-keyword-explorer-back").hide();jQuery("#tb-keyword-explorer-action-dropup-button").hide()});jQuery(document).on("change","#tb-keyword-explorer-trending-topic-country-select",function(e){TBUtilities.CreateCookie("tb-keyword-explorer-country-"+TBGlobal.CurrentChannelId(),jQuery(this).val(),365);ye()});jQuery(document).on("mouseover","#tb-keyword-explorer-action-dropup-button",function(e){e.stopPropagation();if(jQuery("#tb-keyword-explorer-action-dropup-menu").is(":visible")===false){if(ue()){jQuery('.tb-keyword-explorer-action-dropup-menu-item[data-option="addtovideo"]').removeClass("tb-keyword-explorer-action-dropup-menu-item--disabled");jQuery('.tb-keyword-explorer-action-dropup-menu-item[data-option="addtovideo"]').removeAttr("disabled");jQuery('.tb-keyword-explorer-action-dropup-menu-item[data-option="addtovideo"]').removeAttr("title")}else{jQuery('.tb-keyword-explorer-action-dropup-menu-item[data-option="addtovideo"]').addClass("tb-keyword-explorer-action-dropup-menu-item--disabled");jQuery('.tb-keyword-explorer-action-dropup-menu-item[data-option="addtovideo"]').attr("disabled",true);jQuery('.tb-keyword-explorer-action-dropup-menu-item[data-option="addtovideo"]').attr("title","You can only insert this tag when you're editing one of your videos or uploading a new video. Basically, anywhere that you are adding/editing your own tags.")}if(R()>1){jQuery('.tb-keyword-explorer-action-dropup-menu-item[data-option="seostudio"]').addClass("tb-keyword-explorer-action-dropup-menu-item--disabled");jQuery('.tb-keyword-explorer-action-dropup-menu-item[data-option="seostudio"]').attr("disabled",true);jQuery('.tb-keyword-explorer-action-dropup-menu-item[data-option="seostudio"]').attr("title","You can only optimize a video for a single keyword/phrase. Please select only one keyword to proceed to SEO Studio.")}else{jQuery('.tb-keyword-explorer-action-dropup-menu-item[data-option="seostudio"]').removeClass("tb-keyword-explorer-action-dropup-menu-item--disabled");jQuery('.tb-keyword-explorer-action-dropup-menu-item[data-option="seostudio"]').removeAttr("disabled");jQuery('.tb-keyword-explorer-action-dropup-menu-item[data-option="seostudio"]').removeAttr("title")}var t=TBGlobal.host+TBGlobal.apiUrls.taglistsGetLists;TBExtension.Get(t,function(e,t,i){try{if(e){jQuery(".tb-keyword-explorer-lists-container").empty();var o=JSON.parse(i);if(o.length==0){jQuery(".tb-keyword-explorer-lists-container").append('<span class="tb-margin-left10">You don\'t have any tag lists</span>')}else{jQuery.each(o,function(e,t){var i='<div class="tb-keyword-explorer-action-dropup-menu-item" data-option="list" data-list-id="'+t.Id+'" data-list-name="'+t.Name+'"><img src="'+TBGlobal.host+'/images/icons/menu/lists2.png" class="tb-margin-right5"/><span title="'+t.Name+'">'+TBUtilities.Truncate(t.Name,25,true)+"</span></div>";jQuery(".tb-keyword-explorer-lists-container").append(DOMPurify.sanitize(i,DOMPurifyConfig))})}}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyKeywordExplorer] GetLists"})}},null,{contentType:"application/json",dataType:"text"});jQuery("#tb-keyword-explorer-action-dropup-menu").show()}});jQuery(document).on("click",".tb-keyword-explorer-action-dropup-menu-item",function(e){e.stopPropagation();if(jQuery(this).hasClass("tb-keyword-explorer-action-dropup-menu-item--disabled"))return;var t=jQuery(this).attr("data-option");var i=TBGlobal.GetToolById("tagexplorer").name;switch(t){case"clipboard":{TBUtilities.ReportProductEvent("Feature Used",{Tool:i,Action:"Copy tags to Clipboard"});P();ae();R();break}case"addtovideo":{var o=[];jQuery(".tb-keyword-explorer-tag-checkbox").each(function(){if(jQuery(this).is(":checked")&&jQuery(this).hasClass("tb-keyword-explorer-tag-checkbox-hidden")==false){var e=decodeURIComponent(jQuery(this).attr("data-tag-value"));if(e){o.push(e)}}});TBUtilities.ReportProductEvent("Feature Applied",{Tool:i,Action:"Add tags to video",Tags:o});var r=TBGlobal.GetYouTubeUI();switch(r){case"studio":{var n=location.pathname;var s=[];TBUtilities.Log(n);if(n){var s=n.substring(1).split("/");for(var d=0;d<5-s.length;d++)s.push("");if(s[0]=="video"&&s[2]=="edit"){TubeBuddyEditVideoStudio.AddTags(o)}else if(s[2]=="videos"&&s[3]=="upload"){TubeBuddyUploadStudio.AddTags(o)}}break}case"material":case"default":{}}ae();R();break}case"videotopicplanner":{var o=[];var u=[];jQuery(".tb-keyword-explorer-tag-checkbox").each(function(){if(jQuery(this).is(":checked")&&jQuery(this).hasClass("tb-keyword-explorer-tag-checkbox-hidden")==false){var e=decodeURIComponent(jQuery(this).attr("data-tag-value"));if(e){o.push(e);u.push({Title:e,SourceType:4})}}});TBUtilities.ReportProductEvent("Feature Applied",{Tool:i,Action:"Add tags to topic planner",Tags:o});var c=TBGlobal.host+TBGlobal.apiUrls.topicsAddVideoTopics;TBExtension.Post(c,JSON.stringify(u),function(e,t,i){try{if(e){TBUtilities.Log(i);if(i.indexOf("With")>-1){TBUtilities.Alert(result.response)}else{TBUtilities.Alert("Keywords were successfully saved as Video Topics.<br><Br>Click Video Topic Planner from the main TubeBuddy menu to find them.")}}else{TBUtilities.Alert("There was an error saving Video Topics.")}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyKeywordExplrer] tb-keyword-explorer-action-dropup-menu-item [click] videotopicplanner"})}},null,{contentType:"application/json"});break}case"seostudio":{jQuery("#tb-keyword-explorer-container").hide();var p=jQuery("#tb-keyword-explorer-action-dropup-menu").attr("data-clipboard-text");TBUtilities.ReportProductEvent("Feature Used",{Tool:i,Action:"Optimize in SEO Studio",Keyword:p});if(a){if(!jQuery("#upload-mount-node").length){jQuery("<div/>",{id:"upload-mount-node"}).appendTo(a)}jQuery("body").trigger("TBopenSeoStudioVue",[{isUpload:true,videoId:l,startingKeyword:p}])}else{jQuery("body").trigger("TBopenSeoStudioVue",[{isUpload:false,videoId:"",startingKeyword:p}])}break}case"newlist":{if(!a){TBUtilities.Prompt("What would you like the list name to be?",null,function(e,t){if(t.length==0){TBUtilities.Alert("Please enter a list name.");return}var o={Name:t};var r=TBGlobal.host+TBGlobal.apiUrls.taglistsAddList;TBUtilities.ReportProductEvent("Feature Used",{Tool:i,Action:"Create new tag list",Data:o});TBExtension.Post(r,JSON.stringify(o),function(e,t,i){try{if(e){var o=JSON.parse(i);var r='<div class="tb-keyword-explorer-action-dropup-menu-item" data-option="list" data-list-id="'+o.Id+'" data-list-name="'+o.Name+'"><img src="'+TBGlobal.host+'/images/icons/menu/lists2.png" class="tb-margin-right5"/><span title="'+o.Name+'">'+TBUtilities.Truncate(o.Name,25,true)+"</span></div>";jQuery(".tb-keyword-explorer-lists-container").append(DOMPurify.sanitize(r,DOMPurifyConfig))}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyKeywordExplorer] tb-keyword-explorer-action-dropup-menu-item [click] newlist"})}},null,{contentType:"application/json",dataType:"text"})},null)}else{var h=prompt("What would you like the list name to be?","");if(!h||h.length==0){TBUtilities.Alert("Please enter a list name.");return}else{var y={Name:h};var c=TBGlobal.host+TBGlobal.apiUrls.taglistsAddList;TBExtension.Post(c,JSON.stringify(y),function(e,t,i){try{if(e){var o=JSON.parse(i);var r='<div class="tb-keyword-explorer-action-dropup-menu-item" data-option="list" data-list-id="'+o.Id+'" data-list-name="'+o.Name+'"><img src="'+TBGlobal.host+'/images/icons/menu/lists2.png" class="tb-margin-right5"/><span title="'+o.Name+'">'+TBUtilities.Truncate(o.Name,25,true)+"</span></div>";jQuery(".tb-keyword-explorer-lists-container").append(DOMPurify.sanitize(r,DOMPurifyConfig))}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyKeywordExplorer] tb-keyword-explorer-action-dropup-menu-item [click] newlist"})}},null,{contentType:"application/json",dataType:"text"})}}break}case"list":{var b=jQuery(this).attr("data-list-id");if(b){var o=[];jQuery(".tb-keyword-explorer-tag-checkbox").each(function(){if(jQuery(this).is(":checked")&&jQuery(this).hasClass("tb-keyword-explorer-tag-checkbox-hidden")==false){var e=decodeURIComponent(jQuery(this).attr("data-tag-value"));if(e)o.push(e)}});TBUtilities.ReportProductEvent("Feature Applied",{Tool:i,Action:"Copy tags to existing list.",Data:{Tags:o}});var y={Id:b,Tags:o};var c=TBGlobal.host+TBGlobal.apiUrls.taglistsAddTags;TBExtension.Post(c,JSON.stringify(y),function(e,t,i){try{if(e){ae();R()}else{TBUtilities.Alert("There was an error copying tag(s) to your list.  Please make sure the list is still active and try again.")}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyKeywordExplorer] tb-keyword-explorer-action-dropup-menu-item [click] list"})}},null,{contentType:"application/json"})}break}}O();setTimeout(function(){se();R()},5e3)});jQuery(document).on("click","#learn-button",function(){jQuery("body").trigger("TBOpenLearnModule",{playlistType:"keyword-explorer-video-learnings"})});jQuery(document).on("click","#tb-keyword-explorer-common-tags-default",function(){var e=jQuery("#tb-keyword-explorer-common-tags-default").is(":checked");if(e){TBExtension.SetDbValue("tb-keyword-explorer-common-tags-default-option"+TBGlobal.CurrentChannelId(),true,null)}else{TBExtension.RemoveDbValue("tb-keyword-explorer-common-tags-default-option"+TBGlobal.CurrentChannelId())}})};var J=function(e){var t=false;if(e&&e.length>=2){t=true}return t};var X=function(e){if(e!=null){_debugText+="\nANoN";b.push(e);Q.tags=Q.tags+","+e.tags.trim().toLowerCase();Q.titles=Q.titles+" "+e.title.trim().toLowerCase();Q.totalViewCount+=e.viewCount;if(e.channelId==Q.topChannelId){if(Q.topChannelCount==1&&Q.topResult){jQuery("#tb-keyword-explorer-top-channel").text(Q.topResult.channelTitle);jQuery("#tb-keyword-explorer-top-channel").attr("href","https://www.youtube.com/channel/"+Q.topResult.channelId);if(Q.topResult&&Q.topResult.channelThumbnail!=""){jQuery("#tb-keyword-explorer-top-channel-thumbnail").attr("src",Q.topResult.channelThumbnail)}else{jQuery("#tb-keyword-explorer-top-channel-thumbnail").attr("src","https://i.ytimg.com/i/UCo33niDKpTpgwZ_dohqvylg/0.jpg")}jQuery("#tb-keyword-explorer-top-channel-how-many").text("Owns 1 of "+Q.totalResults+" search results.")}else{jQuery("#tb-keyword-explorer-top-channel").text(e.channelTitle);jQuery("#tb-keyword-explorer-top-channel").attr("href","https://www.youtube.com/channel/"+e.channelId);jQuery("#tb-keyword-explorer-top-channel-how-many").text("Owns "+Q.topChannelCount+" of "+Q.totalResults+" search results.");var t=b.filter(function(e){return e.channelId===Q.topChannelId});if(t&&t[0]&&t[0].channelThumbnail!=""){jQuery("#tb-keyword-explorer-top-channel-thumbnail").attr("src",t[0].channelThumbnail)}else{jQuery("#tb-keyword-explorer-top-channel-thumbnail").attr("src","https://i.ytimg.com/i/UCo33niDKpTpgwZ_dohqvylg/0.jpg")}}}}else{_debugText+="\nANiN"}_debugText+="\nF/T: "+Q.videosFetched+" / "+Q.videosTotal;if(Q.videosFetched==Q.videosTotal){_debugText+="\nTags: "+Q.tags;try{var i=new Object;var o=Q.tags.split(",");jQuery.each(o,function(e,t){if(t&&t.trim()!=""){if(i[t]==null)i[t]=1;else i[t]++}});var r=Object.keys(i).sort(function(e,t){return i[t]-i[e]});var n=0;if(r[0]!=null)jQuery.each(r,function(e,t){if(n==0)n=i[t]});if(Q.topResult!=null&&Q.topResultSet==false){Q.topResultSet=true;jQuery("#tb-keyword-explorer-top-video-channel").text(Q.topResult.channelTitle);jQuery("#tb-keyword-explorer-top-video-channel").attr("href","https://www.youtube.com/channel/"+Q.topResult.channelId);jQuery("#tb-keyword-explorer-top-video-title").html(Q.topResult.title);jQuery("#tb-keyword-explorer-top-video-title").attr("href","https://www.youtube.com/watch?v="+Q.topResultVideoId);jQuery("#tb-keyword-explorer-top-video-thumbnail").attr("src","https://i.ytimg.com/vi/"+Q.topResultVideoId+"/mqdefault.jpg")}jQuery("#tb-keyword-explorer-your-channel-thumbnail").attr("src",TBGlobal.Profile().ThumbnailUrl);jQuery("#tb-keyword-explorer-your-channel").attr("href","https://www.youtube.com/channel/"+TBGlobal.CurrentChannelId());jQuery("#tb-keyword-explorer-your-channel").text(TBUtilities.Truncate(TBGlobal.Profile().Title,25,false));jQuery("#tb-keyword-explorer-most-used-tags-list").empty();var a=0;var s=0;jQuery.each(r,function(e,t){if(t.toLowerCase()==u.toLowerCase()){return true}else if(a==3&&!TBGlobal.CanAccessLevel1Tools()){s++;jQuery(".tb-keyword-explorer-most-used-upgrade-count").text(r.length-1);jQuery(".tb-keyword-explorer-most-used-upgrade-container").show()}else{var o=" "+t;var l=i[t];var d=TBUtilities.GetTubeBuddyCheckboxHtml(o,"tb-keyword-explorer-tag-checkbox","data-tag-value="+encodeURIComponent(o.trim()));var c="tb-single-word";if(t.trim().toString().indexOf(" ")>0)c="";var p='<div class="'+c+' tb-tag-has-external"><div style="float:left; position:relative; top:2px;"><img class="tb-keyword-explorer-tag-checkbox-confirm tb-keyword-explorer-tag-checkbox-hidden" src="'+TBGlobal.host+'/images/icons/check.png" />'+d+'</div><div style="float:left;"><a class="tb-video-info-suggested-tag" >'+o+'</a> <a target="_blank" href="https://www.youtube.com/results?search_query='+TBUtilities.GetUrlEncoded(o)+'"><img src="'+TBGlobal.host+'/images/icons/external.png" /></a></div><div style="float:right; background-color:#4A90E2;border-radius: 2px; display:inline-block; color:white; font-size:12px; font-weight:bold; text-align:right; min-width:20px; height:16px; width:'+parseInt(l)/n*100+"px; opacity:"+parseInt(l)*1.3/n+';"  ></div><div style="clear:both"></div>';jQuery("#tb-keyword-explorer-most-used-tags-list").append(DOMPurify.sanitize(p,DOMPurifyConfig));a++}})}catch(e){_debugText+="\nEXB: "+e}jQuery("#tb-keyword-explorer-most-used-tags-loading").hide();jQuery("#tb-keyword-explorer-most-used-tags").show();jQuery("#tb-keyword-explorer-top-ranking-container-loading").hide();jQuery("#tb-keyword-explorer-top-ranking-container").show();jQuery("#tb-keyword-explorer-borrowed-tab-no-results").hide();jQuery("#tb-keyword-explorer-borrowed-tab-results").show();jQuery("#tb-keyword-explorer-most-used-tags-list").show()}};var Z=function(e){jQuery("#tb-keyword-explorer-keyword-score-container-loading").hide();jQuery("#tb-keyword-explorer-keyword-score-container").show();let t=e.Volume&&e.Volume!=null?TBUtilities.FormatNumberAbbreviated(e.Volume):"Insufficient Data";jQuery("#tb-keyword-explorer-search-volume-amount").html(t);jQuery("#tb-keyword-explorer-search-volume").text(Q.searchVolumeName);jQuery("#tb-keyword-explorer-search-volume").attr("title",e.SearchVolume);jQuery("#tb-keyword-explorer-difficulty").text(Q.difficultyName);jQuery("#tb-keyword-explorer-difficulty").attr("title",e.Competition);var i=TBUtilities.FixLocalHtml("url({PLUGIN_FILE_ROOT}/images/icons/caret-left.png)");if(jQuery("#tb-keyword-explorer-competition-chart").highcharts()){jQuery("#tb-keyword-explorer-competition-chart").highcharts().destroy()}var o=100-e.Competition;jQuery("#tb-keyword-explorer-competition-chart").highcharts({chart:{inverted:true,type:"scatter",margin:[4,4,4,4]},title:{text:null},tooltip:{enabled:false},credits:{enabled:false},yAxis:{gridLineColor:"transparent",min:0,max:100,opposite:true,labels:{enabled:false},title:{text:null},plotBands:[{from:0,to:20,color:f[0]},{from:20,to:40,color:f[1]},{from:40,to:60,color:f[2]},{from:60,to:80,color:f[3]},{from:80,to:100,color:f[4]}]},xAxis:{labels:{enabled:false},tickLength:0,min:0,max:1,minorGridLineWidth:0,lineColor:"transparent",minorTickLength:0,tickLength:0,reversed:true},series:[{data:[o],animation:true,showInLegend:false,color:"#000000",dataLabels:{enabled:false,style:{color:"black"}},marker:{symbol:i},states:{hover:{enabled:false}}}]});if(e.Competition<=20){Q.competitionName="Excellent"}else if(e.Competition<=40){Q.competitionName="Very Good"}else if(e.Competition<=60){Q.competitionName="Good"}else if(e.Competition<=80){Q.competitionName="Fair"}else{Q.competitionName="Poor"}jQuery("#tb-keyword-explorer-unweighted-competition").text(Q.competitionName);var r=20;if(e.SearchVolume<=20){Q.searchVolumeName="Poor"}else if(e.SearchVolume<=40){Q.searchVolumeName="Fair"}else if(e.SearchVolume<=60){Q.searchVolumeName="Good"}else if(e.SearchVolume<=80){Q.searchVolumeName="Very Good"}else{Q.searchVolumeName="Excellent"}jQuery("#tb-keyword-explorer-search-volume").text(Q.searchVolumeName);jQuery("#tb-keyword-explorer-search-volume").attr("title",e.SearchVolume);if(jQuery("#tb-keyword-explorer-search-volume-chart").highcharts()){jQuery("#tb-keyword-explorer-search-volume-chart").highcharts().destroy()}jQuery("#tb-keyword-explorer-search-volume-chart").highcharts({chart:{inverted:true,type:"scatter",margin:[4,4,4,4]},title:{text:null},tooltip:{enabled:false},credits:{enabled:false},yAxis:{gridLineColor:"transparent",min:0,max:100,opposite:true,labels:{enabled:false},title:{text:null},plotBands:[{from:0,to:20,color:f[0]},{from:20,to:40,color:f[1]},{from:40,to:60,color:f[2]},{from:60,to:80,color:f[3]},{from:80,to:100,color:f[4]}]},xAxis:{labels:{enabled:false},tickLength:0,min:0,max:1,lineWidth:0,minorGridLineWidth:0,lineColor:"transparent",minorTickLength:0,tickLength:0},series:[{data:[e.SearchVolume],animation:true,showInLegend:false,color:"#000000",dataLabels:{enabled:false,style:{color:"black"}},marker:{symbol:i},states:{hover:{enabled:false}}}]})};var ee=function(e,t){var e=Math.round(e);jQuery("#tb-keyword-explorer-total-score-label").text(t);jQuery("#tb-keyword-explorer-total-score").text(e+"/100");if(e<=20){jQuery("#tb-keyword-explorer-total-score-label").css("color",f[0])}else if(e>20&&e<40){jQuery("#tb-keyword-explorer-total-score-label").css("color",f[1])}else if(e>=40&&e<60){jQuery("#tb-keyword-explorer-total-score-label").css("color",f[2])}else if(e>=60&&e<80){jQuery("#tb-keyword-explorer-total-score-label").css("color",f[3])}else if(e>=80){jQuery("#tb-keyword-explorer-total-score-label").css("color",f[4])}var i=["#0D0D0D","#8e8e8e"];if(jQuery("#tb-keyword-explorer-overall-score-chart").highcharts()){var o=jQuery("#tb-keyword-explorer-overall-score-chart").highcharts();o.series[0].data[0].update(e)}else{jQuery("#tb-keyword-explorer-overall-score-chart").highcharts({chart:{renderTo:"continer",type:"gauge",backgroundColor:"none",margin:[0,0,0,0]},tooltip:{enabled:false},colors:[i[0],i[1]],credits:{enabled:false},title:{text:"",style:{fontFamily:"arial,helvetica,sans-serif",color:i[1],fontWeight:"bold",fontSize:"24px"}},legend:{enabled:false},pane:[{startAngle:-90,endAngle:90,background:null,size:"150%",center:["50%","90%"]}],yAxis:[{min:0,max:100,lineColor:"transparent",tickWidth:2,tickLength:12,tickColor:"transparent",minorTickColor:"transparent",labels:{enabled:false},plotBands:[{from:0,to:20,color:f[0],innerRadius:"50%",outerRadius:"100%"},{from:20,to:40,color:f[1],innerRadius:"50%",outerRadius:"100%"},{from:40,to:60,color:f[2],innerRadius:"50%",outerRadius:"100%"},{from:60,to:80,color:f[3],innerRadius:"50%",outerRadius:"100%"},{from:80,to:100,color:f[4],innerRadius:"50%",outerRadius:"100%"}],pane:0}],plotOptions:{gauge:{dial:{radius:"100%",baseWidth:8,baseLength:3,rearLength:0,labels:{enabled:false}},pivot:{radius:3,backgroundColor:i[1]},showInLegend:false}},series:[{name:"Rank",data:[e],dial:{backgroundColor:i[0]},yAxis:0,dataLabels:{enabled:false,x:0,y:0,color:i[0],borderWidth:0,borderRadius:7,backgroundColor:"#ffffff",padding:1,style:{fontSize:"20px",fontWeight:"bold",lineHeight:"40px"}},states:{hover:{enabled:false}}}]})}};var te=function(){if(c!=null&&B==true){jQuery("#tb-keyword-explorer-weighted-score-loading").hide();jQuery("#tb-keyword-explorer-weighted-score-container").show()}if(TBGlobal.CanAccessLevel1Tools()==false){var e=jQuery(".tb-keyword-explorer-weighted-views:first");var t=e.position();var i=t.left+30+"px";var o=t.top+50+"px";jQuery(".tb-keyword-explorer-custom-analysis-upgrade-container").css({position:"absolute",zIndex:5e3,left:i,top:o});jQuery(".tb-keyword-explorer-custom-analysis-upgrade-container").show()}};var ie=function(e){jQuery(".tb-keyword-explorer-weighted-channel-img").attr("src",TBGlobal.Profile().ThumbnailUrl);if(TBGlobal.CanAccessLevel1Tools()==false){e.WeightedScore=60;e.MedianViews=2e4;e.MedianChannelViews=32e3;e.MedianSubscribers=14e3;e.ChannelSubscribers=15e3}oe(e);re(e)};var oe=function(e){try{var t=TBUtilities.FixLocalHtml("url({PLUGIN_FILE_ROOT}/images/icons/caret-left.png)");if(jQuery("#tb-keyword-explorer-weighted-competition-chart").highcharts()){jQuery("#tb-keyword-explorer-weighted-competition-chart").highcharts().destroy()}if(TBGlobal.CanAccessLevel1Tools()==true){var i=100-e.WeightedCompetition;jQuery("#tb-keyword-explorer-weighted-competition-chart").highcharts({chart:{inverted:true,type:"scatter",margin:[4,4,4,4]},title:{text:null},tooltip:{enabled:false},credits:{enabled:false},yAxis:{gridLineColor:"transparent",min:0,max:100,opposite:true,labels:{enabled:false},title:{text:null},plotBands:[{from:0,to:20,color:f[0]},{from:20,to:40,color:f[1]},{from:40,to:60,color:f[2]},{from:60,to:80,color:f[3]},{from:80,to:100,color:f[4]}]},xAxis:{labels:{enabled:false},tickLength:0,min:0,max:1,lineWidth:0,minorGridLineWidth:0,lineColor:"transparent",minorTickLength:0,tickLength:0},series:[{data:[i],animation:true,showInLegend:false,color:"#000000",dataLabels:{enabled:false,style:{color:"black"}},marker:{symbol:t},states:{hover:{enabled:false}}}]});var o="";if(i<=20){o="Poor"}else if(i<=40){o="Fair"}else if(i<=60){o="Good"}else if(i<=80){o="Very Good"}else{o="Excellent"}jQuery("#tb-tag-weighted-competition").text(o)}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyKeywordExplorer] populateWeightedCompetition"})}};var re=function(e){if(jQuery(".tb-keyword-explorer-weighted-views").highcharts()){jQuery(".tb-keyword-explorer-weighted-views").highcharts().destroy()}var t=TBUtilities.FixLocalHtml("{PLUGIN_FILE_ROOT}/images/icons/target.png");jQuery(".tb-keyword-explorer-weighted-views").highcharts({chart:{type:"column",style:{fontFamily:"CircularStd-Book"},marginBottom:30,marginTop:10,backgroundColor:"rgba(255, 255, 255, 0.0)"},title:{text:""},xAxis:{categories:["Avg.","Target","Your Channel"],crosshair:false,labels:{useHTML:true,formatter:function(){if(this.value=="Your Channel")return'<img data-tbtooltip="Average (median) views for your last 5 videos" class="tb-keyword-explorer-weighted-channel-img" src="'+TBGlobal.Profile().ThumbnailUrl+'" style="height: 20px; vertical-align: middle" />';else if(this.value=="Avg.")return this.value;else if(this.value=="Target")return'<span class="tb-tooltip" data-tbtooltip="Lowest video view count found in top ranking videos"><img  class="tb-keyword-explorer-weighted-target" src="'+t+'" /></span>'}},lineWidth:0,minorGridLineWidth:0,lineColor:"transparent",minorTickLength:0,tickLength:0,minPadding:0,maxPadding:0},yAxis:{min:0,title:{text:"Views"},gridLineWidth:1,gridLineDashStyle:"dash"},tooltip:{enabled:false,formatter:function(){return'<div class="tb-keyword-explorer-chart-tooltip"><span style="font-size:12px">'+this.key+"</span><br><span>"+this.series.name+":</span><b>"+TBUtilities.FormatNumberAbbreviated(this.y)+"</b></div>"}},plotOptions:{column:{dataLabels:{enabled:true,crop:false,color:"#666666",overflow:"none",formatter:function(){return TBUtilities.FormatNumberAbbreviated(this.y)}},minPointLength:2,pointPadding:.2,borderWidth:0},series:{borderRadius:2}},series:[{name:"Median Views",data:[{y:e.MedianViews,color:"#CDCDCD"},{y:e.LowestViews,color:"#00AE00"},{y:e.MedianChannelViews,color:"#4A90E2"}]}],legend:{enabled:false},credits:{enabled:false}});jQuery('[data-tbtooltip!=""]').qtip({content:{attr:"data-tbtooltip"},style:{classes:"qtip-youtube-tubebuddy"}})};var ne=function(e){jQuery(".tb-keyword-explorer-search-result-keyword-count-container").show();var t=TBUtilities.FixLocalHtml("url({PLUGIN_FILE_ROOT}/images/icons/caret-left.png)");if(jQuery("#tb-keyword-explorer-keyword-count-chart").highcharts()){jQuery("#tb-keyword-explorer-keyword-count-chart").highcharts().destroy()}if(e>=100){e=100}var i=100-e;var o="";if(i<=20){o="Poor"}else if(i<=40){o="Fair"}else if(i<=60){o="Good"}else if(i<=80){o="Very Good"}else{o="Excellent"}jQuery(".tb-keyword-explorer-keyword-count").text(o);jQuery("#tb-keyword-explorer-keyword-count-chart").highcharts({chart:{inverted:true,type:"scatter",margin:[4,4,4,4]},title:{text:null},tooltip:{enabled:false},credits:{enabled:false},yAxis:{gridLineColor:"transparent",min:0,max:100,opposite:true,labels:{enabled:false},title:{text:null},plotBands:[{from:0,to:20,color:f[0]},{from:20,to:40,color:f[1]},{from:40,to:60,color:f[2]},{from:60,to:80,color:f[3]},{from:80,to:100,color:f[4]}]},xAxis:{labels:{enabled:false},tickLength:0,min:0,max:1,minorGridLineWidth:0,lineColor:"transparent",minorTickLength:0,tickLength:0,reversed:true},series:[{data:[i],animation:true,showInLegend:false,color:"#000000",dataLabels:{enabled:false,style:{color:"black"}},marker:{symbol:t},states:{hover:{enabled:false}}}]})};var ae=function(){jQuery(".tb-keyword-explorer-tag-checkbox").each(function(){if(jQuery(this).is(":checked")){jQuery(this).closest(".tb-checkbox").addClass("tb-keyword-explorer-tag-checkbox-hidden");jQuery(this).closest(".tb-checkbox").siblings(".tb-keyword-explorer-tag-checkbox-confirm").removeClass("tb-keyword-explorer-tag-checkbox-hidden")}})};var se=function(){jQuery(".tb-keyword-explorer-tag-checkbox").each(function(){jQuery(this).closest(".tb-checkbox").removeClass("tb-keyword-explorer-tag-checkbox-hidden");jQuery(this).closest(".tb-checkbox").siblings(".tb-keyword-explorer-tag-checkbox-confirm").addClass("tb-keyword-explorer-tag-checkbox-hidden")})};var le=function(){jQuery(".tb-keyword-explorer-tab-header-error").show();jQuery(".tb-keyword-explorer-related-keyword-tab-youtube-list").addClass("tb-keyword-explorer-error");jQuery(".tb-keyword-explorer-related-keyword-tab-google-list").addClass("tb-keyword-explorer-error");jQuery(".tb-keyword-explorer-related-keyword-tab-related-list").addClass("tb-keyword-explorer-error")};var de=function(){var e=jQuery("#tb-keyword-explorer-trending-topic-country-select").empty();C.forEach(function(t){e.append('<option value="'+t.code+'">'+t.country+"</option>")})};var ue=function(){var e=document.location.href;return e.indexOf("/edit")>-1||e.indexOf("youtube.com/upload")>-1||e.indexOf("upload?")>0&&e.indexOf("studio.youtube.com")>0&&jQuery(".ytcp-uploads-dialog#dialog").length>0};var ce=function(e,t){var i=[];try{var o=e.match(/\w+/g),r={},n,a;t=t.split(",");for(a=0;a<t.length;a++){r[t[a].trim()]=true}if(o){for(a=0;a<o.length;a++){n=o[a].trim().toLowerCase();if(!r[n]){i.push(n)}}}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyKeywordExplorer] getUncommon"})}return i};var pe=function(){var e=0;TBUtilities.Log("Checking Strength");var t=jQuery("#tb-keyword-explorer-top-hits").text();TBUtilities.Log("Start: "+t.length);e+=TBUtilities.CountMatches(t,u,true,true,false);TBUtilities.Log("M1: "+e);var i=u.split(" ");TBUtilities.Log("Words: "+i);TBUtilities.Log("Words Length: "+i.length);if(i.length>1){for(var o=0;o<i.length;o++){var r=TBUtilities.CountMatches(t,i[o],true,true,false);TBUtilities.Log("wordMatches word: "+i[o]);TBUtilities.Log("wordMatches count: "+r);e+=r/(i.length*i.length*.75);TBUtilities.Log("matches: "+e)}}TBUtilities.Log("Final Score: "+e);return parseInt(e)};var he=function(e,t){var t=Math.round(t);var i=jQuery("#tb-keyword-explorer-recent-list").find('a[data-tag="'+e+'"]');if(i){var o=i.parent().find(".tb-keyword-explorer-recent-list-score");var r=i.parent().first();if(o.length==0){r.append('<span title="keyword score" class="tb-keyword-explorer-recent-list-score"> '+t+"</span>")}else{o.text(t)}}};var ye=function(){jQuery("#tb-topic-generator-trending-list-loading").show();jQuery("#tb-topic-generator-trending-list").hide();var e=TBUtilities.GetCookie("CONSENT");var t=C.map(function(e){return e.code});var o=TBUtilities.GetCookie("tb-keyword-explorer-country-"+TBGlobal.CurrentChannelId());var r="US";if(o){r=o}else if(e&&e.indexOf("+")>-1){try{var n=e.split("+")[1].slice(0,2);if(t.indexOf(n)>-1)r=n}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyKeywordExplorer] getTrendingTopics"})}}jQuery(document).ready(function(){jQuery("#tb-keyword-explorer-trending-topic-country-select").val(r)});var a="https://trends.google.com/trends/trendingsearches/daily/rss?geo="+r;TBExtension.Get(a,function(e,t,o,r){TBUtilities.Log("CRTBTopicGeneratorHotTrends");try{if(e){var n=new Array;var a=jQuery(jQuery.parseXML(o));a.find("item").each(function(){var e=jQuery(this);var t={title:e.find("title").text(),link:e.find("link").text(),description:e.find("description").text(),pubDate:e.find("pubDate").text(),picture:e.filterNode("ht:picture").text(),approxtraffic:e.filterNode("ht:approx_traffic").text(),newsItemTitle:e.filterNode("ht:news_item_title").text()};n.push(t)});jQuery("#tb-keyword-explorer-trending-list-loading").hide();jQuery("#tb-keyword-explorer-trending-list").empty();var s="";for(i=0;i<n.length;i++){var l=jQuery("#tb-keyword-explorer-trending-template").html();rowTemplate=l.formatTemplate(n[i].title,n[i].link,n[i].picture,n[i].approxtraffic,n[i].newsItemTitle);s+=rowTemplate}jQuery("#tb-keyword-explorer-trending-list").append(s);jQuery("#tb-keyword-explorer-trending-list").show()}else{jQuery("#tb-keyword-explorer-trending-related-container").hide()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyKeywordExplorer] GetTrendingTopics"})}})};var be=function(){if(TBGlobal.CanAccessLevel1Tools()==true){TBExtension.GetDbValue("tb-keyword-explorer-weighted-option"+TBGlobal.CurrentChannelId(),function(e,t){if(t){N(t)}else{N("weighted")}})}else{jQuery(".tb-keyword-explorer-keyword-score-unweighted-option").addClass("tb-keyword-explorer-tab-active");jQuery(".tb-keyword-explorer-keyword-score-weighted-option").addClass("tb-keyword-explorer-keyword-score-weighted-disabled")}jQuery("#tb-keyword-explorer-back").hide();S(n);ye();de();jQuery('[data-tbtooltip!=""]').qtip({content:{attr:"data-tbtooltip"},style:{classes:"qtip-youtube-tubebuddy"}})};return{Show:function(t,i,o,d,u,c){r=i;n=t?t:"";if(o&&o.length>0){j=o}if(TBGlobal.IsAuthenticated()){if(d){a=d}else{a=null}if(u){s=u}else{s=null}if(c){l=c}else{l=null}if(!e){if(TBExtension.GetType()==="firefox"){window.requestAnimationFrame=window.requestAnimationFrame.bind(window)}K();U();e=true}else{U()}}},GetScoreColors:function(){return f},GetScore:function(){return c}}}();var TubeBuddyBestTimeToPublish=function(){var e=false;var t=null;var i=6;var o=function(){var e=chrome.extension.getURL("modules/besttimetopublish.html");TBExtension.Get(e,function(e,t,i){try{if(e){TBUtilities.Log("Loading Best Time to Publish template.");i=TBUtilities.FixLocalHtml(DOMPurify.sanitize(i,DOMPurifyConfig));jQuery("body").append(i);y()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyBestTimeToPublish] loadHtml"})}})};var r=async function(e){const t=await TubeBuddyYouTubeActions.AnalyticsGetAudienceOnlineData();try{const e=t.resultData.map(e=>e.Value);if(e.reduce((e,t)=>e+t)>0){let t=e;const i=(new Date).getTimezoneOffset()/60;if(i>0){t=e.slice(i).concat(e.slice(0,i))}else if(i<0){t=e.slice(e.length+i).concat(e.slice(0,e.length+i))}return t}else{return null}}catch(e){TBUtilities.LogError({Exception:e,Location:"[BestTimeToPublish] YouTubeActions AnalyticsGetAudienceOnlineData"})}};var n=async function(){t=await r();if(t){var e=jQuery('input[type=radio][name="tb-best-time-to-publish-create-type"]').val();const i=a(t,e,true);s(i);jQuery("#tb-best-time-to-publish-data-loading").hide();jQuery("#tb-best-time-to-publish-data-loaded").fadeIn()}else{TBUtilities.Log("Not enough viewer data to show this report")}};var a=function(e,t,o){var r=t=="upload";var n=r?i-1:1;var a=e.concat(e.slice(0,n));var s=u(a,r);var d=(new Date).toString();var h=d.substring(d.indexOf("(")+1,d.indexOf(")"));const y={bestDay:c(s),bestHour:p(s%24,true),localTimeZone:h,uploadMode:r};if(o){y.sundayBest=u(a.slice(l.sunday,l.monday+n),r);y.mondayBest=u(a.slice(l.monday,l.tuesday+n),r);y.tuesdayBest=u(a.slice(l.tuesday,l.wednesday+n),r);y.wednesdayBest=u(a.slice(l.wednesday,l.thursday+n),r);y.thursdayBest=u(a.slice(l.thursday,l.friday+n),r);y.fridayBest=u(a.slice(l.friday,l.saturday+n),r);y.saturdayBest=u(a.slice(l.saturday),r)}return y};var s=function(e){const{bestDay:t,bestHour:i,localTimeZone:o,uploadMode:r,sundayBest:n,mondayBest:a,tuesdayBest:s,wednesdayBest:l,thursdayBest:u,fridayBest:c,saturdayBest:h}=e;jQuery('[data-tb-tooltip-btp!=""]').qtip({content:{attr:"data-tb-tooltip-btp"},style:{classes:"qtip-youtube-tubebuddy",tip:false}});if(r){jQuery(".tb-best-time-to-publish-overall-description-livestream").hide();jQuery(".tb-best-time-to-publish-overall-description-upload").show();jQuery("#tb-best-time-to-publish-weekly-help").attr("data-tb-tooltip-btp","If you were to livestream once per week, our analysis indicates that this would be the ideal day and time in order to maximize exposure to your audience.");jQuery("#tb-best-time-to-publish-daily-help").attr("data-tb-tooltip-btp","Based on our analysis, the these hours would be the ideal time to livestream for each day of the week in order to maximize exposure to your audience.")}else{jQuery(".tb-best-time-to-publish-overall-description-upload").hide();jQuery(".tb-best-time-to-publish-overall-description-livestream").show();jQuery("#tb-best-time-to-publish-weekly-help").attr("data-tb-tooltip-btp","If you were to upload once per week, our analysis indicates that this would be the ideal day and time in order to maximize exposure to your audience.");jQuery("#tb-best-time-to-publish-daily-help").attr("data-tb-tooltip-btp","Based on our analysis, the these hours would be the ideal time to upload for each day of the week in order to maximize exposure to your audience.")}jQuery(".tb-best-time-to-publish-overall-peak-day").text(t);jQuery(".tb-best-time-to-publish-overall-peak-time").text(i);jQuery(".tb-best-time-to-publish-timezone").text(o);jQuery(".tb-best-time-to-publish-sunday span").text(p(n%24));d(".tb-best-time-to-publish-sunday i",n);jQuery(".tb-best-time-to-publish-monday span").text(p(a%24));d(".tb-best-time-to-publish-monday i",a);jQuery(".tb-best-time-to-publish-tuesday span").text(p(s%24));d(".tb-best-time-to-publish-tuesday i",s);jQuery(".tb-best-time-to-publish-wednesday span").text(p(l%24));d(".tb-best-time-to-publish-wednesday i",l);jQuery(".tb-best-time-to-publish-thursday span").text(p(u%24));d(".tb-best-time-to-publish-thursday i",u);jQuery(".tb-best-time-to-publish-friday span").text(p(c%24));d(".tb-best-time-to-publish-friday i",c);jQuery(".tb-best-time-to-publish-saturday span").text(p(h%24));d(".tb-best-time-to-publish-saturday i",h)};var l={sunday:0,monday:24,tuesday:48,wednesday:72,thursday:96,friday:120,saturday:144};var d=function(e,t){var i=t%24;jQuery(e).text(i<=12?"wb_sunny":"brightness_3").addClass(i<=12?"tb-font-color-yellow":"tb-font-color-blue")};var u=function(e,t){var o=[1,.4,.25,.2,.2,.2,.2,.15,.15,.15,.15,.15];var r=[1,.75];var n=t?i:r.length;var a={index:0,val:0,hrs:n};for(var s=0;s<=e.length-n;s++){var l;if(t){l=e.slice(s,n+s).map((e,t)=>e*o[t])}else{l=e.slice(s,n+s).map((e,t)=>e*r[t])}var d=l.reduce((e,t)=>e+t);if(d>a.val){a.index=s;a.val=d}}return a.index};var c=function(e){var t;if(e<l.monday){t="Sunday"}else if(e<l.tuesday){t="Monday"}else if(e<l.wednesday){t="Tuesday"}else if(e<l.thursday){t="Wednesday"}else if(e<l.friday){t="Thursday"}else if(e<l.saturday){t="Friday"}else{t="Saturday"}return t};var p=function(e,t){var i;if(e==0){i=t?"12:00am":"12am"}else if(e==12){i=t?"12:00pm":"12pm"}else if(e<12){i=t?e+":00am":e+"am"}else{i=t?e%12+":00pm":e%12+"pm"}return i};var h=function(){jQuery(document).on("change",'input[type=radio][name="tb-best-time-to-publish-create-type"]',function(){const e=a(t,this.value,true);s(e)});jQuery(document).on("click",".tb-best-time-to-publish-more-info-toggle",function(){var e=jQuery(this).siblings(".tb-best-time-to-publish-info");if(e.is(":visible")){e.slideUp();jQuery(this).find(".tb-best-time-to-publish-more-info-toggle-expand").text("arrow_drop_down")}else{e.slideDown();jQuery(this).find(".tb-best-time-to-publish-more-info-toggle-expand").text("arrow_drop_up")}})};var y=function(){if(!e)return;n();var t=0;var o=setInterval(function(){if(jQuery(".yta-audience-online-card.content").length>0){clearInterval(o);var e=jQuery(".yta-audience-online-card.no-data-message");var r=jQuery(".explanation-container:not(.yta-comparison-hovercard)");if(e.length===0){if(r.length>0){r.after(jQuery("#tb-best-time-to-publish-container").show());jQuery(".tb-best-time-to-publish-upload-interval").text(i);try{TBUtilities.AddAction(null,TBUtilities.ActionTypes.BestTimeToPublish_Calculate,"besttimetopublish")}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyBTPcalculate] [addAction]"})}TBExtension.GetDbValue("tb-"+TBGlobal.CurrentChannelId()+"-best-time-to-publish",function(e,t){if(t&&t=="scrollToAudienceOnline"){TBExtension.RemoveDbValue("tb-"+TBGlobal.CurrentChannelId()+"-best-time-to-publish");jQuery(".single-column #see-more-button")[0].scrollIntoView()}})}else{TBUtilities.ReportExtensionDOMIssue("BestTimeToPublish",".explanation-container")}}else{e.after(jQuery("#tb-best-time-to-publish-container-no-data").fadeIn())}}else if(t++>=5){clearInterval(o);TBUtilities.ReportExtensionDOMIssue("BestTimeToPublish",".yta-audience-online-card.content")}},1e3)};return{Initialize:function(){if(!e){h();o();e=true}else if(jQuery("#tb-best-time-to-publish-container").length==0||jQuery("#tb-best-time-to-publish-container-no-data").length==0){o()}else{y()}},GetBestOverall:async function(){const e=await r();if(e){return a(e,"upload",false)}else{return null}}}}();var TubeBuddyV2VPromote=function(){var e=false;var t="-~-~~-~~~-~~-~-";var i="  ";var o=" --~--";var r={step:1,selectedVideo:{id:"",title:"",thumbnail:""},promoteFeaturedContent:{enabled:true,message:""},promoteBulkDescriptionUpdate:{enabled:true,message:"",active:false,index:0,videoList:[],position:"end"},promoteRelatedVideos:{enabled:true},failedVideoIds:[],isStopped:false,notMine:false,channelVideoCount:0};var n=function(){var e=TBGlobal.host+"/ModuleManager/v2vpromotion?v="+TBGlobal.versionNumber;if(loadLocalHTML&&(TBExtension.GetType()=="chrome"||TBExtension.GetType()=="firefox")){e=chrome.extension.getURL("modules/v2vpromotion.html")}else if(loadLocalHTML&&TBExtension.GetType()=="safari"){e="modules/v2vpromotion.html"}TBExtension.Get(e,"CRTBLoadPromoteTemplate")};var a=function(){try{TBUtilities.Log("Preparing Dialog");jQuery("#tb-v2v-promote-header-image").attr("src",r.selectedVideo.thumbnail);jQuery("#tb-v2v-promote-featured-thumbnail").attr("src",r.selectedVideo.thumbnail);jQuery("#tb-v2v-promote-description-text").val('Please watch: "'+r.selectedVideo.title+'" \nhttps://www.youtube.com/watch?v='+r.selectedVideo.id);jQuery(".tb-v2v-promote-video-title").text(r.selectedVideo.title);jQuery("#tb-vid2vid-thumbnail").attr("src",r.selectedVideo.thumbnail);jQuery("#tb-vid2vid-video-link").text(r.selectedVideo.title);jQuery("#tb-vid2vid-video-link").attr("href","https://www.youtube.com/watch?v="+r.selectedVideo.id);jQuery("#tb-v2v-promote-methods-container").hide();jQuery("#tb-v2v-promote-bulk-description-updates-container").hide();jQuery("#tb-v2v-promote-featured-content-container").hide();jQuery("#tb-v2v-promote-cancel").text("Cancel");jQuery("#tb-v2v-promote-kickoff").hide();jQuery("#tb-v2v-promote-continue").show();jQuery("#tb-v2v-promote-summary-container").hide();jQuery("#tb-v2v-promote-featured-video-status-complete").hide();jQuery("#tb-v2v-promote-featured-video-status-processing").hide();jQuery("#tb-v2v-promote-bulk-descriptions-status-complete").hide();jQuery("#tb-v2v-promote-bulk-descriptions-status-processing").hide();jQuery("#tb-v2v-promote-success").hide();jQuery("#tb-v2v-promote-container").fadeIn();jQuery("#tb-v2v-promote-methods-container").fadeIn();if(r.notMine){jQuery("#tb-v2v-promote-select-invideo").prop("checked",false);jQuery("#tb-v2v-promote-select-invideo").prop("disabled",true);jQuery("#tb-v2v-promote-select-invideo-no").show();jQuery("#tb-v2v-promote-select-invideo-disabled").css("color","#aaa")}jQuery("#tb-v2v-promote-select-invideo").prop("checked",false)}catch(e){TBUtilities.LogError({Exception:e,Location:"[V2VPromote] prepareDialog"})}};var s=function(){jQuery(document).on("click","#tb-v2v-promote-cancel, .tb-module-close",function(){try{TubeBuddyMenu.HideBackground();jQuery("#tb-v2v-promote-container").hide();jQuery("#tb-v2v-promote-back").hide();r.step=1}catch(e){TBUtilities.LogError({Exception:e,Location:"[V2VPromote] [click] tb-v2v-promote-cancel"})}});jQuery(document).on("click","#tb-v2v-promote-stop",function(){try{r.isStopped=true;jQuery("#tb-v2v-promote-cancel").show();jQuery("#tb-v2v-promote-cancel").text("Close");jQuery("#tb-v2v-promote-stop").hide();jQuery("#tb-v2v-promote-featured-video-status-processing").hide();jQuery("#tb-v2v-promote-bulk-descriptions-status-processing").hide()}catch(e){TBUtilities.LogError({Exception:e,Location:"[V2VPromote] [click] tb-v2v-promote-stop"})}});jQuery(document).on("click","#tb-v2v-promote-kickoff",function(){try{jQuery("#tb-v2v-promote-kickoff").hide();jQuery("#tb-v2v-promote-back").hide();jQuery("#tb-v2v-promote-cancel").hide();jQuery("#tb-v2v-promote-stop").fadeIn();if(r.promoteFeaturedContent.enabled){l()}else if(r.promoteBulkDescriptionUpdate.enabled){d()}try{if(r.promoteFeaturedContent.enabled)TBUtilities.AddAction(null,TBUtilities.ActionTypes.FeaturedVideoPromotions_Promote,"featuredvideopromotions");if(r.promoteBulkDescriptionUpdate.enabled)TBUtilities.AddAction({VideoCount:r.promoteBulkDescriptionUpdate.videoList.length},TBUtilities.ActionTypes.DescriptionPromotion_Promote,"descriptionpromotion")}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyPromotion] [addAction]"})}}catch(e){TBUtilities.LogError({Exception:e,Location:"[V2VPromote] [click] tb-v2v-promote-kickoff"})}});jQuery(document).on("click","#tb-v2v-promote-back",function(){try{switch(r.step){case 3:if(!r.promoteFeaturedContent.enabled)r.step--;break;case 4:if(!r.promoteBulkDescriptionUpdate.enabled)r.step--;break}r.step--;h()}catch(e){TBUtilities.LogError({Exception:e,Location:"[V2VPromote] [click] tb-v2v-promote-back"})}});jQuery(document).on("click","#tb-v2v-promote-continue",function(){try{switch(r.step){case 1:r.promoteBulkDescriptionUpdate.enabled=jQuery("#tb-v2v-promote-select-description").is(":checked");r.promoteFeaturedContent.enabled=jQuery("#tb-v2v-promote-select-invideo").is(":checked");if(!r.promoteBulkDescriptionUpdate.enabled&&!r.promoteFeaturedContent.enabled){TBUtilities.Alert("You must select at least 1 type of promotion.");return};if(!r.promoteFeaturedContent.enabled){jQuery("#tb-v2v-promote-featured-video-status").text("(skipped)");jQuery("#tb-v2v-promote-featured-video-status").css("color","#777");r.step++}else{jQuery("#tb-v2v-promote-featured-video-status").text("Ready");jQuery("#tb-v2v-promote-featured-video-status").css("color","green")}if(!r.promoteBulkDescriptionUpdate.enabled){jQuery("#tb-v2v-promote-bulk-descriptions-status").text("(skipped)");jQuery("#tb-v2v-promote-bulk-descriptions-status").css("color","#777")}else{jQuery("#tb-v2v-promote-bulk-descriptions-status").text("Ready");jQuery("#tb-v2v-promote-bulk-descriptions-status").css("color","green")}break;case 2:r.promoteFeaturedContent.message=jQuery("#tb-v2v-promote-invideo-message").val();if(!r.promoteBulkDescriptionUpdate.enabled){r.step++}break;case 3:r.promoteBulkDescriptionUpdate.message=jQuery("#tb-v2v-promote-description-text").val();if(jQuery("#tb-v2v-description-start").is(":checked")){r.promoteBulkDescriptionUpdate.position="start";jQuery(".tb-v2v-remove-confirm").hide()}else if(jQuery("#tb-v2v-description-remove").is(":checked")){r.promoteBulkDescriptionUpdate.position="remove";jQuery(".tb-v2v-remove-confirm").show()}else{r.promoteBulkDescriptionUpdate.position="end";jQuery(".tb-v2v-remove-confirm").hide()}break}r.step++;h()}catch(e){TBUtilities.LogError({Exception:e,Location:"[V2VPromote] [click] tb-v2v-promote-continue"})}})};var l=function(){try{jQuery("#tb-v2v-promote-featured-video-status").html("Processing");jQuery("#tb-v2v-promote-featured-video-status").css("color","green");jQuery("#tb-v2v-promote-featured-video-status-processing").fadeIn();TBExtension.Get("https://www.youtube.com/featured_content","CRTBPostCreateVideo")}catch(e){TBUtilities.LogError({Exception:e,Location:"[V2VPromote] startFeaturedContent"})}};var d=function(){try{jQuery("#tb-v2v-promote-bulk-descriptions-status").html("Loading your videos");jQuery("#tb-v2v-promote-bulk-descriptions-status").css("color","green");jQuery("#tb-v2v-promote-bulk-descriptions-status-processing").fadeIn();TBYouTubeApi.GetChannelVideos(TBGlobal.CurrentChannelId(),null,c)}catch(e){TBUtilities.LogError({Exception:e,Location:"[V2VPromote] startBulkDescriptionUpdates"})}};var u=function(e){try{if(!e){jQuery("#tb-v2v-promote-success").fadeIn()}jQuery("#tb-v2v-promote-cancel").show();jQuery("#tb-v2v-promote-cancel").text("Close");jQuery("#tb-v2v-promote-stop").hide();if(r.failedVideoIds.length>0){var t="The following videos failed to update the description:\n";jQuery.each(r.failedVideoIds,function(e,i){t+="https://www.youtube.com/watch?v="+i+"\n"});jQuery("#tb-v2v-failures").val(t);jQuery("#tb-v2v-failures").show()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[V2VPromote] promotionDone"})}};var c=function(e){try{TBUtilities.Log("gotVideos");r.promoteBulkDescriptionUpdate.videoList=e;r.promoteBulkDescriptionUpdate.active=true;r.promoteBulkDescriptionUpdate.index=0;r.failedVideoIds=[];p()}catch(e){TBUtilities.LogError({Exception:e,Location:"[V2VPromote] gotVideos"})}};var p=function(){try{if(r.isStopped){jQuery("#tb-v2v-promote-bulk-descriptions-status").css("color","red");jQuery("#tb-v2v-promote-bulk-descriptions-status").text(jQuery("#tb-v2v-promote-bulk-descriptions-status").text()+" [STOPPED]");u(true);return}var e=r.promoteBulkDescriptionUpdate.videoList.length;jQuery(".tv-v2v-upgrade").attr("href","https://www.tubebuddy.com/account/upgrade?id="+TBGlobal.CurrentChannelId()+"&f=v2vpromotion&utm_source=youtube&utm_medium=extension&utm_campaign=v2vpromotion");if(!TBGlobal.CanAccessLevel1Tools()&&r.promoteBulkDescriptionUpdate.videoList.length>250){jQuery("#tb-v2v-promote-toomany-free").show();e=250}else if(r.promoteBulkDescriptionUpdate.videoList.length>5e3){jQuery("#tb-v2v-promote-toomany-paid").show();e=5e3}if(r.promoteBulkDescriptionUpdate.index>=e){jQuery("#tb-v2v-promote-bulk-descriptions-status").text("Complete");jQuery("#tb-v2v-promote-bulk-descriptions-status-complete").show();jQuery("#tb-v2v-promote-bulk-descriptions-status-processing").hide();u(false);return}jQuery("#tb-v2v-promote-bulk-descriptions-status").text("Processing Video "+(r.promoteBulkDescriptionUpdate.index+1)+" of "+e);var n=r.promoteBulkDescriptionUpdate.videoList[r.promoteBulkDescriptionUpdate.index].snippet.resourceId.videoId;if(r.isStopped){jQuery("#tb-v2v-promote-bulk-descriptions-status").css("color","red");jQuery("#tb-v2v-promote-bulk-descriptions-status").text(jQuery("#tb-v2v-promote-bulk-descriptions-status").text()+" [STOPPED]");u(true);return}var a=r.promoteBulkDescriptionUpdate.videoList[r.promoteBulkDescriptionUpdate.index].snippet.description.indexOf(t);if(a>=0){var s=r.promoteBulkDescriptionUpdate.videoList[r.promoteBulkDescriptionUpdate.index].snippet.description.lastIndexOf(t);var l="";var d="";if(s>0&&s!=a){l=r.promoteBulkDescriptionUpdate.videoList[r.promoteBulkDescriptionUpdate.index].snippet.description.substring(0,a);d=r.promoteBulkDescriptionUpdate.videoList[r.promoteBulkDescriptionUpdate.index].snippet.description.substring(s+t.length,r.promoteBulkDescriptionUpdate.videoList[r.promoteBulkDescriptionUpdate.index].snippet.description.length)}else{d=r.promoteBulkDescriptionUpdate.videoList[r.promoteBulkDescriptionUpdate.index].snippet.description.substring(a+t.length,r.promoteBulkDescriptionUpdate.videoList[r.promoteBulkDescriptionUpdate.index].snippet.description.length)}r.promoteBulkDescriptionUpdate.videoList[r.promoteBulkDescriptionUpdate.index].snippet.description=l+d}a=r.promoteBulkDescriptionUpdate.videoList[r.promoteBulkDescriptionUpdate.index].snippet.description.indexOf(i);if(a>=0){var l="";var d="";d=r.promoteBulkDescriptionUpdate.videoList[r.promoteBulkDescriptionUpdate.index].snippet.description.substring(a+i.length,r.promoteBulkDescriptionUpdate.videoList[r.promoteBulkDescriptionUpdate.index].snippet.description.length);r.promoteBulkDescriptionUpdate.videoList[r.promoteBulkDescriptionUpdate.index].snippet.description=l+d}a=r.promoteBulkDescriptionUpdate.videoList[r.promoteBulkDescriptionUpdate.index].snippet.description.indexOf(o);if(a>=0){var l="";var d="";d=r.promoteBulkDescriptionUpdate.videoList[r.promoteBulkDescriptionUpdate.index].snippet.description.substring(a+o.length,r.promoteBulkDescriptionUpdate.videoList[r.promoteBulkDescriptionUpdate.index].snippet.description.length);r.promoteBulkDescriptionUpdate.videoList[r.promoteBulkDescriptionUpdate.index].snippet.description=l+d}var c=r.promoteBulkDescriptionUpdate.videoList[r.promoteBulkDescriptionUpdate.index].snippet.description;if(r.promoteBulkDescriptionUpdate.videoList[r.promoteBulkDescriptionUpdate.index].snippet.resourceId.videoId!=r.selectedVideo.id){if(r.promoteBulkDescriptionUpdate.position=="end"){c=r.promoteBulkDescriptionUpdate.videoList[r.promoteBulkDescriptionUpdate.index].snippet.description.trim()+"\n\n"+t+"\n"+r.promoteBulkDescriptionUpdate.message+"\n"+t}else if(r.promoteBulkDescriptionUpdate.position=="start"){c=r.promoteBulkDescriptionUpdate.message+o+"\n"+r.promoteBulkDescriptionUpdate.videoList[r.promoteBulkDescriptionUpdate.index].snippet.description.trim()}}var p="";var h={VideoId:r.promoteBulkDescriptionUpdate.videoList[r.promoteBulkDescriptionUpdate.index].snippet.resourceId.videoId,Description:c,Title:null};p=jQuery.param(h);var y=TBGlobal.host+"/api/youtubevideos/UpdateVideoMetadata";TBExtension.Post(y,p,"CTTBV2VEditVideo",null,{contentType:"application/x-www-form-urlencoded; charset=UTF-8"})}catch(e){TBUtilities.LogError({Exception:e,Location:"[V2VPromote] updateNextVideoDescription"})}};var h=function(){try{jQuery("#tb-v2v-promote-methods-container").hide();jQuery("#tb-v2v-promote-bulk-description-updates-container").hide();jQuery("#tb-v2v-promote-featured-content-container").hide();jQuery("#tb-v2v-promote-summary-container").hide();jQuery("#tb-v2v-promote-kickoff").hide();jQuery("#tb-v2v-promote-continue").show();switch(r.step){case 1:jQuery("#tb-v2v-promote-back").hide();jQuery("#tb-v2v-promote-methods-container").fadeIn();break;case 2:jQuery("#tb-v2v-promote-back").fadeIn();jQuery("#tb-v2v-promote-featured-content-container").fadeIn();break;case 3:jQuery("#tb-v2v-promote-back").fadeIn();jQuery("#tb-v2v-promote-bulk-description-updates-container").fadeIn();break;case 4:jQuery("#tb-v2v-promote-back").fadeIn();jQuery("#tb-v2v-promote-summary-container").fadeIn();jQuery("#tb-v2v-promote-kickoff").show();jQuery("#tb-v2v-promote-continue").hide();break}}catch(e){TBUtilities.LogError({Exception:e,Location:"[V2VPromote] showCurrentStep"})}};var y=function(){jQuery(document.body).on("CTTBV2VEditVideo",function(e,t){try{if(r.isStopped){jQuery("#tb-v2v-promote-bulk-descriptions-status").css("color","red");jQuery("#tb-v2v-promote-bulk-descriptions-status").text(jQuery("#tb-v2v-promote-bulk-descriptions-status").text()+" [STOPPED]");u(true);return}r.promoteBulkDescriptionUpdate.index++;p()}catch(e){TBUtilities.LogError({Exception:e,Location:"[V2VPromote] CRTBPromotePostEditUrl"})}});jQuery(document.body).on("CRTBLoadPromoteTemplate",function(e,t){try{if(t.success){t.response=TBUtilities.FixLocalHtml(DOMPurify.sanitize(t.response,DOMPurifyConfig));jQuery("body").append(t.response);b()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[V2VPromote] CRTBLoadPromoteTemplate"})}});jQuery(document.body).on("CRTBPostCreateVideo",function(e,t){try{if(r.isStopped){jQuery("#tb-v2v-promote-featured-video-status").css("color","red");jQuery("#tb-v2v-promote-featured-video-status").text(jQuery("#tb-v2v-promote-featured-video-status").text()+" [STOPPED]");u(true);return}if(t.success){var i=TBUtilities.GetSessionToken(t.response);var o={type:"video",encrypted_video_id:r.selectedVideo.id,timing:"end",start_time:"00:01",smart_timing:1,custom_message:r.promoteFeaturedContent.message,session_token:i};var n=jQuery.param(o);TBExtension.Post("https://www.youtube.com/featured_content?action_save=1",n,"CRTBPostUpdateInVideoProgramming",null,{contentType:"application/x-www-form-urlencoded; charset=UTF-8"})}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[V2VPromote] CRTBPostCreateVideo"})}});jQuery(document.body).on("CRTBPostUpdateInVideoProgramming",function(e,t){try{if(r.isStopped){jQuery("#tb-v2v-promote-featured-video-status").css("color","red");jQuery("#tb-v2v-promote-featured-video-status").text(jQuery("#tb-v2v-promote-featured-video-status").text()+" [STOPPED]");u(true);return}if(t.success){jQuery("#tb-v2v-promote-featured-video-status").text("Complete");jQuery("#tb-v2v-promote-featured-video-status-complete").show();jQuery("#tb-v2v-promote-featured-video-status-processing").hide();if(r.promoteBulkDescriptionUpdate.enabled){d()}else{u(false)}}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[V2VPromote] CRTBPostUpdateInVideoProgramming"})}})};var b=function(){try{a()}catch(e){TBUtilities.LogError({Exception:e,Location:"[V2VPromote] show"})}};return{Show:function(t,i,o,a){if(TBGlobal.IsAuthenticated()){r.selectedVideo.id=t;r.selectedVideo.title=i;r.selectedVideo.thumbnail=o;r.notMine=a==true;if(!e){y();n();s();e=true}else{b()}}}}}();var TubeBuddyCardsStudio=function(){var e=false;var t={method:3,specificVideoIds:[],specificVideos:[],validPlaylistIds:[],playlistId:"",search:"",selectedVideo:{},cards:[],selectedCards:[],videos:[],destinationVideos:[],currentVideo:null,isStopped:false,cardIdsToDelete:[],isDeleteOnly:false,totalDestinationVideos:0,videosWithDeletedCards:[],hasFinished:false,errorCount:0,successCount:0,fromBulkSelectMenu:false,channelVideoCount:0,imageConversionDic:{}};var i={deleteAll:false,deleteUrl:"",deleteText:"",deleteWebsite:false,deleteFundraising:false,deleteMerchandice:false,deleteVideOrPlaylist:false,deleteChannel:false,includePartialMatches:false,includePartialTextMatches:false};var o=function(){var e=chrome.extension.getURL("modules/cardsstudio.html");TBExtension.Get(e,function(e,i,o){try{if(e){o=TBUtilities.FixLocalHtml(DOMPurify.sanitize(o,DOMPurifyConfig));jQuery("body").append(o);if(t.isDeleteOnly){w()}else{k()}}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyCardsStudio] loadHtml"})}})};var r=function(){try{if(!t.isDeleteOnly){TBGlobal.AddUserDebugInfo("TubeBuddyCardsStudio - Loading Video Details");TBYouTubeApi.GetVideoDetails(t.selectedVideo.id,null,function(e){TBGlobal.AddUserDebugInfo("TubeBuddyCardsStudio - selectedVideoDetailsCallback");t.duration=new timelord(e.contentDetails.duration);t.totalVideoMiliseconds=t.duration.ticks();TubeBuddyYouTubeActions.GetCardsListStudio(t.selectedVideo.id).then(e=>{try{t.allData=e;if(!e){t.cards=[];jQuery("#tb-cards-none").show();jQuery("#tb-cards-continue").hide();jQuery("#tb-cards-done-close").show()}else{t.cards=e;jQuery("#tb-cards-total-count").text(t.cards.length);jQuery("#tb-cards-has").show();jQuery("#tb-cards-continue").show();jQuery("#tb-cards-done-close").hide()}jQuery("#tb-cards-list").empty();TBGlobal.AddUserDebugInfo("TubeBuddyCardsStudio - Cards Returned");TBGlobal.AddUserDebugInfo(JSON.stringify(e));var i=t.cards.length;for(var o=0;o<i;o++){var r=t.cards[o];switch(r.type){case"collaborator":{var n='<div class="tb-cards-cards-item tb-card-item" data-card-default-id="'+r.infoCardId+'" ><div class="tb-card-item-inner"> <div class="tb-card-item-type">Channel</div><div class="tb-card-item-input-label">Channel Id</div><input class="tb-cards-default-setting tb-cards-collaborator-channelurl tb-material-input tb-card-item-input" type="text" maxlength="60" data-card-default-id="'+r.key+'" value="'+r.collaboratorInfoCard.channelId+'" /><div class="tb-card-item-input-label">Custom Message</div><input class="tb-cards-default-setting  tb-cards-collaborator-custom-message tb-material-input tb-card-item-input" type="text" maxlength="30" data-card-default-id="'+r.infoCardId+'" value="'+r.customMessage+'" /><div class="tb-card-item-input-label">Teaser Text</div><input class="tb-cards-default-setting tb-cards-collaborator-teaser tb-material-input tb-card-item-input" type="text" maxlength="30" data-card-default-id="'+r.infoCardId+'" value="'+r.teaserText+'" /><div><div class="tb-card-item-input-label">Start Time</div><div class="tb-margin-left10 tb-margin-top5">'+TBUtilities.ReplaceAll(TBUtilities.MilliSecondsToTime(r.teaserStartMs),":"," ")+"</div></div></div></div>";jQuery("#tb-cards-list").append(DOMPurify.sanitize(n,DOMPurifyConfig));break}case"associated":{let e="";if(r.customUploadedImage&&r.customUploadedImage.url){e=r.customUploadedImage.url}else{e=r.externalImageUrl}var n='<div class="tb-cards-cards-item tb-card-item" data-card-default-id="'+r.infoCardId+'"><div class="tb-card-item-inner"><div class="tb-card-item-type"><img style="height:20px; float:right;" src="'+e+'"/>Link</div><div></div><div class="tb-card-item-input-label">Title</div> <input class="tb-cards-default-setting tb-cards-associated-title tb-material-input tb-card-item-input" type="text" maxlength="50" data-card-default-id="'+r.infoCardId+'" value="'+r.associatedWebsiteInfoCard.title+'" /><div class="tb-card-item-input-label">Call to Action</div> <input class="tb-cards-default-setting tb-cards-associated-custom-message tb-material-input tb-card-item-input" type="text" maxlength="30" data-card-default-id="'+r.infoCardId+'" value="'+r.customMessage+'" /><div class="tb-card-item-input-label">URL</div> <input class="tb-cards-default-setting tb-cards-associated-target-url tb-material-input tb-card-item-input" type="text" data-card-default-id="'+r.infoCardId+'" value="'+r.associatedWebsiteInfoCard.targetUrl+'" /><div class="tb-card-item-input-label">Teaser Text</div> <input class="tb-cards-default-setting tb-cards-associated-teaser tb-material-input tb-card-item-input" type="text" maxlength="30" data-card-default-id="'+r.infoCardId+'" value="'+r.teaserText+'" /><div><div class="tb-card-item-input-label">Start Time</div><div class="tb-margin-left10 tb-margin-top5">'+TBUtilities.ReplaceAll(TBUtilities.MilliSecondsToTime(r.teaserStartMs),":"," ")+"</div></div></div></div>";jQuery("#tb-cards-list").append(DOMPurify.sanitize(n,DOMPurifyConfig));break}case"video":{var n='<div class="tb-cards-cards-item tb-card-item" data-card-default-id="'+r.infoCardId+'"><div class="tb-card-item-inner"><div class="tb-card-item-type">Video</div><div class="tb-card-item-input-label">Video Id</div><input class="tb-cards-default-setting tb-cards-video-url tb-material-input tb-card-item-input" type="text" data-card-default-id="'+r.infoCardId+'" value="'+r.videoInfoCard.videoId+'" /><div class="tb-card-item-input-label">Custom Message</div><input class="tb-cards-default-setting tb-cards-video-custom-message tb-material-input tb-card-item-input" type="text" maxlength="30" data-card-default-id="'+r.infoCardId+'" value="'+r.customMessage+'" /><div class="tb-card-item-input-label">Teaser Text</div><input class="tb-cards-default-setting tb-cards-video-teaser tb-material-input tb-card-item-input" type="text" maxlength="30" data-card-default-id="'+r.infoCardId+'" value="'+r.teaserText+'" /><div><div class="tb-card-item-input-label">Start Time</div><div class="tb-margin-left5 tb-margin-top5">'+TBUtilities.ReplaceAll(TBUtilities.MilliSecondsToTime(r.teaserStartMs),":"," ")+"</div></div></div></div>";jQuery("#tb-cards-list").append(DOMPurify.sanitize(n,DOMPurifyConfig));break}case"playlist":{var n='<div class="tb-cards-cards-item tb-card-item" data-card-default-id="'+r.infoCardId+'"  ><div class="tb-card-item-inner"><div class="tb-card-item-type">Playlist</div><div class="tb-card-item-input-label">Playlist Id</div><input class="tb-cards-default-setting tb-cards-playlist-url tb-material-input tb-card-item-input" type="text" data-card-default-id="'+r.infoCardId+'" value="'+r.playlistInfoCard.fullPlaylistId+'" /><div class="tb-card-item-input-label">Custom Message</div><input class="tb-cards-default-setting tb-cards-playlist-custom-message tb-material-input tb-card-item-input" type="text" maxlength="30" data-card-default-id="'+r.infoCardId+'" value="'+r.customMessage+'" /><div class="tb-card-item-input-label">Teaser Text</div><input class="tb-cards-default-setting tb-cards-playlist-teaser tb-material-input tb-card-item-input" type="text" maxlength="30" data-card-default-id="'+r.infoCardId+'" value="'+r.teaserText+'" /><div><div class="tb-card-item-input-label">Start Time</div><div class="tb-margin-left5 tb-margin-top5">'+TBUtilities.ReplaceAll(TBUtilities.MilliSecondsToTime(r.teaserStartMs),":"," ")+"</div></div></div></div>";jQuery("#tb-cards-list").append(DOMPurify.sanitize(n,DOMPurifyConfig));break}case"product":{let e="";if(r.customUploadedImage&&r.customUploadedImage.url){e=r.customUploadedImage.url}else{e=r.externalImageUrl}var n='<div class="tb-cards-cards-item tb-card-item" data-card-default-id="'+r.infoCardId+'"><div class="tb-card-item-inner"><div class="tb-card-item-type"><img style="height:20px; float:right;" src="'+e+'"/>Link</div><div></div><div class="tb-card-item-input-label">Title</div> <input class="tb-cards-default-setting tb-cards-associated-title tb-material-input tb-card-item-input" type="text" maxlength="50" data-card-default-id="'+r.infoCardId+'" value="'+r.productInfoCard.title+'" /><div class="tb-card-item-input-label">Call to Action</div> <input class="tb-cards-default-setting tb-cards-associated-custom-message tb-material-input tb-card-item-input" type="text" maxlength="30" data-card-default-id="'+r.infoCardId+'" value="'+r.customMessage+'" /><div class="tb-card-item-input-label">URL</div> <input class="tb-cards-default-setting tb-cards-associated-target-url tb-material-input tb-card-item-input" type="text" data-card-default-id="'+r.infoCardId+'" value="'+r.productInfoCard.targetUrl+'" /><div class="tb-card-item-input-label">Teaser Text</div> <input class="tb-cards-default-setting tb-cards-associated-teaser tb-material-input tb-card-item-input" type="text" maxlength="30" data-card-default-id="'+r.infoCardId+'" value="'+r.teaserText+'" /><div><div class="tb-card-item-input-label">Start Time</div><div class="tb-margin-left10 tb-margin-top5">'+TBUtilities.ReplaceAll(TBUtilities.MilliSecondsToTime(r.teaserStartMs),":"," ")+"</div></div></div></div>";jQuery("#tb-cards-list").append(DOMPurify.sanitize(n,DOMPurifyConfig));break}case"fund":{let e="";if(r.customUploadedImage&&r.customUploadedImage.url){e=r.customUploadedImage.url}else{e=r.externalImageUrl}var n='<div class="tb-cards-cards-item tb-card-item" data-card-default-id="'+r.infoCardId+'"><div class="tb-card-item-inner"><div class="tb-card-item-type"><img style="height:20px; float:right;" src="'+e+'"/>Link</div><div></div><div class="tb-card-item-input-label">Title</div> <input class="tb-cards-default-setting tb-cards-associated-title tb-material-input tb-card-item-input" type="text" maxlength="50" data-card-default-id="'+r.infoCardId+'" value="'+r.fundraisingInfoCard.title+'" /><div class="tb-card-item-input-label">Call to Action</div> <input class="tb-cards-default-setting tb-cards-associated-custom-message tb-material-input tb-card-item-input" type="text" maxlength="30" data-card-default-id="'+r.infoCardId+'" value="'+r.customMessage+'" /><div class="tb-card-item-input-label">URL</div> <input class="tb-cards-default-setting tb-cards-associated-target-url tb-material-input tb-card-item-input" type="text" data-card-default-id="'+r.infoCardId+'" value="'+r.fundraisingInfoCard.targetUrl+'" /><div class="tb-card-item-input-label">Teaser Text</div> <input class="tb-cards-default-setting tb-cards-associated-teaser tb-material-input tb-card-item-input" type="text" maxlength="30" data-card-default-id="'+r.infoCardId+'" value="'+r.teaserText+'" /><div><div class="tb-card-item-input-label">Start Time</div><div class="tb-margin-left10 tb-margin-top5">'+TBUtilities.ReplaceAll(TBUtilities.MilliSecondsToTime(r.teaserStartMs),":"," ")+"</div></div></div></div>";jQuery("#tb-cards-list").append(DOMPurify.sanitize(n,DOMPurifyConfig));break}case"merch":{let e="";if(r.customUploadedImage&&r.customUploadedImage.url){e=r.customUploadedImage.url}else{e=r.externalImageUrl}var n='<div class="tb-cards-cards-item tb-card-item" data-card-default-id="'+r.infoCardId+'"><div class="tb-card-item-inner"><div class="tb-card-item-type"><img style="height:20px; float:right;" src="'+e+'"/>Link</div><div></div><div class="tb-card-item-input-label">Title</div> <input class="tb-cards-default-setting tb-cards-associated-title tb-material-input tb-card-item-input" type="text" maxlength="50" data-card-default-id="'+r.infoCardId+'" value="'+r.merchInfoCard.title+'" /><div class="tb-card-item-input-label">Call to Action</div> <input class="tb-cards-default-setting tb-cards-associated-custom-message tb-material-input tb-card-item-input" type="text" maxlength="30" data-card-default-id="'+r.infoCardId+'" value="'+r.customMessage+'" /><div class="tb-card-item-input-label">URL</div> <input class="tb-cards-default-setting tb-cards-associated-target-url tb-material-input tb-card-item-input" type="text" data-card-default-id="'+r.infoCardId+'" value="'+r.merchInfoCard.targetUrl+'" /><div class="tb-card-item-input-label">Teaser Text</div> <input class="tb-cards-default-setting tb-cards-associated-teaser tb-material-input tb-card-item-input" type="text" maxlength="30" data-card-default-id="'+r.infoCardId+'" value="'+r.teaserText+'" /><div><div class="tb-card-item-input-label">Start Time</div><div class="tb-margin-left10 tb-margin-top5">'+TBUtilities.ReplaceAll(TBUtilities.MilliSecondsToTime(r.teaserStartMs),":"," ")+"</div></div></div></div>";jQuery("#tb-cards-list").append(DOMPurify.sanitize(n,DOMPurifyConfig));break}}}jQuery("#tb-cards-select-all-cards").click();jQuery("#tb-cards-fetching").hide()}catch(t){t.resultData=e;TBUtilities.LogError({Exception:t,Location:"[TubeBuddyCardsStudio] loadData"})}})})}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyCardsStudio] [loadData]"})}};var n=function(e){jQuery("#tb-cards-progress-container").show();jQuery("#tb-cards-progress-container").html(jQuery("#tb-cards-progress-container").html()+" Delete");t.videosWithDeletedCards.push(e);if(i.deleteAll||t.isDeleteOnly==false&&jQuery("#tb-cards-delete-existing").is(":checked")){TubeBuddyYouTubeActions.DeleteAllCardsStudio(e).then(function(e){jQuery("#tb-cards-progress-container").html(jQuery("#tb-cards-progress-container").html()+" Del Success &#707;");b()}).catch(function(t){TBUtilities.Log("TubeBuddyCardsStudio - deleteAllCardsCallBack cards from video + "+e+" success = false");if(!t)t+="?";jQuery("#tb-cards-progress-container").html(jQuery("#tb-cards-progress-container").html()+" Del Fail &#707;");m(e,"VideoId: "+e+" - Error deleting all cards ("+t+")")})}else if(i.deleteUrl){TubeBuddyYouTubeActions.DeleteAllCardsWithUrlOrTextStudio(e,i.deleteUrl,null,i.includePartialMatches).then(function(e){jQuery("#tb-cards-progress-container").html(jQuery("#tb-cards-progress-container").html()+e.cardsDeleted+" Del Success &#707;");b()}).catch(function(t){TBUtilities.Log("TubeBuddyCardsStudio - DeleteAllCardsWithUrlOrTextStudio cards from video + "+e+" success = false");if(!t)t+="?";jQuery("#tb-cards-progress-container").html(jQuery("#tb-cards-progress-container").html()+" Del Fail &#707;");m(e,"VideoId: "+e+" - Error deleting cards ("+t+")")})}else if(i.deleteText){TubeBuddyYouTubeActions.DeleteAllCardsWithUrlOrTextStudio(e,null,i.deleteText,i.includePartialTextMatches).then(function(e){jQuery("#tb-cards-progress-container").html(jQuery("#tb-cards-progress-container").html()+e.cardsDeleted+" Del Success &#707;");b()}).catch(function(t){TBUtilities.Log("TubeBuddyCardsStudio - DeleteAllCardsWithUrlOrTextStudio cards from video + "+e+" success = false");if(!t)t+="?";jQuery("#tb-cards-progress-container").html(jQuery("#tb-cards-progress-container").html()+" Del Fail &#707;");m(e,"VideoId: "+e+" - Error deleting cards ("+t+")")})}};var a=function(e,t,i){TBUtilities.Log("copyFromTemplateToCard before");TBUtilities.Log(e);switch(e.type){case"merch":{e.merchInfoCard.title=jQuery(t).find(".tb-cards-associated-title").val();e.customMessage=jQuery(t).find(".tb-cards-associated-custom-message").val();e.merchInfoCard.targetUrl=jQuery(t).find(".tb-cards-associated-target-url").val();e.teaserText=jQuery(t).find(".tb-cards-associated-teaser").val();TBUtilities.Log("card.associatedWebsiteInfoCard.targetUrl Post: "+e.merchInfoCard.targetUrl);break}case"fund":{e.fundraisingInfoCard.title=jQuery(t).find(".tb-cards-associated-title").val();e.customMessage=jQuery(t).find(".tb-cards-associated-custom-message").val();e.fundraisingInfoCard.targetUrl=jQuery(t).find(".tb-cards-associated-target-url").val();e.teaserText=jQuery(t).find(".tb-cards-associated-teaser").val();TBUtilities.Log("card.associatedWebsiteInfoCard.targetUrl Post: "+e.fundraisingInfoCard.targetUrl);break}case"product":{e.productInfoCard.title=jQuery(t).find(".tb-cards-associated-title").val();e.customMessage=jQuery(t).find(".tb-cards-associated-custom-message").val();e.productInfoCard.targetUrl=jQuery(t).find(".tb-cards-associated-target-url").val();e.teaserText=jQuery(t).find(".tb-cards-associated-teaser").val();TBUtilities.Log("In Associated");TBUtilities.Log("VideoId: "+i);TBUtilities.Log("card.target_url Pre: "+e.productInfoCard.targetUrl);if(i){try{if(jQuery(".tb-cards-placeholders").is(":checked")){TBUtilities.Log("Doing placeholder replace");e.productInfoCard.targetUrl=TBUtilities.ReplaceAll(e.productInfoCard.targetUrl,"((youtubevideoid))",i,true);e.productInfoCard.targetUrl=TBUtilities.ReplaceAll(e.productInfoCard.targetUrl,"{videoid}",i,true)}}catch(e){console.log(e)}}TBUtilities.Log("card.associatedWebsiteInfoCard.targetUrl Post: "+e.productInfoCard.targetUrl);break}case"associated":{e.associatedWebsiteInfoCard.title=jQuery(t).find(".tb-cards-associated-title").val();e.customMessage=jQuery(t).find(".tb-cards-associated-custom-message").val();e.associatedWebsiteInfoCard.targetUrl=jQuery(t).find(".tb-cards-associated-target-url").val();e.teaserText=jQuery(t).find(".tb-cards-associated-teaser").val();TBUtilities.Log("In Associated");TBUtilities.Log("VideoId: "+i);TBUtilities.Log("card.target_url Pre: "+e.associatedWebsiteInfoCard.targetUrl);if(i){try{if(jQuery(".tb-cards-placeholders").is(":checked")){TBUtilities.Log("Doing placeholder replace");e.associatedWebsiteInfoCard.targetUrl=TBUtilities.ReplaceAll(e.associatedWebsiteInfoCard.targetUrl,"((youtubevideoid))",i,true);e.associatedWebsiteInfoCard.targetUrl=TBUtilities.ReplaceAll(e.associatedWebsiteInfoCard.targetUrl,"{videoid}",i,true)}}catch(e){console.log(e)}}TBUtilities.Log("card.associatedWebsiteInfoCard.targetUrl Post: "+e.associatedWebsiteInfoCard.targetUrl);break}case"video":{e.videoInfoCard.videoId=jQuery(t).find(".tb-cards-video-url").val();e.customMessage=jQuery(t).find(".tb-cards-video-custom-message").val();e.teaserText=jQuery(t).find(".tb-cards-video-teaser").val();break}case"playlist":{e.playlistInfoCard.fullPlaylistId=jQuery(t).find(".tb-cards-playlist-url").val();e.customMessage=jQuery(t).find(".tb-cards-playlist-custom-message").val();e.teaserText=jQuery(t).find(".tb-cards-playlist-teaser").val();break}case"collaborator":{e.customMessage=jQuery(t).find(".tb-cards-collaborator-custom-message").val();e.collaboratorInfoCard.channelId=jQuery(t).find(".tb-cards-collaborator-channelurl").val();e.teaserText=jQuery(t).find(".tb-cards-collaborator-teaser").val();break}}TBUtilities.Log("copyFromTemplateToCard after");TBUtilities.Log(e)};var s=function(e,t,i,o){TBUtilities.Log("TubeBuddyCardsStudio - deleteAllCardsCallBack cards from video + "+t+" success = "+e);if(e){jQuery("#tb-cards-progress-container").html(jQuery("#tb-cards-progress-container").html()+" Del Success &#707;");b()}else{if(!o)o+="?";jQuery("#tb-cards-progress-container").html(jQuery("#tb-cards-progress-container").html()+" Del Fail &#707;");m(t,"VideoId: "+t+" - Error deleting all cards ("+o+")")}};var l=function(){jQuery(document).on("click","#tb-cards-back-bulk",function(){jQuery(".tb-module-embed-video").hide();TubeBuddyMenu.HideBackground();jQuery("#tb-cards-container").hide();t.step=1;TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyBulkCopySelect.Show("TubeBuddyCardsStudio")});jQuery(document).on("change",".tb-cards-placeholders",function(){var e=jQuery(this).is(":checked");if(e&&!TBGlobal.CanAccessLevel3Tools()){jQuery(this).prop("checked",false);TBGlobal.ShowUpgradePage("use Placeholders","legend");return}});jQuery(document).on("click","#tb-cards-error-copy-container",function(){jQuery("#tb-cards-error-copy-container").find("span").text("Copied");window.setTimeout(function(){jQuery("#tb-cards-error-copy-container").find("span").text("Copy video ids")},1500)});jQuery(document).on("click",".tb-cards-default-setting",function(e){e.stopPropagation()});jQuery(document).on("click","#tb-cards-onlyLoadFirstPage",function(e){if(jQuery(this).is(":checked")){jQuery("#tb-cards-onlyLoadFirstPage-number").prop("disabled",false)}else{jQuery("#tb-cards-onlyLoadFirstPage-number").prop("disabled",true)}});jQuery(document).on("click","#tb-cards-select-all-cards",function(e){TBUtilities.Log("TubeBuddyCardsStudio - tb-cards-select-all-cards clicked");jQuery(".tb-cards-cards-item").each(function(){var e=jQuery(this).attr("data-card-default-id");var i=TBUtilities.GetInArray(t.selectedCards,"infoCardId",e);if(i==null){jQuery(this).trigger("click")}})});jQuery(document).on("click","#tb-cards-select-none-cards",function(e){jQuery(".tb-cards-cards-item").each(function(){var e=jQuery(this).attr("data-card-default-id");var i=TBUtilities.GetInArray(t.selectedCards,"infoCardId",e);if(i!=null){jQuery(this).trigger("click")}})});jQuery(document).on("change",".tb-cards-filter",function(){TBUtilities.Log("TubeBuddyCardsStudio - tb-cards-filter clicked");jQuery(".tb-cards-destination-row").show();switch(jQuery(this).val()){case"all":break;case"public":jQuery('.tb-cards-destination-row[data-privacy="private"]').hide();jQuery('.tb-cards-destination-row[data-privacy="unlisted"]').hide();break;case"unlisted":jQuery('.tb-cards-destination-row[data-privacy="public"]').hide();jQuery('.tb-cards-destination-row[data-privacy="private"]').hide();break;case"private":jQuery('.tb-cards-destination-row[data-privacy="public"]').hide();jQuery('.tb-cards-destination-row[data-privacy="unlisted"]').hide();break;case"publicunlisted":jQuery('.tb-cards-destination-row[data-privacy="private"]').hide();break;case"privateunlisted":jQuery('.tb-cards-destination-row[data-privacy="public"]').hide();break}jQuery("#tb-cards-destination-selected-count").text(jQuery("#tb-cards-destination-list").find(".tb-cards-destination-row-selected").filter(":visible").length);jQuery("#tb-cards-destination-total-count").text(jQuery("#tb-cards-destination-list").find(".tb-cards-destination-row").filter(":visible").length)});jQuery(document).on("click","#tb-cards-close, .tb-cards-closex, .tb-module-close",function(){try{TubeBuddyMenu.HideBackground();jQuery("#tb-cards-container").hide();t.step=1}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyCardsStudio] [click] tb-cards-close"})}});jQuery(document).on("click","#tb-cards-method-ids, #tb-cards-method-playlist, #tb-cards-method-search, #tb-cards-method-full",function(e){t.method=parseInt(jQuery(this).attr("data-method"));TBUtilities.Log("TubeBuddyCardsStudio - tb-cards-method-ids, #tb-cards-method-playlist, #tb-cards-method-search, #tb-cards-method-full clicked");TBUtilities.Log("TubeBuddyCardsStudio - data-method "+t.method);jQuery(".tb-playlist-select-manual-id-invalid").hide();var i=jQuery("#tb-cards-input-playlist").playlistSelect().data("plugin_playlistSelect");switch(t.method){case 0:jQuery("#tb-cards-input-ids").removeAttr("disabled","disabled");i.disable();t.playlistId="";jQuery("#tb-cards-input-playlist").attr("disabled","disabled");jQuery("#tb-cards-input-search").attr("disabled","disabled");break;case 1:jQuery("#tb-cards-input-ids").attr("disabled","disabled");jQuery("#tb-cards-input-playlist").removeAttr("disabled","disabled");jQuery("#tb-cards-input-search").attr("disabled","disabled");t.specificVideoIds.length=0;t.specificVideos.length=0;i.enable();i.showDropDown();break;case 2:jQuery("#tb-cards-input-ids").attr("disabled","disabled");i.disable();jQuery("#tb-cards-input-playlist").attr("disabled","disabled");t.specificVideoIds.length=0;t.specificVideos.length=0;t.playlistId="";jQuery("#tb-cards-input-search").removeAttr("disabled","disabled");break;case 3:jQuery("#tb-cards-input-ids").attr("disabled","disabled");jQuery("#tb-cards-input-playlist").attr("disabled","disabled");jQuery("#tb-cards-input-search").attr("disabled","disabled");t.specificVideoIds.length=0;t.specificVideos.length=0;t.playlistId="";i.disable();break}});jQuery(document).on("change keypress keyup paste keydown blur","#tb-cards-input-playlist",function(e){t.playlistId="";var i=jQuery(this).val().trim();i=TBUtilities.ReplaceAll(i,'"',"");if(i.length==0){jQuery("#tb-cards-input-playlist-status").hide();return}if(i.indexOf("list=")>0){i=i.substring(i.indexOf("list=")+5)}if(i.length!=18&&i.length!=34||i.substring(0,2)!="PL"){jQuery("#tb-cards-input-playlist-status").text("Invalid Playlist Id");jQuery("#tb-cards-input-playlist-status").css("color","red")}else{jQuery("#tb-cards-input-playlist-status").text("Valid Playlist Id");jQuery("#tb-cards-input-playlist-status").css("color","green");t.playlistId=i}jQuery("#tb-cards-input-playlist-status").show()});jQuery(document).on("change keypress keyup paste keydown blur","#tb-cards-input-search",function(e){t.search=jQuery(this).val().trim()});jQuery(document).on("change keypress keyup paste keydown blur","#tb-cards-input-ids",function(e){var i=jQuery(this).val().trim();i=TBUtilities.ReplaceAll(i,'"',"");if(i.length==0){jQuery("#tb-cards-input-ids-status").hide();return}jQuery("#tb-cards-input-ids-status").show();t.specificVideoIds=[];if(i.indexOf(",")>-1){t.specificVideoIds=i.split(",")}else{t.specificVideoIds=i.split(" ")}for(var o=0;o<t.specificVideoIds.length;o++){t.specificVideoIds[o]=t.specificVideoIds[o].trim();t.specificVideoIds[o]=t.specificVideoIds[o].replace("https://www.youtube.com/watch?v=","");t.specificVideoIds[o]=t.specificVideoIds[o].replace("https://youtu.be/","");if(t.specificVideoIds[o].length!=11){t.specificVideoIds.splice(o,1);o--}}if(t.specificVideoIds.length==0){jQuery("#tb-cards-input-ids-status").text("No videos detected");jQuery("#tb-cards-input-ids-status").css("color","red")}else if(t.specificVideoIds.length==1){jQuery("#tb-cards-input-ids-status").text("1 video detected");jQuery("#tb-cards-input-ids-status").css("color","green");jQuery("#tb-cards-method-ids").prop("checked",true);jQuery("#tb-cards-method-ids").trigger("click")}else{jQuery("#tb-cards-input-ids-status").text(t.specificVideoIds.length+" videos detected");jQuery("#tb-cards-input-ids-status").css("color","green");jQuery("#tb-cards-method-ids").prop("checked",true);jQuery("#tb-cards-method-ids").trigger("click")}});jQuery(document).on("click",".tb-cards-destination-row",function(){try{if(!jQuery(this).hasClass("tb-cards-destination-row-selected")){if(!TBGlobal.CanAccessLevel2Tools()&&jQuery("#tb-cards-destination-list").find(".tb-cards-destination-row-selected").filter(":visible").length>1){if(t.isDeleteOnly)TBGlobal.ShowUpgradePage("delete cards in bulk (more than 1 video at a time)","bulkdeletecards");else TBGlobal.ShowUpgradePage("copy cards in bulk (more than 1 video at a time)","bulkcopycards");return}jQuery(this).closest(".tb-cards-destination-row").addClass("tb-cards-destination-row-selected")}else{jQuery(this).closest(".tb-cards-destination-row").removeClass("tb-cards-destination-row-selected")}var e=jQuery("#tb-cards-destination-list").find(".tb-cards-destination-row-selected").filter(":visible").length;jQuery("#tb-cards-copy-destination-count").text(e);jQuery("#tb-cards-destination-selected-count").text(e);jQuery("#tb-cards-destination-total-count").text(jQuery("#tb-cards-destination-list").find(".tb-cards-destination-row").filter(":visible").length);if(jQuery("#tb-cards-copy-destination-count").text()=="1")jQuery("#tb-cards-copy-destination-count-s").hide();else jQuery("#tb-cards-copy-destination-count-s").show()}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyCardsStudio] [click] tb-cards-destination-row-selected"})}});jQuery(document).on("click","#tb-cards-select-all-checkboxes",function(){if(!TBGlobal.CanAccessLevel2Tools()&&t.videos.length>1){if(t.isDeleteOnly)TBGlobal.ShowUpgradePage("delete cards in bulk (more than 1 video at a time)","bulkdeletecards");else TBGlobal.ShowUpgradePage("copy cards in bulk (more than 1 video at a time)","bulkcopycards");return}jQuery(".tb-cards-destination-row").addClass("tb-cards-destination-row-selected");var e=jQuery("#tb-cards-destination-list").find(".tb-cards-destination-row-selected").filter(":visible").length;jQuery("#tb-cards-copy-destination-count").text(e);jQuery("#tb-cards-destination-selected-count").text(e);jQuery("#tb-cards-destination-total-count").text(jQuery("#tb-cards-destination-list").find(".tb-cards-destination-row").filter(":visible").length);if(jQuery("#tb-cards-copy-destination-count").text()=="1")jQuery("#tb-cards-copy-destination-count-s").hide();else jQuery("#tb-cards-copy-destination-count-s").show()});jQuery(document).on("click","#tb-cards-select-no-checkboxes",function(){jQuery(".tb-cards-destination-row").removeClass("tb-cards-destination-row-selected");var e=jQuery("#tb-cards-destination-list").find(".tb-cards-destination-row-selected").filter(":visible").length;jQuery("#tb-cards-copy-destination-count").text(e);jQuery("#tb-cards-destination-selected-count").text(e);jQuery("#tb-cards-destination-total-count").text(jQuery("#tb-cards-destination-list").find(".tb-cards-destination-row").filter(":visible").length);if(jQuery("#tb-cards-copy-destination-count").text()=="1")jQuery("#tb-cards-copy-destination-count-s").hide();else jQuery("#tb-cards-copy-destination-count-s").show()});jQuery(document).on("click",".tb-cards-destination-row input",function(e){e.stopPropagation()});jQuery(document).on("click","#tb-cards-expand-all",function(){jQuery(".tb-cards-cards-item-customize").html("Customize &#9650;");jQuery(".tb-cards-cards-item-options").slideDown()});jQuery(document).on("click","#tb-cards-collapse-all",function(){jQuery(".tb-cards-cards-item-customize").html("Customize &#9660;");jQuery(".tb-cards-cards-item-options").slideUp()});jQuery(document).on("click",".tb-cards-cards-item-customize",function(e){e.stopPropagation();try{var t=jQuery(this).attr("data-video-id");if(jQuery(this).parent().parent().find(".tb-cards-cards-item-options").css("display")=="none"){jQuery(this).html("Customize &#9650;");jQuery(this).parent().parent().find(".tb-cards-cards-item-options").slideDown()}else{jQuery(this).html("Customize &#9660;");jQuery(this).parent().parent().find(".tb-cards-cards-item-options").slideUp()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyCardsStudio] [click] tb-cards-cards-item-customize"})}});jQuery(document).on("click","#tb-cards-stop",function(){t.isStopped=true;jQuery("#tb-cards-stop").hide();jQuery("#tb-cards-done-close").show();jQuery("#tb-cards-working").hide();jQuery("#tb-cards-stopped").show()});jQuery(document).on("click","#playlist-select-type-manual",function(){var e=jQuery(this).parents(".playlistSelect").find(".playlistSelectMutliSelectListItem").children("input");e.each(function(e,i){t.validPlaylistIds.push(jQuery(i).val())})});jQuery(document).on("keyup",".playlistSelectManualIds",function(){var e=jQuery(this).val();if(t.validPlaylistIds.indexOf(e)==-1){jQuery(".tb-playlist-select-manual-id-invalid").show()}else{jQuery(".tb-playlist-select-manual-id-invalid").hide()}});jQuery(document).on("click",".playlistSelectTypeList",function(){jQuery(".tb-playlist-select-manual-id-invalid").hide()});jQuery(document).on("click","#tb-cards-kickoff",function(){const e=TBGlobal.GetToolById("bulkcopycards").name;if(!jQuery("#tb-cards-confirm-checkbox").is(":checked")){if(t.isDeleteOnly)TBUtilities.Alert("Please check the box confirming that you want to Delete all cards");else TBUtilities.Alert("Please check the box confirming that you want to copy the cards");return}t.step=4;jQuery("#tb-cards-title-block").text("Bulk Copy Cards - Processing");if(t.isDeleteOnly){TBUtilities.ReportProductEvent("Feature Applied",{Tool:e,Action:`Deleting cards`});jQuery("#tb-cards-title-block").text("Bulk Delete Cards - Processing")}else{TBUtilities.ReportProductEvent("Feature Applied",{Tool:e,Action:`Copying cards`})}jQuery("#tb-cards-status").show();jQuery("#tb-cards-confirm").hide();jQuery("#tb-cards-stop").show();jQuery("#tb-cards-back").hide();jQuery("#tb-cards-kickoff").hide();jQuery("#tb-cards-continue").hide();c()});jQuery(document).on("click change","#tb-cards-delete-text-option, #tb-cards-delete-link-option, #tb-cards-delete-all-option",function(){if(jQuery("#tb-cards-delete-link-option").is(":checked"))jQuery("#tb-cards-delete-partial-matches-container").fadeIn();else jQuery("#tb-cards-delete-partial-matches-container").fadeOut();if(jQuery("#tb-cards-delete-text-option").is(":checked"))jQuery("#tb-cards-delete-partial-matches-container-text").fadeIn();else jQuery("#tb-cards-delete-partial-matches-container-text").fadeOut()});jQuery(document).on("click","#tb-cards-continue, #tb-cards-kickoff",function(){try{TBUtilities.Log("TubeBuddyCardsStudio - tb-cards-continue, #tb-cards-kickoff clicked ");jQuery("#tb-cards-error-copy-container").attr("data-clipboard-text","");if(t.step==1){if(t.selectedCards.length==0&&!t.isDeleteOnly){TBUtilities.Alert("You must select at least 1 card to copy");return}jQuery("#tb-cards-back-bulk").hide();if(t.isDeleteOnly){i.deleteAll=true;i.deleteText="";i.deleteUrl="";if(jQuery("#tb-cards-delete-link-option").is(":checked")){i.deleteAll=false;i.deleteUrl=jQuery("#tb-delete-url").val().trim();i.includePartialMatches=jQuery("#tb-cards-delete-partial-matches").is(":checked");if(!i.deleteUrl){TBUtilities.Alert("You must enter a URL");return}else if(i.deleteUrl.length<=3){TBUtilities.Alert("It does not look like you entered a valid URL");return}}else if(jQuery("#tb-cards-delete-text-option").is(":checked")){i.deleteAll=false;i.deleteText=jQuery("#tb-delete-text").val().trim();i.includePartialTextMatches=jQuery("#tb-cards-delete-partial-matches-text").is(":checked");if(!i.deleteText){TBUtilities.Alert("You must enter a Title/Message/Teaser Text to match");return}else if(i.deleteText.length<3){TBUtilities.Alert("It does not look like you entered a longer Text to match");return}}}jQuery("#tb-cards-loading-videos").show();jQuery("#tb-cards-destination-list").hide();jQuery("#tb-delete-options").hide();jQuery("#tb-cards-source").hide();jQuery("#tb-cards-method").show();if(t.fromBulkSelectMenu==true){jQuery("#tb-cards-title-block").text("Bulk Copy Cards - Step 3")}else{jQuery("#tb-cards-title-block").text("Bulk Copy Cards - Step 2")}if(t.isDeleteOnly)jQuery("#tb-cards-title-block").text("Bulk Delete Cards - Step 2");jQuery("#tb-cards-back").show();TBUtilities.Log("TubeBuddyCardsStudio - Number of cards selected = "+t.selectedCards.length);$.each(t.selectedCards,function(e,t){var i=jQuery("div[data-card-default-id='"+t.infoCardId+"']").first();a(t,i)});t.step=2}else if(t.step==2){if(t.selectedCards.length==0&&!t.isDeleteOnly){TBUtilities.Alert("You must select at least 1 card to copy")}if(t.fromBulkSelectMenu==true){jQuery("#tb-cards-title-block").text("Bulk Copy Cards - Step 4")}else{jQuery("#tb-cards-title-block").text("Bulk Copy Cards - Step 3")}if(t.isDeleteOnly)jQuery("#tb-cards-title-block").text("Bulk Delete Cards - Step 3");jQuery("#tb-cards-destination-selected-count").text(jQuery("#tb-cards-destination-list").find(".tb-cards-destination-row-selected").filter(":visible").length);jQuery(".tb-cards-destination-row").removeClass("tb-cards-destination-row-selected");switch(parseInt(t.method)){case 0:if(t.specificVideoIds.length==0){jQuery("#tb-cards-input-ids-status").css("color","red");jQuery("#tb-cards-input-ids-status").text("No videos detected");jQuery("#tb-cards-input-ids-status").show();TBUtilities.Alert("You must enter a list of 1 or more valid Video IDs (or change you selection method above)");return}if(!TBGlobal.CanAccessLevel2Tools()&&t.specificVideoIds.length>1){if(t.isDeleteOnly)TBGlobal.ShowUpgradePage("delete cards in bulk (more than 1 video at a time)","bulkdeletecards");else TBGlobal.ShowUpgradePage("copy cards in bulk (more than 1 video at a time)","bulkcopycards");return}TBGlobal.AddUserDebugInfo("TubeBuddyCardsStudio - Video Selection Method: Video IDs "+JSON.stringify(t.specificVideoIds));d();break;case 1:var e=jQuery("#tb-cards-input-playlist").playlistSelect().data("plugin_playlistSelect");var o=e.getSelectedPlaylistIds();if(o.length>0){t.playlistId=o.join(",")}if(o.length>=2){TBUtilities.Alert("Please select only one playlist");return}if(t.playlistId==""){jQuery("#tb-cards-input-playlist-status").css("color","red");jQuery("#tb-cards-input-playlist-status").text("Invalid Playlist Id");jQuery("#tb-cards-input-playlist-status").show();TBUtilities.Alert("You must enter a valid Playlist ID (or change you selection method above)");return}TBGlobal.AddUserDebugInfo("TubeBuddyCardsStudio - Video Selection Method: Playlist ["+t.playlistId+"]");TBYouTubeApi.GetPlaylistVideos(t.playlistId,null,g,v);break;case 2:if(t.search==""){TBUtilities.Alert("You must enter a Search Term (or change you selection method above)");return}TBGlobal.AddUserDebugInfo("TubeBuddyCardsStudio - Video Selection Method: Search ["+t.search+"]");jQuery("#tb-cards-destination").show();TBYouTubeApi.GetChannelVideosSearch(t.search,null,g,v);break;case 3:TBGlobal.AddUserDebugInfo("TubeBuddyCardsStudio - Video Selection Method: All");var r=null;if(jQuery("#tb-cards-onlyLoadFirstPage").is(":checked")){var n=/^\+?\d+$/.test(jQuery("#tb-cards-onlyLoadFirstPage-number").val());if(n==false){TBUtilities.Alert("Please enter a valid number for the number of videos to load");return}r=parseInt(jQuery("#tb-cards-onlyLoadFirstPage-number").val());if(r<=0){TBUtilities.Alert("Please enter a valid number for the number of videos to load");return}}TBYouTubeApi.GetChannelVideos(TBGlobal.CurrentChannelId(),null,g,v,r,null,t.selectedVideo.id);break}jQuery("#tb-cards-method").hide();jQuery("#tb-cards-destination").show();jQuery("#tb-cards-destination-list").hide();jQuery("#tb-cards-loading-videos").show();t.step=3}else if(t.step==3){if(jQuery("#tb-cards-delete-existing").is(":checked")){TBGlobal.AddUserDebugInfo("TubeBuddyCardsStudio - Yes, Deleting Existing Cards");jQuery("#tb-cards-delete-existing-warning").show()}else{TBGlobal.AddUserDebugInfo("TubeBuddyCardsStudio - No, Not Deleting Existing Cards");jQuery("#tb-cards-delete-existing-warning").hide()}if(jQuery(".tb-cards-destination-row-selected").filter(":visible").length==0&&t.destinationVideos.length==0){if(t.isDeleteOnly)TBUtilities.Alert("Please select at least 1 video to Delete All Cards from.");else TBUtilities.Alert("Please select at least 1 video to copy the cards to.");return}jQuery("#tb-cards-title-block").text("Bulk Copy Cards - Processing");if(t.isDeleteOnly)jQuery("#tb-cards-title-block").text("Bulk Delete Cards - Processing");t.destinationVideos=[];jQuery(".tb-cards-destination-row-selected").filter(":visible").each(function(){var e=jQuery(this).find(".tb-cards-cards-item-options").attr("data-video-id");jQuery.each(t.videos,function(i,o){if(o.id==e){t.destinationVideos.push(o);TBGlobal.AddUserDebugInfo("TubeBuddyCardsStudio - Selected Destination Video: https://www.youtube.com/watch?v="+e)}})});jQuery("#tb-cards-queue-list").empty();jQuery("#tb-cards-completed-list").empty();jQuery("#tb-cards-queue-list2").empty();jQuery("#tb-cards-completed-list2").empty();jQuery("#tb-cards-error-list2").empty();if(t.isDeleteOnly){if(i.deleteAll)jQuery("#tb-cards-delete-existing-warning").html("<b>WARNING:</b> You have chosen to automatically delete all existing Cards from <b>"+t.destinationVideos.length+"</b> Video(s)");else{if(i.deleteUrl){if(i.includePartialMatches)jQuery("#tb-cards-delete-existing-warning").html('<b>WARNING:</b> You have chosen to automatically delete all existing Cards that contain the URL: "'+i.deleteUrl+'" [INCLUDING PARTIAL MATCHES] from <b>'+t.destinationVideos.length+"</b> Video(s)");else jQuery("#tb-cards-delete-existing-warning").html('<b>WARNING:</b> You have chosen to automatically delete all existing Cards that contain the URL: "'+i.deleteUrl+'" from <b>'+t.destinationVideos.length+"</b> Video(s)")}else if(i.deleteText){if(i.includePartialTextMatches)jQuery("#tb-cards-delete-existing-warning").html('<b>WARNING:</b> You have chosen to automatically delete all existing Cards that have a Title or Tester Text matching: "'+i.deleteText+'" [INCLUDING PARTIAL MATCHES] from <b>'+t.destinationVideos.length+"</b> Video(s)");else jQuery("#tb-cards-delete-existing-warning").html('<b>WARNING:</b> You have chosen to automatically delete all existing Cards that Title or Tester Text: "'+i.deleteText+'" from <b>'+t.destinationVideos.length+"</b> Video(s)")}}}jQuery("#tb-cards-copy-destination-count").text(t.destinationVideos.length);jQuery("#tb-cards-destination-selected-count").text(t.destinationVideos.length);if(jQuery("#tb-cards-copy-destination-count").text()=="1")jQuery("#tb-cards-copy-destination-count-s").hide();else jQuery("#tb-cards-copy-destination-count-s").show();jQuery("#tb-cards-method").hide();jQuery("#tb-cards-confirm-checkbox").prop("checked",false);t.step=4;jQuery("#tb-cards-destination").hide();if(t.fromBulkSelectMenu==true){jQuery("#tb-cards-title-block").text("Bulk Copy Cards - Step 5")}else{jQuery("#tb-cards-title-block").text("Bulk Copy Cards - Step 4")}if(t.isDeleteOnly)jQuery("#tb-cards-title-block").text("Bulk Delete Cards - Step 4");jQuery("#tb-cards-confirm").show();jQuery("#tb-cards-kickoff").show();jQuery("#tb-cards-continue").hide();if(t.destinationVideos.length>=2e3){jQuery("#tb-cards-2k-warning").show()}else{jQuery("#tb-cards-2k-warning").hide()}}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyCardsStudio] [click] #tb-cards-continue, #tb-cards-kickoff"})}});jQuery(document).on("click","#tb-cards-back",function(){TBUtilities.Log(t);if(t.step==2){if(t.isDeleteOnly){jQuery("#tb-delete-options").show();jQuery("#tb-cards-title-block").text("Bulk Delete Cards - Step 1")}else{jQuery("#tb-cards-source").show();if(t.fromBulkSelectMenu==true){jQuery("#tb-cards-back-bulk").show();jQuery("#tb-cards-title-block").text("Bulk Copy Cards - Step 2")}else{jQuery("#tb-cards-title-block").text("Bulk Copy Cards - Step 1")}}jQuery("#tb-cards-method").hide();jQuery("#tb-cards-back").hide();t.step=1}else if(t.step==3){t.step=2;jQuery("#tb-cards-destination").hide();jQuery("#tb-cards-method").show();if(t.fromBulkSelectMenu==true){jQuery("#tb-cards-title-block").text("Bulk Copy Cards - Step 3")}else{jQuery("#tb-cards-title-block").text("Bulk Copy Cards - Step 2")}if(t.isDeleteOnly)jQuery("#tb-cards-title-block").text("Bulk Delete Cards - Step 2");t.specificVideoIds.length=0;t.specificVideos.length=0;jQuery("#tb-cards-input-ids").val("");jQuery("#tb-cards-input-ids-status").hide()}else if(t.step==4){t.step=3;if(t.fromBulkSelectMenu==true){jQuery("#tb-cards-title-block").text("Bulk Copy Cards - Step 4")}else{jQuery("#tb-cards-title-block").text("Bulk Copy Cards - Step 3")}if(t.isDeleteOnly)jQuery("#tb-cards-title-block").text("Bulk Delete Cards - Step 3");jQuery("#tb-cards-destination").show();jQuery("#tb-cards-confirm").hide();jQuery("#tb-cards-kickoff").hide();jQuery("#tb-cards-continue").show();jQuery("#tb-cards-destination-selected-count").text(jQuery("#tb-cards-destination-list").find(".tb-cards-destination-row-selected").filter(":visible").length)}});jQuery(document).on("click",".tb-cards-cards-item",function(){try{var e=jQuery(this).attr("data-card-default-id");TBUtilities.Log("TubeBuddyCardsStudio - card clicked, id = "+e);var i=TBUtilities.GetInArray(t.selectedCards,"infoCardId",e);if(i==null){var o=TBUtilities.GetInArray(t.cards,"infoCardId",e);t.selectedCards.push(o);jQuery(this).addClass("tb-cards-cards-item-selected");jQuery(this).find(".tb-card-item-inner").addClass("tb-card-item-inner-selected")}else{TBUtilities.RemoveFromArray(t.selectedCards,"infoCardId",e);jQuery(this).removeClass("tb-cards-cards-item-selected");jQuery(this).find(".tb-card-item-inner").removeClass("tb-card-item-inner-selected")}jQuery("#tb-cards-selected-count").text(t.selectedCards.length);jQuery("#tb-cards-total-count").text(t.cards.length);jQuery("#tb-cards-copy-count").text(t.selectedCards.length);if(t.selectedCards.length==1)jQuery("#tb-cards-copy-count-s").hide();else jQuery("#tb-cards-copy-count-s").show();if(t.selectedCards.length==0){jQuery("#tb-cards-continue").attr("data-tooltip-text","Select at least 1 Card to Copy")}else{jQuery("#tb-cards-continue").removeAttr("disabled");jQuery("#tb-cards-continue").attr("data-tooltip-text","Continue to next step")}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyCardsStudio] [click] tb-cards-cards-item"})}})};var d=function(){var e=t.specificVideoIds[0];t.specificVideoIds.splice(0,1);TBYouTubeApi.GetVideoDetails(e,"contentDetails,snippet,id",u)};var u=function(e){if(e!=null)t.specificVideos.push(e);if(t.specificVideoIds.length>0){d()}else{g(t.specificVideos)}};var c=function(){try{t.totalDestinationVideos=t.destinationVideos.length;t.hasFinished=false;t.errorCount=0;t.successCount=0;jQuery("#tb-cards-queue-list").empty();jQuery("#tb-cards-completed-list").empty();jQuery("#tb-cards-queue-list2").empty();jQuery("#tb-cards-completed-list2").empty();jQuery("#tb-cards-error-list2").empty();jQuery("#tb-cards-error-list2").hide();jQuery("#tb-cards-error-none-list2").show();jQuery("#tb-cards-working").show();jQuery("#tb-cards-done").hide();jQuery("#tb-cards-stopped").hide();try{if(t.isDeleteOnly)TBUtilities.AddAction({VideoCount:t.destinationVideos.length,Data:"method = "+t.method},TBUtilities.ActionTypes.BulkDeleteCards_Delete,"bulkdeletecards");else TBUtilities.AddAction({VideoCount:t.destinationVideos.length,CardCount:t.selectedCards.length,Data:"method = "+t.method},TBUtilities.ActionTypes.BulkCopyCards_Copy,"bulkcopycards")}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyCardsStudio] [addAction]"})}b();p()}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyCardsStudio] [startProcessing]"})}};var p=function(){jQuery("#tb-cards-queue-list2").empty();jQuery("#tb-cards-queue-complete-list2").hide();var e=0;jQuery.each(t.destinationVideos,function(t,i){var o=jQuery(".tb-cards-processing-template2:last")[0].outerHTML;o=o.replace("#THUMBNAILURL#",i.snippet.thumbnails.default.url);o=TBUtilities.ReplaceAll(o,"#VIDEOID#",i.id);o=o.replace("#VIDEOTITLE#",i.snippet.title);o=o.replace("#HREF#","https://www.youtube.com/watch?v="+i.id);o=o.replace("display: none","display:flex");jQuery("#tb-cards-queue-list2").prepend(DOMPurify.sanitize(o,DOMPurifyConfig));e++;if(e==3)return false});if(e==0){jQuery("#tb-cards-queue-complete-list2").show();jQuery("#tb-cards-queue-list2").hide()}else{jQuery("#tb-cards-queue-list2").show()}};var h=function(e){var i=jQuery(".tb-cards-processed-success:last")[0].outerHTML;if(jQuery("#tb-cards-skip-existing").is(":checked")&&e.skipped&&e.skipped===true){i=jQuery(".tb-cards-skipped-success:last")[0].outerHTML}i=i.replace("#THUMBNAILURL#",e.snippet.thumbnails.default.url);i=TBUtilities.ReplaceAll(i,"#VIDEOID#",e.id);i=i.replace("#VIDEOTITLE#",e.snippet.title);i=i.replace("#HREF#","https://studio.youtube.com/video/"+e.id+"/edit");i=i.replace("display:none","display:flex");jQuery("#tb-cards-completed-list2").prepend(DOMPurify.sanitize(i,DOMPurifyConfig));jQuery("#tb-cards-completed-none-list2").hide();jQuery("#tb-cards-completed-list2").show();t.successCount++;jQuery("#tb-cards-completed-list2-count").text(TBUtilities.FormatNumberWithCommas(t.successCount))};var y=function(e){try{jQuery("#tb-cards-error-copy-container").show();var i=jQuery("#tb-cards-error-copy-container").attr("data-clipboard-text");var o=[];if(i!=""){o=i.split(",");if(o.indexOf(e.id)==-1){o.push(e.id)}}else{o.push(e.id)}jQuery("#tb-cards-error-copy-container").attr("data-clipboard-text",o.join(","))}catch(e){TBUtilites.Log(e)}var r=jQuery(".tb-cards-processed-error:last")[0].outerHTML;r=r.replace("#THUMBNAILURL#",e.snippet.thumbnails.default.url);r=TBUtilities.ReplaceAll(r,"#VIDEOID#",e.id);r=r.replace("#VIDEOTITLE#",e.snippet.title);r=r.replace("#ERROR#",e.error);r=r.replace("#HREF#","https://studio.youtube.com/video/"+e.id+"/edit");r=r.replace("display:none","display:block");jQuery("#tb-cards-error-list2").prepend(DOMPurify.sanitize(r,DOMPurifyConfig));jQuery("#tb-cards-error-list2").show();jQuery("#tb-cards-error-none-list2").hide();t.errorCount++;jQuery("#tb-cards-error-list2-count").text(TBUtilities.FormatNumberWithCommas(t.errorCount))};var b=function(){try{TBUtilities.Log("TubeBuddyCardsStudio - next video");jQuery("#tb-cards-progress-container").html("Start &#707;");if(t.isStopped)return;if(t.destinationVideos.length==0&&!t.hasFinished){t.hasFinished=true;var e="<b>"+t.totalDestinationVideos+"</b> of <b>"+t.totalDestinationVideos+"</b> videos complete";jQuery("#tb-cards-status-count").html(DOMPurify.sanitize(e,DOMPurifyConfig));jQuery("#tb-cards-progress-container").hide();if(t.currentVideo){if(!t.currentVideo.error)h(t.currentVideo);else y(t.currentVideo)}p();jQuery("#tb-cards-working").hide();jQuery("#tb-cards-done").show();jQuery("#tb-cards-stop").hide();jQuery("#tb-cards-done-close").show();return}var i=t.destinationVideos[0].id;if(jQuery("#tb-cards-delete-existing").is(":checked")&&!t.isDeleteOnly){if(t.videosWithDeletedCards.indexOf(i)==-1){n(i);return}}if(t.currentVideo){if(!t.currentVideo.error)h(t.currentVideo);else y(t.currentVideo)}var o=TBUtilities.RemoveFromArray(t.destinationVideos,"id",i)[0];t.currentVideo=o;jQuery("#tb-cards-status-count").html("<b>"+parseInt(t.totalDestinationVideos-t.destinationVideos.length)+"</b> of <b>"+t.totalDestinationVideos+"</b> videos complete");jQuery("#tb-cards-progress-container").html(jQuery("#tb-cards-progress-container").html()+' Id: <a style="font-weight:normal" target="_blank" href="https://www.youtube.com/watch?v='+i+'">'+i+"</a> &#707;");p();TBGlobal.AddUserDebugInfo("TubeBuddyCardsStudio - Getting Video Details for: "+o.id);if(t.isDeleteOnly){n(i)}else{f(t.currentVideo.id,jQuery("#tb-cards-delete-existing").is(":checked")).then(function(e){TBYouTubeApi.GetVideoDetails(t.currentVideo.id,null,function(i){if(jQuery("#tb-cards-skip-existing").is(":checked")){if(e&&e.length>0){jQuery("#tb-cards-progress-container").html(jQuery("#tb-cards-progress-container").html()+" Skipped");t.currentVideo.skipped=true;b();return}}if(!i){throw"Failed to get video details!"}try{t.currentVideo.contentDetails=i.contentDetails;var o=new timelord(i.contentDetails.duration);var r=o.ticks();jQuery("#tb-cards-progress-container").html(jQuery("#tb-cards-progress-container").html()+" Copy ("+t.selectedCards.length+") &#707;");jQuery("#tb-cards-progress-container").html(jQuery("#tb-cards-progress-container").html()+" Got Details &#707;");var n=[];jQuery.each(t.selectedCards,function(e,o){var s=jQuery("div[data-video-id='"+i.id+"'][data-card-default-id='"+o.infoCardId+"']");var l=jQuery.extend({},o);a(l,s,i.id);TBUtilities.CheckCardStartMs(l,t.totalVideoMiliseconds,r);l.newAddition=true;n.push(l)});if(e&&e.length>0){e.forEach(function(e){n.push(e)})}if(n.length>5){throw"Video can only contain up to 5 cards"}TubeBuddyYouTubeActions.CopyCardsStudio(t.currentVideo.id,n).then(e=>{TBUtilities.Log("TubeBuddyCardsStudio card copy callback");TBUtilities.Log(e)}).catch(e=>{if(e){t.currentVideo.error=e}else{t.currentVideo.error="Error copying cards"}}).finally(e=>{b()})}catch(e){let i=" [Error: "+e+"]";jQuery("#tb-cards-progress-container").html(jQuery("#tb-cards-progress-container").html()+" Failed Details &#707;");m(t.currentVideo.id,i)}})}).catch(function(e){let i=" [Error: "+e+"]";jQuery("#tb-cards-progress-container").html(jQuery("#tb-cards-progress-container").html()+" Failed Details &#707;");m(t.currentVideo.id,i)})}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyCardsStudio] [processNextVideo]"});jQuery("#tb-cards-progress-container").html(jQuery("#tb-cards-progress-container").html()+"Error: "+e.message);TBUtilities.Alert('Sorry, there was an error: "'+e.message+'"');jQuery("#tb-cards-stop").trigger("click")}};var f=function(e,t){return new Promise(function(i,o){if(t===true){i([])}else{TubeBuddyYouTubeActions.GetCardsListStudio(e).then(function(e){i(e)})}})};var m=function(e,i){t.currentVideo.error=i;b()};var v=function(e){if(e.totalCount-e.loaded>50){jQuery("#tb-cards-loading-count").attr("data-auto-count",e.loaded);var t=e.totalCount;if(jQuery("#tb-cards-onlyLoadFirstPage").is(":checked")){t=parseInt(jQuery("#tb-cards-onlyLoadFirstPage-number").val())}jQuery("#tb-cards-loading-count-total").text(t);TBUtilities.AutoIncrementCount(jQuery("#tb-cards-loading-count"))}else{jQuery("#tb-cards-rendering").show();jQuery("#tb-cards-loading-count-container").hide()}};var g=function(e){try{if(e==null){if(t.method==0)TBUtilities.Alert("No valid Video IDs found");else if(t.method==1)TBUtilities.Alert("Invalid Playlist Id or no videos found in playlist");else if(t.method==2)TBUtilities.Alert("No videos matching your search");else if(t.method==3)TBUtilities.Alert("No videos found or failed to load. Try again.");jQuery("#tb-cards-back").trigger("click");return}else if(e.length==0){if(t.method==0)TBUtilities.Alert("No valid Video IDs found");else if(t.method==1)TBUtilities.Alert("Invalid Playlist Id or no videos found in playlist");else if(t.method==2)TBUtilities.Alert("No videos matching your search");else if(t.method==3)TBUtilities.Alert("No videos found or failed to load. Try again.");jQuery("#tb-cards-back").trigger("click");return}t.videos=[];jQuery("#tb-cards-destination-list").empty();var i=jQuery(".tb-cards-destination-row:last")[0].outerHTML;var o=jQuery(".tb-cards-destination-option-associated-row:last")[0].outerHTML;var r=jQuery(".tb-cards-destination-option-video-row:last")[0].outerHTML;var n=jQuery(".tb-cards-destination-option-playlist-row:last")[0].outerHTML;var a=jQuery(".tb-cards-destination-option-collaborator-row")[0].outerHTML;jQuery.each(e,function(e,s){var l=false;if(s.id==t.selectedVideo.id)l=true;if(s.snippet.resourceId!=null)if(s.snippet.resourceId.videoId==t.selectedVideo.id)l=true;if(s.id.videoId!=null){s.id=s.id.videoId}if(!l){if(s.snippet.resourceId!=null)s.id=s.snippet.resourceId.videoId;if(s.snippet!=null&&s.snippet.title=="Deleted video"&&s.snippet.thumbnails==null)return;t.videos.push(s);var d=i;var u=s.snippet.thumbnails.thumbnailMedium?s.snippet.thumbnails.thumbnailMedium:s.snippet.thumbnails.thumbnailDefault;d=d.replace("#VIDEOTITLE#",s.snippet.title);d=TBUtilities.ReplaceAll(d,"#VIDEOID#",s.id);d=d.replace("#VIDEOTHUMBNAIL#",u);if(s.status)d=d.replace("#PRIVACY#",s.status.privacy);if(t.isDeleteOnly){d=TBUtilities.ReplaceAll(d,"#CUSTOMDISPLAY#","display:none;");jQuery("#tb-cards-expandcollapse-containers").hide()}else{d=TBUtilities.ReplaceAll(d,"#CUSTOMDISPLAY#","");jQuery("#tb-cards-expandcollapse-containers").show()}var c="";jQuery.each(t.selectedCards,function(e,t){var i=null;switch(t.type){case"merch":{i=o;i=i.replace("#TITLE#",t.merchInfoCard.title);i=i.replace("#CALL#",t.customMessage);i=i.replace("#LINK#",t.merchInfoCard.targetUrl);i=i.replace("#VIDEOID#",s.id);i=i.replace("#TEASER#",t.teaserText);i=i.replace("#DATA-CARD-DEFAULT-ID#",t.infoCardId);break}case"fund":{i=o;i=i.replace("#TITLE#",t.fundraisingInfoCard.title);i=i.replace("#CALL#",t.customMessage);i=i.replace("#LINK#",t.fundraisingInfoCard.targetUrl);i=i.replace("#VIDEOID#",s.id);i=i.replace("#TEASER#",t.teaserText);i=i.replace("#DATA-CARD-DEFAULT-ID#",t.infoCardId);break}case"product":{i=o;i=i.replace("#TITLE#",t.productInfoCard.title);i=i.replace("#CALL#",t.customMessage);i=i.replace("#LINK#",t.productInfoCard.targetUrl);i=i.replace("#VIDEOID#",s.id);i=i.replace("#TEASER#",t.teaserText);i=i.replace("#DATA-CARD-DEFAULT-ID#",t.infoCardId);break}case"associated":{i=o;i=i.replace("#TITLE#",t.associatedWebsiteInfoCard.title);i=i.replace("#CALL#",t.customMessage);i=i.replace("#LINK#",t.associatedWebsiteInfoCard.targetUrl);i=i.replace("#VIDEOID#",s.id);i=i.replace("#TEASER#",t.teaserText);i=i.replace("#DATA-CARD-DEFAULT-ID#",t.infoCardId);break}case"video":{i=r;i=i.replace("#LINK#",t.videoInfoCard.videoId);i=i.replace("#VIDEOID#",s.id);i=i.replace("#DATA-CARD-DEFAULT-ID#",t.infoCardId);i=i.replace("#CALL#",t.customMessage);i=i.replace("#TEASER#",t.teaserText);break}case"playlist":{i=n;i=i.replace("#LINK#",t.playlistInfoCard.fullPlaylistId);i=i.replace("#VIDEOID#",s.id);i=i.replace("#DATA-CARD-DEFAULT-ID#",t.infoCardId);i=i.replace("#CALL#",t.customMessage);i=i.replace("#TEASER#",t.teaserText);break}case"collaborator":{i=a;i=i.replace("#TITLE#",t.title);i=i.replace("#CHANNELURL#",t.collaboratorInfoCard.channelId);i=i.replace("#CALL#",t.customMessage);i=i.replace("#TEASER#",t.teaserText);i=i.replace("#VIDEOID#",s.id);i=i.replace("#DATA-CARD-DEFAULT-ID#",t.infoCardId);break}}c+=i});d=d.replace("#OPTIONS#",c);jQuery("#tb-cards-destination-list").append(DOMPurify.sanitize(d,DOMPurifyConfig));jQuery("#tb-cards-destination-total-count").text(t.videos.length)}});if(t.method==0||t.method==1)jQuery("#tb-cards-select-all-checkboxes").trigger("click");jQuery("#tb-cards-destination").show();jQuery("#tb-cards-method").hide();jQuery("#tb-cards-destination-list").show();jQuery("#tb-cards-loading-videos").hide()}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyCardsStudio] [gotVideoList]"})}};var T=function(){try{jQuery("#tb-cards-back-bulk").hide();jQuery("#tb-cards-fetching").show();if(t.fromBulkSelectMenu==true){jQuery("#tb-cards-back-bulk").show()}jQuery("#tb-cards-error-copy-container").hide();jQuery("#tb-cards-error-copy-container").attr("data-clipboard-text","");var e=new ClipboardJS("#tb-cards-error-copy-container");jQuery("#tb-cards-error-list2-count").text("0");jQuery("#tb-cards-selected-count").text("0");jQuery("#tb-cards-total-count").text("0");jQuery("#tb-cards-destination-selected-count").text("0");jQuery("#tb-cards-header-image").attr("src",t.selectedVideo.thumbnail);jQuery("#tb-cards-featured-thumbnail").attr("src",t.selectedVideo.thumbnail);jQuery("#tb-cards-method").hide();jQuery(".tb-cards-filter").val("all");jQuery("#tb-cards-completed-list2-count").text("0");jQuery("#tb-cards-skip-existing").prop("checked",false);if(t.isDeleteOnly){jQuery("#tb-cards-thumbnail").hide();jQuery("#tb-cards-title").hide();jQuery("#tb-cards-help-link").attr("href",TBGlobal.host+"/tools?tool=bulkdeletecards");jQuery("#tb-cards-title-block").text("Bulk Delete Cards - Step 1");jQuery("#tb-cards-back-bulk").hide();jQuery("#tb-cards-stop").text("Stop Deleting");jQuery(".tb-module-embed-video").hide()}else{jQuery(".tb-module-embed-video").show();jQuery("#tb-cards-thumbnail").attr("src",t.selectedVideo.thumbnail);jQuery("#tb-cards-title").text(t.selectedVideo.title);jQuery("#tb-cards-title").attr("href","https://www.youtube.com/watch?v="+t.selectedVideo.id);jQuery("#tb-cards-thumbnail").show();jQuery("#tb-cards-title").show();jQuery("#tb-cards-help-link").attr("href",TBGlobal.host+"/tools?tool=bulkcopycards");if(t.fromBulkSelectMenu==true){jQuery("#tb-cards-title-block").text("Bulk Copy Cards - Step 2")}else{jQuery("#tb-cards-title-block").text("Bulk Copy Cards - Step 1")}jQuery("#tb-cards-stop").text("Stop Copying")}jQuery("#tb-cards-status").hide();jQuery("#tb-cards-confirm").hide();jQuery("#tb-cards-bulk-description-updates-container").hide();jQuery("#tb-cards-featured-content-container").hide();jQuery("#tb-cards-kickoff").hide();jQuery("#tb-cards-summary-container").hide();jQuery("#tb-cards-featured-video-status-complete").hide();jQuery("#tb-cards-featured-video-status-processing").hide();jQuery("#tb-cards-bulk-descriptions-status-complete").hide();jQuery("#tb-cards-bulk-descriptions-status-processing").hide();jQuery("#tb-cards-success").hide();jQuery("#tb-cards-back").hide();jQuery("#tb-cards-container").fadeIn();jQuery("#tb-cards-methods-container").fadeIn();jQuery("#tb-cards-none").hide();jQuery("#tb-cards-has").hide();jQuery("#tb-cards-stop").hide();jQuery("#tb-cards-done-close").hide();jQuery("#tb-cards-destination").hide();jQuery("#tb-cards-source").show();jQuery("#tb-cards-input-ids").val("");jQuery("#tb-cards-input-ids-status").text("");jQuery("#tb-cards-method-full").prop("checked","checked");jQuery("#tb-cards-onlyLoadFirstPage-number").prop("disabled",true);jQuery("#tb-cards-onlyLoadFirstPage").prop("checked",false);var i=jQuery("#tb-cards-input-playlist").playlistSelect({tbMaterial:true,singleSelectMode:true,onSelect:function(e){t.playlistId=e}}).data("plugin_playlistSelect");jQuery(".tb-playlist-select-manual-id-invalid").hide();jQuery("#tb-cards-input-playlist").find(".tb-material-input").addClass("tb-bulk-input");jQuery("#tb-cards-input-playlist").find(".tb-material-radio-label").addClass("tb-bulk-radio-label");i.disable();if(!t.isDeleteOnly){jQuery("#tb-cards-continue").attr("disabled","disabled");jQuery("#tb-cards-step-2-title").text("Which videos do you want to copy the selected Card(s) to?");jQuery("#tb-cards-what-videos2").text("Which videos do you want to copy the selected Card(s) to?");jQuery("#tb-cards-additional-options-containers").show();jQuery("#tb-cards-delete-existing").prop("checked",false);jQuery("#tb-cards-header-image").hide();jQuery("#tb-cards-confirm-statement").show();jQuery("#tb-cards-confirm-text").text("copying");jQuery("#tb-cards-kickoff").text("Start Copying!");jQuery("#tb-cards-delete-existing-warning").html("<b>WARNING:</b> You have chosen to automatically delete all existing cards from the destination videos before copying new cards to them.");jQuery("#tb-delete-options").hide();jQuery("#tb-cards-source").show();jQuery(".tb-bulk-expand").show()}else{jQuery("#tb-cards-step-2-title").text("Which videos do you want to delete Cards from?");jQuery("#tb-cards-what-videos2").text("Which videos do you want to delete Cards from?");jQuery("#tb-cards-additional-options-containers").hide();jQuery("#tb-cards-delete-existing").prop("checked",true);jQuery("#tb-cards-header-image").hide();jQuery("#tb-cards-confirm-statement").hide();jQuery("#tb-cards-confirm-text").text("delete");jQuery("#tb-cards-kickoff").text("Start Deleting!");jQuery("#tb-cards-continue").show();jQuery("#tb-cards-continue").removeAttr("disabled");jQuery("#tb-delete-options").show();jQuery("#tb-cards-source").hide();jQuery(".tb-bulk-expand").hide()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[CardsPrompt] prepareDialog"})}};var w=function(){try{t.cards=[];t.selectedCards=[];t.videos=[];t.destinationVideos=[];t.currentVideo=null;t.duration=null;t.totalVideoMiliseconds=null;t.isStopped=false;t.videosWithDeletedCards=[];t.specificVideoIds.length=0;t.specificVideos.length=0;t.method=3;t.imageConversionDic={};TBGlobal.AddUserDebugInfo(JSON.stringify(TBGlobal.Profile()));r();T()}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyCardsStudio] show"})}};var k=function(){try{t.cards=[];t.selectedCards=[];t.videos=[];t.destinationVideos=[];t.currentVideo=null;t.duration=null;t.totalVideoMiliseconds=null;t.isStopped=false;t.videosWithDeletedCards=[];t.specificVideoIds.length=0;t.specificVideos.length=0;t.method=3;r();T();jQuery("#tb-cards-back").hide()}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyCardsStudio] showDelete"})}};return{Show:function(i,r,n,a){TBGlobal.ClearUserDebugInfo();TBGlobal.AddUserDebugInfo("TubeBuddyCardsStudio - Opening Cards");if(TBGlobal.IsAuthenticated()){t.isDeleteOnly=false;t.selectedVideo.id=i;t.selectedVideo.title=r;t.selectedVideo.thumbnail=n;t.step=1;t.fromBulkSelectMenu=a;if(!e){o();l();e=true}else{w()}}},ShowDelete:function(){TBGlobal.ClearUserDebugInfo();TBGlobal.AddUserDebugInfo("TubeBuddyCardsStudio - Opening Cards - Delete Mode");if(TBGlobal.IsAuthenticated()){t.selectedVideo.id="";t.selectedVideo.title="";t.selectedVideo.thumbnail="";t.step=1;t.isDeleteOnly=true;if(!e){o();l();e=true}else{k()}}}}}();var TubeBuddyFindAndReplace=function(){var e=false;var t={ids:0,playlist:1,search:2,all:3,recent:4};var i={replace:1,appendAfter:2,appendBefore:3,remove:4,find:5,appendDescription:6,prependDescription:7,replaceDescription:8,trimDescription:9};var o={findText:"",replaceWith:"",replaceTitles:true,replaceDescriptions:true,findCount:0,channelVideoCount:0,actionType:i.replace,removeLineBreaks:false,removeBlankLines:false,method:t.all,specificVideoIds:[],specificVideos:[],playlistId:"",validPlaylistIds:[],search:"",videoEntity:null,videos:[],destinationVideos:[],currentVideo:null,isStopped:false,failedVideos:[],caseSensitive:false,matchWholeWord:true,affectsAllVideos:false};var r=function(){try{}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyFindAndReplace] [loadData]"})}};var n=function(e){if(e.totalCount-e.loaded>50){jQuery("#tb-findandreplace-loading-count").attr("data-auto-count",e.loaded);var t=e.totalCount;if(jQuery("#tb-findandreplace-onlyLoadFirstPage").is(":checked")){t=parseInt(jQuery("#tb-findandreplace-onlyLoadFirstPage-number").val())}jQuery("#tb-findandreplace-loading-count-total").text(t);TBUtilities.AutoIncrementCount(jQuery("#tb-findandreplace-loading-count"))}else{jQuery("#tb-findandreplace-rendering").show();jQuery("#tb-findandreplace-loading-count-container").hide()}};var a=function(){var e=TBGlobal.host+"/ModuleManager/findandreplace/findandreplace?v="+TBGlobal.versionNumber;if(loadLocalHTML&&(TBExtension.GetType()=="chrome"||TBExtension.GetType()=="firefox")){e=chrome.extension.getURL("modules/findandreplace.html")}else if(loadLocalHTML&&TBExtension.GetType()=="safari"){e="modules/findandreplace.html"}TBExtension.Get(e,"CRTBLoadFindAndReplaceTemplate")};var s=function(e){o.videoEntity=e;o.duration=new timelord(e.contentDetails.duration);o.totalVideoMiliseconds=o.duration.ticks()};var l=function(){jQuery(document).on("click","#tb-findandreplace-error-copy-container",function(){jQuery(this).attr("src","https://www.tubebuddy.com/images/icons/check.png");window.setTimeout(function(){jQuery("#tb-findandreplace-error-copy").attr("src","https://www.tubebuddy.com/images/icons/copy.png")},1500)});jQuery(document).on("click","#tb-findandreplace-onlyLoadFirstPage",function(e){if(jQuery(this).is(":checked")){jQuery("#tb-findandreplace-onlyLoadFirstPage-number").prop("disabled",false)}else{jQuery("#tb-findandreplace-onlyLoadFirstPage-number").prop("disabled",true)}});jQuery(document).on("click",".tb-findandreplace-default-setting",function(e){e.stopPropagation()});jQuery(document).on("click","#tb-findandreplace-done-close, #tb-findandreplace-cancel, .tb-findandreplace-closex",function(){try{TubeBuddyMenu.HideBackground();jQuery("#tb-findandreplace-container").hide();o.step=1}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyFindAndReplace] [click] tb-findandreplace-close"})}});jQuery(document).on("click","#tb-findandreplace-method-ids, #tb-findandreplace-method-playlist, #tb-findandreplace-method-search, #tb-findandreplace-method-full",function(e){o.method=parseInt(jQuery(this).attr("data-method"));var t=jQuery("#tb-findandreplace-input-playlist").playlistSelect({tbMaterial:true,singleSelectMode:true,onSelect:function(e){o.playlistId=e}}).data("plugin_playlistSelect");switch(o.method){case 0:jQuery("#tb-findandreplace-input-ids").removeAttr("disabled","disabled");jQuery("#tb-findandreplace-input-playlist").attr("disabled","disabled");jQuery("#tb-findandreplace-input-search").attr("disabled","disabled");t.disable();break;case 1:jQuery("#tb-findandreplace-input-ids").attr("disabled","disabled");jQuery("#tb-findandreplace-input-playlist").removeAttr("disabled","disabled");jQuery("#tb-findandreplace-input-search").attr("disabled","disabled");t.enable();t.showDropDown();break;case 2:jQuery("#tb-findandreplace-input-ids").attr("disabled","disabled");jQuery("#tb-findandreplace-input-playlist").attr("disabled","disabled");jQuery("#tb-findandreplace-input-search").removeAttr("disabled","disabled");t.disable();break;case 3:jQuery("#tb-findandreplace-input-ids").attr("disabled","disabled");jQuery("#tb-findandreplace-input-playlist").attr("disabled","disabled");jQuery("#tb-findandreplace-input-search").attr("disabled","disabled");t.disable();break}});jQuery(document).on("change keypress keyup paste keydown blur","#tb-findandreplace-input-playlist",function(e){o.playlistId="";var t=jQuery(this).val().trim();t=TBUtilities.ReplaceAll(t,'"',"");if(t.length==0){jQuery("#tb-findandreplace-input-playlist-status").hide();return}if(t.indexOf("list=")>0){t=t.substring(t.indexOf("list=")+5)}if(t.length!=18&&t.length!=34||t.substring(0,2)!="PL"){jQuery("#tb-findandreplace-input-playlist-status").text("Invalid Playlist Id");jQuery("#tb-findandreplace-input-playlist-status").css("color","red")}else{jQuery("#tb-findandreplace-input-playlist-status").text("Valid Playlist Id");jQuery("#tb-findandreplace-input-playlist-status").css("color","green");o.playlistId=t}jQuery("#tb-findandreplace-input-playlist-status").show()});jQuery(document).on("change keypress keyup paste keydown blur","#tb-findandreplace-input-search",function(e){o.search=jQuery(this).val().trim()});jQuery(document).on("change keypress keyup paste keydown blur","#tb-findandreplace-input-ids",function(e){var t=jQuery(this).val().trim();t=TBUtilities.ReplaceAll(t,'"',"");if(t.length==0){jQuery("#tb-findandreplace-input-ids-status").hide();return}jQuery("#tb-findandreplace-input-ids-status").show();o.specificVideoIds=[];if(t.indexOf(",")>-1){o.specificVideoIds=t.split(",")}else{o.specificVideoIds=t.split(" ")}for(var i=0;i<o.specificVideoIds.length;i++){o.specificVideoIds[i]=o.specificVideoIds[i].trim();o.specificVideoIds[i]=o.specificVideoIds[i].replace("https://www.youtube.com/watch?v=","");o.specificVideoIds[i]=o.specificVideoIds[i].replace("https://youtu.be/","");if(o.specificVideoIds[i].length!=11){o.specificVideoIds.splice(i,1);i--}}if(o.specificVideoIds.length==0){jQuery("#tb-findandreplace-input-ids-status").text("No videos detected");jQuery("#tb-findandreplace-input-ids-status").css("color","red")}else if(o.specificVideoIds.length==1){jQuery("#tb-findandreplace-input-ids-status").text("1 video detected");jQuery("#tb-findandreplace-input-ids-status").css("color","green");jQuery("#tb-findandreplace-method-ids").prop("checked",true);jQuery("#tb-findandreplace-method-ids").trigger("click")}else{jQuery("#tb-findandreplace-input-ids-status").text(o.specificVideoIds.length+" videos detected");jQuery("#tb-findandreplace-input-ids-status").css("color","green");jQuery("#tb-findandreplace-method-ids").prop("checked",true);jQuery("#tb-findandreplace-method-ids").trigger("click")}});jQuery(document).on("click",".tb-findandreplace-checkbox-include",function(){try{if(jQuery(this).is(":checked")){if(!TBGlobal.CanAccessLevel2Tools()&&jQuery("#tb-findandreplace-destination-list").find(".tb-findandreplace-checkbox-include:checked").length>1){jQuery(this).prop("checked",false);TBGlobal.ShowUpgradePage("find/replace/append/delete in bulk (more than 1 video at a time)","bulkfindreplaceappend");return}jQuery(this).closest(".tb-findandreplace-destination-row").addClass("tb-findandreplace-destination-row-selected")}else{jQuery(this).closest(".tb-findandreplace-destination-row").removeClass("tb-findandreplace-destination-row-selected")}jQuery("#tb-findandreplace-destination-selected-count").text(jQuery("#tb-findandreplace-destination-list").find(".tb-findandreplace-checkbox-include").filter(":visible").filter(":checked").length)}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyFindAndReplace] [click] tb-findandreplace-checkbox-include"})}});jQuery(document).on("click","#tb-findandreplace-select-all-checkboxes",function(){if(!TBGlobal.CanAccessLevel2Tools()&&o.findCount>1){TBGlobal.ShowUpgradePage("find/replace/append/delete in bulk (more than 1 video at a time)","bulkfindreplaceappend");return}jQuery(".tb-findandreplace-checkbox-include:visible").prop("checked",false);jQuery(".tb-findandreplace-checkbox-include:visible").trigger("click")});jQuery(document).on("click",".tb-findandreplace-more-info",function(){TBGlobal.ShowUpgradePage("find/replace/append/delete in bulk (more than 1 video at a time)","bulkfindreplaceappend")});jQuery(document).on("click","#tb-findandreplace-select-no-checkboxes",function(){jQuery(".tb-findandreplace-checkbox-include:visible").prop("checked",true);jQuery(".tb-findandreplace-checkbox-include:visible").trigger("click")});jQuery(document).on("click",".tb-findandreplace-search",function(){var e=jQuery(this).attr("data-video-id");var t=TBUtilities.GetInArray(o.videos,"id",e);var r=t.snippet.description;if(o.actionType!=i.trimDescription)r=TBUtilities.ReplaceAll(r,o.findText,'<span style="background-color:#ffff66;">'+o.findText+"</span>",!o.caseSensitive,o.matchWholeWord);r=TBUtilities.ReplaceAll(r,"\n","<br />");var n=jQuery(this).closest(".tb-findandreplace-destination-row").find(".tb-findandreplace-preview-description:first");var a=jQuery(this).closest(".tb-findandreplace-destination-row").find(".tb-findandreplace-preview-title:first");var s=jQuery(this).closest(".tb-findandreplace-destination-row").find(".tb-findandreplace-preview-tags:first");var l=jQuery(this).closest(".tb-findandreplace-destination-row").find(".tb-findandreplace-preview-options:first");if(n.is(":visible")||a.is(":visible")){n.slideUp();a.slideUp();s.slideUp();l.slideUp();return}if(o.actionType!=i.find)l.slideDown();if(o.replaceDescriptions)n.slideDown();n.find(".tb-findandreplace-preview-description-text").html(DOMPurify.sanitize(r,DOMPurifyConfig));var d=t.snippet.title;d=TBUtilities.ReplaceAll(d,"\n","<br />");d=TBUtilities.ReplaceAll(d,o.findText,'<span style="background-color:#ffff66;">'+o.findText+"</span>",!o.caseSensitive,o.matchWholeWord);if(o.replaceTitles)a.slideDown();a.find(".tb-findandreplace-preview-title-text").html(DOMPurify.sanitize(d,DOMPurifyConfig));var u=t.snippet.tags;u=TBUtilities.ReplaceAll(u,"\n","<br />");u=TBUtilities.ReplaceAll(u,o.findText,'<span style="background-color:#ffff66;">'+o.findText+"</span>",!o.caseSensitive,o.matchWholeWord);s.slideDown();s.find(".tb-findandreplace-preview-tags-text").html(DOMPurify.sanitize(u,DOMPurifyConfig))});jQuery(document).on("click","#tb-findandreplace-stop",function(){o.isStopped=true;jQuery("#tb-findandreplace-stop").hide();jQuery("#tb-findandreplace-close").show();jQuery("#tb-findandreplace-working").hide();jQuery("#tb-findandreplace-stopped").show()});jQuery(document).on("click",".tb-findandreplace-preview-before",function(){var e=jQuery(this).attr("data-video-id");var t=TBUtilities.GetInArray(o.videos,"id",e);var r=t.snippet.description;if(o.actionType!=i.trimDescription)r=TBUtilities.ReplaceAll(r,o.findText,'<span style="background-color:#ffff66;">'+o.findText+"</span>",!o.caseSensitive,o.matchWholeWord);r=TBUtilities.ReplaceAll(r,"\n","<br />");var n=jQuery(this).closest(".tb-findandreplace-destination-row").find(".tb-findandreplace-preview-description:first");var a=jQuery(this).closest(".tb-findandreplace-destination-row").find(".tb-findandreplace-preview-title:first");n.find(".tb-findandreplace-preview-description-text").html(DOMPurify.sanitize(r,DOMPurifyConfig));n.find(".tb-findandreplace-preview-box-header").removeClass("tb-findandreplace-preview-box-header--after");n.find(".tb-findandreplace-preview-box-header").addClass("tb-findandreplace-preview-box-header--before");var s=t.snippet.title;s=TBUtilities.ReplaceAll(s,"\n","<br />");s=TBUtilities.ReplaceAll(s,o.findText,'<span style="background-color:#ffff66;">'+o.findText+"</span>",!o.caseSensitive,o.matchWholeWord);a.find(".tb-findandreplace-preview-title-text").html(DOMPurify.sanitize(s,DOMPurifyConfig));a.find(".tb-findandreplace-preview-box-header").removeClass("tb-findandreplace-preview-box-header--after");a.find(".tb-findandreplace-preview-box-header").addClass("tb-findandreplace-preview-box-header--before")});jQuery(document).on("click",".tb-findandreplace-preview-after",function(){var e=jQuery(this).attr("data-video-id");var t=TBUtilities.GetInArray(o.videos,"id",e);var r=t.snippet.description;if(o.actionType==i.trimDescription)r=jQuery.trim(r);switch(o.actionType){case i.replace:r=TBUtilities.ReplaceAll(r,o.findText,'<span style="background-color:#ffff66;">'+o.findText+"</span>",!o.caseSensitive,o.matchWholeWord);r=TBUtilities.ReplaceAll(r,o.findText,TBUtilities.ReplaceAll(o.replaceWith,"\n","<br />"),!o.caseSensitive,o.matchWholeWord);break;case i.appendAfter:r=TBUtilities.ReplaceAll(r,o.findText,o.findText+'<br /><span style="background-color:#ffff66;">'+TBUtilities.ReplaceAll(o.replaceWith,"\n","<br />")+"</span>",!o.caseSensitive,o.matchWholeWord);break;case i.appendBefore:r=TBUtilities.ReplaceAll(r,o.findText,'<span style="background-color:#ffff66;">'+TBUtilities.ReplaceAll(o.replaceWith,"\n","<br />")+"</span><br />"+o.findText,!o.caseSensitive,o.matchWholeWord);break;case i.trimDescription:break;case i.remove:if(!o.removeLineBreaks&&!o.removeBlankLines){r=TBUtilities.ReplaceAll(r,o.findText,"",!o.caseSensitive,o.matchWholeWord)}if(o.removeBlankLines){while(r.indexOf(o.findText+" ")>-1)r=TBUtilities.ReplaceAll(r,o.findText+" ",o.findText,!o.caseSensitive);r=TBUtilities.ReplaceAll(r,o.findText+"<br /><br />","",!o.caseSensitive,o.matchWholeWord);r=TBUtilities.ReplaceAll(r,o.findText+" <br /><br />","",!o.caseSensitive,o.matchWholeWord);r=TBUtilities.ReplaceAll(r,o.findText+"<br><br>","",!o.caseSensitive,o.matchWholeWord);r=TBUtilities.ReplaceAll(r,o.findText+" <br><br>","",!o.caseSensitive,o.matchWholeWord);r=TBUtilities.ReplaceAll(r,o.findText,"",!o.caseSensitive,o.matchWholeWord)}if(o.removeLineBreaks){while(r.indexOf(o.findText+" ")>-1)r=TBUtilities.ReplaceAll(r,o.findText+" ",o.findText,!o.caseSensitive);r=TBUtilities.ReplaceAll(r,o.findText+"<br />","",!o.caseSensitive,o.matchWholeWord);r=TBUtilities.ReplaceAll(r,o.findText+"<br>","",!o.caseSensitive,o.matchWholeWord);r=TBUtilities.ReplaceAll(r,o.findText,"",!o.caseSensitive,o.matchWholeWord)}break;case i.appendDescription:r=r+'<br/><span style="background-color:#ffff66;">'+TBUtilities.ReplaceAll(o.findText,"\n","<br />")+"</span>";break;case i.prependDescription:var n="";if(jQuery("#tb-findandreplace-linebreak-prepend").is(":checked"))n="<br>";r='<span style="background-color:#ffff66;">'+TBUtilities.ReplaceAll(o.findText,"\n","<br />")+"</span>"+n+r;break;case i.replaceDescription:r='<span style="background-color:#ffff66;">'+TBUtilities.ReplaceAll(o.findText,"\n","<br />")+"</span>";break}r=TBUtilities.ReplaceAll(r,"\n","<br />");var a=jQuery(this).closest(".tb-findandreplace-destination-row").find(".tb-findandreplace-preview-description:first");var s=jQuery(this).closest(".tb-findandreplace-destination-row").find(".tb-findandreplace-preview-title:first");a.find(".tb-findandreplace-preview-description-text").html(DOMPurify.sanitize(r,DOMPurifyConfig));a.find(".tb-findandreplace-preview-box-header").removeClass("tb-findandreplace-preview-box-header--before");a.find(".tb-findandreplace-preview-box-header").addClass("tb-findandreplace-preview-box-header--after");var l=t.snippet.title;l=TBUtilities.ReplaceAll(l,"\n","<br />");switch(o.actionType){case i.replace:l=TBUtilities.ReplaceAll(l,o.findText,'<span style="background-color:#ffff66;">'+o.findText+"</span>",!o.caseSensitive,o.matchWholeWord);l=TBUtilities.ReplaceAll(l,o.findText,o.replaceWith,!o.caseSensitive,o.matchWholeWord);break;case i.remove:l=TBUtilities.ReplaceAll(l,o.findText,"",!o.caseSensitive,o.matchWholeWord);break}s.find(".tb-findandreplace-preview-title-text").html(DOMPurify.sanitize(l,DOMPurifyConfig));s.find(".tb-findandreplace-preview-box-header").removeClass("tb-findandreplace-preview-box-header--before");s.find(".tb-findandreplace-preview-box-header").addClass("tb-findandreplace-preview-box-header--after")});jQuery(document).on("click","#tb-findandreplace-kickoff",function(){if(!jQuery("#tb-findandreplace-confirm-checkbox").is(":checked")){TBUtilities.Alert("Please check the box confirming that you want to run these bulk actions.");return}const e=TBGlobal.GetToolById("bulkfindreplaceappend").name;TBUtilities.ReportProductEvent("Feature Applied",{Tool:e,Action:`Find and Replace/Append applying to video`});o.step=4;jQuery("#tb-findandreplace-status").show();jQuery("#tb-findandreplace-confirm").hide();jQuery("#tb-findandreplace-stop").show();jQuery("#tb-findandreplace-cancel").hide();jQuery("#tb-findandreplace-back").hide();jQuery("#tb-findandreplace-kickoff").hide();jQuery("#tb-findandreplace-continue").hide();try{switch(o.actionType){case i.find:TBUtilities.AddAction({VideoCount:o.destinationVideos.length,FindDescriptionSelected:o.replaceDescriptions,FindTitleSelected:o.replaceTitles},TBUtilities.ActionTypes.BulkFindReplaceAppent_Find,"bulkfindreplaceappend");break;case i.replace:TBUtilities.AddAction({VideoCount:o.destinationVideos.length,FindDescriptionSelected:o.replaceDescriptions,FindTitleSelected:o.replaceTitles},TBUtilities.ActionTypes.BulkFindReplaceAppend_FindAndUpdate,"bulkfindreplaceappend");break;case i.appendAfter:TBUtilities.AddAction({VideoCount:o.destinationVideos.length,FindDescriptionSelected:o.replaceDescriptions,FindTitleSelected:o.replaceTitles},TBUtilities.ActionTypes.BulkFindReplaceAppend_FindAndUpdate,"bulkfindreplaceappend");break;case i.appendBefore:TBUtilities.AddAction({VideoCount:o.destinationVideos.length,FindDescriptionSelected:o.replaceDescriptions,FindTitleSelected:o.replaceTitles},TBUtilities.ActionTypes.BulkFindReplaceAppend_FindAndUpdate,"bulkfindreplaceappend");break;case i.remove:TBUtilities.AddAction({VideoCount:o.destinationVideos.length,FindDescriptionSelected:o.replaceDescriptions,FindTitleSelected:o.replaceTitles},TBUtilities.ActionTypes.BulkFindReplaceAppend_FindAndUpdate,"bulkfindreplaceappend");break;case i.appendDescription:TBUtilities.AddAction({VideoCount:o.destinationVideos.length,FindDescriptionSelected:o.replaceDescriptions,FindTitleSelected:o.replaceTitles},TBUtilities.ActionTypes.BulkFindReplaceAppend_FindAndUpdate,"bulkfindreplaceappend");break;case i.prependDescription:TBUtilities.AddAction({VideoCount:o.destinationVideos.length,FindDescriptionSelected:o.replaceDescriptions,FindTitleSelected:o.replaceTitles},TBUtilities.ActionTypes.BulkFindReplaceAppend_FindAndUpdate,"bulkfindreplaceappend");break;case i.replaceDescription:TBUtilities.AddAction({VideoCount:o.destinationVideos.length,FindDescriptionSelected:o.replaceDescriptions,FindTitleSelected:o.replaceTitles},TBUtilities.ActionTypes.BulkFindReplaceAppend_FindAndUpdate,"bulkfindreplaceappend");break;case i.trimDescription:TBUtilities.AddAction({VideoCount:o.destinationVideos.length,FindDescriptionSelected:o.replaceDescriptions,FindTitleSelected:o.replaceTitles},TBUtilities.ActionTypes.BulkFindReplaceAppend_FindAndUpdate,"bulkfindreplaceappend");break}}catch(e){TBUtilities.LogError({Exception:e,Location:"[FindReplace] [addAction]"})}p()});jQuery(document).on("change",".tb-findandreplace-filter",function(){jQuery(".tb-findandreplace-destination-row").show();switch(jQuery(this).val()){case"all":break;case"public":jQuery('.tb-findandreplace-destination-row[data-privacy="private"]').hide();jQuery('.tb-findandreplace-destination-row[data-privacy="unlisted"]').hide();break;case"unlisted":jQuery('.tb-findandreplace-destination-row[data-privacy="public"]').hide();jQuery('.tb-findandreplace-destination-row[data-privacy="private"]').hide();break;case"private":jQuery('.tb-findandreplace-destination-row[data-privacy="public"]').hide();jQuery('.tb-findandreplace-destination-row[data-privacy="unlisted"]').hide();break;case"publicunlisted":jQuery('.tb-findandreplace-destination-row[data-privacy="private"]').hide();break;case"privateunlisted":jQuery('.tb-findandreplace-destination-row[data-privacy="public"]').hide();break}jQuery("#tb-findandreplace-destination-selected-count").text(jQuery("#tb-findandreplace-destination-list").find(".tb-findandreplace-checkbox-include").filter(":visible").filter(":checked").length)});jQuery(document).on("change","#tb-findandreplace-action-type",function(){var e=jQuery(this).val();jQuery(".tb-findandreplace-example").hide();jQuery(".tb-findandreplace-find-text").text("Find Text:");jQuery("#tb-findandreplace-options-container").css("display","flex");jQuery("#tb-findandreplace-example-container").css("display","inline");jQuery(".tb-findandreplace-find-text").css("top","-22px");jQuery("#tb-findandreplace-linebreak-prepend-box").hide();o.affectsAllVideos=false;switch(e){case"1":jQuery("#tb-findandreplace-find-container").show();jQuery("#tb-findandreplace-search-in-descriptions").show();jQuery("#tb-findandreplace-search-in-titles").show();jQuery("#tb-findandreplace-descriptions").removeAttr("disabled");jQuery("#tb-findandreplace-replace").show();jQuery("#tb-findandreplace-linebreak-box").hide();jQuery(".tb-findandreplace-action-type-text").text("Replace Text:");jQuery("#tb-findandreplace-example-input-container-replace").show();jQuery("#tb-findandreplace-example-input-container-find").show();jQuery(".tb-findandreplace-example-container").show();jQuery("#tb-findandreplace-action-type-text-container").show();jQuery("#tb-findandreplace-example-replace-before").show();jQuery("#tb-findandreplace-example-replace-after").show();jQuery("#tb-findandreplace-sample-replace-text").val("iTunes: http://smarturl.it/mjiT");jQuery("#tb-findandreplace-find").attr("rows","2");o.actionType=i.replace;break;case"2":jQuery("#tb-findandreplace-find-container").show();jQuery("#tb-findandreplace-search-in-descriptions").show();jQuery("#tb-findandreplace-descriptions").prop("checked",true);jQuery("#tb-findandreplace-descriptions").attr("disabled","disabled");jQuery("#tb-findandreplace-search-in-titles").hide();jQuery("#tb-findandreplace-replace").show();jQuery("#tb-findandreplace-linebreak-box").hide();jQuery(".tb-findandreplace-action-type-text").text("Append Text:");jQuery("#tb-findandreplace-example-input-container-replace").show();jQuery("#tb-findandreplace-example-input-container-find").show();jQuery(".tb-findandreplace-example-container").show();jQuery("#tb-findandreplace-action-type-text-container").show();jQuery("#tb-findandreplace-example-append-before").show();jQuery("#tb-findandreplace-example-append-after").show();jQuery("#tb-findandreplace-sample-replace-text").val("iTunes: http://smarturl.it/mjiT");jQuery("#tb-findandreplace-find").attr("rows","2");o.actionType=i.appendAfter;break;case"3":jQuery("#tb-findandreplace-find-container").show();jQuery("#tb-findandreplace-search-in-descriptions").show();jQuery("#tb-findandreplace-descriptions").prop("checked",true);jQuery("#tb-findandreplace-descriptions").attr("disabled","disabled");jQuery("#tb-findandreplace-search-in-titles").hide();jQuery("#tb-findandreplace-replace").show();jQuery("#tb-findandreplace-linebreak-box").hide();jQuery(".tb-findandreplace-action-type-text").text("Prepend Text:");jQuery("#tb-findandreplace-example-input-container-replace").show();jQuery("#tb-findandreplace-example-input-container-find").show();jQuery(".tb-findandreplace-example-container").show();jQuery("#tb-findandreplace-action-type-text-container").show();jQuery("#tb-findandreplace-example-prepend-before").show();jQuery("#tb-findandreplace-example-prepend-after").show();jQuery("#tb-findandreplace-sample-replace-text").val("iTunes: http://smarturl.it/mjiT");jQuery("#tb-findandreplace-find").attr("rows","2");o.actionType=i.appendBefore;break;case"4":jQuery("#tb-findandreplace-find-container").show();jQuery("#tb-findandreplace-search-in-descriptions").show();jQuery("#tb-findandreplace-search-in-titles").show();jQuery("#tb-findandreplace-descriptions").removeAttr("disabled");jQuery("#tb-findandreplace-replace").hide();jQuery("#tb-findandreplace-linebreak-box").show();jQuery(".tb-findandreplace-find-text").text("Remove Text:");jQuery(".tb-findandreplace-action-type-text").text("");jQuery("#tb-findandreplace-example-input-container-replace").hide();jQuery("#tb-findandreplace-example-input-container-find").show();jQuery(".tb-findandreplace-example-container").show();jQuery("#tb-findandreplace-action-type-text-container").hide();if(jQuery("#tb-findandreplace-linebreak").is(":checked")){jQuery("#tb-findandreplace-example-removeline-before").show();jQuery("#tb-findandreplace-example-removeline-after").show();jQuery("#tb-findandreplace-example-remove-before").hide();jQuery("#tb-findandreplace-example-remove-after").hide()}else{jQuery("#tb-findandreplace-example-remove-before").show();jQuery("#tb-findandreplace-example-remove-after").show();jQuery("#tb-findandreplace-example-removeline-before").hide();jQuery("#tb-findandreplace-example-removeline-after").hide()}jQuery("#tb-findandreplace-sample-replace-text").val("");jQuery("#tb-findandreplace-find").attr("rows","2");o.actionType=i.remove;break;case"5":jQuery("#tb-findandreplace-find-container").show();jQuery("#tb-findandreplace-search-in-descriptions").show();jQuery("#tb-findandreplace-search-in-titles").show();jQuery("#tb-findandreplace-descriptions").removeAttr("disabled");jQuery("#tb-findandreplace-replace").hide();jQuery("#tb-findandreplace-linebreak-box").hide();jQuery(".tb-findandreplace-action-type-text").text("");jQuery("#tb-findandreplace-example-input-container-replace").hide();jQuery("#tb-findandreplace-example-input-container-find").show();jQuery(".tb-findandreplace-example-container").show();jQuery("#tb-findandreplace-action-type-text-container").hide();jQuery("#tb-findandreplace-example-find-before").show();jQuery("#tb-findandreplace-sample-replace-text").val("");jQuery("#tb-findandreplace-find").attr("rows","5");jQuery(".tb-findandreplace-find-text").css("top","-62px");o.actionType=i.find;break;case"6":jQuery("#tb-findandreplace-find-container").show();jQuery("#tb-findandreplace-descriptions").prop("checked",true);jQuery("#tb-findandreplace-descriptions").attr("disabled","disabled");jQuery("#tb-findandreplace-search-in-titles").hide();jQuery("#tb-findandreplace-replace").hide();jQuery("#tb-findandreplace-linebreak-box").hide();jQuery(".tb-findandreplace-find-text").text("Append Text:");jQuery(".tb-findandreplace-action-type-text").text("");jQuery("#tb-findandreplace-example-input-container-replace").hide();jQuery("#tb-findandreplace-example-input-container-find").hide();jQuery(".tb-findandreplace-example-container").hide();jQuery("#tb-findandreplace-action-type-text-container").hide();jQuery("#tb-findandreplace-options-container").css("display","none");jQuery("#tb-findandreplace-example-container").css("display","none");jQuery("#tb-findandreplace-find").attr("rows","5");jQuery(".tb-findandreplace-find-text").css("top","-62px");o.affectsAllVideos=true;o.actionType=i.appendDescription;break;case"7":jQuery("#tb-findandreplace-linebreak-prepend-box").show();jQuery("#tb-findandreplace-find-container").show();jQuery("#tb-findandreplace-descriptions").prop("checked",true);jQuery("#tb-findandreplace-descriptions").attr("disabled","disabled");jQuery("#tb-findandreplace-search-in-titles").hide();jQuery("#tb-findandreplace-replace").hide();jQuery("#tb-findandreplace-linebreak-box").hide();jQuery(".tb-findandreplace-find-text").text("Prepend Text:");jQuery(".tb-findandreplace-action-type-text").text("");jQuery("#tb-findandreplace-example-input-container-replace").hide();jQuery("#tb-findandreplace-example-input-container-find").hide();jQuery(".tb-findandreplace-example-container").hide();jQuery("#tb-findandreplace-action-type-text-container").hide();jQuery("#tb-findandreplace-options-container").css("display","none");jQuery("#tb-findandreplace-example-container").css("display","none");jQuery("#tb-findandreplace-find").attr("rows","5");jQuery(".tb-findandreplace-find-text").css("top","-62px");o.affectsAllVideos=true;o.actionType=i.prependDescription;break;case"8":jQuery("#tb-findandreplace-find-container").show();jQuery("#tb-findandreplace-descriptions").prop("checked",true);jQuery("#tb-findandreplace-descriptions").attr("disabled","disabled");jQuery("#tb-findandreplace-search-in-titles").hide();jQuery("#tb-findandreplace-replace").hide();jQuery("#tb-findandreplace-linebreak-box").hide();jQuery(".tb-findandreplace-find-text").text("New Text:");jQuery(".tb-findandreplace-action-type-text").text("");jQuery("#tb-findandreplace-example-input-container-replace").hide();jQuery("#tb-findandreplace-example-input-container-find").hide();jQuery(".tb-findandreplace-example-container").hide();jQuery("#tb-findandreplace-action-type-text-container").hide();jQuery("#tb-findandreplace-options-container").css("display","none");jQuery("#tb-findandreplace-example-container").css("display","none");jQuery("#tb-findandreplace-find").attr("rows","5");jQuery(".tb-findandreplace-find-text").css("top","-62px");o.affectsAllVideos=true;o.actionType=i.replaceDescription;break;case"9":jQuery("#tb-findandreplace-find-container").hide();jQuery("#tb-findandreplace-descriptions").prop("checked",true);jQuery("#tb-findandreplace-descriptions").attr("disabled","disabled");jQuery("#tb-findandreplace-search-in-titles").hide();jQuery("#tb-findandreplace-replace").hide();jQuery("#tb-findandreplace-linebreak-box").hide();jQuery(".tb-findandreplace-find-text").text("New Text:");jQuery(".tb-findandreplace-action-type-text").text("");jQuery("#tb-findandreplace-example-input-container-replace").hide();jQuery("#tb-findandreplace-example-input-container-find").hide();jQuery(".tb-findandreplace-example-container").hide();jQuery("#tb-findandreplace-action-type-text-container").hide();jQuery("#tb-findandreplace-options-container").css("display","none");jQuery("#tb-findandreplace-example-container").css("display","none");jQuery("#tb-findandreplace-find").attr("rows","5");jQuery(".tb-findandreplace-find-text").css("top","-62px");o.affectsAllVideos=false;o.actionType=i.trimDescription;break}c()});jQuery(document).on("change click","#tb-findandreplace-linebreak",function(){if(jQuery("#tb-findandreplace-linebreak").is(":checked")){jQuery("#tb-findandreplace-example-removeline-before").show();jQuery("#tb-findandreplace-example-removeline-after").show();jQuery("#tb-findandreplace-example-remove-before").hide();jQuery("#tb-findandreplace-example-remove-after").hide()}else{jQuery("#tb-findandreplace-example-remove-before").show();jQuery("#tb-findandreplace-example-remove-after").show();jQuery("#tb-findandreplace-example-removeline-before").hide();jQuery("#tb-findandreplace-example-removeline-after").hide()}});jQuery(document).on("change keypress keyup keydown paste","#tb-findandreplace-find, #tb-findandreplace-replace",function(){o.findText=jQuery("#tb-findandreplace-find").val();o.replaceWith=jQuery("#tb-findandreplace-replace").val();if(TBUtilities.IsAlphaNumeric(o.findText.replace(/\s+/g,""))||!jQuery("#tb-findandreplace-options-container").is(":visible")){jQuery("#tb-findandreplace-specialcharacters").hide();jQuery("#tb-findandreplace-partialword").prop("disabled",false)}else{jQuery("#tb-findandreplace-specialcharacters").show();jQuery("#tb-findandreplace-partialword").prop("checked",true);jQuery("#tb-findandreplace-partialword").prop("disabled",true)}if(o.replaceWith.length>0)jQuery("#tb-findandreplace-replace").css("border","");c()});jQuery(document).on("click","#tb-findandreplace-continue, #tb-findandreplace-kickoff",function(){try{if(o.step==1){o.findText=jQuery("#tb-findandreplace-find").val();o.replaceWith=jQuery("#tb-findandreplace-replace").val();o.findText=o.findText.replace(/[\u200B-\u200D\uFEFF]/g,"");o.replaceWith=o.replaceWith.replace(/[\u200B-\u200D\uFEFF]/g,"");o.replaceTitles=jQuery("#tb-findandreplace-titles:first").is(":checked")&&jQuery("#tb-findandreplace-titles:first").is(":visible");o.replaceDescriptions=jQuery("#tb-findandreplace-descriptions:first").is(":checked")&&jQuery("#tb-findandreplace-descriptions:first").is(":visible");o.removeLineBreaks=jQuery("#tb-findandreplace-linebreak").is(":checked");o.removeBlankLines=jQuery("#tb-findandreplace-blanklines").is(":checked");if(o.findText.length==0&&o.actionType!=i.trimDescription){TBUtilities.Alert("You must enter some Text");return}if(!o.replaceTitles&&!o.replaceDescriptions){TBUtilities.Alert("You must select to search Titles and/or Descriptions");return}if(o.replaceWith==""&&(o.actionType==i.replace||o.actionType==i.appendAfter||o.actionType==i.appendBefore)){jQuery("#tb-findandreplace-replace").css("border","solid 1px red");switch(o.actionType){case i.replace:TBUtilities.Alert('Please enter replacement text.\n\n(If you are simply trying to delete the "Find Text", select "Remove" from the actions drop down.');break;case i.appendAfter:TBUtilities.Alert('Please enter text to append after "Find Text"');break;case i.appendBefore:TBUtilities.Alert('Please enter text to append before "Find Text"');break}return}if((o.replaceWith.indexOf(">")>-1||o.replaceWith.indexOf("<")>-1)&&jQuery("#tb-findandreplace-replace").is(":visible")){jQuery("#tb-findandreplace-replace").css("border","solid 1px red");TBUtilities.Alert('YouTube does not allow angle brackets in Titles or Descriptions (">" or "<")\n\nPlease remove them before continuing.');return}if((o.findText.indexOf(">")>-1||o.findText.indexOf("<")>-1)&&jQuery("#tb-findandreplace-find").is(":visible")){jQuery("#tb-findandreplace-replace").css("border","solid 1px red");TBUtilities.Alert('YouTube does not allow angle brackets in Titles or Descriptions (">" or "<")\n\nPlease remove them before continuing.');return}jQuery("#tb-findandreplace-replace").css("border","");o.caseSensitive=jQuery("#tb-findandreplace-casesensitive").is(":checked");o.matchWholeWord=!jQuery("#tb-findandreplace-partialword").is(":checked");jQuery("#tb-findandreplace-loading-videos").show();jQuery("#tb-findandreplace-destination-list").hide();jQuery("#tb-findandreplace-source").hide();jQuery("#tb-findandreplace-method").show();jQuery("#tb-findandreplace-back").show();var e=jQuery("#tb-findandreplace-input-playlist").playlistSelect({tbMaterial:true,singleSelectMode:true,onSelect:function(e){o.playlistId=e}}).data("plugin_playlistSelect");jQuery(".tb-playlist-select-manual-id-invalid").hide();jQuery("#tb-findandreplace-input-playlist").find(".tb-material-input").addClass("tb-bulk-input");jQuery("#tb-findandreplace-input-playlist").find(".tb-material-radio-label").addClass("tb-bulk-radio-label");o.method&&o.method==1?e.enable():e.disable();o.step=2}else if(o.step==2){switch(o.actionType){case i.find:jQuery("#tb-findandreplace-whatvideos-text").hide();jQuery("#tb-findandreplace-whatvideos-text2").show();jQuery("#tb-findandreplace-selected-text").hide();jQuery("#tb-findandreplace-selected-text2").hide();break;default:jQuery("#tb-findandreplace-whatvideos-text").show();jQuery("#tb-findandreplace-whatvideos-text2").hide();jQuery("#tb-findandreplace-selected-text").show();jQuery("#tb-findandreplace-selected-text2").show();break}switch(parseInt(o.method)){case 0:if(o.specificVideoIds.length==0){jQuery("#tb-findandreplace-input-ids-status").css("color","red");jQuery("#tb-findandreplace-input-ids-status").text("No videos detected");jQuery("#tb-findandreplace-input-ids-status").show();TBUtilities.Alert("You must enter a list of 1 or more valid Video IDs (or change you selection method above)");return}TBGlobal.AddUserDebugInfo("Video Selection Method: Video IDs "+JSON.stringify(o.specificVideoIds));d();break;case 1:var e=jQuery("#tb-findandreplace-input-playlist").playlistSelect({tbMaterial:true,singleSelectMode:true,onSelect:function(e){o.playlistId=e}}).data("plugin_playlistSelect");jQuery(".tb-playlist-select-manual-id-invalid").hide();var t=e.getSelectedPlaylistIds();if(!t||t.length==0){TBUtilities.Alert("You must enter a valid Playlist ID (or change you selection method above)",function(){return});return}else if(t.length>=2){TBUtilities.Alert("Please select only one playlist",function(){return});return}if(t.length==1){var r=jQuery("#tb-findandreplace-input-playlist").find(".playlistSelectTypeList").is(":checked");if(o.validPlaylistIds.indexOf(t[0])>-1||r&&t.length>0){o.playlistId=t.join(",")}else{e.showValidationWarning();TBUtilities.Alert("You must enter a valid Playlist ID (or change you selection method above)",function(){return});return}}TBGlobal.AddUserDebugInfo("Video Selection Method: Playlist ["+o.playlistId+"]");TBYouTubeApi.GetPlaylistVideos(o.playlistId,null,v,n);break;case 2:if(o.search==""){TBUtilities.Alert("You must enter a Search Term (or change you selection method above)");return}TBGlobal.AddUserDebugInfo("Video Selection Method: Search ["+o.search+"]");jQuery("#tb-findandreplace-destination").show();TBYouTubeApi.GetChannelVideosSearch(o.search,null,v,n);break;case 3:TBGlobal.AddUserDebugInfo("Video Selection Method: All");var a=null;if(jQuery("#tb-findandreplace-onlyLoadFirstPage").is(":checked")){var s=/^\+?\d+$/.test(jQuery("#tb-findandreplace-onlyLoadFirstPage-number").val());if(s==false){TBUtilities.Alert("Please enter a valid number for the number of videos to load");return}a=parseInt(jQuery("#tb-findandreplace-onlyLoadFirstPage-number").val());if(a<=0){TBUtilities.Alert("Please enter a valid number for the number of videos to load");return}}TBYouTubeApi.GetChannelVideos(TBGlobal.CurrentChannelId(),null,v,n,a,null,null);break}jQuery("#tb-findandreplace-method").hide();jQuery("#tb-findandreplace-destination").show();jQuery("#tb-findandreplace-destination-list").hide();jQuery("#tb-findandreplace-loading-videos").show();o.step=3;if(o.actionType==i.find){jQuery("#tb-findandreplace-continue").hide();jQuery("#tb-findandreplace-cancel").text("Close")}else{jQuery("#tb-findandreplace-continue").show();jQuery("#tb-findandreplace-cancel").text("Cancel")}}else if(o.step==3){if(jQuery(".tb-findandreplace-checkbox-include").filter(":visible").filter(":checked").length==0&&o.destinationVideos.length==0){TBUtilities.Alert("Please select at least 1 video to run Find and Replace on.");return}o.destinationVideos=[];jQuery(".tb-findandreplace-checkbox-include").filter(":visible").filter(":checked").each(function(){if(jQuery(this).is(":checked")){var e=jQuery(this).attr("data-video-id");jQuery.each(o.videos,function(t,i){if(i.id==e){o.destinationVideos.push(i);TBGlobal.AddUserDebugInfo("Selected Destination Video: https://www.youtube.com/watch?v="+e)}})}});var l="Please confirm that you want to";switch(o.actionType){case i.replace:l+=' find the text "<b>'+o.findText+'</b>" ';if(o.replaceTitles&&o.replaceDescriptions)l+=" in both Video Titles and Descriptions ";else if(o.replaceTitles)l+=" in Video Titles ";else l+=" in Video Descriptions ";l+=' and replace it with the text "<b>'+o.replaceWith+'</b>"';l+=" in the <b>"+o.destinationVideos.length+"</b> Video";if(o.destinationVideos.length>1)l+="s";l+=" that you selected.";break;case i.appendAfter:l+=' <br>find the text <br>"<b>'+o.findText+'</b>" ';if(o.replaceTitles&&o.replaceDescriptions)l+=" in both Video Titles and Descriptions ";else if(o.replaceTitles)l+=" in Video Titles ";else l+=" in Video Descriptions ";l+=' and add a new line after it with the text "<b>'+o.replaceWith+'"</b>"';l+=" in the <b>"+o.destinationVideos.length+"</b> Video";if(o.destinationVideos.length>1)l+="s";l+=" that you selected.";break;case i.appendBefore:l+=' find the text "<b>'+o.findText+'</b>" ';if(o.replaceTitles&&o.replaceDescriptions)l+=" in both Video Titles and Descriptions ";else if(o.replaceTitles)l+=" in Video Titles ";else l+=" in Video Descriptions ";l+=' and add a new line before it with the text "<b>'+o.replaceWith+'"</b>"';l+=" in the <b>"+o.destinationVideos.length+"</b> Video";if(o.destinationVideos.length>1)l+="s";l+=" that you selected.";break;case i.remove:l+=' find the text "<b>'+o.findText+'</b>" ';if(o.replaceTitles&&o.replaceDescriptions)l+=" in both Video Titles and Descriptions ";else if(o.replaceTitles)l+=" in Video Titles ";else l+=" in Video Descriptions ";l+=" and remove it ";if(o.removeLineBreaks)l+=" (and a line break if found immediately after)";if(o.removeBlankLines)l+=" (and a blank line if found immediately after)";l+=" in the <b>"+o.destinationVideos.length+"</b> Video";if(o.destinationVideos.length>1)l+="s";l+=" that you selected.";break;case i.appendDescription:l+=' append the text "<b>'+o.findText+'</b>" ';l+=" to the end of the Descriptions of the <b>"+o.destinationVideos.length+"</b> Video";if(o.destinationVideos.length>1)l+="s";l+=" that you selected.";break;case i.prependDescription:l+=' prepend the text "<b>'+o.findText+'</b>" ';l+=" to the beginning of the Descriptions of the <b>"+o.destinationVideos.length+"</b> Video";if(o.destinationVideos.length>1)l+="s";l+=" that you selected.";break;case i.replaceDescription:l+=' set to description to "<b>'+o.findText+'</b>" ';l+=" on the <b>"+o.destinationVideos.length+"</b> Video";if(o.destinationVideos.length>1)l+="s";l+=" that you selected.";break;case i.trimDescription:l+=" trim the descriptions (remove line breaks and spaces from beginning and end) ";l+=" on the <b>"+o.destinationVideos.length+"</b> Video";if(o.destinationVideos.length>1)l+="s";l+=" that you selected.";break}l=TBUtilities.ReplaceAll(l,"\n","<br/>");jQuery("#tb-findandreplace-confirmation-text").html(DOMPurify.sanitize(l,DOMPurifyConfig));jQuery("#tb-findandreplace-queue-list").empty();jQuery("#tb-findandreplace-completed-list").empty();jQuery("#tb-findandreplace-destination-selected-count").text(o.destinationVideos.length);jQuery("#tb-findandreplace-method").hide();jQuery("#tb-findandreplace-confirm-checkbox").prop("checked",false);o.step=4;jQuery("#tb-findandreplace-destination").hide();jQuery("#tb-findandreplace-confirm").show();jQuery("#tb-findandreplace-kickoff").show();jQuery("#tb-findandreplace-continue").hide()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyFindAndReplace] [click] #tb-findandreplace-continue, #tb-findandreplace-kickoff"})}});jQuery(document).on("click","#tb-findandreplace-back",function(){jQuery("#tb-findandreplace-continue").show();jQuery("#tb-findandreplace-cancel").text("Cancel");if(o.step==2){jQuery("#tb-findandreplace-source").show();jQuery("#tb-findandreplace-method").hide();jQuery("#tb-findandreplace-back").hide();o.step=1}else if(o.step==3){o.step=2;jQuery("#tb-findandreplace-destination").hide();jQuery("#tb-findandreplace-method").show();o.specificVideoIds.length=0;o.specificVideos.length=0;jQuery("#tb-findandreplace-input-ids").val("");jQuery("#tb-findandreplace-input-ids-status").hide();jQuery("#tb-findandreplace-destination-selected-count").text("0")}else if(o.step==4){o.step=3;jQuery("#tb-findandreplace-destination").show();jQuery("#tb-findandreplace-confirm").hide();jQuery("#tb-findandreplace-kickoff").hide();jQuery("#tb-findandreplace-continue").show()}});jQuery(document).on("click",".playlistSelectTypeManual",function(){var e=jQuery(this).parents(".playlistSelect").find(".playlistSelectMutliSelectListItem").find("input");e.each(function(e,t){o.validPlaylistIds.push(jQuery(t).val())})});jQuery(document).on("change keypress keyup paste keydown blur",".playlistSelectManualIds",function(){var e=jQuery(this).val();if(o.validPlaylistIds.indexOf(e)==-1){jQuery("#tb-playlist-select-manual-id-invalid").show()}else{jQuery("#tb-playlist-select-manual-id-invalid").hide()}});jQuery(document).on("click",".playlistSelectTypeList",function(){jQuery("#tb-playlist-select-manual-id-invalid").hide()})};var d=function(){var e=o.specificVideoIds[0];o.specificVideoIds.splice(0,1);TBYouTubeApi.GetVideoDetails(e,"contentDetails,snippet,id",u)};var u=function(e){if(e!=null)o.specificVideos.push(e);jQuery("#tb-findandreplace-progress-container").html(jQuery("#tb-findandreplace-progress-container").html()+" Got Details &rarr;");if(o.specificVideoIds.length>0){d()}else{v(o.specificVideos)}};var c=function(){var e="<b>Action:</b> ";switch(o.actionType){case i.find:if(o.findText.length>0)e+='Find the text "'+o.findText+'"';break;case i.replace:if(o.findText.length>0)e+='Find the text "'+o.findText+'" and replace it with "'+o.replaceWith+'"';break;case i.appendAfter:if(o.findText.length>0)e+='Find the text "'+o.findText+'" and append after it "'+o.replaceWith+'"';break;case i.appendBefore:if(o.findText.length>0)e+='Find the text "'+o.findText+'" and prepend before it "'+o.replaceWith+'"';break;case i.remove:if(o.findText.length>0)e+='Find the text "'+o.findText+'" and remove it';break;case i.appendDescription:if(o.findText.length>0)e+='Append to video descriptions: "'+o.findText+'"';break;case i.prependDescription:if(o.findText.length>0)e+='Prepend video descriptions with "'+o.findText+'"';break;case i.replaceDescription:if(o.findText.length>0)e+='Set video descriptions to "'+o.findText+'"';break;case i.trimDescription:e+="Trim video descriptions";break}jQuery("#tb-findandreplace-action-text").html(e);if(o.findText=="")jQuery("#tb-findandreplace-action-text").hide();else jQuery("#tb-findandreplace-action-text").show()};var p=function(){try{o.failedVideos=[];o.totalDestinationVideos=o.destinationVideos.length;o.hasFinished=false;o.errorCount=0;o.successCount=0;jQuery("#tb-findandreplace-queue-list").empty();jQuery("#tb-findandreplace-completed-list").empty();jQuery("#tb-findandreplace-queue-list2").empty();jQuery("#tb-findandreplace-completed-list2").empty();jQuery("#tb-findandreplace-error-list2").empty();jQuery("#tb-findandreplace-error-list2").hide();jQuery("#tb-findandreplace-error-none-list2").show();jQuery("#tb-findandreplace-working").show();jQuery("#tb-findandreplace-done").hide();jQuery("#tb-findandreplace-stopped").hide();TBUtilities.Log(o);h();y()}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyFindAndReplace] [startProcessing]"})}};var h=function(){try{if(o.isStopped)return;jQuery("#tb-findandreplace-progress-container").html("Start &rarr;");if(o.destinationVideos.length==0){var e="<b>"+o.totalDestinationVideos+"</b> of <b>"+o.totalDestinationVideos+"</b> videos complete";jQuery("#tb-findandreplace-status-count").html(DOMPurify.sanitize(e,DOMPurifyConfig));jQuery("#tb-findandreplace-progress-container").hide();if(o.currentVideo){if(!o.currentVideo.error)b(o.currentVideo);else f(o.currentVideo)}y();jQuery("#tb-findandreplace-working").hide();jQuery("#tb-findandreplace-done").show();jQuery("#tb-findandreplace-done-close").show();jQuery("#tb-findandreplace-stop").hide();jQuery("#tb-findandreplace-close").show();return}if(o.currentVideo){if(!o.currentVideo.error)b(o.currentVideo);else f(o.currentVideo)}var t=o.destinationVideos[0].id;var r=TBUtilities.RemoveFromArray(o.destinationVideos,"id",t)[0];o.currentVideo=r;var n="<b>"+parseInt(o.totalDestinationVideos-o.destinationVideos.length)+"</b> of <b>"+o.totalDestinationVideos+"</b> videos complete";jQuery("#tb-findandreplace-status-count").html(DOMPurify.sanitize(n,DOMPurifyConfig));var a=jQuery("#tb-findandreplace-progress-container").html()+' Id: <a style="font-weight:normal" target="_blank" href="https://www.youtube.com/watch?v='+t+'">'+t+"</a> &rarr;";jQuery("#tb-findandreplace-progress-container").html(DOMPurify.sanitize(a,DOMPurifyConfig));y();var s=o.currentVideo.snippet.title;var l=o.currentVideo.snippet.description;switch(o.actionType){case i.replace:l=TBUtilities.ReplaceAll(l,o.findText,o.replaceWith,!o.caseSensitive,o.matchWholeWord);s=TBUtilities.ReplaceAll(s,o.findText,o.replaceWith,!o.caseSensitive,o.matchWholeWord);break;case i.appendAfter:l=TBUtilities.ReplaceAll(l,o.findText,o.findText+"\n"+o.replaceWith,!o.caseSensitive,o.matchWholeWord);break;case i.appendBefore:l=TBUtilities.ReplaceAll(l,o.findText,o.replaceWith+"\n"+o.findText,!o.caseSensitive,o.matchWholeWord);break;case i.trimDescription:l=jQuery.trim(l);break;case i.remove:s=TBUtilities.ReplaceAll(s,o.findText,"",!o.caseSensitive,o.matchWholeWord);if(!o.removeLineBreaks&&!o.removeBlankLines)l=TBUtilities.ReplaceAll(l,o.findText,"",!o.caseSensitive,o.matchWholeWord);if(o.removeBlankLines){while(l.indexOf(o.findText+"  ")>-1)l=TBUtilities.ReplaceAll(l,o.findText+"  ",o.findText+" ",!o.caseSensitive);l=TBUtilities.ReplaceAll(l,o.findText+"\n\n","",!o.caseSensitive,o.matchWholeWord);l=TBUtilities.ReplaceAll(l,o.findText+" \n\n","",!o.caseSensitive,o.matchWholeWord);l=TBUtilities.ReplaceAll(l,o.findText+" ","",!o.caseSensitive,o.matchWholeWord);l=TBUtilities.ReplaceAll(l,o.findText,"",!o.caseSensitive,o.matchWholeWord)}if(o.removeLineBreaks){while(l.indexOf(o.findText+" ")>-1)l=TBUtilities.ReplaceAll(l,o.findText+" ",o.findText,!o.caseSensitive);l=TBUtilities.ReplaceAll(l,o.findText+"\n","",!o.caseSensitive,o.matchWholeWord);l=TBUtilities.ReplaceAll(l,o.findText,"",!o.caseSensitive,o.matchWholeWord)}break;case i.appendDescription:l=l+"\n"+o.findText;break;case i.prependDescription:var d="";if(jQuery("#tb-findandreplace-linebreak-prepend").is(":checked"))d="\n";l=o.findText+d+l;break;case i.replaceDescription:l=o.findText;break}var u="";var c={VideoId:o.currentVideo.id,Description:o.replaceDescriptions?l:null,Title:o.replaceTitles?s:null};u=jQuery.param(c);var p=TBGlobal.host+"/api/youtubevideos/UpdateVideoMetadata";TBExtension.Post(p,u,"CTTBFAREditVideo",null,{contentType:"application/x-www-form-urlencoded"})}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyFindAndReplace] [processNextVideo]"});jQuery("#tb-findandreplace-progress-container").html(jQuery("#tb-findandreplace-progress-container").html()+"Error: "+e.message);TBUtilities.Alert('Sorry, there was an error: "'+e.message+'"');jQuery("#tb-findandreplace-stop").trigger("click")}};var y=function(){jQuery("#tb-findandreplace-queue-list2").empty();jQuery("#tb-findandreplace-queue-complete-list2").hide();var e=0;jQuery.each(o.destinationVideos,function(t,i){var o=jQuery(".tb-findandreplace-processing-template2:last")[0].outerHTML;o=o.replace("#THUMBNAILURL#",i.snippet.thumbnails.thumbnailMedium?i.snippet.thumbnails.thumbnailMedium:i.snippet.thumbnails.default.url);o=TBUtilities.ReplaceAll(o,"#VIDEOID#",i.id);o=o.replace("#VIDEOTITLE#",i.snippet.title);o=o.replace("#HREF#","https://www.youtube.com/watch?v="+i.id);o=o.replace("display: none","display:flex");jQuery("#tb-findandreplace-queue-list2").prepend(DOMPurify.sanitize(o,DOMPurifyConfig));e++;if(e==3)return false});if(e==0){jQuery("#tb-findandreplace-queue-complete-list2").show();jQuery("#tb-findandreplace-queue-list2").hide()}else{jQuery("#tb-findandreplace-queue-list2").show()}};var b=function(e){var t=jQuery(".tb-findandreplace-processed-success:last")[0].outerHTML;t=t.replace("#THUMBNAILURL#",e.snippet.thumbnails.thumbnailMedium?e.snippet.thumbnails.thumbnailMedium:e.snippet.thumbnails.default.url);t=TBUtilities.ReplaceAll(t,"#VIDEOID#",e.id);t=t.replace("#VIDEOTITLE#",e.snippet.title);t=t.replace("#HREF#","https://studio.youtube.com/video/"+e.id+"/edit");t=t.replace("display:none","display:flex");jQuery("#tb-findandreplace-completed-list2").prepend(DOMPurify.sanitize(t,DOMPurifyConfig));jQuery("#tb-findandreplace-completed-none-list2").hide();jQuery("#tb-findandreplace-completed-list2").show();o.successCount++;jQuery("#tb-findandreplace-completed-list2-count").text(TBUtilities.FormatNumberWithCommas(o.successCount))};var f=function(e){try{jQuery("#tb-findandreplace-error-copy-container").show();var t=jQuery("#tb-findandreplace-error-copy").attr("data-clipboard-text");var i=[];if(t!=""){i=t.split(",");if(i.indexOf(e.id)==-1){i.push(e.id)}}else{i.push(e.id)}jQuery("#tb-findandreplace-error-copy").attr("data-clipboard-text",i.join(","))}catch(e){}var r=jQuery(".tb-findandreplace-processed-error:last")[0].outerHTML;r=r.replace("#THUMBNAILURL#",e.snippet.thumbnails.thumbnailMedium?e.snippet.thumbnails.thumbnailMedium:e.snippet.thumbnails.default.url);r=TBUtilities.ReplaceAll(r,"#VIDEOID#",e.id);r=r.replace("#VIDEOTITLE#",e.snippet.title);r=r.replace("#ERROR#",e.error);r=r.replace("#HREF#","https://studio.youtube.com/video/"+e.id+"/edit");r=r.replace("display:none","display:flex");jQuery("#tb-findandreplace-error-list2").prepend(DOMPurify.sanitize(r,DOMPurifyConfig));jQuery("#tb-findandreplace-error-list2").show();jQuery("#tb-findandreplace-error-none-list2").hide();o.errorCount++;jQuery("#tb-findandreplace-error-list2-count").text(TBUtilities.FormatNumberWithCommas(o.errorCount))};var m=function(e,t){o.currentVideo.error=t;h()};var v=function(e){try{if(e==null){if(o.method==0)TBUtilities.Alert("No valid Video IDs found");else if(o.method==1)TBUtilities.Alert("Invalid Playlist Id or no videos found in playlist");else if(o.method==2)TBUtilities.Alert("No videos matching your search");else if(o.method==3)TBUtilities.Alert("No videos found or failed to load. Please try again.");jQuery("#tb-findandreplace-back").trigger("click");return}else if(e.length==0){if(o.method==0)TBUtilities.Alert("No valid Video IDs found");else if(o.method==1)TBUtilities.Alert("Invalid Playlist Id or no videos found in playlist");else if(o.method==2)TBUtilities.Alert("No videos matching your search");else if(o.method==3)TBUtilities.Alert("No videos found or failed to load. Please try again.");jQuery("#tb-findandreplace-back").trigger("click");return}jQuery("#tb-findandreplace-loading-videos").hide();o.videos=[];jQuery("#tb-findandreplace-destination-list").empty();var t=[];TBUtilities.Log("status.affectsAllVideos: "+o.affectsAllVideos);TBUtilities.Log("status.actionType: "+o.actionType);jQuery.each(e,function(e,r){if(r.id.videoId!=null){r.id=r.id.videoId}if(r.snippet.resourceId!=null)r.id=r.snippet.resourceId.videoId;if(r.snippet.tags==null)r.snippet.tags="";o.videos.push(r);var n=false;var a=r.snippet.thumbnails.thumbnailMedium?r.snippet.thumbnails.thumbnailMedium:r.snippet.thumbnails.default.url;var s=jQuery(".tb-findandreplace-destination-row:last")[0].outerHTML;s=s.replace("#VIDEOTITLE#",r.snippet.title);s=TBUtilities.ReplaceAll(s,"#VIDEOID#",r.id);s=s.replace("#VIDEOTHUMBNAIL#",a);if(r.status)s=s.replace("#PRIVACY#",r.status.privacy);if(o.replaceTitles){s=s.replace("#TITLEDISPLAY#","display:inline-block;");if(TBUtilities.CountMatches(r.snippet.title,o.findText,!o.caseSensitive,o.matchWholeWord)>0){s=s.replace("#TITLEFOUNDSTATUS#","tb-findandreplace-found-status--found");TBUtilities.Log("Title Match "+r.id);n=true}else{s=s.replace("#TITLEFOUNDSTATUS#","tb-findandreplace-found-status--notfound")}}else{s=s.replace("#TITLEDISPLAY#","display:none;")}if(o.replaceDescriptions){s=s.replace("#DESCRIPTIONDISPLAY#","display:inline-block;");var l=false;r.snippet.description=r.snippet.description.replace(/[\u200B-\u200D\uFEFF]/g,"");if(o.actionType==i.trimDescription){var d="abcd\ufeffe";r.snippet.description=r.snippet.description.replace(/[\u200B-\u200D\uFEFF]/g,"");l=r.snippet.description!=jQuery.trim(r.snippet.description)}if(o.affectsAllVideos||o.actionType==i.trimDescription&&l||o.actionType!=i.trimDescription&&TBUtilities.CountMatches(r.snippet.description,o.findText,!o.caseSensitive,o.matchWholeWord)>0){s=s.replace("#DESCRIPTIONFOUNDSTATUS#","tb-findandreplace-found-status--found");TBUtilities.Log("Description  Match: "+r.id);n=true}else{s=s.replace("#DESCRIPTIONFOUNDSTATUS#","tb-findandreplace-found-status--notfound")}}else{s=s.replace("#DESCRIPTIONDISPLAY#","display:none;")}if(o.actionType==i.find){s=TBUtilities.ReplaceAll(s,"#DISPLAYCHECKBOX#","display:none;");s=s.replace("#DISPLAYX#","display:none")}if(n){s=s.replace("#ENABLED#","");s=s.replace("#enabled#","");s=TBUtilities.ReplaceAll(s,"#DISPLAYCHECKBOX#","");s=s.replace("#DISPLAYX#","display:none");jQuery("#tb-findandreplace-destination-list").append(s)}else{s=s.replace("#ENABLED#",' disabled="disabled" ');s=s.replace("#enabled#",' disabled="disabled" ');s=TBUtilities.ReplaceAll(s,"#DISPLAYCHECKBOX#","display:none;");s=s.replace("#DISPLAYX#","");t.push(s)}});if(t.length>0){if(o.replaceDescriptions&&o.replaceTitles)jQuery("#tb-findandreplace-destination-list").append('<div style="border-bottom: solid 1px red; color:Red; padding-bottom:2px; font-size:11px; margin-bottom:10px; font-weight:bold;">Your search text was not found in the Title or Description of the following videos...</div>');else if(o.replaceDescriptions)jQuery("#tb-findandreplace-destination-list").append('<div style="border-bottom: solid 1px red; color:Red; padding-bottom:2px; font-size:11px; margin-bottom:10px; font-weight:bold;">Your search text was not found in the Description of the following videos...</div>');else jQuery("#tb-findandreplace-destination-list").append('<div style="border-bottom: solid 1px red; color:Red; padding-bottom:2px; font-size:11px; margin-bottom:10px; font-weight:bold;">Your search text was not found in the Title of the following videos...</div>');jQuery.each(t,function(e,t){jQuery("#tb-findandreplace-destination-list").append(t)})}o.channelVideoCount=e.length;o.findCount=e.length-t.length;try{if(o.actionType==5)TBUtilities.AddAction({VideoCount:o.findCount,FindDescriptionSelected:o.replaceDescriptions,FindTitleSelected:o.replaceTitles},TBUtilities.ActionTypes.BulkFindReplaceAppent_Find,"bulkfindreplaceappend")}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyFind] [addAction]"})}jQuery("#tb-findandreplace-destination").show();jQuery("#tb-findandreplace-method").hide();jQuery("#tb-findandreplace-destination-list").show();if((TBGlobal.CanAccessLevel2Tools()||o.findCount<2)&&(o.method==0||o.method==1))jQuery("#tb-findandreplace-select-all-checkboxes").trigger("click")}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyFindAndReplace] [gotVideoList]"})}};var g=function(){jQuery(document.body).on("CTTBFAREditVideo",function(e,t){try{if(t.success&&(t.response=="null"||t.response==null)){h()}else{t.location="CTTBFAREditVideo";TBUtilities.LogError("Error in find and replace. Details: "+JSON.stringify(t));m(o.currentVideo.id,"Failed to update video ("+t.response+")")}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyFindAndReplace] CTTBFAREditVideo"});m(o.currentVideo.id,t.response)}});jQuery(document.body).on("CRTBLoadFindAndReplaceTemplate",function(e,t){try{if(t.success){t.response=TBUtilities.FixLocalHtml(DOMPurify.sanitize(t.response,DOMPurifyConfig));jQuery("body").append(t.response);w()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyFindAndReplace] CRTBLoadFindAndReplaceTemplate"})}})};var T=function(){try{jQuery("#tb-findandreplace-error-copy-container").hide();jQuery("#tb-findandreplace-error-copy").prop("data-clipboard-text","");var e=new ClipboardJS("#tb-findandreplace-error-copy");jQuery("#tb-findandreplace-selected-count").text("0");jQuery("#tb-findandreplace-destination-selected-count").text("0");jQuery("#tb-findandreplace-method").hide();jQuery("#tb-findandreplace-status").hide();jQuery("#tb-findandreplace-confirm").hide();jQuery("#tb-findandreplace-onlyLoadFirstPage-number").prop("disabled",true);jQuery("#tb-findandreplace-onlyLoadFirstPage").prop("checked",false);jQuery("#tb-findandreplace-bulk-description-updates-container").hide();jQuery("#tb-findandreplace-featured-content-container").hide();jQuery("#tb-findandreplace-cancel").text("Cancel");jQuery("#tb-findandreplace-kickoff").hide();jQuery("#tb-findandreplace-summary-container").hide();jQuery(".tb-findandreplace-filter").val("all");jQuery("#tb-findandreplace-featured-video-status-complete").hide();jQuery("#tb-findandreplace-featured-video-status-processing").hide();jQuery("#tb-findandreplace-bulk-descriptions-status-complete").hide();jQuery("#tb-findandreplace-bulk-descriptions-status-processing").hide();jQuery("#tb-findandreplace-success").hide();jQuery("#tb-findandreplace-back").hide();jQuery("#tb-findandreplace-container").fadeIn();jQuery("#tb-findandreplace-methods-container").fadeIn();jQuery("#tb-findandreplace-find").val("");jQuery("#tb-findandreplace-replace").val("");jQuery("#tb-findandreplace-action-text").text("");jQuery("#tb-findandreplace-cancel").show();jQuery("#tb-findandreplace-continue").show();jQuery("#tb-findandreplace-close").hide();jQuery("#tb-findandreplace-done-close").hide();jQuery("#tb-findandreplace-none").hide();jQuery("#tb-findandreplace-has").hide();jQuery("#tb-findandreplace-destination").hide();jQuery("#tb-findandreplace-source").show();jQuery("#tb-findandreplace-input-ids").val("");jQuery("#tb-findandreplace-input-ids-status").text("");jQuery("#tb-findandreplace-method-full").prop("checked","checked")}catch(e){TBUtilities.LogError({Exception:e,Location:"[V2VPromote] prepareDialog"})}};var w=function(){TBGlobal.ClearUserDebugInfo();TBGlobal.AddUserDebugInfo("Opening FindAndReplace");o.videoEntity=null;o.videos=[];o.destinationVideos=[];o.currentVideo=null;o.step=1;o.specificVideoIds.length=0;o.specificVideos.length=0;o.method=3;r();T()};return{Show:function(){if(TBGlobal.IsAuthenticated()){if(!e){g();a();l();e=true}else{w()}}}}}();var TubeBuddyQuickEditToolbarStudio=function(){var e=false;var t="";var i=false;var o=false;var r=null;var n=null;var a={startingIndex:0,totalItems:0,showInList:7,currentPage:1,max:9999,cookie:null,isFetching:false,startPage:1,currentlUrl:"",onPage:1,startingUrl:"",isLoadingPlaylists:false};var s=function(){return document.location.href.indexOf("/channel/")>-1&&document.location.href.indexOf("/videos?")>-1};var l=function(){return new Promise(function(e){if(s()){e()}else{TBExtension.GetDbValue("tb-"+TBGlobal.CurrentChannelId()+"-edit-playlist-videos-pl-id",function(t,i){if(i){r=i.playlistId;n=i.title;o=true;var a=i.page?i.page:1;TBExtension.RemoveDbValue("tb-"+TBGlobal.CurrentChannelId()+"-edit-playlist-videos-pl-id");p("https://www.youtube.com/playlist?list="+r,a,'This list currently shows videos in the <a href="'+"https://www.youtube.com/playlist?list="+r+'">'+n+"</a> Playlist.");e()}else{r=null;n=null;o=false;var s=localStorage.getItem("tb-videos-list-studio-current-url"+TBGlobal.CurrentChannelId())!=null?localStorage.getItem("tb-videos-list-studio-current-url"+TBGlobal.CurrentChannelId()):jQuery("a#back-button").attr("href");p("https://studio.youtube.com/"+s,1,'This list currently shows videos that were last displayed on your <a href="'+s+'">My Videos</a> page.');e()}})}})};var d=function(){jQuery.each(a.cookie.videos,function(e,i){if(i!=null){if(i.v==t){a.startingIndex=e-3;if(a.startingIndex<0)a.startingIndex=0}}});a.startPage=a.cookie.page;if(a.startPage==1){jQuery("#tb-editvideo-nav-list-prev").addClass("tb-editvideo-nav-scroll-disabled");jQuery("#tb-editvideo-nav-list-prev").removeClass("tb-editvideo-nav-scroll-enabled")}jQuery(".tb-quickedittoolbar-description").html(DOMPurify.sanitize(a.cookie.description,DOMPurifyConfig));h()};var u=function(){TBUtilities.Log("Quick-Edit Toolbar Referrer: "+document.referrer);var e=TBUtilities.GetCookie("tb_pl_edit");TBUtilities.RemoveCookie("tb_pl_edit");if(document.location.href.indexOf("/videos/upload")>-1||s()){a.totalItems=0;var t=TBUtilities.GetUrlParameter("pi");if(!t)t=1;TBUtilities.Log("Is My Videos Page");p(document.location.href,t,'This list currently shows videos that were last displayed on your <a href="'+document.location.href+'">My Videos</a> page.')}else if(document.location.href.indexOf("/playlist")>-1){TBUtilities.Log("Is Playlist Page");p(document.location.href,1,'This list currently shows videos in the <a href="'+document.location.href+'">'+TBUtilities.GetHtmlEncoded(jQuery(".pl-header-title").text())+"</a> Playlist.")}else{if(e=="1"||document.referrer.indexOf("playlist")>-1||document.location.href.indexOf("/edit")>-1){var i=TBUtilities.GetCookie("tb-quick-edit-toolbar-data"+TBGlobal.CurrentChannelId());if(i){TBUtilities.Log("Fetching initial Quick-Edit Toolbar page");a.cookie=JSON.parse(TBUtilities.GetCookie("tb-quick-edit-toolbar-data"+TBGlobal.CurrentChannelId()));var o=0;var r=setInterval(function(){var e=jQuery("#edit.ytcp-app").is(":visible");if(e===true){clearInterval(r);if(jQuery(".tb-editvideo-nav-video-studio:visible").length==0){jQuery("#edit.ytcp-app").before(jQuery("#tb-editvideo-nav-video")[0].outerHTML);jQuery("#tb-editvideo-nav-video").before(jQuery("#tb-editvideo-nav-list-menu")[0].outerHTML)}}else if(o<25){o++}else{clearInterval(r);TBUtilities.ReportExtensionDOMIssue("QuickEditToolbarStudio","#edit.ytcp-app")}},100);TBExtension.GetDbValue("tb-edit-video-hide-quick-edit-toolbar-"+TBGlobal.CurrentChannelId(),function(e,t){if(t||TBUtilities.GetCookie("tb-edit-video-hide-menu")==true||TBUtilities.GetCookie("tb-edit-video-hide-menu")=="true"){TBUtilities.Log("Hiding, do not fetch results.");jQuery(".tb-editvideos-hide-editor").hide();jQuery(".tb-editvideos-show-editor").show();jQuery("#tb-editvideo-nav-video").addClass("tb-editvideo-nav-hiding");jQuery("#tb-editvideo-nav-video").removeClass("tb-editvideo-nav-showing")}else{TBUtilities.Log("Not hiding, go fetch results.");c()}})}else{TBUtilities.Log("Not a Quick-Edit Toolbar Studio page url")}}else{TBUtilities.Log("Not coming from Playlist or My Videos page")}}};var c=function(){if(!a.isFetching){a.isFetching=true;i=true;TBUtilities.Log("Fetching first page: "+a.cookie.url);jQuery("#tb-editvideo-nav-list-loading-more").show();a.currentlUrl=a.cookie.url;a.onPage=a.cookie.page;a.startingUrl=a.cookie.url;TBExtension.Get(a.cookie.url,function(e,t,i){a.isFetching=false;jQuery("#tb-editvideo-nav-list-loading-more").hide();jQuery("#tb-editvideo-container").show();try{if(e){var o=i;if(a.cookie.url.indexOf("/playlist")>0||a.cookie.url.indexOf("view_all_playlists")>-1){jQuery("#tb-editvideo-nav-list-loading-more").show();b(o).then(d)}else{f().then(d)}if(TBUtilities.GetCookie("tb-edit-video-hide-menu")=="true"){jQuery(".tb-editvideos-hide-editor").hide();jQuery(".tb-editvideos-show-editor").show();jQuery("#tb-editvideo-nav-video").addClass("tb-editvideo-nav-hiding");jQuery("#tb-editvideo-nav-video").removeClass("tb-editvideo-nav-showing")}else{jQuery(".tb-editvideos-show-editor").hide();jQuery(".tb-editvideos-hide-editor").show();jQuery("#tb-editvideo-nav-video").addClass("tb-editvideo-nav-showing");jQuery("#tb-editvideo-nav-video").removeClass("tb-editvideo-nav-hiding")}}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyQuickEditToolbar] fetchInitialPage"})}})}};var p=function(e,t,i){var o={url:e,page:t,videos:[],description:i};TBUtilities.Log("cookie");TBUtilities.Log(o);TBUtilities.RemoveCookie("tb-quick-edit-toolbar-data"+TBGlobal.CurrentChannelId());TBUtilities.CreateCookie("tb-quick-edit-toolbar-data"+TBGlobal.CurrentChannelId(),JSON.stringify(o),7)};var h=function(){if(a.isLoadingPlaylists==true){jQuery("#tb-editvideo-nav-list-loading-more").show();return}if(!o){var e=window.localStorage.getItem("tb-videos-list-studio-current-url"+TBGlobal.CurrentChannelId());if(e){jQuery(".tb-quickedittoolbar-description a").attr("href",e)}else{var i=jQuery("a#back-button").attr("href");jQuery(".tb-quickedittoolbar-description a").attr("href",i)}}a.totalItems=a.cookie.videos.length;var r="";var n=0;if(a.startingIndex<0)a.startingIndex=0;jQuery.each(a.cookie.videos,function(e,i){i.editLink="https://studio.youtube.com/video/"+i.v+"/edit?c="+TBGlobal.CurrentChannelId();if(e>=a.startingIndex&&e<a.startingIndex+a.showInList){if(i.v==t){r+='<div style="">                       <img style="border:solid 3px red !important;"             class="tb-editvideo-nav-image" data-videoid="'+i.v+'" src="'+(i.i?i.i:"https://i.ytimg.com/vi/"+i.v+"/default.jpg")+'" title="'+TBUtilities.GetHtmlEncoded(i.t)+'" /></div>'}else{r+='<div style=""><a data-page-url="'+i.editLink+'" data-page="'+i.p+'" class="tb-quickedit-toolbar-link" href="'+i.editLink+'"><img style="opacity:.45;" class="tb-editvideo-nav-image" data-videoid="'+i.v+'" src="'+(i.i?i.i:"https://i.ytimg.com/vi/"+i.v+"/default.jpg")+'" title="'+TBUtilities.GetHtmlEncoded(i.t)+'" /></a></div>'}n++}});if(a.startingIndex>0||a.cookie.page>1){jQuery("#tb-editvideo-nav-list-prev").addClass("tb-editvideo-nav-scroll-enabled");jQuery("#tb-editvideo-nav-list-prev").removeClass("tb-editvideo-nav-scroll-disabled")}else{jQuery("#tb-editvideo-nav-list-prev").addClass("tb-editvideo-nav-scroll-disabled");jQuery("#tb-editvideo-nav-list-prev").removeClass("tb-editvideo-nav-scroll-enabled")}if(a.startingIndex==0&&(a.cookie.page==1||a.startPage==1)){jQuery("#tb-editvideo-nav-list-prev").addClass("tb-editvideo-nav-scroll-disabled");jQuery("#tb-editvideo-nav-list-prev").removeClass("tb-editvideo-nav-scroll-enabled")}else{jQuery("#tb-editvideo-nav-list-prev").addClass("tb-editvideo-nav-scroll-enabled");jQuery("#tb-editvideo-nav-list-prev").removeClass("tb-editvideo-nav-scroll-disabled")}var s=a.totalItems-a.startingIndex>a.showInList;if(a.totalItems<=a.max&&s){jQuery("#tb-editvideo-nav-list-next").show()}else{jQuery("#tb-editvideo-nav-list-next").hide()}if(a.cookie.url.indexOf("playlist")>-1&&a.cookie.videos.length<=a.showInList+a.startingIndex){jQuery("#tb-editvideo-nav-list-next").hide()}jQuery("#tb-editvideo-nav-list").html(DOMPurify.sanitize(r,DOMPurifyConfig));TBUtilities.Log(a)};var y=function(e){var t=e.indexOf('window["ytInitialData"] = ');t=t+26;var i=e.substring(t,e.length);var o=i.indexOf("};")+1;var i=i.substring(0,o);var r=jQuery.parseJSON(i);return r};var b=function(e){return new Promise(function(t,i){var o=0;var r=0;a.isLoadingPlaylists=true;var n=y(e);if(n&&n.contents.twoColumnBrowseResultsRenderer.tabs["0"].tabRenderer.content.sectionListRenderer.contents["0"].itemSectionRenderer.contents["0"].playlistVideoListRenderer.contents){try{var s=n.contents.twoColumnBrowseResultsRenderer.tabs["0"].tabRenderer.content.sectionListRenderer.contents["0"].itemSectionRenderer.contents["0"].playlistVideoListRenderer.contents;jQuery.each(s,function(e,s){if(s.playlistVideoRenderer){var l=s.playlistVideoRenderer.videoId;var d=s.playlistVideoRenderer.title.runs[0].text;var u=s.playlistVideoRenderer.thumbnail.thumbnails["1"].url;TubeBuddyYouTubeActions.GetVideoInfo(l,function(i){o++;if(l&&i!=null&&i.channelid!=null&&i.channelid==TBGlobal.CurrentChannelId()){var s=TBUtilities.GetInArray(a.cookie.videos,"v",l);TBUtilities.Log(s);if(!s&&d&&d!="\\n\\n"){a.cookie.videos.push({v:l,t:d,i:u,u:a.currentlUrl,p:a.onPage,d:i.publishDate,o:e});a.totalItems++;r++}}if(o>=n.contents.twoColumnBrowseResultsRenderer.tabs["0"].tabRenderer.content.sectionListRenderer.contents["0"].itemSectionRenderer.contents["0"].playlistVideoListRenderer.contents.length){a.cookie.videos.sort(function(e,t){return e.o-t.o});a.isLoadingPlaylists=false;jQuery("#tb-editvideo-nav-list-loading-more").hide();h();if(r==0){a.max=a.totalItems}else{a.max=a.totalItems+1;jQuery("#tb-editvideo-nav-list-next").show()}t()}})}else{i()}})}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddy QuickEditToolbarStudio] - parsePlaylistPageStudio"})}}else{i()}})};var f=function(){return new Promise(function(e,t){var i=0;var o=JSON.parse(window.localStorage.getItem("tb-videos-list-studio-video-info"+TBGlobal.CurrentChannelId()));var r=o&&o.length>0?o[0].lastUpdated:null;var n;if(r&&Math.floor(((new Date).getTime()-r)/36e5)<8){n=false}else{n=true}a.cookie.videos=[];if(n){var s="https://studio.youtube.com/channel/"+TBGlobal.CurrentChannelId()+"/videos";p(document.location.href,1,'This list currently shows videos that were last displayed on your <a href="'+s+'">My Videos</a> page.');window.localStorage.removeItem("tb-videos-list-studio-video-info"+TBGlobal.CurrentChannelId());var l=[];TubeBuddyYouTubeActions.GetVideosListStudio(30,false).then(o=>{if(o&&o.videosList){o.videosList.forEach(e=>{l.push({videoId:e.videoId,title:e.title,thumbnail:e.thumbnailDetails.thumbnails[1].url,lastUpdated:(new Date).getTime()});a.cookie.videos.push({v:e.videoId,t:e.title,i:e.thumbnailDetails.thumbnails[1].url,u:document.location.href,p:a.onPage});a.totalItems++;i++});window.localStorage.setItem("tb-videos-list-studio-current-url"+TBGlobal.CurrentChannelId(),s);window.localStorage.setItem("tb-videos-list-studio-video-info"+TBGlobal.CurrentChannelId(),JSON.stringify(l));if(i==0){a.max=a.totalItems}else{jQuery("#tb-editvideo-nav-list-next").show()}e()}else{t("Unable to load default Videos List")}})}else{o.forEach(function(e){a.cookie.videos.push({v:e.videoId,t:e.title,i:e.thumbnail,u:a.currentlUrl,p:a.onPage});a.totalItems++;i++});if(i==0){a.max=a.totalItems}else{jQuery("#tb-editvideo-nav-list-next").show()}e()}})};var m=function(){var e=chrome.extension.getURL("modules/quickedittoolbarstudio.html");TBExtension.Get(e,function(e,t,i){try{if(e){i=TBUtilities.FixLocalHtml(DOMPurify.sanitize(i,DOMPurifyConfig));jQuery("body").append(i);l().then(u)}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyQuickEditToolbar] loadHtml "})}})};var v=function(){if(!a.isFetching){a.isFetching=true;if(a.cookie.url.indexOf("pi=")==-1){a.cookie.url+="&pi=1"}a.cookie.url=TBUtilities.ReplaceAll(a.cookie.url,"pi="+a.cookie.page,"pi="+(parseInt(a.cookie.page)+1));a.cookie.page=parseInt(a.cookie.page)+1;TBUtilities.Log("Next: "+a.cookie.url);a.currentlUrl=a.cookie.url;a.onPage=a.cookie.page;TBExtension.Get(a.cookie.url,function(e,t,i){a.isFetching=false;try{if(e){var o=i;var r=o.indexOf("VIDEO_LIST_DISPLAY_OBJECT");TBUtilities.Log("currentIndex: "+r);var n=0;var s=0;while(o.indexOf("data-video-id",r)>-1&&r>n){if(r>n)n=r;var l=o.indexOf("data-video-id",r)+"data-video-id".length+3;var d=o.substring(l,l+11);if(d=="__VIDEO_ID"){}else{TBUtilities.Log("videoId: "+d);var u=o.indexOf("vm-video-title-content",l);u=o.indexOf("data-sessionlink=",u);u=o.indexOf("u003e",u)+"u003e".length;var c=o.indexOf("u003c",u)-1;var p=o.substring(u,c);if(!p)p="";p=p.trim();TBUtilities.Log(d+" - "+p);var y="";var b=o.indexOf("vm-private",r);var f=o.substring(b,b+25).indexOf("hid")==-1;if(f){var m=o.indexOf("yt-thumb-clip",r);m=o.indexOf("https",m);var v=o.indexOf('"',m)-1;var g=o.substring(m,v);g=TBUtilities.ReplaceAll(g,"\\/","\\");g=TBUtilities.ReplaceAll(g,"\\u0026amp;","&");y=g}r=o.indexOf("vm-video-item-content-horizontal-divider",r+5);var T=TBUtilities.GetInArray(a.cookie.videos,"v",d);TBUtilities.Log(T);if(!T&&p&&p!="\\n\\n"){a.cookie.videos.push({v:d,t:p,i:y,u:a.currentlUrl,p:a.onPage});a.totalItems++;s++}}}jQuery("#tb-editvideo-nav-list-loading-more").hide();if(s==0){a.max=a.totalItems}else{jQuery("#tb-editvideo-nav-list-next").show()}h()}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyQuickEditToolbar] fetchNextNavPage"})}})}};var g=function(){if(!a.isFetching){a.isFetching=true;if(a.cookie.url.indexOf("pi=")==-1){a.cookie.url+="&pi=1"}a.cookie.url=TBUtilities.ReplaceAll(a.cookie.url,"pi="+a.cookie.page,"pi="+(parseInt(a.cookie.page)-1));a.cookie.page=parseInt(a.cookie.page)-1;TBUtilities.Log("Prev: "+a.cookie.url);a.currentlUrl=a.cookie.url;a.onPage=a.cookie.page;TBExtension.Get(a.cookie.url,function(e,t,i){a.isFetching=false;try{if(e){var o=i;var r=o.indexOf("VIDEO_LIST_DISPLAY_OBJECT");TBUtilities.Log("currentIndex: "+r);var n=0;var s=false;var l=a.cookie.videos.length;while(o.indexOf("data-video-id",r)>-1&&r>n){if(r>n)n=r;var d=o.indexOf("data-video-id",r)+"data-video-id".length+3;var u=o.substring(d,d+11);if(u=="__VIDEO_ID"){r=r+9999999999}else{TBUtilities.Log("videoId: "+u);var c=o.indexOf("vm-video-title-content",d);c=o.indexOf("data-sessionlink=",c);c=o.indexOf("u003e",c)+"u003e".length;var p=o.indexOf("u003c",c)-1;var y=o.substring(c,p);if(!y)y="";y=y.trim();TBUtilities.Log(u+" - "+y);var b="";var f=o.indexOf("vm-private",r);var m=o.substring(f,f+25).indexOf("hid")==-1;if(m){var v=o.indexOf("yt-thumb-clip",r);v=o.indexOf("https",v);var g=o.indexOf('"',v)-1;var T=o.substring(v,g);T=TBUtilities.ReplaceAll(T,"\\/","\\");T=TBUtilities.ReplaceAll(T,"\\u0026amp;","&");b=T}r=o.indexOf("vm-video-item-content-horizontal-divider",r+5);var w=TBUtilities.GetInArray(a.cookie.videos,"v",u);TBUtilities.Log(w);if(!w&&y){a.cookie.videos.splice(s,0,{v:u,t:y,i:b,u:a.currentlUrl,p:a.onPage});a.totalItems++;s++}}}jQuery("#tb-editvideo-nav-list-loading-prev").hide();if(s>0){jQuery("#tb-editvideo-nav-list-prev").show();a.startingIndex+=s-a.showInList}h()}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyQuickEditToolbar] fetchPrevNavPage"})}})}};var T=function(){jQuery(document).on("mouseover",".tb-editvideo-nav-image",function(e){var t=jQuery(this).attr("data-videoid");jQuery(this).parent().parent().find(".tb-editvideo-nav-title"+t).fadeIn("fast")});jQuery(document).on("click",".tb-quickedit-toolbar-link",function(e){if(document.referrer.indexOf("playlist")>-1||o){TBUtilities.AddAction(null,TBUtilities.ActionTypes.QuickEditToolbar_PlaylistEdit,"quickedittoolbar")}else if(document.referrer.indexOf("my_videos")>-1||document.location.href.indexOf("/edit")>-1){TBUtilities.AddAction(null,TBUtilities.ActionTypes.QuickEditToolbar_MyVideosEdit,"quickedittoolbar")}var t=jQuery(this).attr("data-page-url");var i=jQuery(this).find("img").attr("data-videoid");var s=jQuery(this).find("img").attr("title");TBUtilities.ReportProductEvent("Feature Used",{Tool:TBGlobal.GetToolById("quickedittoolbar").name,Action:"click on video",VideoId:i,VideoTitle:s});e.preventDefault();document.location.href=t;var l=jQuery(this).attr("data-page");if(t!=a.startingUrl){if(o){TBExtension.SetDbValue("tb-"+TBGlobal.CurrentChannelId()+"-edit-playlist-videos-pl-id",{playlistId:r,title:n,page:a.cookie.page},"")}p(t,l,a.cookie.description)}});jQuery(document).on("mouseleave",".tb-editvideo-nav-image",function(e){var t=jQuery(this).attr("data-videoid");jQuery(this).parent().parent().find(".tb-editvideo-nav-title"+t).hide()});jQuery(document).on("click","#tb-editvideo-nav-list-header-menu, .tb-editvideo-settings-closex",function(){jQuery("#tb-editvideo-nav-list-menu").toggle()});jQuery(document).on("click",".tb-editvideos-hide-editor",function(){jQuery(this).hide();jQuery(".tb-editvideos-show-editor").show();jQuery("#tb-editvideo-nav-video").addClass("tb-editvideo-nav-hiding");jQuery("#tb-editvideo-nav-video").removeClass("tb-editvideo-nav-showing");TBExtension.SetDbValue("tb-edit-video-hide-quick-edit-toolbar-"+TBGlobal.CurrentChannelId(),true,"");jQuery("#tb-editvideo-nav-list-menu").toggle()});jQuery(document).on("click",".tb-editvideos-show-editor",function(){jQuery(this).hide();jQuery(".tb-editvideos-hide-editor").show();jQuery("#tb-editvideo-nav-list-wrapper").slideDown();jQuery("#tb-editvideo-nav-video").addClass("tb-editvideo-nav-showing");jQuery("#tb-editvideo-nav-video").removeClass("tb-editvideo-nav-hiding");TBExtension.SetDbValue("tb-edit-video-hide-quick-edit-toolbar-"+TBGlobal.CurrentChannelId(),false,"");if(!i||!a.cookie.videos.length)c();jQuery("#tb-editvideo-nav-list-menu").toggle()});jQuery(document).on("click","#tb-editvideo-nav-list-prev",function(){if(jQuery("#tb-editvideo-nav-list-prev").hasClass("tb-editvideo-nav-scroll-enabled")){if(a.startingIndex<a.showInList&&a.cookie.page>1&&a.startPage>1){jQuery(this).hide();jQuery("#tb-editvideo-nav-list-loading-prev").show();g()}else{a.startingIndex-=a.showInList;if(a.startingIndex<0)a.startingIndex=0;h()}jQuery("#tb-editvideo-nav-list-loading-more").hide();jQuery("#tb-editvideo-nav-list-next").show()}});jQuery(document).on("click","#tb-editvideo-nav-list-next",function(){if(a.startingIndex+a.showInList>=a.totalItems){jQuery(this).hide();jQuery("#tb-editvideo-nav-list-loading-more").show();v()}else{a.startingIndex+=a.showInList;h()}});jQuery(document).on("click",".tb-quickedittoolbar-description a",function(){if(!o)jQuery(".tb-video-tools-menu-dropdown:visible").remove()})};return{Initialize:function(){if(TBGlobal.IsAuthenticated()){if(!e){t=document.location.href.indexOf("/video/")>-1?document.location.href.split("/video/")[1].substr(0,11):"";if(!t)t=TBUtilities.GetUrlParameter("v");m();T();e=true}else{t=document.location.href.indexOf("/video/")>-1?document.location.href.split("/video/")[1].substr(0,11):"";l().then(u)}}},CreateQuickEditToolbarCookie:function(e,t,i){p(e,t,i)}}}();var TubeBuddySearchResults=function(){var e=false;var t="";var i=false;var o=null;var r=0;var n=[];var a=null;var s=null;var l=null;var d=null;var u="#contents ytd-video-renderer";var c=function(){var e=TBUtilities.GetUrlParameter("search_query");if(e==null||e=="")e=TBUtilities.GetUrlParameter("q");t=TBUtilities.ReplaceAll(TBUtilities.GetUrlDecoded(e),"+"," ");t=jQuery("<div/>").html(DOMPurify.sanitize(t,DOMPurifyConfig)).text();i=false;var o="#filter-menu";if(jQuery(o).length>0){jQuery(o).append(jQuery(".tb-search-results-view-details:last")[0])}else{TBUtilities.ReportExtensionDOMIssue("SearchResults",o)}p();h();TBUtilities.Log("TubeBuddy SearchResults - populateContent")};var p=function(){clearInterval(o);o=null;n=[];r=0;jQuery(".tb-search-results-details").remove();jQuery(".tb-search-results-view-details span").text("View")};var h=function(){jQuery(".tb-search-results-view-details").qtip({content:{text:"View video Tags, Subscriber Count, and Likes/Dislikes"},style:{classes:"qtip-youtube-tubebuddy",width:"150px",tip:false},position:{at:"bottom left",adjust:{y:5}}})};var y=function(){jQuery(".tb-search-results-view-details").qtip("destroy",true)};var b=function(){var e=chrome.extension.getURL("modules/searchresults.html");TBExtension.Get(e,function(e,t,i){try{if(e){i=TBUtilities.FixLocalHtml(DOMPurify.sanitize(i,DOMPurifyConfig));jQuery("body").append(i);a=jQuery("#tb-search-results-insights-subscribers-container-template").html();s=jQuery("#tb-search-results-insights-likes-container-template").html();l=jQuery("#tb-search-results-insights-tags-container-template").html();d=jQuery("#tb-search-results-insights-video-tag-container-template").html();c()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddySearchResults] LoadSearchResultsTemplate"})}})};var f=function(){var e=[u,u+" #thumbnail",u+" #channel-info",u+" #metadata-line"];var t=[];e.forEach(e=>{if(jQuery(e).length===0){t.push(e)}});if(t.length>0)TBUtilities.ReportExtensionDOMIssue("SearchResults",t.join(" && "))};var m=function(){jQuery(document).on("click",".tb-search-results-view-details",function(){i=!i;if(i){try{TBUtilities.AddAction({Data:t},TBUtilities.ActionTypes.SearchInsights_ViewDetails,"searchinsights")}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddySearchResults] add channel action"})}jQuery(".tb-search-results-view-details span").text("Hide");y();f();o=setInterval(function(){if(location.href.indexOf("results?search_query")==-1){TBUtilities.Log("TubeBuddySearchResultsInsights - URL change detected. Stop checking for new results.");clearInterval(o);jQuery(".tb-search-results-details").remove();o=null;i=false}else if(jQuery(u).length>r){v()}else{jQuery(".tb-search-results-details").show()}},1e3)}else{clearInterval(o);o=null;jQuery(".tb-search-results-details").hide();jQuery(".tb-search-results-view-details span").text("View");h()}});jQuery(document).on("click",".tb-search-results-tag-explorer",function(){var e=jQuery(this).attr("data-tb-keyword");TubeBuddyMenu.ShowBackgroundSticky();TBUtilities.ReportProductEvent("Feature Used",{Tool:"Search Results",Action:"Keyword Explorer Opened"});TubeBuddyKeywordExplorer.Show(e,jQuery(this))});jQuery(document).on("click",".tb-search-results-details-copy-tags-button",function(){var e=jQuery(this).attr("data-tags-list");if(e){jQuery("#tb-copyto-dropdown-template").remove();var t=e.split(",");TubeBuddyCopyTo.ShowMenu(jQuery(this),t,false,null,jQuery(this).attr("data-metadata-width")-26)}})};var v=function(){jQuery.each(jQuery(u),function(){var e=jQuery(this);var t=jQuery(this).find("#thumbnail").attr("href");var i=TBUtilities.GetParameterByName("v",t);if(e.find(".tb-search-results-details").length==0){TubeBuddyYouTubeActions.GetVideoInfo(i,function(t){if(t&&e.find(".tb-search-results-details").length==0){if(t.channelsubscribers!=0){var i=a.formatTemplate(t.channelsubscribers);e.find("#channel-info").append(DOMPurify.sanitize(i,DOMPurifyConfig))}var o=t.likes?TBUtilities.FormatNumberAbbreviated(t.likes):0;var n=t.dislikes?TBUtilities.FormatNumberAbbreviated(t.dislikes):0;var u=s.formatTemplate(o,n);e.find("#metadata-line").append(DOMPurify.sanitize(u,DOMPurifyConfig));var c=e.find(".ytd-video-renderer.text-wrapper").width();var p=l.formatTemplate("width:"+c+"px;",t.tags,c);e.append(DOMPurify.sanitize(p,DOMPurifyConfig));if(t.tags.length>0){t.tags.forEach(function(t){var i=d.formatTemplate(t);e.find(".tb-search-results-details-tags-box").append(DOMPurify.sanitize(i,DOMPurifyConfig))})}else{e.find(".tb-search-results-details-tags-box").append('<span class="tb-search-results-no-tags">Video does not contain any tags.</span>');e.find(".tb-search-results-details-copy-tags-button").hide()}r++}})}else{e.find(".tb-search-results-details").show()}})};return{Initialize:function(){if(TBGlobal.IsAuthenticated()){if(!e){b();m();e=true}else{c()}}}}}();var TubeBuddyVideoMenuStudio=function(){var e=false;var t=function(){var e=document.location.href;if(document.location.href.indexOf("studio.youtube.com/video/")>0){var t=0;var i=setInterval(function(){var o=jQuery('ytcp-navigation-drawer[layout="video"] div#entity-label-container').filter(":visible");var r=jQuery(".title.input-container #textbox:visible");if(o.length>0&&r.length>0){clearInterval(i);if(o.find(".tb-video-tools-menu-dropdown").length==0){var n=jQuery("#tb-studio-video-edit-dropdown-template").html();jQuery(n).attr("id","tb-video-edit-studio-tools-menu-dropdown");o.append(DOMPurify.sanitize(n,DOMPurifyConfig))}else if(o.find(".tb-video-tools-menu-dropdown:hidden").length==1){o.find(".tb-video-tools-menu-dropdown").show()}}else if(t<5){t++}else if(document.location.href.match(/\/edit$/gm)&&jQuery(".title.input-container #textbox").length===0){clearInterval(i);TBUtilities.ReportExtensionDOMIssue("VideoMenuStudio",".title.input-container #textbox",e)}else if(document.location.href.match(/\/edit$/gm)&&o.length==0){TBUtilities.ReportExtensionDOMIssue("VideoMenuStudio",'ytcp-navigation-drawer[layout="video"] div#entity-label-container:visible',e)}jQuery(".tb-video-tools-menu-studio-chapter-editor").show()},1e3)}};var i=function(){jQuery(".tb-video-menu-overview").hide();jQuery(".tb-studio-video-edit-dropdown").removeAttr("menu-open")};var o=function(){var e=TBGlobal.host+"/ModuleManager/videomenustudio/videomenustudio?v="+TBGlobal.versionNumber;if(loadLocalHTML&&(TBExtension.GetType()=="chrome"||TBExtension.GetType()=="firefox")){e=chrome.extension.getURL("modules/videomenustudio.html")}else if(loadLocalHTML&&TBExtension.GetType()=="safari"){e="modules/videomenustudio.html"}TBExtension.Get(e,"CRTBLoadVideoMenuStudio")};var r=function(){return document.location.href.slice(document.location.href.search("/video/")+7,document.location.href.search("/video/")+18)};var n=function(){if(jQuery("#entity-name").length>0)return jQuery("#entity-name").text().trim();return""};var a=function(){if(jQuery(".description").find("textarea").length>0)return jQuery(".description").find("textarea").val().trim();return};var s=function(){if(jQuery("#img-with-fallback:first").length>0)return jQuery('#img-with-fallback[src*="'+r()+'"]:first').attr("src");else return"https://img.youtube.com/vi/"+r()+"/mqdefault.jpg"};var l=function(e){var t=JSON.parse(window.localStorage.getItem("tb-videos-list-studio-video-info"+TBGlobal.CurrentChannelId()));if(t&&t.length>0){var i=t.filter(function(t){return t.videoId==e});if(i.length>0){return i[0].views}else{return null}}else{return null}};var d=async function(e){jQuery(".tb-video-edit-studio-playlist-container").html('<span class="tb-spinner tb-margin-right5"></span> Loading Playlists...');await TubeBuddyYouTubeActions.GetPlaylistsThatContainVideoStudio(e).then(u).catch(e=>TBUtilities.LogError(e))};var u=function(e){var t=e.videoId;var i=e.playlists;$(".tb-video-edit-studio-playlist-container").empty();if(!i||!i.length){$(".tb-video-edit-studio-playlist-container").append('<div style="padding:15px 0 10px 5px; color:coral;">This video was not found in any of your Playlists.</div>');return}for(const e of i){var o=e.title;var r=e.playlistId;var n='<div style="padding:0 0 10px"><b>Playlist Link - "'+o+'"</b><br /> <input class="tb-material-input tb-playlist-info-studio" style="width:50%;margin-right:15px" type="text" value="https://www.youtube.com/watch?v='+t+"&list="+r+'" readonly /><button id="tb-video-studio-copy-playlist-'+r+'" class="tb-btn-blue tb-video-studio-playlist-copy" data-clipboard-action="copy" data-clipboard-text="https://www.youtube.com/watch?v='+t+"&list="+r+'" >Copy</button></div>';$(".tb-video-edit-studio-playlist-container").append(DOMPurify.sanitize(n,DOMPurifyConfig));new ClipboardJS("#tb-video-studio-copy-playlist-"+r)}};var c=function(){jQuery(document).on("click",".tb-video-tools-menu-dropdown-ab-test",function(){var e=r();var t=n();var o=encodeURI("https://img.youtube.com/vi/"+e+"/mqdefault.jpg");i(true);window.open(TBGlobal.host+"/channel/abtestcreate/"+TBGlobal.CurrentChannelId()+"?videoid="+e+"&videotitle="+t+"&videothumbnail="+o,"_blank")});jQuery(document).on("click",".tb-video-tools-menu-dropdown-comments",function(){var e=jQuery(this).attr("data-id");TBUtilities.Confirm("Are you sure you want to export all comments (1,000 max) from this video to a CSV file?\n\nThis process can take up to 2 MINUTES to complete based on how many comments you have (so be patient).",function(){if(!TBGlobal.CanAccessLevel3Tools()){TBGlobal.ShowUpgradePage("export video comments",TBGlobal.limitation.exportComments);return false}const t=TBGlobal.GetToolById("exportcomments").name;TBUtilities.ReportProductEvent("Feature Used",{Tool:t,Action:`Exporting comments`});var i=TBGlobal.host+"/youtubechannel/ExportVideoComments?channelId="+TBGlobal.CurrentChannelId()+"&videoId="+e;var o=window.open(i,"_blank");o.focus()},null)});jQuery(document).on("click",".tb-video-tools-menu-studio-seo-studio",function(){i();TubeBuddyMenu.ShowBackgroundSticky();jQuery("body").trigger("TBopenSeoStudioVue")});jQuery(document).on("click",".tb-video-tools-menu-studio-chapter-editor",function(){i();TubeBuddyMenu.ShowBackgroundSticky();jQuery("body").trigger("TBopenChapterEditor")});jQuery(document).on("click",".tb-video-id-copy",function(){jQuery(".tb-video-id-copy").text("Copied");window.setTimeout(function(){jQuery(".tb-video-id-copy").text("Copy")},1500)});jQuery(document).on("click",".tb-video-link-copy",function(){jQuery(".tb-video-link-copy").text("Copied");window.setTimeout(function(){jQuery(".tb-video-link-copy").text("Copy")},1500)});jQuery(document).on("click",".tb-video-studio-playlist-copy",function(){jQuery(this).text("Copied");window.setTimeout(function(){jQuery(".tb-video-studio-playlist-copy").text("Copy")},1500)});jQuery(document).on("click",".tb-video-tools-menu-dropdown-suggested-tags",function(e){e.preventDefault();if(window.location.href.indexOf("edit")>-1){jQuery(".tb-edit-video-studio-tag-button-container")[0].scrollIntoView({behavior:"smooth"})}else{var t=jQuery(this).find("a").attr("href");var i=window.open(t,"_blank")}});jQuery(document).on("click",".tb-video-tools-menu-dropdown-tag-translator",function(e){e.preventDefault();if(window.location.href.indexOf("edit")>-1){var t=[];jQuery("#outer").find("div.ytcp-chip").each(function(e){t.push(jQuery(this).text())});TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyTagTranslator.Show(t);i();e.stopPropagation()}else{var o=jQuery(this).find("a").attr("href");var r=window.open(o,"_blank")}});jQuery(document).on("click",".tb-studio-video-edit-dropdown",function(e){e.stopPropagation();if(jQuery(this).attr("menu-open")){i()}else{jQuery(this).attr("menu-open",true);var t=r();var o=n();var a=s();if(jQuery("#tb-videosmenu-quicklinks-tab:visible")){var l=jQuery("#tb-video-tools-menu-studio-dropdown-template").html();var d=l.formatTemplate(t,o,a);jQuery("ytcp-navigation-drawer.ytcp-entity-page").prepend(DOMPurify.sanitize(d,DOMPurifyConfig));var u=TBGlobal.host+TBGlobal.apiUrls.youTubeVideosGetVideoStatus+"?videoId="+r();TBExtension.Get(u,"CRTBEditVideoAnnotationsLoadVideoStudioStatus")}jQuery("#tb-video-menu-studio-overview").css("left","200px");jQuery("#tb-video-menu-studio-overview").removeClass("tb-hid");jQuery("#tb-video-menu-studio-overview").show()}});jQuery(document).on("click",".tb-video-menu-studio-tab-header",function(){jQuery(this).parent().find(".tb-video-menu-studio-tab-header").removeClass("selected tb-selected");jQuery(this).addClass("selected tb-selected");jQuery(this).parent().parent().find(".tb-video-edit-studio-menu-tab-container").hide();jQuery(this).parent().parent().find("#"+jQuery(this).attr("data-tab-id")).show();if(jQuery(this).attr("data-tab-id")==="tb-videosmenu-quicklinks-tab"){const e="Video Studio Menu";const t=TBGlobal.GetToolById("quicklinksmenu").name;TBUtilities.ReportProductEvent("Feature Used",{Tool:e,Action:`${t} on ${e}`})}var e=r();var t=n();var i=s();jQuery(this).closest("div").find(".tb-videos-list-info-video-id").val(e);jQuery(this).closest("div").find(".tb-videos-list-info-video-link").val("https://youtu.be/"+e);jQuery(".tb-video-id-copy").attr("data-clipboard-text",e);var o=new ClipboardJS(".tb-video-id-copy");jQuery(".tb-video-link-copy").attr("data-clipboard-text","https://youtu.be/"+e);var a=new ClipboardJS(".tb-video-link-copy");d(e)});jQuery(document).on("click",".tb-video-tools-menu-video-overview, .tb-video-menu-overview",function(e){e.stopPropagation()});jQuery(document).on("click","#entity-page",function(){i()});jQuery(document).on("change",".tb-video-tools-menu-comment-filters",function(e){if(jQuery(this).val()=="filter")return;var t=jQuery(this).val();localStorage.setItem("tb-quicklinks-video-comments-studio-filter-"+TBGlobal.CurrentChannelId(),t);var i=window.open("https://studio.youtube.com/video/"+r()+"/comments/inbox?filter=[]","_blank");jQuery(this).val("filter");e.stopPropagation()});jQuery(document).on("click",".tb-video-tools-menu-dropdown-promote",function(e){var t=r();var o=n();var a=s();TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyV2VPromote.Show(t,o,a);i();e.stopPropagation()});jQuery(document).on("click",".tb-video-tools-menu-dropdown-twitter",function(e){var t=r();var o=n();var a=s();TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyTwitterPost.Show(t,o,a);i();e.stopPropagation()});jQuery(document).on("click",".tb-video-tools-menu-dropdown-captions",function(e){var t=r();var o=n();var a=s();TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyTranscriptions.Show(t,o,a);i();e.stopPropagation()});jQuery(document).on("click",".tb-video-tools-menu-dropdown-copy-cards",function(e){var t=r();var o=n();var a=s();TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyCardsStudio.Show(t,o,a);i();e.stopPropagation()});jQuery(document).on("click",".tb-video-tools-menu-dropdown-embed",function(e){var t=r();var o=n();var a=s();TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyEmbed.ShowForVideo(t,o,a);i();e.stopPropagation()});jQuery(document).on("click",".tb-video-tools-menu-dropdown-share-tracker",function(e){var t=r();var o=n();var a=s();TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyShareTracker.ShowForVideo(t,o,a);i();e.stopPropagation()});jQuery(document).on("click",".tb-video-tools-menu-dropdown-search-ranking",function(e){var t=r();var o=n();var a=s();TubeBuddyMenu.ShowBackgroundSticky();TubeBuddySearchRanking.Show(t,a,o);i();e.stopPropagation()});jQuery(document).on("click",".tb-video-tools-menu-dropdown-thumbnail-creator",function(e){var t=r();var o=n();var d=s();var u=a();var c=l(t);TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyThumbnailGenerator.Show(t,o,d,u,c);i();e.stopPropagation()});jQuery(document).on("click",".tb-video-tools-menu-dropdown-pick-a-winner",function(e){var t=r();var o=n();var a=s();TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyPickAWinner.Show(t,a,o);i();e.stopPropagation()});jQuery(document).on("click",".tb-video-tools-menu-dropdown-export-to-facebook",function(e){var t=r();var o=n();var a=s();TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyPublishToFacebook.Show(t,a,o);i();e.stopPropagation()});jQuery(document).on("click",".tb-video-tools-menu-dropdown-sunset-video",function(e){var t=r();var o=n();var a=s();TubeBuddyMenu.ShowBackgroundSticky();TubeBuddySunsetVideo.Show(t,o,a);i();e.stopPropagation()});jQuery(document).on("click",".tb-video-tools-menu-dropdown-golive-video",function(e){var t=r();var o=n();var a=s();TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyScheduledPublish.Show(t,o,a);i();e.stopPropagation()});jQuery(document).on("click",".tb-video-tools-menu-dropdown-scheduled-video-update-video",function(e){var t=r();var o=n();var a=s();TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyScheduledMetaUpdates.Show(t,o,a);i();e.stopPropagation()});jQuery(document).on("click",".tb-video-tools-menu-dropdown-apply-card-template",function(e){var t=r();var o=n();var a=s();TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyCardTemplatesStudio.Show(t,o,a);i();e.stopPropagation()});jQuery(document).on("click",".tb-video-tools-menu-dropdown-copy-endscreen",function(e){var t=r();var o=n();var a=s();TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyEndScreens.Show(t,o,a);i();e.stopPropagation()});jQuery(document).on("click",".tb-video-tools-menu-dropdown-apply-endscreen-template",function(e){var t=r();var o=n();var a=s();TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyEndScreenTemplatesStudio.Show(t,o,a);i();e.stopPropagation()});jQuery(document).on("click","a",function(){var e=jQuery(this).attr("id");if(e=="back-button"||e=="home-button"||e=="Comments"||e=="AnalyticsRealtime")jQuery("#tb-video-edit-studio-tools-menu-dropdown").hide();if(e=="video-title")jQuery("#tb-video-edit-studio-tools-menu-dropdown").show()});jQuery(document).on("click","ul.tb-menu-quick-list li",function(){var e=jQuery(this).find("a.tb-menu-item").text();if(e=="Dashboard"||e=="My Videos"){jQuery("#tb-video-edit-studio-tools-menu-dropdown").hide()}})};var p=function(){jQuery(document.body).on("CRTBLoadVideoMenuStudio",function(e,i){try{if(i.success){i.response=TBUtilities.FixLocalHtml(DOMPurify.sanitize(i.response,DOMPurifyConfig));jQuery("body").append(i.response);t()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyVideoMenuStudio] CRTBLoadVideoMenuStudio"})}});jQuery(document.body).on("CRTBEditVideoAnnotationsLoadVideoStudioStatus",function(e,t){if(t.success){var i=JSON.parse(t.response);if(i.DateThumbnailGeneratedLocal){jQuery(".tb-video-tools-menu-thumbnail-generated-date").text(i.DateThumbnailGeneratedLocal);jQuery(".tb-video-tools-menu-thumbnail-generated").show();jQuery(".tb-video-tools-menu-notes").show()}if(i.IsCardTemplate){jQuery(".tb-video-tools-menu-is-card-template").show();jQuery(".tb-video-tools-menu-notes").show()}if(i.DateFacebookPostedLocal){jQuery(".tb-video-tools-menu-facebook-date").text(i.DateFacebookPostedLocal);jQuery(".tb-video-tools-menu-view-facebook").attr("href","https://www.facebook.com/video/video.php?v="+i.FacebookVideoId);jQuery(".tb-video-tools-menu-facebook").show();jQuery(".tb-video-tools-menu-notes").show()}if(i.ScheduledGoLiveLocal){jQuery(".tb-video-tools-menu-golive-date").text(i.ScheduledGoLiveLocal);jQuery(".tb-video-tools-menu-golive").show();jQuery(".tb-video-tools-menu-notes").show()}if(i.DateWentLiveLocal){jQuery(".tb-video-tools-menu-wentlive-date").text(i.DateWentLiveLocal);jQuery(".tb-video-tools-menu-wentlive").show();jQuery(".tb-video-tools-menu-notes").show()}if(i.DateSunsetLocal){jQuery(".tb-video-tools-menu-sunset-date").text(i.DateSunsetLocal);jQuery(".tb-video-tools-menu-sunset").show();jQuery(".tb-video-tools-menu-notes").show()}if(i.DateSunsettedLocal){jQuery(".tb-video-tools-menu-sunsetted-date").text(i.DateSunsettedLocal);jQuery(".tb-video-tools-menu-sunsetted").show();jQuery(".tb-video-tools-menu-notes").show()}if(i.DateScheduledMetaUpdate){jQuery(menuContainer).find(".tb-video-tools-menu-scheduledmetaupdate-date").text(i.DateScheduledMetaUpdateLocal);jQuery(menuContainer).find(".tb-video-tools-menu-scheduledmetaupdate").show();jQuery(menuContainer).find(".tb-video-tools-menu-notes").show()}if(i.DateScheduledMetaUpdated){jQuery(menuContainer).find(".tb-video-tools-menu-scheduledmetaupdated-date").text(i.DateScheduledMetaUpdatedLocal);jQuery(menuContainer).find(".tb-video-tools-menu-scheduledmetaupdated").show();jQuery(menuContainer).find(".tb-video-tools-menu-notes").show()}if(i.SharedWithNetworks!=null){jQuery(".tb-video-tools-menu-share-tracker-items").show();jQuery.each(i.SharedWithNetworks,function(e,t){var i='<img src="'+TBGlobal.host+"/images/icons/social/"+t+'.png" style="height:12px;" /> ';jQuery(".tb-video-tools-menu-share-tracker-items-list").append(DOMPurify.sanitize(i,DOMPurifyConfig))});jQuery(".tb-video-tools-menu-notes").show()}}else{}})};return{Initialize:function(){if(TBGlobal.IsAuthenticated()){if(!e){p();o();c();e=true}else{o()}}}}}();(()=>{"use strict";function e(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,o)}return i}function t(t){for(var i=1;i<arguments.length;i++){var r=null!=arguments[i]?arguments[i]:{};i%2?e(Object(r),!0).forEach(function(e){o(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):e(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function o(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},r.apply(this,arguments)}function n(e,t){if(null==e)return{};var i,o,r=function(e,t){if(null==e)return{};var i,o,r={},n=Object.keys(e);for(o=0;o<n.length;o++)i=n[o],t.indexOf(i)>=0||(r[i]=e[i]);return r}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(o=0;o<n.length;o++)i=n[o],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function a(e){if("undefined"!=typeof window&&window.navigator)return!!navigator.userAgent.match(e)}var s=a(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),l=a(/Edge/i),d=a(/firefox/i),u=a(/safari/i)&&!a(/chrome/i)&&!a(/android/i),c=a(/iP(ad|od|hone)/i),p=a(/chrome/i)&&a(/android/i),h={capture:!1,passive:!1};function y(e,t,i){e.addEventListener(t,i,!s&&h)}function b(e,t,i){e.removeEventListener(t,i,!s&&h)}function f(e,t){if(t){if(">"===t[0]&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch(e){return!1}return!1}}function m(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function v(e,t,i,o){if(e){i=i||document;do{if(null!=t&&(">"===t[0]?e.parentNode===i&&f(e,t):f(e,t))||o&&e===i)return e;if(e===i)break}while(e=m(e))}return null}var g,T=/\s+/g;function w(e,t,i){if(e&&t)if(e.classList)e.classList[i?"add":"remove"](t);else{var o=(" "+e.className+" ").replace(T," ").replace(" "+t+" "," ");e.className=(o+(i?" "+t:"")).replace(T," ")}}function k(e,t,i){var o=e&&e.style;if(o){if(void 0===i)return document.defaultView&&document.defaultView.getComputedStyle?i=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(i=e.currentStyle),void 0===t?i:i[t];t in o||-1!==t.indexOf("webkit")||(t="-webkit-"+t),o[t]=i+("string"==typeof i?"":"px")}}function x(e,t){var i="";if("string"==typeof e)i=e;else do{var o=k(e,"transform");o&&"none"!==o&&(i=o+" "+i)}while(!t&&(e=e.parentNode));var r=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return r&&new r(i)}function B(e,t,i){if(e){var o=e.getElementsByTagName(t),r=0,n=o.length;if(i)for(;r<n;r++)i(o[r],r);return o}return[]}function j(){return document.scrollingElement||document.documentElement}function L(e,t,i,o,r){if(e.getBoundingClientRect||e===window){var n,a,l,d,u,c,p;if(e!==window&&e.parentNode&&e!==j()?(a=(n=e.getBoundingClientRect()).top,l=n.left,d=n.bottom,u=n.right,c=n.height,p=n.width):(a=0,l=0,d=window.innerHeight,u=window.innerWidth,c=window.innerHeight,p=window.innerWidth),(t||i)&&e!==window&&(r=r||e.parentNode,!s))do{if(r&&r.getBoundingClientRect&&("none"!==k(r,"transform")||i&&"static"!==k(r,"position"))){var h=r.getBoundingClientRect();a-=h.top+parseInt(k(r,"border-top-width")),l-=h.left+parseInt(k(r,"border-left-width")),d=a+n.height,u=l+n.width;break}}while(r=r.parentNode);if(o&&e!==window){var y=x(r||e),b=y&&y.a,f=y&&y.d;y&&(d=(a/=f)+(c/=f),u=(l/=b)+(p/=b))}return{top:a,left:l,bottom:d,right:u,width:p,height:c}}}function C(e,t,i){for(var o=A(e,!0),r=L(e)[t];o;){var n=L(o)[i];if(!("top"===i||"left"===i?r>=n:r<=n))return o;if(o===j())break;o=A(o,!1)}return!1}function Q(e,t,i,o){for(var r=0,n=0,a=e.children;n<a.length;){if("none"!==a[n].style.display&&a[n]!==De.ghost&&(o||a[n]!==De.dragged)&&v(a[n],i.draggable,e,!1)){if(r===t)return a[n];r++}n++}return null}function U(e,t){for(var i=e.lastElementChild;i&&(i===De.ghost||"none"===k(i,"display")||t&&!f(i,t));)i=i.previousElementSibling;return i||null}function I(e,t){var i=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)"TEMPLATE"===e.nodeName.toUpperCase()||e===De.clone||t&&!f(e,t)||i++;return i}function S(e){var t=0,i=0,o=j();if(e)do{var r=x(e),n=r.a,a=r.d;t+=e.scrollLeft*n,i+=e.scrollTop*a}while(e!==o&&(e=e.parentNode));return[t,i]}function A(e,t){if(!e||!e.getBoundingClientRect)return j();var i=e,o=!1;do{if(i.clientWidth<i.scrollWidth||i.clientHeight<i.scrollHeight){var r=k(i);if(i.clientWidth<i.scrollWidth&&("auto"==r.overflowX||"scroll"==r.overflowX)||i.clientHeight<i.scrollHeight&&("auto"==r.overflowY||"scroll"==r.overflowY)){if(!i.getBoundingClientRect||i===document.body)return j();if(o||t)return i;o=!0}}}while(i=i.parentNode);return j()}function E(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}function D(e,t){return function(){if(!g){var i=arguments,o=this;1===i.length?e.call(o,i[0]):e.apply(o,i),g=setTimeout(function(){g=void 0},t)}}}function R(e,t,i){e.scrollLeft+=t,e.scrollTop+=i}function P(e){var t=window.Polymer,i=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):i?i(e).clone(!0)[0]:e.cloneNode(!0)}var G="Sortable"+(new Date).getTime();var O=[],V={initializeByDefault:!0},_={mount:function(e){for(var t in V)V.hasOwnProperty(t)&&!(t in e)&&(e[t]=V[t]);O.forEach(function(t){if(t.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),O.push(e)},pluginEvent:function(e,i,o){var r=this;this.eventCanceled=!1,o.cancel=function(){r.eventCanceled=!0};var n=e+"Global";O.forEach(function(r){i[r.pluginName]&&(i[r.pluginName][n]&&i[r.pluginName][n](t({sortable:i},o)),i.options[r.pluginName]&&i[r.pluginName][e]&&i[r.pluginName][e](t({sortable:i},o)))})},initializePlugins:function(e,t,i,o){for(var n in O.forEach(function(o){var n=o.pluginName;if(e.options[n]||o.initializeByDefault){var a=new o(e,t,e.options);a.sortable=e,a.options=e.options,e[n]=a,r(i,a.defaults)}}),e.options)if(e.options.hasOwnProperty(n)){var a=this.modifyOption(e,n,e.options[n]);void 0!==a&&(e.options[n]=a)}},getEventProperties:function(e,t){var i={};return O.forEach(function(o){"function"==typeof o.eventProperties&&r(i,o.eventProperties.call(t[o.pluginName],e))}),i},modifyOption:function(e,t,i){var o;return O.forEach(function(r){e[r.pluginName]&&r.optionListeners&&"function"==typeof r.optionListeners[t]&&(o=r.optionListeners[t].call(e[r.pluginName],i))}),o}};var M=["evt"],F=function(e,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=o.evt,a=n(o,M);_.pluginEvent.bind(De)(e,i,t({dragEl:Y,parentEl:H,ghostEl:W,rootEl:z,nextEl:q,lastDownEl:K,cloneEl:J,cloneHidden:X,dragStarted:ue,putSortable:oe,activeSortable:De.active,originalEvent:r,oldIndex:Z,oldDraggableIndex:ee,newIndex:$,newDraggableIndex:te,hideGhostForTarget:Ie,unhideGhostForTarget:Se,cloneNowHidden:function(){X=!0},cloneNowShown:function(){X=!1},dispatchSortableEvent:function(e){N({sortable:i,name:e,originalEvent:r})}},a))};function N(e){!function(e){var i=e.sortable,o=e.rootEl,r=e.name,n=e.targetEl,a=e.cloneEl,d=e.toEl,u=e.fromEl,c=e.oldIndex,p=e.newIndex,h=e.oldDraggableIndex,y=e.newDraggableIndex,b=e.originalEvent,f=e.putSortable,m=e.extraEventProperties;if(i=i||o&&o[G]){var v,g=i.options,T="on"+r.charAt(0).toUpperCase()+r.substr(1);!window.CustomEvent||s||l?(v=document.createEvent("Event")).initEvent(r,!0,!0):v=new CustomEvent(r,{bubbles:!0,cancelable:!0}),v.to=d||o,v.from=u||o,v.item=n||o,v.clone=a,v.oldIndex=c,v.newIndex=p,v.oldDraggableIndex=h,v.newDraggableIndex=y,v.originalEvent=b,v.pullMode=f?f.lastPutMode:void 0;var w=t(t({},m),_.getEventProperties(r,i));for(var k in w)v[k]=w[k];o&&o.dispatchEvent(v),g[T]&&g[T].call(i,v)}}(t({putSortable:oe,cloneEl:J,targetEl:Y,rootEl:z,oldIndex:Z,oldDraggableIndex:ee,newIndex:$,newDraggableIndex:te},e))}var Y,H,W,z,q,K,J,X,Z,$,ee,te,ie,oe,re,ne,ae,se,le,de,ue,ce,pe,he,ye,be=!1,fe=!1,me=[],ve=!1,ge=!1,Te=[],we=!1,ke=[],xe="undefined"!=typeof document,Be=c,je=l||s?"cssFloat":"float",Le=xe&&!p&&!c&&"draggable"in document.createElement("div"),Ce=function(){if(xe){if(s)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto","auto"===e.style.pointerEvents}}(),Qe=function(e,t){var i=k(e),o=parseInt(i.width)-parseInt(i.paddingLeft)-parseInt(i.paddingRight)-parseInt(i.borderLeftWidth)-parseInt(i.borderRightWidth),r=Q(e,0,t),n=Q(e,1,t),a=r&&k(r),s=n&&k(n),l=a&&parseInt(a.marginLeft)+parseInt(a.marginRight)+L(r).width,d=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+L(n).width;if("flex"===i.display)return"column"===i.flexDirection||"column-reverse"===i.flexDirection?"vertical":"horizontal";if("grid"===i.display)return i.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(r&&a.float&&"none"!==a.float){var u="left"===a.float?"left":"right";return!n||"both"!==s.clear&&s.clear!==u?"horizontal":"vertical"}return r&&("block"===a.display||"flex"===a.display||"table"===a.display||"grid"===a.display||l>=o&&"none"===i[je]||n&&"none"===i[je]&&l+d>o)?"vertical":"horizontal"},Ue=function(e){function t(e,i){return function(o,r,n,a){var s=o.options.group.name&&r.options.group.name&&o.options.group.name===r.options.group.name;if(null==e&&(i||s))return!0;if(null==e||!1===e)return!1;if(i&&"clone"===e)return e;if("function"==typeof e)return t(e(o,r,n,a),i)(o,r,n,a);var l=(i?o:r).options.group.name;return!0===e||"string"==typeof e&&e===l||e.join&&e.indexOf(l)>-1}}var o={},r=e.group;r&&"object"==i(r)||(r={name:r}),o.name=r.name,o.checkPull=t(r.pull,!0),o.checkPut=t(r.put),o.revertClone=r.revertClone,e.group=o},Ie=function(){!Ce&&W&&k(W,"display","none")},Se=function(){!Ce&&W&&k(W,"display","")};xe&&document.addEventListener("click",function(e){if(fe)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),fe=!1,!1},!0);var Ae=function(e){if(Y){e=e.touches?e.touches[0]:e;var t=(r=e.clientX,n=e.clientY,me.some(function(e){var t=e[G].options.emptyInsertThreshold;if(t&&!U(e)){var i=L(e),o=r>=i.left-t&&r<=i.right+t,s=n>=i.top-t&&n<=i.bottom+t;return o&&s?a=e:void 0}}),a);if(t){var i={};for(var o in e)e.hasOwnProperty(o)&&(i[o]=e[o]);i.target=i.rootEl=t,i.preventDefault=void 0,i.stopPropagation=void 0,t[G]._onDragOver(i)}}var r,n,a},Ee=function(e){Y&&Y.parentNode[G]._isOutsideThisEl(e.target)};function De(e,i){if(!e||!e.nodeType||1!==e.nodeType)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=i=r({},i),e[G]=this;var o,n,a={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Qe(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(e,t){e.setData("Text",t.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==De.supportPointer&&"PointerEvent"in window&&!u,emptyInsertThreshold:5};for(var s in _.initializePlugins(this,e,a),a)!(s in i)&&(i[s]=a[s]);for(var l in Ue(i),this)"_"===l.charAt(0)&&"function"==typeof this[l]&&(this[l]=this[l].bind(this));this.nativeDraggable=!i.forceFallback&&Le,this.nativeDraggable&&(this.options.touchStartThreshold=1),i.supportPointer?y(e,"pointerdown",this._onTapStart):(y(e,"mousedown",this._onTapStart),y(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(y(e,"dragover",this),y(e,"dragenter",this)),me.push(this.el),i.store&&i.store.get&&this.sort(i.store.get(this)||[]),r(this,(n=[],{captureAnimationState:function(){n=[],this.options.animation&&[].slice.call(this.el.children).forEach(function(e){if("none"!==k(e,"display")&&e!==De.ghost){n.push({target:e,rect:L(e)});var i=t({},n[n.length-1].rect);if(e.thisAnimationDuration){var o=x(e,!0);o&&(i.top-=o.f,i.left-=o.e)}e.fromRect=i}})},addAnimationState:function(e){n.push(e)},removeAnimationState:function(e){n.splice(function(e,t){for(var i in e)if(e.hasOwnProperty(i))for(var o in t)if(t.hasOwnProperty(o)&&t[o]===e[i][o])return Number(i);return-1}(n,{target:e}),1)},animateAll:function(e){var t=this;if(!this.options.animation)return clearTimeout(o),void("function"==typeof e&&e());var i=!1,r=0;n.forEach(function(e){var o=0,n=e.target,a=n.fromRect,s=L(n),l=n.prevFromRect,d=n.prevToRect,u=e.rect,c=x(n,!0);c&&(s.top-=c.f,s.left-=c.e),n.toRect=s,n.thisAnimationDuration&&E(l,s)&&!E(a,s)&&(u.top-s.top)/(u.left-s.left)==(a.top-s.top)/(a.left-s.left)&&(o=function(e,t,i,o){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-i.top,2)+Math.pow(t.left-i.left,2))*o.animation}(u,l,d,t.options)),E(s,a)||(n.prevFromRect=a,n.prevToRect=s,o||(o=t.options.animation),t.animate(n,u,s,o)),o&&(i=!0,r=Math.max(r,o),clearTimeout(n.animationResetTimer),n.animationResetTimer=setTimeout(function(){n.animationTime=0,n.prevFromRect=null,n.fromRect=null,n.prevToRect=null,n.thisAnimationDuration=null},o),n.thisAnimationDuration=o)}),clearTimeout(o),i?o=setTimeout(function(){"function"==typeof e&&e()},r):"function"==typeof e&&e(),n=[]},animate:function(e,t,i,o){if(o){k(e,"transition",""),k(e,"transform","");var r=x(this.el),n=r&&r.a,a=r&&r.d,s=(t.left-i.left)/(n||1),l=(t.top-i.top)/(a||1);e.animatingX=!!s,e.animatingY=!!l,k(e,"transform","translate3d("+s+"px,"+l+"px,0)"),this.forRepaintDummy=function(e){return e.offsetWidth}(e),k(e,"transition","transform "+o+"ms"+(this.options.easing?" "+this.options.easing:"")),k(e,"transform","translate3d(0,0,0)"),"number"==typeof e.animated&&clearTimeout(e.animated),e.animated=setTimeout(function(){k(e,"transition",""),k(e,"transform",""),e.animated=!1,e.animatingX=!1,e.animatingY=!1},o)}}}))}function Re(e,t,i,o,r,n,a,d){var u,c,p=e[G],h=p.options.onMove;return!window.CustomEvent||s||l?(u=document.createEvent("Event")).initEvent("move",!0,!0):u=new CustomEvent("move",{bubbles:!0,cancelable:!0}),u.to=t,u.from=e,u.dragged=i,u.draggedRect=o,u.related=r||t,u.relatedRect=n||L(t),u.willInsertAfter=d,u.originalEvent=a,e.dispatchEvent(u),h&&(c=h.call(p,u,a)),c}function Pe(e){e.draggable=!1}function Ge(){we=!1}function Oe(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,i=t.length,o=0;i--;)o+=t.charCodeAt(i);return o.toString(36)}function Ve(e){return setTimeout(e,0)}function _e(e){return clearTimeout(e)}De.prototype={constructor:De,_isOutsideThisEl:function(e){this.el.contains(e)||e===this.el||(ce=null)},_getDirection:function(e,t){return"function"==typeof this.options.direction?this.options.direction.call(this,e,t,Y):this.options.direction},_onTapStart:function(e){if(e.cancelable){var t=this,i=this.el,o=this.options,r=o.preventOnFilter,n=e.type,a=e.touches&&e.touches[0]||e.pointerType&&"touch"===e.pointerType&&e,s=(a||e).target,l=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||s,d=o.filter;if(function(e){ke.length=0;for(var t=e.getElementsByTagName("input"),i=t.length;i--;){var o=t[i];o.checked&&ke.push(o)}}(i),!Y&&!(/mousedown|pointerdown/.test(n)&&0!==e.button||o.disabled)&&!l.isContentEditable&&(this.nativeDraggable||!u||!s||"SELECT"!==s.tagName.toUpperCase())&&!((s=v(s,o.draggable,i,!1))&&s.animated||K===s)){if(Z=I(s),ee=I(s,o.draggable),"function"==typeof d){if(d.call(this,e,s,this))return N({sortable:t,rootEl:l,name:"filter",targetEl:s,toEl:i,fromEl:i}),F("filter",t,{evt:e}),void(r&&e.cancelable&&e.preventDefault())}else if(d&&(d=d.split(",").some(function(o){if(o=v(l,o.trim(),i,!1))return N({sortable:t,rootEl:o,name:"filter",targetEl:s,fromEl:i,toEl:i}),F("filter",t,{evt:e}),!0})))return void(r&&e.cancelable&&e.preventDefault());o.handle&&!v(l,o.handle,i,!1)||this._prepareDragStart(e,a,s)}}},_prepareDragStart:function(e,t,i){var o,r=this,n=r.el,a=r.options,u=n.ownerDocument;if(i&&!Y&&i.parentNode===n){var c=L(i);if(z=n,H=(Y=i).parentNode,q=Y.nextSibling,K=i,ie=a.group,De.dragged=Y,re={target:Y,clientX:(t||e).clientX,clientY:(t||e).clientY},le=re.clientX-c.left,de=re.clientY-c.top,this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,Y.style["will-change"]="all",o=function(){F("delayEnded",r,{evt:e}),De.eventCanceled?r._onDrop():(r._disableDelayedDragEvents(),!d&&r.nativeDraggable&&(Y.draggable=!0),r._triggerDragStart(e,t),N({sortable:r,name:"choose",originalEvent:e}),w(Y,a.chosenClass,!0))},a.ignore.split(",").forEach(function(e){B(Y,e.trim(),Pe)}),y(u,"dragover",Ae),y(u,"mousemove",Ae),y(u,"touchmove",Ae),y(u,"mouseup",r._onDrop),y(u,"touchend",r._onDrop),y(u,"touchcancel",r._onDrop),d&&this.nativeDraggable&&(this.options.touchStartThreshold=4,Y.draggable=!0),F("delayStart",this,{evt:e}),!a.delay||a.delayOnTouchOnly&&!t||this.nativeDraggable&&(l||s))o();else{if(De.eventCanceled)return void this._onDrop();y(u,"mouseup",r._disableDelayedDrag),y(u,"touchend",r._disableDelayedDrag),y(u,"touchcancel",r._disableDelayedDrag),y(u,"mousemove",r._delayedDragTouchMoveHandler),y(u,"touchmove",r._delayedDragTouchMoveHandler),a.supportPointer&&y(u,"pointermove",r._delayedDragTouchMoveHandler),r._dragStartTimer=setTimeout(o,a.delay)}}},_delayedDragTouchMoveHandler:function(e){var t=e.touches?e.touches[0]:e;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){Y&&Pe(Y),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;b(e,"mouseup",this._disableDelayedDrag),b(e,"touchend",this._disableDelayedDrag),b(e,"touchcancel",this._disableDelayedDrag),b(e,"mousemove",this._delayedDragTouchMoveHandler),b(e,"touchmove",this._delayedDragTouchMoveHandler),b(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||"touch"==e.pointerType&&e,!this.nativeDraggable||t?this.options.supportPointer?y(document,"pointermove",this._onTouchMove):y(document,t?"touchmove":"mousemove",this._onTouchMove):(y(Y,"dragend",this),y(z,"dragstart",this._onDragStart));try{document.selection?Ve(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch(e){}},_dragStarted:function(e,t){if(be=!1,z&&Y){F("dragStarted",this,{evt:t}),this.nativeDraggable&&y(document,"dragover",Ee);var i=this.options;!e&&w(Y,i.dragClass,!1),w(Y,i.ghostClass,!0),De.active=this,e&&this._appendGhost(),N({sortable:this,name:"start",originalEvent:t})}else this._nulling()},_emulateDragOver:function(){if(ne){this._lastX=ne.clientX,this._lastY=ne.clientY,Ie();for(var e=document.elementFromPoint(ne.clientX,ne.clientY),t=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(ne.clientX,ne.clientY))!==t;)t=e;if(Y.parentNode[G]._isOutsideThisEl(e),t)do{if(t[G]&&t[G]._onDragOver({clientX:ne.clientX,clientY:ne.clientY,target:e,rootEl:t})&&!this.options.dragoverBubble)break;e=t}while(t=t.parentNode);Se()}},_onTouchMove:function(e){if(re){var t=this.options,i=t.fallbackTolerance,o=t.fallbackOffset,r=e.touches?e.touches[0]:e,n=W&&x(W,!0),a=W&&n&&n.a,s=W&&n&&n.d,l=Be&&ye&&S(ye),d=(r.clientX-re.clientX+o.x)/(a||1)+(l?l[0]-Te[0]:0)/(a||1),u=(r.clientY-re.clientY+o.y)/(s||1)+(l?l[1]-Te[1]:0)/(s||1);if(!De.active&&!be){if(i&&Math.max(Math.abs(r.clientX-this._lastX),Math.abs(r.clientY-this._lastY))<i)return;this._onDragStart(e,!0)}if(W){n?(n.e+=d-(ae||0),n.f+=u-(se||0)):n={a:1,b:0,c:0,d:1,e:d,f:u};var c="matrix(".concat(n.a,",").concat(n.b,",").concat(n.c,",").concat(n.d,",").concat(n.e,",").concat(n.f,")");k(W,"webkitTransform",c),k(W,"mozTransform",c),k(W,"msTransform",c),k(W,"transform",c),ae=d,se=u,ne=r}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!W){var e=this.options.fallbackOnBody?document.body:z,t=L(Y,!0,Be,!0,e),i=this.options;if(Be){for(ye=e;"static"===k(ye,"position")&&"none"===k(ye,"transform")&&ye!==document;)ye=ye.parentNode;ye!==document.body&&ye!==document.documentElement?(ye===document&&(ye=j()),t.top+=ye.scrollTop,t.left+=ye.scrollLeft):ye=j(),Te=S(ye)}w(W=Y.cloneNode(!0),i.ghostClass,!1),w(W,i.fallbackClass,!0),w(W,i.dragClass,!0),k(W,"transition",""),k(W,"transform",""),k(W,"box-sizing","border-box"),k(W,"margin",0),k(W,"top",t.top),k(W,"left",t.left),k(W,"width",t.width),k(W,"height",t.height),k(W,"opacity","0.8"),k(W,"position",Be?"absolute":"fixed"),k(W,"zIndex","100000"),k(W,"pointerEvents","none"),De.ghost=W,e.appendChild(W),k(W,"transform-origin",le/parseInt(W.style.width)*100+"% "+de/parseInt(W.style.height)*100+"%")}},_onDragStart:function(e,t){var i=this,o=e.dataTransfer,r=i.options;F("dragStart",this,{evt:e}),De.eventCanceled?this._onDrop():(F("setupClone",this),De.eventCanceled||((J=P(Y)).draggable=!1,J.style["will-change"]="",this._hideClone(),w(J,this.options.chosenClass,!1),De.clone=J),i.cloneId=Ve(function(){F("clone",i),De.eventCanceled||(i.options.removeCloneOnHide||z.insertBefore(J,Y),i._hideClone(),N({sortable:i,name:"clone"}))}),!t&&w(Y,r.dragClass,!0),t?(fe=!0,i._loopId=setInterval(i._emulateDragOver,50)):(b(document,"mouseup",i._onDrop),b(document,"touchend",i._onDrop),b(document,"touchcancel",i._onDrop),o&&(o.effectAllowed="move",r.setData&&r.setData.call(i,o,Y)),y(document,"drop",i),k(Y,"transform","translateZ(0)")),be=!0,i._dragStartId=Ve(i._dragStarted.bind(i,t,e)),y(document,"selectstart",i),ue=!0,u&&k(document.body,"user-select","none"))},_onDragOver:function(e){var i,o,r,n,a=this.el,s=e.target,l=this.options,d=l.group,u=De.active,c=ie===d,p=l.sort,h=oe||u,y=this,b=!1;if(!we){if(void 0!==e.preventDefault&&e.cancelable&&e.preventDefault(),s=v(s,l.draggable,a,!0),_("dragOver"),De.eventCanceled)return b;if(Y.contains(e.target)||s.animated&&s.animatingX&&s.animatingY||y._ignoreWhileAnimating===s)return K(!1);if(fe=!1,u&&!l.disabled&&(c?p||(r=H!==z):oe===this||(this.lastPutMode=ie.checkPull(this,u,Y,e))&&d.checkPut(this,u,Y,e))){if(n="vertical"===this._getDirection(e,s),i=L(Y),_("dragOverValid"),De.eventCanceled)return b;if(r)return H=z,M(),this._hideClone(),_("revert"),De.eventCanceled||(q?z.insertBefore(Y,q):z.appendChild(Y)),K(!0);var f=U(a,l.draggable);if(!f||function(e,t,i){var o=L(U(i.el,i.options.draggable));return t?e.clientX>o.right+10||e.clientX<=o.right&&e.clientY>o.bottom&&e.clientX>=o.left:e.clientX>o.right&&e.clientY>o.top||e.clientX<=o.right&&e.clientY>o.bottom+10}(e,n,this)&&!f.animated){if(f===Y)return K(!1);if(f&&a===e.target&&(s=f),s&&(o=L(s)),!1!==Re(z,a,Y,i,s,o,e,!!s))return M(),a.appendChild(Y),H=a,J(),K(!0)}else if(f&&function(e,t,i){var o=L(Q(i.el,0,i.options,!0));return t?e.clientX<o.left-10||e.clientY<o.top&&e.clientX<o.right:e.clientY<o.top-10||e.clientY<o.bottom&&e.clientX<o.left}(e,n,this)){var m=Q(a,0,l,!0);if(m===Y)return K(!1);if(o=L(s=m),!1!==Re(z,a,Y,i,s,o,e,!1))return M(),a.insertBefore(Y,m),H=a,J(),K(!0)}else if(s.parentNode===a){o=L(s);var g,T,x,B=Y.parentNode!==a,j=!function(e,t,i){var o=i?e.left:e.top,r=i?e.right:e.bottom,n=i?e.width:e.height,a=i?t.left:t.top,s=i?t.right:t.bottom,l=i?t.width:t.height;return o===a||r===s||o+n/2===a+l/2}(Y.animated&&Y.toRect||i,s.animated&&s.toRect||o,n),S=n?"top":"left",A=C(s,"top","top")||C(Y,"top","top"),E=A?A.scrollTop:void 0;if(ce!==s&&(T=o[S],ve=!1,ge=!j&&l.invertSwap||B),g=function(e,t,i,o,r,n,a,s){var l=o?e.clientY:e.clientX,d=o?i.height:i.width,u=o?i.top:i.left,c=o?i.bottom:i.right,p=!1;if(!a)if(s&&he<d*r){if(!ve&&(1===pe?l>u+d*n/2:l<c-d*n/2)&&(ve=!0),ve)p=!0;else if(1===pe?l<u+he:l>c-he)return-pe}else if(l>u+d*(1-r)/2&&l<c-d*(1-r)/2)return function(e){return I(Y)<I(e)?1:-1}(t);return(p=p||a)&&(l<u+d*n/2||l>c-d*n/2)?l>u+d/2?1:-1:0}(e,s,o,n,j?1:l.swapThreshold,null==l.invertedSwapThreshold?l.swapThreshold:l.invertedSwapThreshold,ge,ce===s),0!==g){var D=I(Y);do{D-=g,x=H.children[D]}while(x&&("none"===k(x,"display")||x===W))}if(0===g||x===s)return K(!1);ce=s,pe=g;var P=s.nextElementSibling,O=!1,V=Re(z,a,Y,i,s,o,e,O=1===g);if(!1!==V)return 1!==V&&-1!==V||(O=1===V),we=!0,setTimeout(Ge,30),M(),O&&!P?a.appendChild(Y):s.parentNode.insertBefore(Y,O?P:s),A&&R(A,0,E-A.scrollTop),H=Y.parentNode,void 0===T||ge||(he=Math.abs(T-L(s)[S])),J(),K(!0)}if(a.contains(Y))return K(!1)}return!1}function _(l,d){F(l,y,t({evt:e,isOwner:c,axis:n?"vertical":"horizontal",revert:r,dragRect:i,targetRect:o,canSort:p,fromSortable:h,target:s,completed:K,onMove:function(t,o){return Re(z,a,Y,i,t,L(t),e,o)},changed:J},d))}function M(){_("dragOverAnimationCapture"),y.captureAnimationState(),y!==h&&h.captureAnimationState()}function K(t){return _("dragOverCompleted",{insertion:t}),t&&(c?u._hideClone():u._showClone(y),y!==h&&(w(Y,oe?oe.options.ghostClass:u.options.ghostClass,!1),w(Y,l.ghostClass,!0)),oe!==y&&y!==De.active?oe=y:y===De.active&&oe&&(oe=null),h===y&&(y._ignoreWhileAnimating=s),y.animateAll(function(){_("dragOverAnimationComplete"),y._ignoreWhileAnimating=null}),y!==h&&(h.animateAll(),h._ignoreWhileAnimating=null)),(s===Y&&!Y.animated||s===a&&!s.animated)&&(ce=null),l.dragoverBubble||e.rootEl||s===document||(Y.parentNode[G]._isOutsideThisEl(e.target),!t&&Ae(e)),!l.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),b=!0}function J(){$=I(Y),te=I(Y,l.draggable),N({sortable:y,name:"change",toEl:a,newIndex:$,newDraggableIndex:te,originalEvent:e})}},_ignoreWhileAnimating:null,_offMoveEvents:function(){b(document,"mousemove",this._onTouchMove),b(document,"touchmove",this._onTouchMove),b(document,"pointermove",this._onTouchMove),b(document,"dragover",Ae),b(document,"mousemove",Ae),b(document,"touchmove",Ae)},_offUpEvents:function(){var e=this.el.ownerDocument;b(e,"mouseup",this._onDrop),b(e,"touchend",this._onDrop),b(e,"pointerup",this._onDrop),b(e,"touchcancel",this._onDrop),b(document,"selectstart",this)},_onDrop:function(e){var t=this.el,i=this.options;$=I(Y),te=I(Y,i.draggable),F("drop",this,{evt:e}),H=Y&&Y.parentNode,$=I(Y),te=I(Y,i.draggable),De.eventCanceled||(be=!1,ge=!1,ve=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),_e(this.cloneId),_e(this._dragStartId),this.nativeDraggable&&(b(document,"drop",this),b(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),u&&k(document.body,"user-select",""),k(Y,"transform",""),e&&(ue&&(e.cancelable&&e.preventDefault(),!i.dropBubble&&e.stopPropagation()),W&&W.parentNode&&W.parentNode.removeChild(W),(z===H||oe&&"clone"!==oe.lastPutMode)&&J&&J.parentNode&&J.parentNode.removeChild(J),Y&&(this.nativeDraggable&&b(Y,"dragend",this),Pe(Y),Y.style["will-change"]="",ue&&!be&&w(Y,oe?oe.options.ghostClass:this.options.ghostClass,!1),w(Y,this.options.chosenClass,!1),N({sortable:this,name:"unchoose",toEl:H,newIndex:null,newDraggableIndex:null,originalEvent:e}),z!==H?($>=0&&(N({rootEl:H,name:"add",toEl:H,fromEl:z,originalEvent:e}),N({sortable:this,name:"remove",toEl:H,originalEvent:e}),N({rootEl:H,name:"sort",toEl:H,fromEl:z,originalEvent:e}),N({sortable:this,name:"sort",toEl:H,originalEvent:e})),oe&&oe.save()):$!==Z&&$>=0&&(N({sortable:this,name:"update",toEl:H,originalEvent:e}),N({sortable:this,name:"sort",toEl:H,originalEvent:e})),De.active&&(null!=$&&-1!==$||($=Z,te=ee),N({sortable:this,name:"end",toEl:H,originalEvent:e}),this.save())))),this._nulling()},_nulling:function(){F("nulling",this),z=Y=H=W=q=J=K=X=re=ne=ue=$=te=Z=ee=ce=pe=oe=ie=De.dragged=De.ghost=De.clone=De.active=null,ke.forEach(function(e){e.checked=!0}),ke.length=ae=se=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":Y&&(this._onDragOver(e),function(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.cancelable&&e.preventDefault()}(e));break;case"selectstart":e.preventDefault()}},toArray:function(){for(var e,t=[],i=this.el.children,o=0,r=i.length,n=this.options;o<r;o++)v(e=i[o],n.draggable,this.el,!1)&&t.push(e.getAttribute(n.dataIdAttr)||Oe(e));return t},sort:function(e,t){var i={},o=this.el;this.toArray().forEach(function(e,t){var r=o.children[t];v(r,this.options.draggable,o,!1)&&(i[e]=r)},this),t&&this.captureAnimationState(),e.forEach(function(e){i[e]&&(o.removeChild(i[e]),o.appendChild(i[e]))}),t&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return v(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var i=this.options;if(void 0===t)return i[e];var o=_.modifyOption(this,e,t);i[e]=void 0!==o?o:t,"group"===e&&Ue(i)},destroy:function(){F("destroy",this);var e=this.el;e[G]=null,b(e,"mousedown",this._onTapStart),b(e,"touchstart",this._onTapStart),b(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(b(e,"dragover",this),b(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(e){e.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),me.splice(me.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!X){if(F("hideClone",this),De.eventCanceled)return;k(J,"display","none"),this.options.removeCloneOnHide&&J.parentNode&&J.parentNode.removeChild(J),X=!0}},_showClone:function(e){if("clone"===e.lastPutMode){if(X){if(F("showClone",this),De.eventCanceled)return;Y.parentNode!=z||this.options.group.revertClone?q?z.insertBefore(J,q):z.appendChild(J):z.insertBefore(J,Y),this.options.group.revertClone&&this.animate(Y,J),k(J,"display",""),X=!1}}else this._hideClone()}},xe&&y(document,"touchmove",function(e){(De.active||be)&&e.cancelable&&e.preventDefault()}),De.utils={on:y,off:b,css:k,find:B,is:function(e,t){return!!v(e,t,e,!1)},extend:function(e,t){if(e&&t)for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e},throttle:D,closest:v,toggleClass:w,clone:P,index:I,nextTick:Ve,cancelNextTick:_e,detectDirection:Qe,getChild:Q},De.get=function(e){return e[G]},De.mount=function(){for(var e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];i[0].constructor===Array&&(i=i[0]),i.forEach(function(e){if(!e.prototype||!e.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(e));e.utils&&(De.utils=t(t({},De.utils),e.utils)),_.mount(e)})},De.create=function(e,t){return new De(e,t)},De.version="1.14.0";var Me,Fe,Ne,Ye,He,We,ze=[],qe=!1;function Ke(){ze.forEach(function(e){clearInterval(e.pid)}),ze=[]}function Je(){clearInterval(We)}var Xe=D(function(e,t,i,o){if(t.scroll){var r,n=(e.touches?e.touches[0]:e).clientX,a=(e.touches?e.touches[0]:e).clientY,s=t.scrollSensitivity,l=t.scrollSpeed,d=j(),u=!1;Fe!==i&&(Fe=i,Ke(),Me=t.scroll,r=t.scrollFn,!0===Me&&(Me=A(i,!0)));var c=0,p=Me;do{var h=p,y=L(h),b=y.top,f=y.bottom,m=y.left,v=y.right,g=y.width,T=y.height,w=void 0,x=void 0,B=h.scrollWidth,C=h.scrollHeight,Q=k(h),U=h.scrollLeft,I=h.scrollTop;h===d?(w=g<B&&("auto"===Q.overflowX||"scroll"===Q.overflowX||"visible"===Q.overflowX),x=T<C&&("auto"===Q.overflowY||"scroll"===Q.overflowY||"visible"===Q.overflowY)):(w=g<B&&("auto"===Q.overflowX||"scroll"===Q.overflowX),x=T<C&&("auto"===Q.overflowY||"scroll"===Q.overflowY));var S=w&&(Math.abs(v-n)<=s&&U+g<B)-(Math.abs(m-n)<=s&&!!U),E=x&&(Math.abs(f-a)<=s&&I+T<C)-(Math.abs(b-a)<=s&&!!I);if(!ze[c])for(var D=0;D<=c;D++)ze[D]||(ze[D]={});ze[c].vx==S&&ze[c].vy==E&&ze[c].el===h||(ze[c].el=h,ze[c].vx=S,ze[c].vy=E,clearInterval(ze[c].pid),0==S&&0==E||(u=!0,ze[c].pid=setInterval(function(){o&&0===this.layer&&De.active._onTouchMove(He);var t=ze[this.layer].vy?ze[this.layer].vy*l:0,i=ze[this.layer].vx?ze[this.layer].vx*l:0;"function"==typeof r&&"continue"!==r.call(De.dragged.parentNode[G],i,t,e,He,ze[this.layer].el)||R(ze[this.layer].el,i,t)}.bind({layer:c}),24))),c++}while(t.bubbleScroll&&p!==d&&(p=A(p,!1)));qe=u}},30),Ze=function(e){var t=e.originalEvent,i=e.putSortable,o=e.dragEl,r=e.activeSortable,n=e.dispatchSortableEvent,a=e.hideGhostForTarget,s=e.unhideGhostForTarget;if(t){var l=i||r;a();var d=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,u=document.elementFromPoint(d.clientX,d.clientY);s(),l&&!l.el.contains(u)&&(n("spill"),this.onSpill({dragEl:o,putSortable:i}))}};function $e(){}function et(){}$e.prototype={startIndex:null,dragStart:function(e){var t=e.oldDraggableIndex;this.startIndex=t},onSpill:function(e){var t=e.dragEl,i=e.putSortable;this.sortable.captureAnimationState(),i&&i.captureAnimationState();var o=Q(this.sortable.el,this.startIndex,this.options);o?this.sortable.el.insertBefore(t,o):this.sortable.el.appendChild(t),this.sortable.animateAll(),i&&i.animateAll()},drop:Ze},r($e,{pluginName:"revertOnSpill"}),et.prototype={onSpill:function(e){var t=e.dragEl,i=e.putSortable||this.sortable;i.captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),i.animateAll()},drop:Ze},r(et,{pluginName:"removeOnSpill"}),De.mount(new function(){function e(){for(var e in this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0},this)"_"===e.charAt(0)&&"function"==typeof this[e]&&(this[e]=this[e].bind(this))}return e.prototype={dragStarted:function(e){var t=e.originalEvent;this.sortable.nativeDraggable?y(document,"dragover",this._handleAutoScroll):this.options.supportPointer?y(document,"pointermove",this._handleFallbackAutoScroll):t.touches?y(document,"touchmove",this._handleFallbackAutoScroll):y(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(e){var t=e.originalEvent;this.options.dragOverBubble||t.rootEl||this._handleAutoScroll(t)},drop:function(){this.sortable.nativeDraggable?b(document,"dragover",this._handleAutoScroll):(b(document,"pointermove",this._handleFallbackAutoScroll),b(document,"touchmove",this._handleFallbackAutoScroll),b(document,"mousemove",this._handleFallbackAutoScroll)),Je(),Ke(),clearTimeout(g),g=void 0},nulling:function(){He=Fe=Me=qe=We=Ne=Ye=null,ze.length=0},_handleFallbackAutoScroll:function(e){this._handleAutoScroll(e,!0)},_handleAutoScroll:function(e,t){var i=this,o=(e.touches?e.touches[0]:e).clientX,r=(e.touches?e.touches[0]:e).clientY,n=document.elementFromPoint(o,r);if(He=e,t||this.options.forceAutoScrollFallback||l||s||u){Xe(e,this.options,n,t);var a=A(n,!0);!qe||We&&o===Ne&&r===Ye||(We&&Je(),We=setInterval(function(){var n=A(document.elementFromPoint(o,r),!0);n!==a&&(a=n,Ke()),Xe(e,i.options,n,t)},10),Ne=o,Ye=r)}else{if(!this.options.bubbleScroll||A(n,!0)===j())return void Ke();Xe(e,this.options,A(n,!1),!1)}}},r(e,{pluginName:"scroll",initializeByDefault:!0})}),De.mount(et,$e);const tt=De;window.Sortable=tt})();