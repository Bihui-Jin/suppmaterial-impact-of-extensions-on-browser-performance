import '../../chunks/index-f253f80e.js';
import { t } from '../../chunks/background.injected-b956e480.js';
import { s as s$1 } from '../../chunks/router.interface-3a81c163.js';

var n,a=new Uint8Array(16);function r(){if(!n&&!(n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(a)}var i=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function o(e){return "string"==typeof e&&i.test(e)}for(var s=[],c=0;c<256;++c)s.push((c+256).toString(16).substr(1));function d(e,t,n){var a=(e=e||{}).random||(e.rng||r)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t){n=n||0;for(var i=0;i<16;++i)t[n+i]=a[i];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(s[e[t+0]]+s[e[t+1]]+s[e[t+2]]+s[e[t+3]]+"-"+s[e[t+4]]+s[e[t+5]]+"-"+s[e[t+6]]+s[e[t+7]]+"-"+s[e[t+8]]+s[e[t+9]]+"-"+s[e[t+10]]+s[e[t+11]]+s[e[t+12]]+s[e[t+13]]+s[e[t+14]]+s[e[t+15]]).toLowerCase();if(!o(n))throw TypeError("Stringified UUID is invalid");return n}(a)}const u=["40934651","29829912","110690086","31106024"];!async function(e){async function n(e){if(Array.isArray(e))for(const t of e)await a(t);return e}async function a(n){var a,r,i,o;try{switch(n.extensions.operationName){case"FollowingLive_CurrentUser":{const a=n.data,r=await e.fetch("/youtube/get-streams"),i=await e.fetch("/youtube/get-watched-channels"),o=await e.fetch("/spore/fetch-is-twitch-following-enabled");s$1(r)&&s$1(i)&&s$1(o)&&r.body&&(r.body.forEach((e=>{o.body&&e&&i.body.includes(null==e?void 0:e.twitchId)&&a.currentUser.followedLiveUsers.edges.push(function({title:e,viewersCount:t,profileImageURL:n,previewImageURL:a,displayName:r,login:i,twitchId:o}){return {__typename:"FollowedLiveUserEdge",cursor:"LTE=",node:{__typename:"User",id:o,displayName:r,login:i,profileImageURL:n,stream:{broadcaster:{id:o,primaryColorHex:"00FFE2",__typename:"User",channel:{id:o,self:{isAuthorized:!0,__typename:"ChannelSelfEdge"},__typename:"Channel"}},freeformTags:[],id:d(),previewImageURL:a,game:{id:"-1",name:"YouTube",displayName:"YouTube",boxArtURL:"https://i.postimg.cc/NjQvCPh2/image.png",__typename:"Game"},restriction:null,tags:[],title:e,type:"live",viewersCount:t,__typename:"Stream"}}}}(e));})),a.currentUser.followedLiveUsers.edges.sort(((e,t)=>t.node.stream.viewersCount-e.node.stream.viewersCount)));break}case"PersonalSections":{const a=n.data.personalSections.find((e=>"FOLLOWED_SECTION"===e.type));if(a){const n=await e.fetch("/youtube/get-streams"),r=await e.fetch("/youtube/get-watched-channels"),i=await e.fetch("/spore/fetch-is-twitch-following-enabled");s$1(n)&&s$1(r)&&s$1(i)&&n.body&&(n.body.forEach((e=>{i.body&&e&&r.body.includes(null==e?void 0:e.twitchId)&&a.items.push(function({title:e,viewersCount:t,profileImageURL:n,previewImageURL:a,displayName:r,login:i,twitchId:o}){return {trackingID:d(),promotionsCampaignID:"",user:{id:o,login:i,displayName:r,profileImageURL:n,primaryColorHex:"00FFE2",broadcastSettings:{id:o,title:e,__typename:"BroadcastSettings"},channel:{id:o,creatorAnniversaries:{id:o,isAnniversary:!1,__typename:"CreatorAnniversaries"},__typename:"Channel"},__typename:"User"},label:"NONE",content:{id:d(),previewImageURL:a,broadcaster:{id:o,broadcastSettings:{id:o,title:e,__typename:"BroadcastSettings"},__typename:"User"},freeformTags:[],viewersCount:t,self:{canWatch:!0,isRestricted:!1,restrictionType:null,__typename:"StreamSelfConnection"},game:{id:"-1",displayName:"YouTube",name:"YouTube",__typename:"Game"},type:"live",__typename:"Stream"},__typename:"PersonalSectionChannel"}}(e));})),a.items.sort(((e,t)=>(t.content.viewersCount||0)-(e.content.viewersCount||0))));}break}case"StreamMetadata":{const a=n.data;if(u.includes(a.user.id)){const n=await e.fetch("/youtube/get-stream",a.user.id);s$1(n)&&n.body&&(a.user.lastBroadcast.id="-1",a.user.lastBroadcast.title=n.body.title,a.user.stream={id:"-1",type:"live",createdAt:(new Date).toJSON(),viewersCount:n.body.viewersCount,game:{id:"-1",name:"YouTube",__typename:"Game"},__typename:"Stream"});}break}default:{const s=n.data;if(u.includes(null===(a=s.user)||void 0===a?void 0:a.id)&&(null===(i=null===(r=s.user)||void 0===r?void 0:r.lastBroadcast)||void 0===i?void 0:i.title)){const n=await e.fetch("/youtube/get-stream",null===(o=s.user)||void 0===o?void 0:o.id);s$1(n)&&n.body&&(s.user.lastBroadcast.title=n.body.title);}}}}catch(e){}}const r=window.fetch.bind(window);window.fetch=async function(e,t){const a=await r(e,t);try{let t;if(t="string"==typeof e?e:e.url,!t.includes("gql.twitch.tv/gql"))return a;const r=a.text.bind(a),i=a.json.bind(a);a.text=async function(){const e=await r();try{const t=JSON.parse(e);return await n(t),JSON.stringify(t)}catch(t){return e}},a.json=async function(){const e=await i();try{return await n(e),e}catch(t){return e}};}catch(e){return a}return a};}(new t);
